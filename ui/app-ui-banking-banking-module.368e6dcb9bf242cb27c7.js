(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{oBd1:function(e,t,n){"use strict";n.r(t),n.d(t,"BankingModule",(function(){return om}));var i=n("XDzf"),a=n("VeBv"),c=n("t+Rn"),r=n("rCAV"),o=n("v4xg"),s=n("ObUu"),l=n("QH++"),u=n("2Vo4"),b=n("vkgz"),d=n("xdKd"),m=n("fXoL"),f=n("3qho"),g=n("ofXK"),p=n("I0FJ"),h=n("Zilp"),y=n("IbGL"),x=n("Ae/X"),v=n("3Pt+"),P=n("JFlR"),D=n("Ls5z"),L=n("WYBn"),w=n("chz4"),C=n("4APx"),Q=n("6g1M"),I=n("iXUt"),F=n("DIHi"),T=n("JbOn"),S=n("Aw04"),k=n("qCwG"),O=n("I9hm");function N(e,t){1&e&&m.Lb(0,"hr",7)}const B=function(e){return{"status-label-last":e}};function A(e,t){if(1&e&&(m.Qb(0,"div",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("ngClass",m.jc(2,B,!e.account.user||!e.showUser)),m.xb(1),m.Fc(" ",e.account.type.name," ")}}function E(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",9),m.Dc(2),m.Pb(),m.Qb(3,"div",10),m.Lb(4,"user-link",11),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.Fc(" ",e.i18n.general.user," "),m.xb(2),m.gc("user",e.account.user)}}function $(e,t){1&e&&m.Lb(0,"hr")}function R(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.ac(2,"currency"),m.Nb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.xb(1),m.Fc(" ",m.cc(2,1,e.amount,t.currency)," ")}}const Z=function(e,t,n){return{negative:e,positive:t,"status-value-last":n}};function M(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",12),m.Qb(2,"span",13),m.Dc(3),m.Pb(),m.Pb(),m.Qb(4,"div",14),m.Bc(5,R,3,4,"ng-container",5),m.Pb(),m.Nb()),2&e){const e=t.$implicit,n=t.last,i=m.Zb(2);m.xb(1),m.gc("ngClass",n?"status-label-last":""),m.xb(2),m.Ec(e.label),m.xb(1),m.gc("ngClass",m.lc(4,Z,e.alwaysNegative||i.format.isNegative(e.amount),!e.alwaysNegative&&i.format.isPositive(e.amount),n)),m.xb(1),m.gc("ngIf",e.amount)}}function H(e,t){if(1&e&&(m.Qb(0,"div",1),m.Bc(1,N,1,0,"hr",2),m.Qb(2,"div",3),m.Bc(3,A,2,4,"div",4),m.Bc(4,E,5,2,"ng-container",5),m.Bc(5,$,1,0,"hr",5),m.Bc(6,M,6,8,"ng-container",6),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",e.showSeparator),m.xb(2),m.gc("ngIf",e.showAccount),m.xb(1),m.gc("ngIf",e.account.user&&e.showUser),m.xb(1),m.gc("ngIf",e.showAccount||e.account.user&&e.showUser),m.xb(1),m.gc("ngForOf",e.indicators$.value)}}let q=(()=>{class e extends k.a{constructor(e){super(e),this.mode="current",this._showAccount=!1,this._showUser=!1,this._showSeparator=!1,this.indicators$=new u.a(null)}get showAccount(){return this._showAccount}set showAccount(e){this._showAccount=Object(s.G)(e)}get showUser(){return this._showUser}set showUser(e){this._showUser=Object(s.G)(e)}get showSeparator(){return this._showSeparator}set showSeparator(e){this._showSeparator=Object(s.G)(e)}ngOnInit(){this.updateIndicators()}get status(){return this.account.status}get currency(){return this.account.currency}updateIndicators(){const e=[],t=this.status,n=(t,n,i=!1)=>{t&&e.push({label:n,amount:t,alwaysNegative:!this.format.isZero(t)&&i})};if("current"===this.mode)n(t.balance,this.i18n.account.balance),t.availableBalance!==t.balance&&n(t.availableBalance,this.i18n.account.availableBalance),t.reservedAmount&&!this.format.isZero(t.reservedAmount)&&n(t.reservedAmount,this.i18n.account.reservedAmount,!0),t.creditLimit&&!this.format.isZero(t.creditLimit)&&n(t.creditLimit,this.i18n.account.negativeLimit),t.upperCreditLimit&&!this.format.isZero(t.upperCreditLimit)&&n(t.upperCreditLimit,this.i18n.account.positiveLimit);else{if(this.layout.gtxxs&&null!=t.balanceAtBegin&&n(t.balanceAtBegin,this.i18n.account.balanceOn(this.format.formatAsDate(t.beginDate))),this.layout.gtxxs&&null!=t.balanceAtEnd&&n(t.balanceAtEnd,this.i18n.account.balanceOn(this.format.formatAsDate(t.endDate))),null!=t.incoming&&t.incoming.sum&&n(t.incoming.sum,this.i18n.account.totalIncome),null!=t.outgoing&&t.outgoing.sum){let e=t.outgoing.sum;this.format.isZero(e)||(e="-"+e),n(e,this.i18n.account.totalOutflow)}null!=t.netInflow&&n(t.netInflow,this.i18n.account.netInflow)}this.indicators$.next(e)}ngOnChanges(e){(e.mode||e.account||e.showAccount)&&this.updateIndicators()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["account-status-view"]],inputs:{account:"account",mode:"mode",showAccount:"showAccount",showUser:"showUser",showSeparator:"showSeparator"},features:[m.ub,m.vb],decls:2,vars:3,consts:[["class","container mw-100 px-0",4,"ngIf"],[1,"container","mw-100","px-0"],["class","mt-0",4,"ngIf"],[1,"row","no-gutters"],["class","status-label col-12",3,"ngClass",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mt-0"],[1,"status-label","col-12",3,"ngClass"],[1,"status-label","col-6","col-md-3","mb-0"],[1,"status-label","col-6","col-md-9","mb-0"],[3,"user"],[1,"status-label","col-6","col-sm-3",3,"ngClass"],[1,"ellipsis"],[1,"status-value","col-6","col-sm-3",3,"ngClass"]],template:function(e,t){var n;1&e&&(m.Bc(0,H,7,5,"div",0),m.ac(1,"async")),2&e&&m.gc("ngIf",(null==(n=m.bc(1,1,t.indicators$))?null:n.length)>0)},directives:[g.t,g.s,g.q,D.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();var U=n("oj/z"),V=n("iM3x"),z=n("sifq"),j=n("tyNb"),G=n("yL40");function K(e,t){1&e&&m.Mb(0)}function _(e,t){1&e&&m.Lb(0,"div",15)}function X(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",15),m.Qb(2,"label-value",16),m.Lb(3,"user-link",17),m.Pb(),m.Pb(),m.Bc(4,_,1,0,"div",12),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.account.user),m.xb(1),m.gc("ngIf",e.layout.gtsm$)}}function W(e,t){if(1&e&&m.Lb(0,"field-option",20),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e)("text",e.name)}}function Y(e,t){if(1&e&&(m.Qb(0,"div",15),m.Qb(1,"single-selection-field",18),m.Bc(2,W,1,3,"field-option",19),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.period),m.xb(1),m.gc("ngForOf",e.data.preselectedPeriods)}}function J(e,t){if(1&e&&m.Lb(0,"field-option",20),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e.id)("text",e.name)}}function ee(e,t){if(1&e&&(m.Qb(0,"div",15),m.Qb(1,"multi-selection-field",21),m.Bc(2,J,1,3,"field-option",19),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.account.transferFilter),m.xb(1),m.gc("ngForOf",e.data.transferFilters)}}function te(e,t){1&e&&m.Lb(0,"div",15)}function ne(e,t){if(1&e&&m.Bc(0,te,1,0,"div",12),2&e){const e=m.Zb(3);m.gc("ngIf",e.layout.gtsm$)}}function ie(e,t){if(1&e&&(m.Qb(0,"div",15),m.Lb(1,"date-field",22),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.beginDate)}}function ae(e,t){if(1&e&&(m.Qb(0,"div",15),m.Lb(1,"date-field",23),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.endDate)}}function ce(e,t){if(1&e&&m.Lb(0,"field-option",38),2&e){const e=t.$implicit,n=m.Zb(5);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function re(e,t){if(1&e&&(m.Qb(0,"div",15),m.Qb(1,"multi-selection-field",36),m.Bc(2,ce,1,5,"field-option",37),m.Pb(),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),m.xb(1),m.gc("ngForOf",e.data.groups)}}function oe(e,t){if(1&e&&m.Lb(0,"field-option",41),2&e){const e=t.$implicit;m.gc("id",e.id)("internalName",e.internalName)("value",e.internalName)("text",e.name)}}function se(e,t){if(1&e&&(m.Qb(0,"div",15),m.Qb(1,"multi-selection-field",39),m.Bc(2,oe,1,4,"field-option",40),m.Pb(),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.channel),m.xb(1),m.gc("ngForOf",e.data.channels)}}function le(e,t){if(1&e&&(m.Qb(0,"div",15),m.Lb(1,"input-field",42),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("mask",e.data.transactionNumberMask)("label",e.i18n.transaction.number)}}function ue(e,t){if(1&e&&m.Lb(0,"field-option",45),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.display)}}function be(e,t){if(1&e&&(m.Qb(0,"div",15),m.Qb(1,"single-selection-field",43),m.Bc(2,ue,1,2,"field-option",44),m.Pb(),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.data.operators)}}function de(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",15),m.Lb(2,"decimal-field",24),m.Pb(),m.Qb(3,"div",15),m.Lb(4,"decimal-field",25),m.Pb(),m.Qb(5,"div",15),m.Lb(6,"input-field",26),m.Pb(),m.Qb(7,"div",15),m.Qb(8,"single-selection-field",27),m.Lb(9,"field-option",28),m.Lb(10,"field-option",29),m.Pb(),m.Pb(),m.Bc(11,re,3,3,"div",12),m.Bc(12,se,3,3,"div",12),m.Qb(13,"div",15),m.Lb(14,"user-field",30),m.Pb(),m.Bc(15,le,2,2,"div",12),m.Bc(16,be,3,3,"div",12),m.Qb(17,"div",15),m.Qb(18,"single-selection-field",31),m.Lb(19,"field-option",32),m.Lb(20,"field-option",33),m.Lb(21,"field-option",34),m.Lb(22,"field-option",35),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.gc("label",e.i18n.account.minAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),m.xb(2),m.gc("label",e.i18n.account.maxAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),m.xb(2),m.gc("label",e.i18n.general.description),m.xb(2),m.gc("label",e.i18n.account.direction)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("text",e.i18n.account.incoming),m.xb(1),m.gc("text",e.i18n.account.outgoing),m.xb(1),m.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("ngIf",e.data.transactionNumberMask),m.xb(1),m.gc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),m.xb(2),m.gc("label",e.i18n.general.orderBy),m.xb(1),m.gc("text",e.i18n.account.orderBy.dateDesc),m.xb(1),m.gc("text",e.i18n.account.orderBy.dateAsc),m.xb(1),m.gc("text",e.i18n.account.orderBy.amountAsc),m.xb(1),m.gc("text",e.i18n.account.orderBy.amountDesc)}}const me=function(e){return{"border-0":e}};function fe(e,t){if(1&e&&(m.Qb(0,"form",10),m.ac(1,"async"),m.Qb(2,"div",11),m.Bc(3,X,5,3,"ng-container",6),m.Bc(4,Y,3,2,"div",12),m.Bc(5,ee,3,2,"div",13),m.ac(6,"async"),m.Bc(7,ne,1,1,"ng-template",null,14,m.Cc),m.Bc(9,ie,2,1,"div",12),m.ac(10,"async"),m.Bc(11,ae,2,1,"div",12),m.ac(12,"async"),m.Bc(13,de,23,23,"ng-container",6),m.ac(14,"async"),m.Pb(),m.Pb()),2&e){const e=m.qc(8),t=m.Zb(2);var n,i;m.gc("formGroup",t.form)("ngClass",m.jc(19,me,m.bc(1,9,t.noStatus$))),m.xb(3),m.gc("ngIf",t.data.account.user&&!t.self),m.xb(1),m.gc("ngIf",(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>1),m.xb(1),m.gc("ngIf",m.bc(6,11,t.layout.gtxxs$)&&(null==t.data.transferFilters?null:t.data.transferFilters.length)>1)("ngIfElse",e),m.xb(4),m.gc("ngIf",null==(null==(n=t.form.value||m.bc(10,13,t.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),m.xb(2),m.gc("ngIf",null==(null==(i=t.form.value||m.bc(12,15,t.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),m.xb(2),m.gc("ngIf",m.bc(14,17,t.layout.gtxxs$))}}function ge(e,t){if(1&e&&(m.Lb(0,"account-status-view",47),m.ac(1,"async"),m.ac(2,"async"),m.ac(3,"async"),m.ac(4,"async")),2&e){const e=m.Zb(3);m.gc("account",e.status$.value)("mode",m.bc(1,5,e.moreFilters$)?"period":"current")("showSeparator",m.bc(2,7,e.showForm$))("showAccount",m.bc(3,9,e.layout.xxs$)&&e.multipleAccounts)("showUser",!e.self&&!1===m.bc(4,11,e.showForm$))}}function pe(e,t){1&e&&m.Lb(0,"spinner")}function he(e,t){if(1&e&&(m.Ob(0),m.Bc(1,ge,5,13,"account-status-view",46),m.ac(2,"async"),m.ac(3,"async"),m.Bc(4,pe,1,0,"spinner",6),m.ac(5,"async"),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",m.bc(2,2,e.status$)&&(m.bc(3,4,e.layout.gtxxs$)||0===(null==e.results?null:e.results.page))),m.xb(3),m.gc("ngIf",null===m.bc(5,6,e.status$))}}function ye(e,t){if(1&e&&(m.Qb(0,"mobile-result",48),m.Qb(1,"div",49),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("avatarImage",n.avatarImage(e))("avatarIcon",n.avatarIcon(e))("date",e.date)("amount",e.amount)("currency",n.currency),m.xb(2),m.Fc(" ",n.subjectName(e)," ")}}function xe(e,t){if(1&e&&(m.Qb(0,"th",55),m.Dc(1),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.Ec(e.i18n.general.description)}}function ve(e,t){if(1&e&&(m.Qb(0,"a",61),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2).$implicit,t=m.Zb(3);m.gc("routerLink",t.path(e)),m.xb(1),m.Fc(" ",e.description," ")}}function Pe(e,t){if(1&e&&(m.Qb(0,"td"),m.Bc(1,ve,2,2,"a",60),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.gc("ngIf",e.description)}}const De=function(e,t){return{positive:e,negative:t}};function Le(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",56),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td",51),m.Lb(3,"avatar",57),m.Pb(),m.Qb(4,"td"),m.Qb(5,"a",58),m.Dc(6),m.ac(7,"date"),m.Pb(),m.Pb(),m.Qb(8,"td"),m.Qb(9,"a",58),m.Dc(10),m.Pb(),m.Pb(),m.Bc(11,Pe,2,1,"td",6),m.ac(12,"async"),m.Qb(13,"td",53),m.Qb(14,"a",59),m.Dc(15),m.ac(16,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("image",n.avatarImage(e))("icon",n.avatarIcon(e)),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.bc(7,10,e.date)," "),m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",n.subjectName(e)," "),m.xb(1),m.gc("ngIf",m.bc(12,12,n.layout.gtsm$)),m.xb(3),m.gc("routerLink",n.path(e))("ngClass",m.kc(18,De,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),m.xb(1),m.Fc(" ",m.dc(16,14,e.amount,n.currency,!0)," ")}}function we(e,t){if(1&e&&(m.Qb(0,"table",50),m.Qb(1,"thead"),m.Lb(2,"th",51),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Bc(7,xe,2,1,"th",52),m.ac(8,"async"),m.Qb(9,"th",53),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"tbody"),m.Bc(12,Le,17,21,"ng-container",54),m.ac(13,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(4),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.transaction.fromTo),m.xb(1),m.gc("ngIf",m.bc(8,5,e.layout.gtsm$)),m.xb(3),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(13,7,e.results$))?null:n.results)}}function Ce(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,fe,15,21,"form",5),m.ac(4,"async"),m.Bc(5,he,6,8,"ng-container",6),m.ac(6,"async"),m.Pb(),m.Qb(7,"results-layout",7),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(8,"async"),m.Bc(9,ye,3,6,"mobile-result",8),m.Bc(10,we,14,9,"table",9),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.title)("mobileHeading",m.bc(1,8,e.layout.xxs$)?e.i18n.account.mobileTitle.account:e.title)("headingActions",m.bc(2,10,e.headingActions$)),m.xb(3),m.gc("ngIf",m.bc(4,12,e.showForm$)),m.xb(2),m.gc("ngIf",!1===m.bc(6,14,e.noStatus$)),m.xb(2),m.gc("results",m.bc(8,16,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function Qe(e,t){1&e&&m.Lb(0,"spinner",62)}let Ie=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.accountsService=t,this.bankingHelper=n,this.status$=new u.a(null),this.noStatus$=new u.a(!1),this.showForm$=new u.a(!1)}get type(){return null==this.data?null:this.data.account.type}get number(){return null==this.data?null:this.data.account.number}get currency(){return null==this.data?null:this.data.account.currency}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}get transferFilters(){return null==this.data?null:this.data.transferFilters}get title(){const e=this.type;if(null==e)return this.i18n.account.mobileTitle.account;const t=this.layout.ltsm?null:this.number;return null==t?e.name:e.name+" - "+t}getFormControlNames(){return["transferFilters","preselectedPeriod","periodBegin","periodEnd","minAmount","maxAmount","transactionNumber","direction","user","by","orderBy","groups","channels","description"]}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.ownerParam=e.owner,this.typeParam=e.type,this.self=this.authHelper.isSelf(this.ownerParam),this.multipleAccounts=this.accountTypes.length>1,this.stateManager.cache("data",this.accountsService.getAccountHistoryDataByOwnerAndType({owner:this.ownerParam,accountType:this.typeParam})).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.form.controls.preselectedPeriod.value||this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.exportActions=this.exportHelper.headingActions(e.exportFormats,e=>this.accountsService.exportAccountHistory$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateShowForm(e))),this.addSub(this.moreFilters$.subscribe(()=>this.updateShowForm(e))),this.updateShowForm(e)}updateShowForm(e){this.showForm$.next(this.layout.xxs&&!Object(s.i)(e.preselectedPeriods)||this.moreFilters)}toSearchParams(e){const t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],t.owner=this.ownerParam,t.accountType=this.typeParam,t}doSearch(e){return this.accountsService.searchAccountHistory$Response(e).pipe(Object(b.a)(()=>{e.fields=["status"],this.addSub(this.accountsService.getAccountStatusByOwnerAndType(e).subscribe(e=>{const t=Object.assign(Object.assign({},this.data.account),{status:(e||{}).status});null==t.status?(this.noStatus$.next(!0),this.moreFilters=!0,this.headingActions=this.exportActions):this.headingActions=[this.moreFiltersAction,...this.exportActions],this.status$.next(t)}))}))}get accountTypes(){return(((this.login.auth||{}).permissions||{}).banking.accounts.filter(e=>!1!==e.visible)||[]).map(e=>e.account.type)}subjectName(e){return e.relatedName||this.bankingHelper.subjectName(e.relatedAccount)}path(e){return["/banking","transfer",this.data.account.id,this.bankingHelper.transactionNumberOrId(e)]}avatarIcon(e){return"user"===e.relatedAccount.kind?d.a.PersonCircle:d.a.Briefcase}avatarImage(e){return"user"===e.relatedAccount.kind?e.relatedAccount.user.image:null}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return e=>this.path(e)}resolveMenu(e){const t=new l.a(l.b.ACCOUNT_HISTORY,{accountType:e.account.type});return e.account.kind===i.a.SYSTEM?t:this.menu.userMenu(e.account.user,t)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(a.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["account-history"]],features:[m.ub],decls:8,vars:7,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],["class","filters-form",3,"formGroup","ngClass",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form",3,"formGroup","ngClass"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf","ngIfElse"],["noTransferFilters",""],[1,"col-12","col-md-6"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","transferFilters",3,"label"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["type","text","formControlName","description",3,"label"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","by",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"account","mode","showSeparator","showAccount","showUser",4,"ngIf"],[3,"account","mode","showSeparator","showAccount","showUser"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%",4,"ngIf"],[1,"amount"],[4,"ngFor","ngForOf"],["width","30%"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink","ngClass"],["class","d-inline-block",3,"routerLink",4,"ngIf"],[1,"d-inline-block",3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,K,1,0,"ng-container",1),m.Pb(),m.Bc(4,Ce,11,18,"ng-template",null,2,m.Cc),m.Bc(6,Qe,1,0,"ng-template",null,3,m.Cc)),2&e){const e=m.qc(5);m.gc("ready",m.bc(1,3,t.noStatus$)||m.bc(2,5,t.status$)),m.xb(3),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,h.a,y.a,x.a,v.H,v.v,v.n,g.q,P.a,D.a,L.a,v.u,v.l,g.s,w.a,C.a,Q.a,I.a,F.a,T.a,S.a,q,U.a,V.a,z.a,j.h],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();var Fe=n("TFmz"),Te=n("+HmS"),Se=n("XvX2"),ke=n("9AzD"),Oe=n("fe3a"),Ne=n("uao2");function Be(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",3),m.Dc(2),m.Pb(),m.Qb(3,"div",4),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Qb(6,"div",5),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Qb(9,"div",6),m.Dc(10),m.ac(11,"currency"),m.Pb(),m.Qb(12,"div",3),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Qb(15,"div",3),m.Dc(16),m.Pb(),m.Qb(17,"div",4),m.Dc(18),m.ac(19,"currency"),m.Pb(),m.Qb(20,"div",5),m.Dc(21),m.ac(22,"currency"),m.Pb(),m.Qb(23,"div",6),m.Dc(24),m.ac(25,"currency"),m.Pb(),m.Qb(26,"div",3),m.Dc(27),m.ac(28,"currency"),m.Pb(),m.Qb(29,"div",3),m.Dc(30),m.Pb(),m.Qb(31,"div",4),m.Dc(32),m.Pb(),m.Qb(33,"div",5),m.Dc(34),m.Pb(),m.Qb(35,"div",6),m.Dc(36),m.Pb(),m.Qb(37,"div",3),m.Dc(38),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(2),m.Fc(" ",e.i18n.account.userBalances.balancesSum," "),m.xb(2),m.Fc(" ",m.cc(5,15,e.summary.low.sum,e.currency)," "),m.xb(3),m.Fc(" ",m.cc(8,18,e.summary.medium.sum,e.currency)," "),m.xb(3),m.Fc(" ",m.cc(11,21,e.summary.high.sum,e.currency)," "),m.xb(3),m.Fc(" ",e.totalSum(m.cc(14,24,e.summary.total.sum,e.currency))," "),m.xb(3),m.Fc(" ",e.i18n.account.userBalances.balancesAverage," "),m.xb(2),m.Fc(" ",m.cc(19,27,e.summary.low.average,e.currency)," "),m.xb(3),m.Fc(" ",m.cc(22,30,e.summary.medium.average,e.currency)," "),m.xb(3),m.Fc(" ",m.cc(25,33,e.summary.high.average,e.currency)," "),m.xb(3),m.Fc(" ",e.totalSum(m.cc(28,36,e.summary.total.average,e.currency))," "),m.xb(3),m.Fc(" ",e.i18n.account.userBalances.balancesCount," "),m.xb(2),m.Fc(" ",e.summary.low.count," "),m.xb(2),m.Fc(" ",e.summary.medium.count," "),m.xb(2),m.Fc(" ",e.summary.high.count," "),m.xb(2),m.Fc(" ",e.totalSum(e.summary.total.count)," ")}}function Ae(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",7),m.Dc(2),m.Pb(),m.Qb(3,"div",8),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Qb(6,"div",7),m.Dc(7),m.Pb(),m.Qb(8,"div",8),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"div",7),m.Dc(12),m.Pb(),m.Qb(13,"div",8),m.Dc(14),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(2),m.Fc(" ",e.i18n.account.userBalances.balancesSum," "),m.xb(2),m.Fc(" ",m.cc(5,6,e.summary.total.sum,e.currency)," "),m.xb(3),m.Fc(" ",e.i18n.account.userBalances.balancesAverage," "),m.xb(2),m.Fc(" ",m.cc(10,9,e.summary.total.average,e.currency)," "),m.xb(3),m.Fc(" ",e.i18n.account.userBalances.balancesCount," "),m.xb(2),m.Fc(" ",e.summary.total.count," ")}}let Ee=(()=>{class e extends k.a{constructor(e){super(e),this.hasYellowRange$=new u.a(!1)}get summary(){return this.summary$.value}ngOnInit(){this.summary$.subscribe(e=>this.hasYellowRange$.next(!!e.low))}totalSum(e){return this.i18n.account.userBalances.total+": "+e}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["balances-summary"]],inputs:{summary$:"summary$",currency:"currency"},features:[m.ub],decls:6,vars:6,consts:[[1,"mt-0","mb-0"],[1,"row","no-gutters","my-3"],[4,"ngIf"],[1,"col-12","col-sm-3"],[1,"col-12","col-sm-2","low-balance"],[1,"col-12","col-sm-2","medium-balance"],[1,"col-12","col-sm-2","high-balance"],[1,"col-6","col-sm-3"],[1,"col-6","col-sm-9"]],template:function(e,t){1&e&&(m.Lb(0,"hr",0),m.Qb(1,"div",1),m.Bc(2,Be,39,39,"ng-container",2),m.ac(3,"async"),m.Bc(4,Ae,15,12,"ng-container",2),m.ac(5,"async"),m.Pb()),2&e&&(m.xb(2),m.gc("ngIf",m.bc(3,2,t.hasYellowRange$)),m.xb(2),m.gc("ngIf",!m.bc(5,4,t.hasYellowRange$)))},directives:[g.t],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();var $e=n("IJ5G");function Re(e,t){1&e&&m.Mb(0)}function Ze(e,t){if(1&e&&m.Lb(0,"field-option",19),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e.id)("internalName",e.internalName)("text",e.name)}}function Me(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"max-distance-field",37),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function He(e,t){if(1&e&&m.Lb(0,"field-option",40),2&e){const e=t.$implicit,n=m.Zb(4);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function qe(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"multi-selection-field",38),m.Bc(2,He,1,5,"field-option",39),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),m.xb(1),m.gc("ngForOf",e.data.groups)}}function Ue(e,t){if(1&e&&m.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=m.Zb(4);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ve(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"multi-selection-field",41),m.Bc(2,Ue,1,4,"field-option",42),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.assignedProducts),m.xb(1),m.gc("ngForOf",e.data.products)}}function ze(e,t){if(1&e&&m.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=m.Zb(4);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function je(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"multi-selection-field",44),m.Bc(2,ze,1,4,"field-option",42),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.acceptedAgreements),m.xb(1),m.gc("ngForOf",e.data.agreements)}}function Ge(e,t){if(1&e&&m.Lb(0,"field-option",43),2&e){const e=t.$implicit,n=m.Zb(4);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ke(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"multi-selection-field",45),m.Bc(2,Ge,1,4,"field-option",42),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.notAcceptedAgreements),m.xb(1),m.gc("ngForOf",e.data.agreements)}}function _e(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"basic-profile-field-filter",46),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(3);m.xb(1),m.gc("field",e)("formControl",n.form.get("profileFields").get(e.field))}}function Xe(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"custom-field-filter",46),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(3);m.xb(1),m.gc("field",e)("formControl",n.form.get("profileFields").get(e.internalName))}}function We(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",20),m.Qb(2,"div",7),m.Lb(3,"decimal-field",21),m.Pb(),m.Qb(4,"div",7),m.Lb(5,"decimal-field",22),m.Pb(),m.Qb(6,"div",7),m.Lb(7,"decimal-field",23),m.Pb(),m.Qb(8,"div",7),m.Lb(9,"decimal-field",24),m.Pb(),m.Bc(10,Me,2,2,"div",25),m.Bc(11,qe,3,3,"div",25),m.Bc(12,Ve,3,3,"div",25),m.Bc(13,je,3,3,"div",25),m.Bc(14,Ke,3,3,"div",25),m.Qb(15,"div",26),m.Qb(16,"div",7),m.Lb(17,"date-field",27),m.Pb(),m.Qb(18,"div",7),m.Lb(19,"date-field",28),m.Pb(),m.Pb(),m.Qb(20,"div",26),m.Qb(21,"div",7),m.Lb(22,"date-field",29),m.Pb(),m.Qb(23,"div",7),m.Lb(24,"date-field",30),m.Pb(),m.Pb(),m.Qb(25,"div",26),m.Qb(26,"div",7),m.Lb(27,"date-field",31),m.Pb(),m.Qb(28,"div",7),m.Lb(29,"date-field",32),m.Pb(),m.Pb(),m.Qb(30,"div",26),m.Qb(31,"div",7),m.Lb(32,"date-field",33),m.Pb(),m.Qb(33,"div",7),m.Lb(34,"date-field",34),m.Pb(),m.Pb(),m.Qb(35,"div",7),m.Lb(36,"user-field",35),m.Pb(),m.Bc(37,_e,2,2,"div",36),m.Bc(38,Xe,2,2,"div",36),m.Nb()),2&e){const e=m.Zb(2);m.xb(3),m.gc("label",e.i18n.account.userBalances.minBalance)("scale",0),m.xb(2),m.gc("label",e.i18n.account.userBalances.maxBalance)("scale",0),m.xb(2),m.gc("label",e.i18n.account.userBalances.fromYellowBalance)("scale",0),m.xb(2),m.gc("label",e.i18n.account.userBalances.toYellowBalance)("scale",0),m.xb(1),m.gc("ngIf",e.data.searchByDistanceData),m.xb(1),m.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.products?null:e.data.products.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>1),m.xb(3),m.gc("label",e.i18n.user.creationBegin),m.xb(2),m.gc("label",e.i18n.user.creationEnd),m.xb(3),m.gc("label",e.i18n.user.beginUserActivationDate),m.xb(2),m.gc("label",e.i18n.user.endUserActivationDate),m.xb(3),m.gc("label",e.i18n.user.beginLastLoginDate),m.xb(2),m.gc("label",e.i18n.user.endLastLoginDate),m.xb(3),m.gc("label",e.i18n.account.userBalances.beginNegativeSince),m.xb(2),m.gc("label",e.i18n.account.userBalances.endNegativeSince),m.xb(2),m.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters()),m.xb(1),m.gc("ngForOf",e.data.basicFields),m.xb(1),m.gc("ngForOf",e.customFieldsInSearch)}}function Ye(e,t){if(1&e&&(m.Qb(0,"div",47),m.Qb(1,"single-selection-field",48),m.Lb(2,"field-option",49),m.Lb(3,"field-option",50),m.Lb(4,"field-option",51),m.Lb(5,"field-option",52),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy),m.xb(1),m.gc("text",e.i18n.account.userBalances.orderBy.alphabeticallyDesc),m.xb(1),m.gc("text",e.i18n.account.userBalances.orderBy.alphabeticallyAsc),m.xb(1),m.gc("text",e.i18n.account.userBalances.orderBy.balanceDesc),m.xb(1),m.gc("text",e.i18n.account.userBalances.orderBy.balanceAsc)}}function Je(e,t){if(1&e&&(m.Lb(0,"balances-summary",53),m.ac(1,"async")),2&e){const e=m.Zb(2);m.gc("summary$",e.summary$)("currency",m.bc(1,2,e.currency$))}}function et(e,t){1&e&&m.Lb(0,"spinner")}function tt(e,t){if(1&e&&(m.Qb(0,"mobile-result",54),m.Qb(1,"div",55),m.Qb(2,"div",56),m.Dc(3),m.Pb(),m.Qb(4,"div",57),m.Dc(5),m.ac(6,"currency"),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("avatarImage",e.image)("avatarIcon",n.SvgIcon.Person),m.xb(3),m.Fc(" ",e.display," "),m.xb(2),m.Fc(" ",m.cc(6,4,e.balance,n.findCurrency())," ")}}function nt(e,t){if(1&e&&(m.Qb(0,"th"),m.Dc(1),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.Ec(e.i18n.account.number)}}function it(e,t){if(1&e&&(m.Qb(0,"th"),m.Dc(1),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.account.userBalances.negativeSince,"")}}function at(e,t){if(1&e&&(m.Qb(0,"td"),m.Dc(1),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.Fc("",e.accountNumber," ")}}function ct(e,t){if(1&e&&(m.Qb(0,"td"),m.Dc(1),m.ac(2,"date"),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.Fc(" ",m.bc(2,1,e.negativeSince),"")}}function rt(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",62),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td",59),m.Lb(3,"avatar",63),m.Pb(),m.Qb(4,"td"),m.Dc(5),m.Pb(),m.Bc(6,at,2,1,"td",10),m.ac(7,"async"),m.Bc(8,ct,3,3,"td",10),m.ac(9,"async"),m.Qb(10,"td",60),m.Dc(11),m.ac(12,"currency"),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("image",e.image)("icon",n.SvgIcon.Person),m.xb(2),m.Ec(e.display),m.xb(1),m.gc("ngIf",m.bc(7,6,n.showAccountNumber$)),m.xb(2),m.gc("ngIf",m.bc(9,8,n.showNegativeSince$)),m.xb(3),m.Fc(" ",m.cc(12,10,e.balance,n.findCurrency())," ")}}function ot(e,t){if(1&e&&(m.Qb(0,"table",58),m.Qb(1,"thead"),m.Lb(2,"th",59),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Bc(5,nt,2,1,"th",10),m.ac(6,"async"),m.Bc(7,it,2,1,"th",10),m.ac(8,"async"),m.Qb(9,"th",60),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"tbody"),m.Bc(12,rt,13,13,"ng-container",61),m.ac(13,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(4),m.Ec(e.i18n.general.user),m.xb(1),m.gc("ngIf",m.bc(6,5,e.showAccountNumber$)),m.xb(2),m.gc("ngIf",m.bc(8,7,e.showNegativeSince$)),m.xb(3),m.Ec(e.i18n.account.balance),m.xb(2),m.gc("ngForOf",null==(n=m.bc(13,9,e.results$))?null:n.results)}}function st(e,t){if(1&e&&(m.Qb(0,"map-result",64),m.Qb(1,"div",65),m.Dc(2),m.Pb(),m.Qb(3,"div",65),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("image",e.image)("address",e.address),m.xb(2),m.Fc(" ",e.display,""),m.xb(2),m.Fc(" ",m.cc(5,4,e.balance,n.findCurrency()),"")}}function lt(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Qb(2,"form",5),m.Qb(3,"div",6),m.Qb(4,"div",7),m.Qb(5,"single-selection-field",8),m.Bc(6,Ze,1,4,"field-option",9),m.Pb(),m.Pb(),m.Bc(7,We,39,25,"ng-container",10),m.ac(8,"async"),m.Pb(),m.Pb(),m.Qb(9,"div",6),m.Qb(10,"div",11),m.Lb(11,"result-type-field",12),m.ac(12,"async"),m.Pb(),m.Bc(13,Ye,6,6,"div",13),m.ac(14,"async"),m.Pb(),m.Ob(15),m.Bc(16,Je,2,4,"balances-summary",14),m.ac(17,"async"),m.Bc(18,et,1,0,"spinner",10),m.ac(19,"async"),m.Nb(),m.Pb(),m.Qb(20,"results-layout",15),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(21,"async"),m.Bc(22,tt,7,7,"mobile-result",16),m.Bc(23,ot,14,11,"table",17),m.Bc(24,st,6,7,"map-result",18),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.account.userBalances.title)("mobileHeading",e.i18n.account.userBalances.mobileTitle)("headingActions",m.bc(1,17,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(3),m.gc("label",e.i18n.account.account),m.xb(1),m.gc("ngForOf",e.data.accountTypes),m.xb(1),m.gc("ngIf",m.bc(8,19,e.moreFilters$)),m.xb(4),m.gc("allowedResultTypes",m.bc(12,21,e.allowedResultTypes$))("formControl",e.resultTypeControl),m.xb(2),m.gc("ngIf","map"!==m.bc(14,23,e.resultType$)),m.xb(3),m.gc("ngIf",m.bc(17,25,e.summary$)),m.xb(2),m.gc("ngIf",null===m.bc(19,27,e.summary$)),m.xb(2),m.gc("resultType",e.resultType)("results",m.bc(21,29,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)("toAddress",e.toAddress)}}function ut(e,t){1&e&&m.Lb(0,"spinner",66)}let bt=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.accountsService=t,this.bankingHelper=n,this.summary$=new u.a(null),this.currency$=new u.a(null),this.showAccountNumber$=new u.a(!1),this.showNegativeSince$=new u.a(!1)}getFormControlNames(){return["accountType","minMediumRange","maxMediumRange","minBalance","maxBalance","orderBy","groups","distanceFilter","brokers","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","customValues","endLastLoginPeriod","beginNegativeSincePeriod","endNegativeSincePeriod","notAcceptedAgreements","acceptedAgreements","products"]}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.accountsService.getUserBalancesData()).subscribe(e=>this.data=e),this.allowedResultTypes=(((this.login.auth||{}).permissions||{}).users||{}).map?[Fe.a.LIST,Fe.a.MAP]:[Fe.a.LIST]}onDataInitialized(e){super.onDataInitialized(e),this.customFieldsInSearch=e.customFields.filter(t=>e.fieldsInSearch.includes(t.internalName)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,this.customFieldsInSearch));const t=this.moreFiltersAction;t.breakpoint=null,this.headingActions=[t],this.exportHelper.headingActions(e.exportFormats,e=>this.accountsService.exportUsersWithBalances$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e)),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.accountType.valueChanges.subscribe(e=>{const t=this.data.accountTypes.find(t=>t.id===e);this.updateYellowRange(t),this.currency$.next(t.currency)}));const n=e.accountTypes[0];this.currency$.next(n.currency),this.updateYellowRange(n)}onBeforeRender(e){const t=(null==e?void 0:e.results)||[];this.showAccountNumber$.next(!!t.find(e=>e.accountNumber)),this.showNegativeSince$.next(!!t.find(e=>e.negativeSince))}onResultTypeChanged(e,t){super.onResultTypeChanged(e,t),this.resetPage()}updateYellowRange(e){null!=e.defaultMediumBalanceRange?(this.form.controls.minMediumRange.patchValue(e.defaultMediumBalanceRange.min),this.form.controls.maxMediumRange.patchValue(e.defaultMediumBalanceRange.max)):(this.form.controls.minMediumRange.patchValue(null),this.form.controls.maxMediumRange.patchValue(null))}userSearchFilters(){return{roles:[i.pb.BROKER]}}mapBalance(e){return this.i18n.account.balance+": "+e}toAddress(e){return e.address}getInitialResultType(){return Fe.a.LIST}toSearchParams(e){const t=e;t.ignoreProfileFieldsInList=!0,t.activationPeriod=r.a.dateRangeFilter(e.beginActivationPeriod,e.endActivationPeriod),t.creationPeriod=r.a.dateRangeFilter(e.beginCreationPeriod,e.endCreationPeriod),t.lastLoginPeriod=r.a.dateRangeFilter(e.beginLastLoginPeriod,e.endLastLoginPeriod),t.negativeSincePeriod=r.a.dateRangeFilter(e.beginNegativeSincePeriod,e.endNegativeSincePeriod),e.minBalance&&e.maxBalance&&(t.balanceRange=[e.minBalance,e.maxBalance]),null!=e.minMediumRange&&null!=e.maxMediumRange&&(t.mediumBalanceRange=[e.minMediumRange,e.maxMediumRange]),t.addressResult=this.resultType===Fe.a.MAP?i.Ib.ALL:null,t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);const n=e.distanceFilter;return n&&(t.maxDistance=n.maxDistance,t.latitude=n.latitude,t.longitude=n.longitude),t.fields=[],t}doSearch(e){return this.accountsService.searchUsersWithBalances$Response(e).pipe(Object(b.a)(()=>{this.addSub(this.accountsService.getUserBalancesSummary(e).subscribe(e=>this.summary$.next(e)))}))}findCurrency(){const e=this.form.controls.accountType.value;return e?this.data.accountTypes.find(t=>t.id===e||t.internalName===e).currency:this.currency$.value}currencyDecimalDigits(){const e=this.findCurrency();return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency();return e?e.prefix:null}currencySuffix(){const e=this.findCurrency();return e?e.suffix:null}path(e){return["/users",e.id,"profile"]}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return e=>this.path(e)}resolveMenu(){return l.b.USER_BALANCES_OVERVIEW}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(a.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-user-balances"]],features:[m.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row","filters-row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","accountType",3,"label"],[3,"id","value","internalName","text",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12","col-md-9","col-xs-5"],[3,"allowedResultTypes","formControl"],["class","col-12 col-md-3 col-xs-7",4,"ngIf"],[3,"summary$","currency",4,"ngIf"],[3,"resultType","results","toLink","rendering$","toAddress","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"image","address",4,"resultInfoWindow"],[3,"id","value","internalName","text"],[1,"w-100"],["labelPosition","side","formControlName","minBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","maxBalance","fieldSize","full","allowNegative","",3,"label","scale"],["labelPosition","side","formControlName","minMediumRange","fieldSize","full",3,"label","scale"],["labelPosition","side","formControlName","maxMediumRange","fieldSize","full",3,"label","scale"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endNegativeSincePeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","acceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["labelPosition","side",3,"field","formControl"],[1,"col-12","col-md-3","col-xs-7"],[3,"formControl","display"],["value","alphabeticallyDesc",3,"text"],["value","alphabeticallyAsc",3,"text"],["value","balanceDesc",3,"text"],["value","balanceAsc",3,"text"],[3,"summary$","currency"],[3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main","row"],[1,"col-6","align-text-start"],[1,"col-6","align-text-end","amount"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"image","address"],[1,"font-weight-bold"],[1,"p-3"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Re,1,0,"ng-container",1),m.Pb(),m.Bc(3,lt,25,31,"ng-template",null,2,m.Cc),m.Bc(5,ut,1,0,"ng-template",null,3,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,L.a,v.u,v.l,g.s,Te.a,v.k,h.a,y.a,x.a,Se.a,w.a,I.a,Q.a,T.a,ke.a,C.a,Oe.a,Ne.a,Ee,U.a,V.a,z.a,$e.a],pipes:[g.b,O.a,G.a],encapsulation:2,changeDetection:0}),e})();var dt=n("ZXJw"),mt=n("uuU0"),ft=n("XIp8"),gt=n("UXR7"),pt=n("OTwK"),ht=n("YG2p");function yt(e,t){if(1&e&&(m.Ob(0,4),m.Qb(1,"label-value",5),m.Lb(2,"user-link",6),m.Pb(),m.Qb(3,"label-value",7),m.Dc(4),m.Pb(),m.Qb(5,"h2",8),m.Dc(6),m.Pb(),m.Lb(7,"single-selection-field",9),m.Lb(8,"decimal-field",10),m.ac(9,"async"),m.ac(10,"async"),m.Qb(11,"label-value",11),m.ac(12,"async"),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Qb(15,"h2",8),m.Dc(16),m.Pb(),m.Lb(17,"single-selection-field",12),m.Lb(18,"decimal-field",13),m.ac(19,"async"),m.ac(20,"async"),m.ac(21,"async"),m.ac(22,"async"),m.Qb(23,"label-value",11),m.ac(24,"async"),m.Dc(25),m.ac(26,"currency"),m.Pb(),m.Lb(27,"hr"),m.Lb(28,"textarea-field",14),m.Nb()),2&e){const e=m.Zb();m.gc("formGroup",e.form),m.xb(1),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("label",e.i18n.account.account),m.xb(1),m.Fc(" ",e.data.account.type.name," "),m.xb(2),m.Ec(e.i18n.account.balanceLimits.negativeLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.negativeModeOptions),m.xb(1),m.gc("hidden",m.bc(9,30,e.isDefaultCreditLimit$))("required",!m.bc(10,32,e.isDefaultCreditLimit$))("label",e.i18n.account.balanceLimits.negativeLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(3),m.gc("hidden",!m.bc(12,34,e.isDefaultCreditLimit$))("label",e.i18n.account.balanceLimits.negativeLimit),m.xb(2),m.Fc(" ",m.cc(14,36,e.data.defaultCreditLimit?e.data.defaultCreditLimit:0,e.data.account.currency)," "),m.xb(3),m.Ec(e.i18n.account.balanceLimits.positiveLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.positiveModeOptions),m.xb(1),m.gc("hidden",m.bc(19,39,e.isDefaultUpperCreditLimit$)||m.bc(20,41,e.isUnlimitedUpperCreditLimit$))("required",!(m.bc(21,43,e.isDefaultUpperCreditLimit$)||m.bc(22,45,e.isUnlimitedUpperCreditLimit$)))("label",e.i18n.account.balanceLimits.positiveLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(5),m.gc("hidden",!m.bc(24,47,e.isDefaultUpperCreditLimit$))("label",e.i18n.account.balanceLimits.positiveLimit),m.xb(2),m.Fc(" ",e.data.defaultUpperCreditLimit?m.cc(26,49,e.data.defaultUpperCreditLimit,e.data.account.currency):e.i18n.account.limits.unlimited," "),m.xb(3),m.gc("label",e.i18n.general.comments)}}let xt=(()=>{class e extends mt.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.isDefaultCreditLimit$=new u.a(null),this.isDefaultUpperCreditLimit$=new u.a(null),this.isUnlimitedUpperCreditLimit$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}get positiveModeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e.push({value:"unlimited",text:this.i18n.account.limits.unlimited}),e}get negativeModeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}onDataInitialized(e){super.onDataInitialized(e);const t=e.customCreditLimit?"personalized":"default",n=e.customUpperCreditLimit?e.upperCreditLimit?"personalized":"unlimited":"default";this.form=this.formBuilder.group({creditLimitMode:t,creditLimit:e.creditLimit,upperCreditLimitMode:n,upperCreditLimit:e.upperCreditLimit,comment:null}),this.formControl("creditLimitMode").valueChanges.subscribe(e=>this.onCreditLimitModeChange(e)),this.formControl("upperCreditLimitMode").valueChanges.subscribe(e=>this.onUpperCreditLimitModeChange(e)),this.isDefaultCreditLimit$.next("default"===t),this.isDefaultUpperCreditLimit$.next("default"===n),this.isUnlimitedUpperCreditLimit$.next("unlimited"===n)}onCreditLimitModeChange(e){this.isDefaultCreditLimit$.next("default"===e)}onUpperCreditLimitModeChange(e){this.isDefaultUpperCreditLimit$.next("default"===e),this.isUnlimitedUpperCreditLimit$.next("unlimited"===e)}save(){if(Object(s.I)(this.form),!this.form.valid)return;const e=Object(ft.a)(this.form.value);e.customCreditLimit="default"!==e.creditLimitMode,e.customCreditLimit||delete e.creditLimit,e.customUpperCreditLimit="default"!==e.upperCreditLimitMode,"unlimited"!==e.upperCreditLimitMode&&e.customUpperCreditLimit||delete e.upperCreditLimit,delete e.creditLimitMode,delete e.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.balanceLimits.confirm,createDeviceConfirmation:this.balanceLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doSave(e,t.confirmationPassword)}):this.doSave(e)}doSave(e,t){this.addSub(this.balanceLimitsService.setAccountBalanceLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.account.balanceLimits.saved),this.reload()}))}balanceLimitsDeviceConfirmation(){return()=>({type:i.r.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(dt.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["edit-account-balance-limits"]],features:[m.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],["labelPosition","side","formControlName","creditLimitMode",3,"label","fieldOptions"],["formControlName","creditLimit","negative","",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","upperCreditLimitMode",3,"label","fieldOptions"],["formControlName","upperCreditLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Qb(2,"page-content",1),m.ac(3,"async"),m.Bc(4,yt,29,52,"ng-container",2),m.Qb(5,"actions"),m.Qb(6,"action-button",3),m.Xb("action",(function(){return t.save()})),m.ac(7,"async"),m.Pb(),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.gc("ready",m.bc(1,7,t.data$)),m.xb(2),m.gc("heading",t.i18n.account.balanceLimits.title.edit)("mobileHeading",t.i18n.account.balanceLimits.mobileTitle.edit)("headingActions",m.bc(3,9,t.headingActions$)),m.xb(2),m.gc("ngIf",t.data),m.xb(2),m.gc("disabled",m.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[f.a,p.a,g.t,gt.a,pt.a,v.v,v.n,P.a,D.a,L.a,v.u,v.l,I.a,v.C,ht.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();var vt=n("s7Af");function Pt(e,t){if(1&e){const e=m.Rb();m.Qb(0,"mobile-result",7),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(2);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),m.Qb(1,"div",8),m.Qb(2,"div",9),m.Qb(3,"label-value",10),m.Dc(4),m.Pb(),m.Qb(5,"label-value",10),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Qb(8,"label-value",10),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.account.account),m.xb(1),m.Fc(" ",e.account.type.name," "),m.xb(1),m.gc("label",n.i18n.account.balanceLimits.negative),m.xb(1),m.Fc(" ",m.cc(7,6,e.creditLimit,e.account.currency)," "),m.xb(2),m.gc("label",n.i18n.account.balanceLimits.positive),m.xb(1),m.Fc(" ",e.upperCreditLimit?m.cc(10,9,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function Dt(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",7),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(3);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),m.Qb(1,"td",13),m.Dc(2),m.Pb(),m.Qb(3,"td"),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Qb(6,"td"),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(e.account.type.name),m.xb(2),m.Ec(m.cc(5,3,e.creditLimit,e.account.currency)),m.xb(3),m.Fc(" ",e.upperCreditLimit?m.cc(8,6,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function Lt(e,t){if(1&e&&(m.Qb(0,"table",11),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Pb(),m.Qb(8,"tbody"),m.Bc(9,Dt,9,9,"tr",12),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.account.account),m.xb(2),m.Ec(e.i18n.account.balanceLimits.negativeLimit),m.xb(2),m.Ec(e.i18n.account.balanceLimits.positiveLimit),m.xb(2),m.gc("ngForOf",e.data.accountLimits)}}function wt(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"page-content",2),m.ac(2,"async"),m.Lb(3,"user-info",3),m.Pb(),m.Qb(4,"results-layout",4),m.Bc(5,Pt,11,12,"mobile-result",5),m.Bc(6,Lt,10,4,"table",6),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("mode","normal")("heading",e.i18n.account.balanceLimits.title.list)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.list)("headingActions",m.bc(2,6,e.headingActions$)),m.xb(2),m.gc("user",e.data.user),m.xb(1),m.gc("results",e.data.accountLimits)}}let Ct=(()=>{class e extends mt.a{constructor(e,t){super(e),this.balanceLimitsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.balanceLimitsService.getDataForUserBalanceLimits({user:this.user}).subscribe(e=>{1===e.accountLimits.length?this.router.navigate(this.path(e.accountLimits[0].account.type),{replaceUrl:!0}):this.data=e}))}path(e){return["/banking",this.user,"account-balance-limits",e.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(dt.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["list-accounts-balance-limits"]],features:[m.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","20%"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,wt,7,8,"ng-container",1),m.Pb()),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,vt.a,h.a,y.a,x.a,V.a,P.a,g.s],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function Qt(e,t){if(1&e&&m.Lb(0,"user-info",7),2&e){const e=m.Zb(2);m.gc("user",e.data.user)}}function It(e,t){if(1&e&&(m.Qb(0,"mobile-result"),m.Qb(1,"div",8),m.Qb(2,"div"),m.Qb(3,"div",9),m.Dc(4),m.Pb(),m.Qb(5,"div",10),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(4),m.Ec(e.type.name),m.xb(2),m.Gc(" ",n.i18n.account.balance,": ",m.cc(7,3,e.status.balance,e.currency),"")}}function Ft(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",14),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(3);return a.router.navigate(a.path(i.type)),n.stopPropagation()})),m.Qb(1,"td"),m.Dc(2),m.Pb(),m.Qb(3,"td",12),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit;m.xb(2),m.Ec(e.type.name),m.xb(2),m.Fc(" ",m.cc(5,2,e.status.balance,e.currency),"")}}function Tt(e,t){if(1&e&&(m.Qb(0,"table",11),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th",12),m.Dc(5),m.Pb(),m.Pb(),m.Qb(6,"tbody"),m.Bc(7,Ft,6,5,"tr",13),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.account.account),m.xb(2),m.Ec(e.i18n.account.balance),m.xb(2),m.gc("ngForOf",e.data.accounts)}}function St(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"page-content",2),m.Bc(2,Qt,1,1,"user-info",3),m.Pb(),m.Qb(3,"results-layout",4),m.Bc(4,It,8,6,"mobile-result",5),m.Bc(5,Tt,8,3,"table",6),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("mode",e.self?"emptyFilters":"filters")("heading",e.i18n.account.title.accountsSummary)("mobileHeading",e.i18n.account.mobileTitle.accountsSummary),m.xb(1),m.gc("ngIf",!e.self),m.xb(1),m.gc("results",e.data.accounts)("toLink",e.toLink)}}let kt=(()=>{class e extends mt.a{constructor(e,t){super(e),this.accountsService=t}ngOnInit(){super.ngOnInit(),this.owner=this.route.snapshot.params.owner,this.addSub(this.accountsService.getOwnerAccountsListData({owner:this.owner}).subscribe(e=>this.data=e))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user)}path(e){return["/banking",this.owner,"account",e.id]}get toLink(){return e=>this.path(e.type)}resolveMenu(){return r.a.SYSTEM===this.owner||r.a.SELF===this.owner?l.b.ACCOUNTS_SUMMARY:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(a.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["list-accounts"]],features:[m.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,St,6,6,"ng-container",1),m.Pb()),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,h.a,y.a,x.a,vt.a,V.a,g.s],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function Ot(e,t){1&e&&m.Mb(0)}function Nt(e,t){if(1&e&&m.Lb(0,"field-option",14),2&e){const e=t.$implicit,n=m.Zb(3);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Bt(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"multi-selection-field",12),m.Bc(2,Nt,1,5,"field-option",13),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.user.groupFilter),m.xb(1),m.gc("ngForOf",e.data.groups)}}function At(e,t){if(1&e&&m.Lb(0,"field-option",17),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function Et(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",15),m.Bc(2,At,1,2,"field-option",16),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.currencies)}}function $t(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e.id)("text",e.name)}}function Rt(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",29),m.Bc(2,$t,1,3,"field-option",30),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.account.account)("emptyOption",e.i18n.general.all),m.xb(1),m.gc("ngForOf",e.accountTypes())}}function Zt(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Rt,3,3,"div",6),m.Qb(2,"div",11),m.Lb(3,"single-selection-field",18),m.Pb(),m.Lb(4,"div",19),m.ac(5,"async"),m.Qb(6,"div",20),m.ac(7,"async"),m.Lb(8,"decimal-field",21),m.Pb(),m.Qb(9,"div",20),m.ac(10,"async"),m.Lb(11,"decimal-field",22),m.Pb(),m.Qb(12,"div",11),m.Lb(13,"single-selection-field",23),m.Pb(),m.Lb(14,"div",19),m.ac(15,"async"),m.Qb(16,"div",20),m.ac(17,"async"),m.Lb(18,"decimal-field",24),m.Pb(),m.Qb(19,"div",20),m.ac(20,"async"),m.Lb(21,"decimal-field",25),m.Pb(),m.Qb(22,"div",11),m.Lb(23,"user-field",26),m.Pb(),m.Qb(24,"div",11),m.Lb(25,"user-field",27),m.Pb(),m.Qb(26,"div",11),m.Lb(27,"user-field",28),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.balanceLimits.personalizedNegativeLimit),m.xb(1),m.gc("hidden",!m.bc(5,37,e.isCustomLimit$)),m.xb(2),m.gc("hidden",!m.bc(7,39,e.isCustomLimit$)),m.xb(2),m.gc("label",e.i18n.account.balanceLimits.fromNegativeLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(10,41,e.isCustomLimit$)),m.xb(2),m.gc("label",e.i18n.account.balanceLimits.toNegativeLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.balanceLimits.personalizedPositiveLimit),m.xb(1),m.gc("hidden",!m.bc(15,43,e.isCustomUpperLimit$)),m.xb(2),m.gc("hidden",!m.bc(17,45,e.isCustomUpperLimit$)),m.xb(2),m.gc("label",e.i18n.account.balanceLimits.fromPositiveLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(20,47,e.isCustomUpperLimit$)),m.xb(2),m.gc("label",e.i18n.account.balanceLimits.toPositiveLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("label",e.i18n.general.user)("allowContacts",!1),m.xb(2),m.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters(!0))("allowContacts",!1),m.xb(2),m.gc("label",e.i18n.general.changedBy)("filters",e.userSearchFilters(!1))("allowContacts",!1)}}function Mt(e,t){if(1&e){const e=m.Rb();m.Qb(0,"mobile-result",32),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(2);return a.router.navigate(a.view(i)),n.stopPropagation()})),m.Qb(1,"div",33),m.Qb(2,"div",34),m.Qb(3,"label-value",35),m.Dc(4),m.Pb(),m.Qb(5,"label-value",35),m.Dc(6),m.Pb(),m.Qb(7,"label-value",35),m.Dc(8),m.ac(9,"currency"),m.Pb(),m.Qb(10,"label-value",35),m.Dc(11),m.ac(12,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.general.user),m.xb(1),m.Fc(" ",e.user.display," "),m.xb(1),m.gc("label",n.i18n.account.account),m.xb(1),m.Fc(" ",e.account.type.name," "),m.xb(1),m.gc("label",n.i18n.account.balanceLimits.negative),m.xb(1),m.Fc(" ",e.customCreditLimit?m.cc(9,8,e.creditLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.balanceLimits.positive),m.xb(1),m.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?m.cc(12,11,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," ")}}function Ht(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",32),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(3);return a.router.navigate(a.view(i)),n.stopPropagation()})),m.Qb(1,"td",38),m.Dc(2),m.Pb(),m.Qb(3,"td",38),m.Dc(4),m.Pb(),m.Qb(5,"td"),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Qb(8,"td"),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(e.user.display),m.xb(2),m.Ec(e.account.type.name),m.xb(2),m.Fc(" ",e.customCreditLimit?m.cc(7,4,e.creditLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?m.cc(10,7,e.upperCreditLimit,e.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," ")}}function qt(e,t){if(1&e&&(m.Qb(0,"table",36),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Pb(),m.Qb(10,"tbody"),m.Bc(11,Ht,11,10,"tr",37),m.ac(12,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.user),m.xb(2),m.Ec(e.i18n.account.account),m.xb(2),m.Ec(e.i18n.account.balanceLimits.negativeLimit),m.xb(2),m.Ec(e.i18n.account.balanceLimits.positiveLimit),m.xb(2),m.gc("ngForOf",null==(n=m.bc(12,5,e.results$))?null:n.results)}}function Ut(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"form",4),m.Qb(3,"div",5),m.Bc(4,Bt,3,2,"div",6),m.Bc(5,Et,3,3,"div",6),m.Bc(6,Zt,28,49,"ng-container",7),m.ac(7,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(8,"results-layout",8),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(9,"async"),m.Bc(10,Mt,13,14,"mobile-result",9),m.Bc(11,qt,13,7,"table",10),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.account.balanceLimits.title.overview)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.overview)("headingActions",m.bc(1,9,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),m.xb(1),m.gc("ngIf",(null==e.currencies?null:e.currencies.length)>1),m.xb(1),m.gc("ngIf",m.bc(7,11,e.moreFilters$)),m.xb(2),m.gc("results",m.bc(9,13,e.results$))("rendering$",e.rendering$)}}let Vt=(()=>{class e extends o.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.isCustomLimit$=new u.a(!1),this.isCustomUpperLimit$=new u.a(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","by","currency","customLimit","limitFrom","limitTo","customUpperLimit","upperLimitFrom","upperLimitTo","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.balanceLimitsService.getAccountBalanceLimitsData().subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),(e.accountTypes||[]).forEach(e=>this.currencies.push(e.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customUpperLimit").valueChanges.subscribe(e=>this.isCustomUpperLimit$.next("yes"===e)),this.form.get("customLimit").valueChanges.subscribe(e=>this.isCustomLimit$.next("yes"===e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction]}doSearch(e){return this.balanceLimitsService.searchAccountBalanceLimits$Response(e)}toSearchParams(e){const t=e;return this.isCustomLimit$.value?(t.customLimit=!0,t.customLimitRange=r.a.rangeFilter(e.limitFrom,e.limitTo)):t.customLimit=!e.customLimit&&null,this.isCustomUpperLimit$.value?(t.customUpperLimit=!0,t.customUpperLimitRange=r.a.rangeFilter(e.upperLimitFrom,e.upperLimitTo)):t.customUpperLimit=!e.customUpperLimit&&null,e.broker&&(t.brokers=[e.broker]),t}get customLimitOptions(){const e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}userSearchFilters(e){const t={roles:[i.pb.BROKER]};return e||t.roles.push(i.pb.ADMINISTRATOR),t}updateAccountTypes(e){const t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find(e=>e.id===t).currency.id!==e&&this.form.controls.accountType.setValue(null)}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e.id):t}findCurrency(e){if(this.singleCurrency)return this.singleCurrency;const t=this.form.controls.currency.value;if(t)return this.currencies.find(e=>e.id===t);const n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find(e=>e.id===n).currency:null}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(e){return["/banking",e.user.id,"account-balance-limits",e.account.type.id]}resolveMenu(){return new l.a(l.b.ACCOUNT_BALANCE_LIMITS_OVERVIEW)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(dt.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-balance-limits-overview"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","limitFrom","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","limitTo","negative","","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customUpperLimit",3,"fieldOptions","emptyOption","label"],["formControlName","upperLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","upperLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","25%"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Ot,1,0,"ng-container",1),m.Pb(),m.Bc(3,Ut,12,15,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,h.a,y.a,x.a,C.a,v.u,v.l,g.s,w.a,L.a,I.a,T.a,V.a,P.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();var zt=n("tAww");function jt(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"label-value",5),m.Lb(2,"user-link",6),m.Pb(),m.Qb(3,"label-value",7),m.Dc(4),m.Pb(),m.Qb(5,"h2",8),m.Dc(6),m.Pb(),m.Qb(7,"label-value",7),m.Dc(8),m.ac(9,"currency"),m.Pb(),m.Qb(10,"label-value",7),m.Dc(11),m.Pb(),m.Qb(12,"h2",8),m.Dc(13),m.Pb(),m.Qb(14,"label-value",7),m.Dc(15),m.ac(16,"currency"),m.Pb(),m.Qb(17,"label-value",7),m.Dc(18),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("label",e.i18n.account.account),m.xb(1),m.Fc(" ",e.data.account.type.name," "),m.xb(2),m.Ec(e.i18n.account.balanceLimits.negativeLimit),m.xb(1),m.gc("label",e.i18n.account.balanceLimits.negativeLimit),m.xb(1),m.Fc(" ",m.cc(9,14,e.data.creditLimit,e.data.account.currency)," "),m.xb(2),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.data.customCreditLimit?e.i18n.account.limits.personalized:e.i18n.account.limits.productDefault," "),m.xb(2),m.Ec(e.i18n.account.balanceLimits.positiveLimit),m.xb(1),m.gc("label",e.i18n.account.balanceLimits.positiveLimit),m.xb(1),m.Fc(" ",e.data.upperCreditLimit?m.cc(16,17,e.data.upperCreditLimit,e.data.account.currency):e.i18n.account.limits.unlimited," "),m.xb(2),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.upperCreditLimitMode()," ")}}function Gt(e,t){if(1&e&&(m.Qb(0,"page-content",3),m.ac(1,"async"),m.Bc(2,jt,19,20,"ng-container",4),m.Pb()),2&e){const e=m.Zb();m.gc("heading",e.i18n.account.balanceLimits.title.view)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.view)("headingActions",m.bc(1,4,e.headingActions$)),m.xb(2),m.gc("ngIf",e.data)}}function Kt(e,t){if(1&e&&(m.Qb(0,"label-value",15),m.Dc(1),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.gc("label",t.i18n.general.comments),m.xb(1),m.Fc(" ",e.comment," ")}}function _t(e,t){if(1&e&&(m.Qb(0,"mobile-result"),m.Qb(1,"div",13),m.Qb(2,"div",14),m.Qb(3,"label-value",15),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Qb(6,"label-value",15),m.Dc(7),m.Pb(),m.Qb(8,"label-value",15),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"label-value",15),m.Dc(12),m.ac(13,"currency"),m.Pb(),m.Bc(14,Kt,2,2,"label-value",16),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(5,9,e.date)," "),m.xb(2),m.gc("label",n.i18n.general.performedBy),m.xb(1),m.Fc(" ",e.by.display," "),m.xb(1),m.gc("label",n.i18n.account.balanceLimits.negative),m.xb(1),m.Fc(" ",e.customCreditLimit?m.cc(10,11,e.creditLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.balanceLimits.positive),m.xb(1),m.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?m.cc(13,14,e.upperCreditLimit,n.data.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("ngIf",e.comment)}}function Xt(e,t){if(1&e&&(m.Qb(0,"tr"),m.Qb(1,"td"),m.Dc(2),m.ac(3,"date"),m.Pb(),m.Qb(4,"td"),m.Dc(5),m.Pb(),m.Qb(6,"td"),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Qb(9,"td"),m.Dc(10),m.ac(11,"currency"),m.Pb(),m.Qb(12,"td"),m.Dc(13),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(m.bc(3,5,e.date)),m.xb(3),m.Ec(e.by.display),m.xb(2),m.Fc(" ",e.customCreditLimit?m.cc(8,7,e.creditLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customUpperCreditLimit?e.upperCreditLimit?m.cc(11,10,e.upperCreditLimit,n.data.account.currency):n.i18n.account.limits.unlimited:n.i18n.account.limits.productDefault," "),m.xb(3),m.Ec(e.comment)}}function Wt(e,t){if(1&e&&(m.Qb(0,"table",17),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th"),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"tbody"),m.Bc(13,Xt,14,13,"tr",18),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.general.performedBy),m.xb(2),m.Ec(e.i18n.account.balanceLimits.negative),m.xb(2),m.Ec(e.i18n.account.balanceLimits.positive),m.xb(2),m.Ec(e.i18n.general.comments),m.xb(2),m.gc("ngForOf",e.data.history)}}function Yt(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"page-content",9),m.ac(2,"async"),m.Lb(3,"user-info",6),m.Pb(),m.Qb(4,"results-layout",10),m.Bc(5,_t,15,17,"mobile-result",11),m.Bc(6,Wt,14,6,"table",12),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("mode","empty")("heading",e.i18n.account.balanceLimits.title.history)("mobileHeading",e.i18n.account.balanceLimits.mobileTitle.history)("headingActions",m.bc(2,6,e.headingActions$)),m.xb(2),m.gc("user",e.data.user),m.xb(1),m.gc("results",e.data.history)}}let Jt=(()=>{class e extends mt.a{constructor(e,t){super(e),this.balanceLimitsService=t,this.step$=new u.a("details")}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.balanceLimitsService.getAccountBalanceLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.detailsHeadingActions=[],e.editable&&this.detailsHeadingActions.push(new zt.c(d.a.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.detailsHeadingActions.push(new zt.c(d.a.Clock,this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=[],e.editable&&this.historyHeadingActions.push(new zt.c(d.a.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.historyHeadingActions.push(new zt.c(d.a.ArrowLeft,this.i18n.general.details,()=>this.showView()))}upperCreditLimitMode(){return this.data.upperCreditLimit?this.data.customUpperCreditLimit?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault:this.data.customUpperCreditLimit?this.i18n.account.limits.unlimited:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-balance-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(dt.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["view-account-balance-limits"]],features:[m.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table",4,"resultTable"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],["labelPosition","sideForced",3,"label",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,Gt,3,6,"page-content",1),m.Bc(4,Yt,7,8,"ng-container",2),m.Pb()),2&e&&(m.gc("ready",m.bc(1,4,t.data$))("ngSwitch",m.bc(2,6,t.step$)),m.xb(3),m.gc("ngSwitchCase","details"),m.xb(1),m.gc("ngSwitchCase","history"))},directives:[f.a,g.x,g.y,p.a,g.t,P.a,D.a,vt.a,h.a,y.a,x.a,V.a,g.s],pipes:[g.b,O.a,G.a],encapsulation:2,changeDetection:0}),e})();var en=n("TJod");function tn(e,t){if(1&e&&(m.Ob(0,4),m.Qb(1,"label-value",5),m.Lb(2,"user-link",6),m.Pb(),m.Qb(3,"label-value",7),m.Dc(4),m.Pb(),m.Qb(5,"h2",8),m.Dc(6),m.Pb(),m.Lb(7,"single-selection-field",9),m.Lb(8,"decimal-field",10),m.ac(9,"async"),m.ac(10,"async"),m.Qb(11,"label-value",11),m.ac(12,"async"),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Qb(15,"h2",8),m.Dc(16),m.Pb(),m.Lb(17,"single-selection-field",12),m.Lb(18,"decimal-field",13),m.ac(19,"async"),m.ac(20,"async"),m.Qb(21,"label-value",11),m.ac(22,"async"),m.Dc(23),m.ac(24,"currency"),m.Pb(),m.Qb(25,"h2",8),m.Dc(26),m.Pb(),m.Lb(27,"single-selection-field",14),m.Lb(28,"decimal-field",15),m.ac(29,"async"),m.ac(30,"async"),m.Qb(31,"label-value",11),m.ac(32,"async"),m.Dc(33),m.ac(34,"currency"),m.Pb(),m.Qb(35,"h2",8),m.Dc(36),m.Pb(),m.Lb(37,"single-selection-field",16),m.Lb(38,"decimal-field",17),m.ac(39,"async"),m.ac(40,"async"),m.Qb(41,"label-value",11),m.ac(42,"async"),m.Dc(43),m.ac(44,"currency"),m.Pb(),m.Lb(45,"hr"),m.Lb(46,"textarea-field",18),m.Nb()),2&e){const e=m.Zb();m.gc("formGroup",e.form),m.xb(1),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("label",e.i18n.account.account),m.xb(1),m.Fc(" ",e.data.account.type.name," "),m.xb(2),m.Ec(e.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),m.xb(1),m.gc("hidden",m.bc(9,54,e.isDefaultPaymentLimit$))("required",!m.bc(10,56,e.isDefaultPaymentLimit$))("label",e.i18n.account.paymentLimits.paymentLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(3),m.gc("hidden",!m.bc(12,58,e.isDefaultPaymentLimit$))("label",e.i18n.account.paymentLimits.paymentLimit),m.xb(2),m.Fc(" ",m.cc(14,60,e.data.productAmountLimit?e.data.productAmountLimit:0,e.data.account.currency)," "),m.xb(3),m.Ec(e.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),m.xb(1),m.gc("hidden",m.bc(19,63,e.isDefaultDailyLimit$))("required",!m.bc(20,65,e.isDefaultDailyLimit$))("label",e.i18n.account.paymentLimits.dailyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(3),m.gc("hidden",!m.bc(22,67,e.isDefaultDailyLimit$))("label",e.i18n.account.paymentLimits.dailyLimit),m.xb(2),m.Fc(" ",m.cc(24,69,e.data.productAmountPerDayLimit?e.data.productAmountPerDayLimit:0,e.data.account.currency)," "),m.xb(3),m.Ec(e.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),m.xb(1),m.gc("hidden",m.bc(29,72,e.isDefaultWeeklyLimit$))("required",!m.bc(30,74,e.isDefaultWeeklyLimit$))("label",e.i18n.account.paymentLimits.weeklyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(3),m.gc("hidden",!m.bc(32,76,e.isDefaultWeeklyLimit$))("label",e.i18n.account.paymentLimits.weeklyLimit),m.xb(2),m.Fc(" ",m.cc(34,78,e.data.productAmountPerWeekLimit?e.data.productAmountPerWeekLimit:0,e.data.account.currency)," "),m.xb(3),m.Ec(e.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.gc("label",e.i18n.account.limits.mode)("fieldOptions",e.modeOptions),m.xb(1),m.gc("hidden",m.bc(39,81,e.isDefaultMonthlyLimit$))("required",!m.bc(40,83,e.isDefaultMonthlyLimit$))("label",e.i18n.account.paymentLimits.monthlyLimit)("scale",e.data.account.currency.decimalDigits)("prefix",e.data.account.currency.prefix)("suffix",e.data.account.currency.suffix),m.xb(3),m.gc("hidden",!m.bc(42,85,e.isDefaultMonthlyLimit$))("label",e.i18n.account.paymentLimits.monthlyLimit),m.xb(2),m.Fc(" ",m.cc(44,87,e.data.productAmountPerMonthLimit?e.data.productAmountPerMonthLimit:0,e.data.account.currency)," "),m.xb(3),m.gc("label",e.i18n.general.comments)}}let nn=(()=>{class e extends mt.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.isDefaultPaymentLimit$=new u.a(null),this.isDefaultDailyLimit$=new u.a(null),this.isDefaultWeeklyLimit$=new u.a(null),this.isDefaultMonthlyLimit$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}get modeOptions(){const e=[{value:"default",text:this.i18n.account.limits.productDefault}];return e.push({value:"personalized",text:this.i18n.account.limits.personalized}),e}mode(e){return e?"personalized":"default"}onDataInitialized(e){super.onDataInitialized(e);const t=this.mode(e.customAmountLimit),n=this.mode(e.customAmountPerDayLimit),i=this.mode(e.customAmountPerWeekLimit),a=this.mode(e.customAmountPerMonthLimit);this.form=this.formBuilder.group({paymentLimitMode:t,amountLimit:e.amountLimit,dailyLimitMode:n,amountPerDayLimit:e.amountPerDayLimit,weeklyLimitMode:i,amountPerWeekLimit:e.amountPerWeekLimit,monthlyLimitMode:a,amountPerMonthLimit:e.amountPerMonthLimit,comment:null}),this.formControl("paymentLimitMode").valueChanges.subscribe(e=>this.isDefaultPaymentLimit$.next("default"===e)),this.isDefaultPaymentLimit$.next("default"===t),this.formControl("dailyLimitMode").valueChanges.subscribe(e=>this.isDefaultDailyLimit$.next("default"===e)),this.isDefaultDailyLimit$.next("default"===n),this.formControl("weeklyLimitMode").valueChanges.subscribe(e=>this.isDefaultWeeklyLimit$.next("default"===e)),this.isDefaultWeeklyLimit$.next("default"===i),this.formControl("monthlyLimitMode").valueChanges.subscribe(e=>this.isDefaultMonthlyLimit$.next("default"===e)),this.isDefaultMonthlyLimit$.next("default"===a)}save(){if(Object(s.I)(this.form),!this.form.valid)return;const e=Object(ft.a)(this.form.value);e.customAmountLimit="default"!==e.paymentLimitMode,e.customAmountLimit||delete e.amountLimit,e.customAmountPerDayLimit="default"!==e.dailyLimitMode,e.customAmountPerDayLimit||delete e.amountPerDayLimit,e.customAmountPerWeekLimit="default"!==e.weeklyLimitMode,e.customAmountPerWeekLimit||delete e.amountPerWeekLimit,e.customAmountPerMonthLimit="default"!==e.monthlyLimitMode,e.customAmountPerMonthLimit||delete e.amountPerMonthLimit,delete e.creditLimitMode,delete e.upperCreditLimitMode,this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.account.paymentLimits.confirm,createDeviceConfirmation:this.paymentLimitsDeviceConfirmation(),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doSave(e,t.confirmationPassword)}):this.doSave(e)}doSave(e,t){this.addSub(this.paymentLimitsService.setAccountPaymentLimits({user:this.user,accountType:this.accountType,confirmationPassword:t,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.account.paymentLimits.saved),this.reload()}))}paymentLimitsDeviceConfirmation(){return()=>({type:i.r.CHANGE_ACCOUNT_LIMITS,account:this.data.account.id})}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(en.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["edit-account-payment-limits"]],features:[m.ub],decls:8,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],["labelPosition","side","formControlName","paymentLimitMode",3,"label","fieldOptions"],["formControlName","amountLimit",3,"hidden","required","label","scale","prefix","suffix"],[3,"hidden","label"],["labelPosition","side","formControlName","dailyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerDayLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","weeklyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerWeekLimit",3,"hidden","required","label","scale","prefix","suffix"],["labelPosition","side","formControlName","monthlyLimitMode",3,"label","fieldOptions"],["formControlName","amountPerMonthLimit",3,"hidden","required","label","scale","prefix","suffix"],["formControlName","comment",1,"mt-4",3,"label"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Qb(2,"page-content",1),m.ac(3,"async"),m.Bc(4,tn,47,90,"ng-container",2),m.Qb(5,"actions"),m.Qb(6,"action-button",3),m.Xb("action",(function(){return t.save()})),m.ac(7,"async"),m.Pb(),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.gc("ready",m.bc(1,7,t.data$)),m.xb(2),m.gc("heading",t.i18n.account.paymentLimits.title.edit)("mobileHeading",t.i18n.account.paymentLimits.mobileTitle.edit)("headingActions",m.bc(3,9,t.headingActions$)),m.xb(2),m.gc("ngIf",t.data),m.xb(2),m.gc("disabled",m.bc(7,11,t.requesting$))("label",t.i18n.general.save))},directives:[f.a,p.a,g.t,gt.a,pt.a,v.v,v.n,P.a,D.a,L.a,v.u,v.l,I.a,v.C,ht.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function an(e,t){if(1&e){const e=m.Rb();m.Qb(0,"mobile-result",7),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(2);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),m.Qb(1,"div",8),m.Qb(2,"div",9),m.Qb(3,"label-value",10),m.Dc(4),m.Pb(),m.Qb(5,"label-value",10),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Qb(8,"label-value",10),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"label-value",10),m.Dc(12),m.ac(13,"currency"),m.Pb(),m.Qb(14,"label-value",10),m.Dc(15),m.ac(16,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.account.account),m.xb(1),m.Fc(" ",e.account.type.name," "),m.xb(1),m.gc("label",n.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.Fc(" ",e.amountLimit?m.cc(7,10,e.amountLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.Fc(" ",e.amountPerDayLimit?m.cc(10,13,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.Fc(" ",e.amountPerWeekLimit?m.cc(13,16,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.Fc(" ",e.amountPerMonthLimit?m.cc(16,19,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function cn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",7),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(3);return a.router.navigate(a.path(i.account.type)),n.stopPropagation()})),m.Qb(1,"td",13),m.Dc(2),m.Pb(),m.Qb(3,"td"),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Qb(6,"td"),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Qb(9,"td"),m.Dc(10),m.ac(11,"currency"),m.Pb(),m.Qb(12,"td"),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(e.account.type.name),m.xb(2),m.Fc(" ",e.amountLimit?m.cc(5,5,e.amountLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(3),m.Fc(" ",e.amountPerDayLimit?m.cc(8,8,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(3),m.Fc(" ",e.amountPerWeekLimit?m.cc(11,11,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.unlimited," "),m.xb(3),m.Fc(" ",e.amountPerMonthLimit?m.cc(14,14,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.unlimited," ")}}function rn(e,t){if(1&e&&(m.Qb(0,"table",11),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th"),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"tbody"),m.Bc(13,cn,15,17,"tr",12),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.account.account),m.xb(2),m.Ec(e.i18n.account.paymentLimits.paymentLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.dailyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.weeklyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.monthlyLimit),m.xb(2),m.gc("ngForOf",e.data.accountLimits)}}function on(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"page-content",2),m.ac(2,"async"),m.Lb(3,"user-info",3),m.Pb(),m.Qb(4,"results-layout",4),m.Bc(5,an,17,22,"mobile-result",5),m.Bc(6,rn,14,6,"table",6),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("mode","normal")("heading",e.i18n.account.paymentLimits.title.list)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.list)("headingActions",m.bc(2,6,e.headingActions$)),m.xb(2),m.gc("user",e.data.user),m.xb(1),m.gc("results",e.data.accountLimits)}}let sn=(()=>{class e extends mt.a{constructor(e,t){super(e),this.paymentLimitsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.paymentLimitsService.getDataForUserPaymentLimits({user:this.user}).subscribe(e=>{1===e.accountLimits.length?this.router.navigate(this.path(e.accountLimits[0].account.type),{replaceUrl:!0}):this.data=e}))}path(e){return["/banking",this.user,"account-payment-limits",e.id]}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(en.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["list-accounts-payment-limits"]],features:[m.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"user"],[3,"results"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],["width","20%"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,on,7,8,"ng-container",1),m.Pb()),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,vt.a,h.a,y.a,x.a,V.a,P.a,g.s],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function ln(e,t){1&e&&m.Mb(0)}function un(e,t){if(1&e&&m.Lb(0,"field-option",14),2&e){const e=t.$implicit,n=m.Zb(3);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function bn(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"multi-selection-field",12),m.Bc(2,un,1,5,"field-option",13),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.user.groupFilter),m.xb(1),m.gc("ngForOf",e.data.groups)}}function dn(e,t){if(1&e&&m.Lb(0,"field-option",17),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function mn(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",15),m.Bc(2,dn,1,2,"field-option",16),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.currencies)}}function fn(e,t){if(1&e&&m.Lb(0,"field-option",37),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e.id)("text",e.name)}}function gn(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",35),m.Bc(2,fn,1,3,"field-option",36),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.account.account)("emptyOption",e.i18n.general.all),m.xb(1),m.gc("ngForOf",e.accountTypes())}}function pn(e,t){if(1&e&&(m.Ob(0),m.Bc(1,gn,3,3,"div",6),m.Qb(2,"div",11),m.Lb(3,"single-selection-field",18),m.Pb(),m.Lb(4,"div",19),m.ac(5,"async"),m.Qb(6,"div",20),m.ac(7,"async"),m.Lb(8,"decimal-field",21),m.Pb(),m.Qb(9,"div",20),m.ac(10,"async"),m.Lb(11,"decimal-field",22),m.Pb(),m.Qb(12,"div",11),m.Lb(13,"single-selection-field",23),m.Pb(),m.Lb(14,"div",19),m.ac(15,"async"),m.Qb(16,"div",20),m.ac(17,"async"),m.Lb(18,"decimal-field",24),m.Pb(),m.Qb(19,"div",20),m.ac(20,"async"),m.Lb(21,"decimal-field",25),m.Pb(),m.Qb(22,"div",11),m.Lb(23,"single-selection-field",26),m.Pb(),m.Lb(24,"div",19),m.ac(25,"async"),m.Qb(26,"div",20),m.ac(27,"async"),m.Lb(28,"decimal-field",27),m.Pb(),m.Qb(29,"div",20),m.ac(30,"async"),m.Lb(31,"decimal-field",28),m.Pb(),m.Qb(32,"div",11),m.Lb(33,"single-selection-field",29),m.Pb(),m.Lb(34,"div",19),m.ac(35,"async"),m.Qb(36,"div",20),m.ac(37,"async"),m.Lb(38,"decimal-field",30),m.Pb(),m.Qb(39,"div",20),m.ac(40,"async"),m.Lb(41,"decimal-field",31),m.Pb(),m.Qb(42,"div",11),m.Lb(43,"user-field",32),m.Pb(),m.Qb(44,"div",11),m.Lb(45,"user-field",33),m.Pb(),m.Qb(46,"div",11),m.Lb(47,"user-field",34),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedPaymentLimit),m.xb(1),m.gc("hidden",!m.bc(5,65,e.isCustomPaymentLimit$)),m.xb(2),m.gc("hidden",!m.bc(7,67,e.isCustomPaymentLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.fromPaymentLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(10,69,e.isCustomPaymentLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.toPaymentLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedDailyLimit),m.xb(1),m.gc("hidden",!m.bc(15,71,e.isCustomDailyLimit$)),m.xb(2),m.gc("hidden",!m.bc(17,73,e.isCustomDailyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.fromDailyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(20,75,e.isCustomDailyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.toDailyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedWeeklyLimit),m.xb(1),m.gc("hidden",!m.bc(25,77,e.isCustomWeeklyLimit$)),m.xb(2),m.gc("hidden",!m.bc(27,79,e.isCustomWeeklyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.fromWeeklyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(30,81,e.isCustomWeeklyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.toWeeklyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("fieldOptions",e.customLimitOptions)("emptyOption",e.i18n.general.all)("label",e.i18n.account.paymentLimits.personalizedMonthlyLimit),m.xb(1),m.gc("hidden",!m.bc(35,83,e.isCustomMonthlyLimit$)),m.xb(2),m.gc("hidden",!m.bc(37,85,e.isCustomMonthlyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.fromMonthlyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(1),m.gc("hidden",!m.bc(40,87,e.isCustomMonthlyLimit$)),m.xb(2),m.gc("label",e.i18n.account.paymentLimits.toMonthlyLimit)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("label",e.i18n.general.user)("allowContacts",!1),m.xb(2),m.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters(!0))("allowContacts",!1),m.xb(2),m.gc("label",e.i18n.general.changedBy)("filters",e.userSearchFilters(!1))("allowContacts",!1)}}function hn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"mobile-result",38),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(2);return a.router.navigate(a.view(i)),n.stopPropagation()})),m.Qb(1,"div",39),m.Qb(2,"div",40),m.Qb(3,"label-value",41),m.Dc(4),m.Pb(),m.Qb(5,"label-value",41),m.Dc(6),m.Pb(),m.Qb(7,"label-value",41),m.Dc(8),m.ac(9,"currency"),m.Pb(),m.Qb(10,"label-value",41),m.Dc(11),m.ac(12,"currency"),m.Pb(),m.Qb(13,"label-value",41),m.Dc(14),m.ac(15,"currency"),m.Pb(),m.Qb(16,"label-value",41),m.Dc(17),m.ac(18,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.general.user),m.xb(1),m.Fc(" ",e.user.display," "),m.xb(1),m.gc("label",n.i18n.account.account),m.xb(1),m.Fc(" ",e.account.type.name," "),m.xb(1),m.gc("label",n.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.Fc(" ",e.customAmountLimit?m.cc(9,12,e.amountLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.Fc(" ",e.customAmountPerDayLimit?m.cc(12,15,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.Fc(" ",e.customAmountPerWeekLimit?m.cc(15,18,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.Fc(" ",e.customAmountPerMonthLimit?m.cc(18,21,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.productDefault," ")}}function yn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",38),m.Xb("click",(function(n){m.sc(e);const i=t.$implicit,a=m.Zb(3);return a.router.navigate(a.view(i)),n.stopPropagation()})),m.Qb(1,"td"),m.Dc(2),m.Pb(),m.Qb(3,"td"),m.Dc(4),m.Pb(),m.Qb(5,"td"),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Qb(8,"td"),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"td"),m.Dc(12),m.ac(13,"currency"),m.Pb(),m.Qb(14,"td"),m.Dc(15),m.ac(16,"currency"),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(e.user.display),m.xb(2),m.Ec(e.account.type.name),m.xb(2),m.Fc(" ",e.customAmountLimit?m.cc(7,6,e.amountLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerDayLimit?m.cc(10,9,e.amountPerDayLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerWeekLimit?m.cc(13,12,e.amountPerWeekLimit,e.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerMonthLimit?m.cc(16,15,e.amountPerMonthLimit,e.account.currency):n.i18n.account.limits.productDefault," ")}}function xn(e,t){if(1&e&&(m.Qb(0,"table",42),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th"),m.Dc(11),m.Pb(),m.Qb(12,"th"),m.Dc(13),m.Pb(),m.Pb(),m.Qb(14,"tbody"),m.Bc(15,yn,17,18,"tr",43),m.ac(16,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.user),m.xb(2),m.Ec(e.i18n.account.account),m.xb(2),m.Ec(e.i18n.account.paymentLimits.paymentLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.dailyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.weeklyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.monthlyLimit),m.xb(2),m.gc("ngForOf",null==(n=m.bc(16,7,e.results$))?null:n.results)}}function vn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"form",4),m.Qb(3,"div",5),m.Bc(4,bn,3,2,"div",6),m.Bc(5,mn,3,3,"div",6),m.Bc(6,pn,48,89,"ng-container",7),m.ac(7,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(8,"results-layout",8),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(9,"async"),m.Bc(10,hn,19,24,"mobile-result",9),m.Bc(11,xn,17,9,"table",10),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.account.paymentLimits.title.overview)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.overview)("headingActions",m.bc(1,9,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),m.xb(1),m.gc("ngIf",(null==e.currencies?null:e.currencies.length)>1),m.xb(1),m.gc("ngIf",m.bc(7,11,e.moreFilters$)),m.xb(2),m.gc("results",m.bc(9,13,e.results$))("rendering$",e.rendering$)}}let Pn=(()=>{class e extends o.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.isCustomPaymentLimit$=new u.a(!1),this.isCustomDailyLimit$=new u.a(!1),this.isCustomWeeklyLimit$=new u.a(!1),this.isCustomMonthlyLimit$=new u.a(!1),this.currencies=[]}getFormControlNames(){return["accountType","broker","by","currency","customAmountLimit","paymentLimitFrom","paymentLimitTo","dailyLimitFrom","dailyLimitTo","customAmountPerDayLimit","customAmountPerWeekLimit","weeklyLimitFrom","weeklyLimitTo","customAmountPerMonthLimit","monthlyLimitFrom","monthlyLimitTo","groups","user"]}ngOnInit(){super.ngOnInit(),this.addSub(this.paymentLimitsService.getAccountPaymentLimitsData().subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),(e.accountTypes||[]).forEach(e=>this.currencies.push(e.currency)),this.singleCurrency=1===this.currencies.length?this.currencies[0]:null,this.form.get("customAmountLimit").valueChanges.subscribe(e=>this.isCustomPaymentLimit$.next("yes"===e)),this.form.get("customAmountPerDayLimit").valueChanges.subscribe(e=>this.isCustomDailyLimit$.next("yes"===e)),this.form.get("customAmountPerWeekLimit").valueChanges.subscribe(e=>this.isCustomWeeklyLimit$.next("yes"===e)),this.form.get("customAmountPerMonthLimit").valueChanges.subscribe(e=>this.isCustomMonthlyLimit$.next("yes"===e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction]}doSearch(e){return this.paymentLimitsService.searchAccountPaymentLimits$Response(e)}toSearchParams(e){const t=e;return this.isCustomPaymentLimit$.value?(t.customAmountLimit=!0,t.customAmountLimitRange=r.a.rangeFilter(e.paymentLimitFrom,e.paymentLimitTo)):t.customAmountLimit=!e.customAmountLimit&&null,this.isCustomDailyLimit$.value?(t.customAmountPerDayLimit=!0,t.customAmountPerDayLimitRange=r.a.rangeFilter(e.dailyLimitFrom,e.dailyLimitTo)):t.customAmountPerDayLimit=!e.customAmountPerDayLimit&&null,this.isCustomWeeklyLimit$.value?(t.customAmountPerWeekLimit=!0,t.customAmountPerWeekLimitRange=r.a.rangeFilter(e.weeklyLimitFrom,e.weeklyLimitTo)):t.customAmountPerWeekLimit=!e.customAmountPerWeekLimit&&null,this.isCustomMonthlyLimit$.value?(t.customAmountPerMonthLimit=!0,t.customAmountPerMonthLimitRange=r.a.rangeFilter(e.monthlyLimitFrom,e.monthlyLimitTo)):t.customAmountPerMonthLimit=!e.customAmountPerMonthLimit&&null,e.broker&&(t.brokers=[e.broker]),t}get customLimitOptions(){const e=[{value:"yes",text:this.i18n.general.yes}];return e.push({value:"no",text:this.i18n.general.no}),e}userSearchFilters(e){const t={roles:[i.pb.BROKER]};return e||t.roles.push(i.pb.ADMINISTRATOR),t}updateAccountTypes(e){const t=this.form.controls.accountType.value;e&&t&&this.data.accountTypes.find(e=>e.id===t).currency.id!==e&&this.form.controls.accountType.setValue(null)}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e.id):t}findCurrency(e){if(this.singleCurrency)return this.singleCurrency;const t=this.form.controls.currency.value;if(t)return this.currencies.find(e=>e.id===t);const n=this.form.controls.accountType.value;return e&&n?this.data.accountTypes.find(e=>e.id===n).currency:null}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}view(e){return["/banking",e.user.id,"account-payment-limits",e.account.type.id]}resolveMenu(){return new l.a(l.b.ACCOUNT_PAYMENT_LIMITS_OVERVIEW)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(en.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-payment-limits-overview"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[3,"results","rendering$","update"],[3,"click",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","customAmountLimit",3,"fieldOptions","emptyOption","label"],[1,"w-100",3,"hidden"],[1,"col-12","col-md-6",3,"hidden"],["formControlName","paymentLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","paymentLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerDayLimit",3,"fieldOptions","emptyOption","label"],["formControlName","dailyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","dailyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerWeekLimit",3,"fieldOptions","emptyOption","label"],["formControlName","weeklyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","weeklyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","customAmountPerMonthLimit",3,"fieldOptions","emptyOption","label"],["formControlName","monthlyLimitFrom","fieldSize","full",3,"label","scale","prefix","suffix"],["formControlName","monthlyLimitTo","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label","allowContacts"],["labelPosition","side","formControlName","broker",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","by",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[3,"click"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,ln,1,0,"ng-container",1),m.Pb(),m.Bc(3,vn,12,15,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,h.a,y.a,x.a,C.a,v.u,v.l,g.s,w.a,L.a,I.a,T.a,V.a,P.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function Dn(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"label-value",5),m.Lb(2,"user-link",6),m.Pb(),m.Qb(3,"label-value",7),m.Dc(4),m.Pb(),m.Qb(5,"h2",8),m.Dc(6),m.Pb(),m.Qb(7,"label-value",7),m.Dc(8),m.Pb(),m.Qb(9,"label-value",7),m.Dc(10),m.Pb(),m.Qb(11,"h2",8),m.Dc(12),m.Pb(),m.Qb(13,"label-value",7),m.Dc(14),m.Pb(),m.Qb(15,"label-value",7),m.Dc(16),m.Pb(),m.Qb(17,"h2",8),m.Dc(18),m.Pb(),m.Qb(19,"label-value",7),m.Dc(20),m.Pb(),m.Qb(21,"label-value",7),m.Dc(22),m.Pb(),m.Qb(23,"h2",8),m.Dc(24),m.Pb(),m.Qb(25,"label-value",7),m.Dc(26),m.Pb(),m.Qb(27,"label-value",7),m.Dc(28),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("label",e.i18n.account.account),m.xb(1),m.Fc(" ",e.data.account.type.name," "),m.xb(2),m.Ec(e.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.gc("label",e.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.Fc(" ",e.amountLimitValue()," "),m.xb(1),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),m.xb(2),m.Ec(e.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.gc("label",e.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.Fc(" ",e.amountPerDayLimitValue()," "),m.xb(1),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),m.xb(2),m.Ec(e.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.gc("label",e.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.Fc(" ",e.amountPerWeekLimitValue()," "),m.xb(1),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.limitMode(e.data.customAmountLimit)," "),m.xb(2),m.Ec(e.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.gc("label",e.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.Fc(" ",e.amountPerMonthLimitValue()," "),m.xb(1),m.gc("label",e.i18n.account.limits.mode),m.xb(1),m.Fc(" ",e.limitMode(e.data.customAmountLimit)," ")}}function Ln(e,t){if(1&e&&(m.Qb(0,"page-content",3),m.ac(1,"async"),m.Bc(2,Dn,29,24,"ng-container",4),m.Pb()),2&e){const e=m.Zb();m.gc("heading",e.i18n.account.paymentLimits.title.view)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.view)("headingActions",m.bc(1,4,e.headingActions$)),m.xb(2),m.gc("ngIf",e.data)}}function wn(e,t){if(1&e&&(m.Qb(0,"label-value",15),m.Dc(1),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.gc("label",t.i18n.general.comments),m.xb(1),m.Fc(" ",e.comment," ")}}function Cn(e,t){if(1&e&&(m.Qb(0,"mobile-result"),m.Qb(1,"div",13),m.Qb(2,"div",14),m.Qb(3,"label-value",15),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Qb(6,"label-value",15),m.Dc(7),m.Pb(),m.Qb(8,"label-value",15),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"label-value",15),m.Dc(12),m.ac(13,"currency"),m.Pb(),m.Qb(14,"label-value",15),m.Dc(15),m.ac(16,"currency"),m.Pb(),m.Qb(17,"label-value",15),m.Dc(18),m.ac(19,"currency"),m.Pb(),m.Bc(20,wn,2,2,"label-value",16),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("label",n.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(5,13,e.date)," "),m.xb(2),m.gc("label",n.i18n.general.performedBy),m.xb(1),m.Fc(" ",e.by.display," "),m.xb(1),m.gc("label",n.i18n.account.paymentLimits.paymentLimit),m.xb(1),m.Fc(" ",e.customAmountLimit?m.cc(10,15,e.amountLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.dailyLimit),m.xb(1),m.Fc(" ",e.customAmountPerDayLimit?m.cc(13,18,e.amountPerDayLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.weeklyLimit),m.xb(1),m.Fc(" ",e.customAmountPerWeekLimit?m.cc(16,21,e.amountPerWeekLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("label",n.i18n.account.paymentLimits.monthlyLimit),m.xb(1),m.Fc(" ",e.customAmountPerMonthLimit?m.cc(19,24,e.amountPerMonthLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(2),m.gc("ngIf",e.comment)}}function Qn(e,t){if(1&e&&(m.Qb(0,"tr"),m.Qb(1,"td"),m.Dc(2),m.ac(3,"date"),m.Pb(),m.Qb(4,"td"),m.Dc(5),m.Pb(),m.Qb(6,"td"),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Qb(9,"td"),m.Dc(10),m.ac(11,"currency"),m.Pb(),m.Qb(12,"td"),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Qb(15,"td"),m.Dc(16),m.ac(17,"currency"),m.Pb(),m.Qb(18,"td"),m.Dc(19),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.Ec(m.bc(3,7,e.date)),m.xb(3),m.Ec(e.by.display),m.xb(2),m.Fc(" ",e.customAmountLimit?m.cc(8,9,e.amountLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerDayLimit?m.cc(11,12,e.amountPerDayLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerWeekLimit?m.cc(14,15,e.amountPerWeekLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Fc(" ",e.customAmountPerMonthLimit?m.cc(17,18,e.amountPerMonthLimit,n.data.account.currency):n.i18n.account.limits.productDefault," "),m.xb(3),m.Ec(e.comment)}}function In(e,t){if(1&e&&(m.Qb(0,"table",17),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th"),m.Dc(11),m.Pb(),m.Qb(12,"th"),m.Dc(13),m.Pb(),m.Qb(14,"th"),m.Dc(15),m.Pb(),m.Pb(),m.Qb(16,"tbody"),m.Bc(17,Qn,20,21,"tr",18),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.general.performedBy),m.xb(2),m.Ec(e.i18n.account.paymentLimits.paymentLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.dailyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.weeklyLimit),m.xb(2),m.Ec(e.i18n.account.paymentLimits.monthlyLimit),m.xb(2),m.Ec(e.i18n.general.comments),m.xb(2),m.gc("ngForOf",e.data.history)}}function Fn(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"page-content",9),m.ac(2,"async"),m.Lb(3,"user-info",6),m.Pb(),m.Qb(4,"results-layout",10),m.Bc(5,Cn,21,27,"mobile-result",11),m.Bc(6,In,18,8,"table",12),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("mode","empty")("heading",e.i18n.account.paymentLimits.title.history)("mobileHeading",e.i18n.account.paymentLimits.mobileTitle.history)("headingActions",m.bc(2,6,e.headingActions$)),m.xb(2),m.gc("user",e.data.user),m.xb(1),m.gc("results",e.data.history)}}let Tn=(()=>{class e extends mt.a{constructor(e,t){super(e),this.paymentLimitsService=t,this.step$=new u.a("details")}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.accountType=this.route.snapshot.params.accountType,this.addSub(this.paymentLimitsService.getAccountPaymentLimits({user:this.user,accountType:this.accountType}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.detailsHeadingActions=[],e.editable&&this.detailsHeadingActions.push(new zt.c(d.a.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.detailsHeadingActions.push(new zt.c(d.a.Clock,this.i18n.general.viewHistory,()=>this.showHistory())),this.headingActions=this.detailsHeadingActions,this.historyHeadingActions=[],e.editable&&this.historyHeadingActions.push(new zt.c(d.a.Pencil,this.i18n.general.edit,()=>this.navigateToEdit())),this.historyHeadingActions.push(new zt.c(d.a.ArrowLeft,this.i18n.general.details,()=>this.showView()))}amountLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountLimit,this.data.amountLimit,this.data.productAmountLimit)}amountPerDayLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerDayLimit,this.data.amountPerDayLimit,this.data.productAmountPerDayLimit)}amountPerWeekLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerWeekLimit,this.data.amountPerWeekLimit,this.data.productAmountPerWeekLimit)}amountPerMonthLimitValue(){return this.resolveAmountLimitValue(this.data.customAmountPerMonthLimit,this.data.amountPerMonthLimit,this.data.productAmountPerMonthLimit)}resolveAmountLimitValue(e,t,n){return e?this.format.formatAsCurrency(this.data.account.currency,t,!1):n?this.format.formatAsCurrency(this.data.account.currency,n,!1):this.i18n.account.paymentLimits.definedInPaymentType}limitMode(e){return e?this.i18n.account.limits.personalized:this.i18n.account.limits.productDefault}showHistory(){this.headingActions=this.historyHeadingActions,this.step="history"}showView(){this.headingActions=this.detailsHeadingActions,this.step="details"}navigateToEdit(){this.router.navigate(["/banking",this.user,"account-payment-limits",this.accountType,"edit"])}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(en.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["view-account-payment-limits"]],features:[m.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[3,"label"],[1,"mb-2"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table",4,"resultTable"],[1,"d-flex"],[1,"w-100"],["labelPosition","sideForced",3,"label"],["labelPosition","sideForced",3,"label",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,Ln,3,6,"page-content",1),m.Bc(4,Fn,7,8,"ng-container",2),m.Pb()),2&e&&(m.gc("ready",m.bc(1,4,t.data$))("ngSwitch",m.bc(2,6,t.step$)),m.xb(3),m.gc("ngSwitchCase","details"),m.xb(1),m.gc("ngSwitchCase","history"))},directives:[f.a,g.x,g.y,p.a,g.t,P.a,D.a,vt.a,h.a,y.a,x.a,V.a,g.s],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();var Sn=n("PmQH"),kn=n("dVyd"),On=n("9d5G"),Nn=n("Muja"),Bn=n("SxV6");function An(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Qb(2,"payment-step-form",5),m.Xb("availablePaymentTypes",(function(t){return m.sc(e),m.Zb().availablePaymentTypes=t})),m.ac(3,"async"),m.Pb(),m.Qb(4,"actions",6),m.Qb(5,"action-button",7),m.Xb("action",(function(){return m.sc(e),m.Zb().toConfirm()})),m.ac(6,"async"),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.title)("mobileHeading",e.mobileTitle)("mode",m.bc(1,11,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("data",e.data)("pos",e.pos)("form",e.form)("currency",m.bc(3,13,e.currency$))("paymentTypeData$",e.paymentTypeData$)("customValuesControlGetter",e.customValuesControlGetter),m.xb(3),m.gc("disabled",m.bc(6,15,e.requesting$))("label",e.i18n.general.next)}}function En(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",7),m.Xb("action",(function(){return m.sc(e),m.Zb(2).perform()})),m.ac(1,"async"),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("disabled",!e.canConfirm||m.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function $n(e,t){1&e&&m.Dc(0,"\xa0")}const Rn=function(){return[]};function Zn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",8),m.ac(1,"async"),m.Qb(2,"payment-step-confirm",9),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().perform(t)})),m.Pb(),m.Qb(3,"actions",6),m.Bc(4,En,2,4,"action-button",10),m.ac(5,"async"),m.Bc(6,$n,1,0,"ng-template",null,11,m.Cc),m.Qb(8,"action-button",12),m.Xb("action",(function(){return m.sc(e),m.Zb().backToForm()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.qc(7),t=m.Zb();m.gc("heading",t.i18n.transaction.title.paymentConfirmation)("mobileHeading",t.i18n.transaction.mobileTitle.paymentConfirmation)("mode",m.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("pos",t.pos)("preview",t.preview)("confirmationPassword",t.confirmationPassword)("showPaymentType",(t.availablePaymentTypes||m.ic(14,Rn)).length>1),m.xb(2),m.gc("ngIf",m.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),m.xb(4),m.gc("label",t.i18n.general.previous)}}function Mn(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",8),m.ac(1,"async"),m.Lb(2,"payment-step-done",13),m.Qb(3,"actions",6),m.Qb(4,"action-button",14),m.Xb("action",(function(){return m.sc(e),m.Zb().viewPerformed()})),m.Pb(),m.Qb(5,"action-button",12),m.Xb("action",(function(){return m.sc(e),m.Zb().reload()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.doneTitle)("mobileHeading",e.doneMobileTitle)("mode",m.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("performed",e.performed),m.xb(2),m.gc("label",e.i18n.transaction.doneView),m.xb(1),m.gc("label",e.i18n.transaction.doneNew)}}function Hn(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}const qn=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("firstInstallmentIsNow").value;if(Object(s.i)(e.value)&&("futureDate"===n||n===i.db.SCHEDULED&&!a))return{required:!0}}return null},Un=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===i.db.RECURRING&&!a){const t=parseInt(e.value,10);return isNaN(t)?{required:!0}:v.F.min(2)(e)}}return null},Vn=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("firstOccurrenceIsNow").value;if(Object(s.i)(e.value)&&n===i.db.RECURRING&&!a)return{required:!0}}return null};let zn=(()=>{class e extends mt.a{constructor(e,t,n,i,a){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=i,this.changeDetector=a,this.ConfirmationMode=On.a,this.steps=["form","confirm","done"],this.step$=new u.a(null),this.currency$=new u.a(null),this.paymentTypeData$=new u.a(null),this.customValuesControls=new Map,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.pos="pos"===e.url[e.url.length-1].path,this.pos||(this.fromParam=e.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=e.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam)),this.pos?(this.title=this.i18n.transaction.title.pos,this.mobileTitle=this.i18n.transaction.mobileTitle.pos):this.fromSystem?this.toSystem?(this.title=this.i18n.transaction.title.paymentSystemToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToSystem):(this.title=this.i18n.transaction.title.paymentSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToUser):this.toSelf?(this.title=this.i18n.transaction.title.paymentToSelf,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSelf):this.toSystem?(this.title=this.i18n.transaction.title.paymentToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSystem):(this.title=this.i18n.transaction.title.paymentToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.pos?this.posService.dataForReceivePayment({}).subscribe(e=>this.data=e):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:this.toParam}).subscribe(e=>this.data=e)),this.addSub(this.form.get("account").valueChanges.subscribe(e=>this.updateCurrency(this.data,e))),this.addSub(this.paymentTypeData$.subscribe(e=>{null!=this.lastPaymentTypeData&&Object(Nn.a)(this.lastPaymentTypeData,e)||this.adjustForm(e),this.lastPaymentTypeData=e})),this.addSub(this.form.valueChanges.subscribe(e=>this.adjustFormValidators(e)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.pos?null:this.toParam,v.F.required],type:[null,v.F.required],amount:[null,v.F.required],description:null,scheduling:[i.db.DIRECT,v.F.required],installmentsCount:null,firstInstallmentIsNow:!0,firstInstallmentDate:[null,qn],repeatUntilCanceled:!0,occurrencesCount:[null,Un],firstOccurrenceIsNow:!0,firstOccurrenceDate:[null,Vn]})}updateCurrency(e,t){let n=null;!Object(s.i)(t)&&e&&e.accounts&&(n=e.accounts.find(e=>e.type.id===t)),this.currency=n?n.currency:null}adjustForm(e){const t=this.form.get("description");(e||{}).descriptionAvailability===i.h.REQUIRED?t.setValidators(v.F.required):Object(s.d)(t)}adjustFormValidators(e){if(this.lastValue&&Object(Nn.a)(this.lastValue,e))return;this.lastValue=e;const t=this.form.get("firstInstallmentDate");"futureDate"===e.scheduling||e.scheduling===i.db.SCHEDULED&&!e.firstInstallmentIsNow?t.setValidators(v.F.required):Object(s.d)(t);const n=this.form.get("installmentsCount");e.scheduling===i.db.SCHEDULED?n.setValidators(v.F.compose([v.F.required,v.F.min(2)])):Object(s.d)(n);const a=this.form.get("occurrencesCount"),c=this.form.get("firstOccurrenceDate");e.scheduling===i.db.RECURRING?(e.repeatUntilCanceled?Object(s.d)(a):a.setValidators(v.F.compose([v.F.required,v.F.min(2)])),e.firstOccurrenceIsNow?Object(s.d)(c):c.setValidators(v.F.required)):(Object(s.d)(a),Object(s.d)(c)),this.changeDetector.detectChanges()}onDataInitialized(e){if(Object(s.i)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";const t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}updatePaymentTypeData(e){const t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}backToForm(){this.step="form"}toConfirm(){const e={},t=this.paymentTypeData;if(t&&t.customFields)for(const n of t.customFields)e[n.internalName]=this.customValuesControlGetter(n);this.form.setControl("customValues",new v.m(e)),Object(s.I)(this.form)&&this.addSub(this.confirmDataRequest().subscribe(e=>{this.preview=e,this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?v.F.required:null),Object(s.A)()}))}perform(e){if(e&&this.confirmationPassword.setValue(e),!Object(s.I)(this.confirmationPassword))return;let t;t=this.pos?this.posService.receivePayment({body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}):this.paymentsService.performPayment({owner:this.fromParam,body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}),t.pipe(Object(Bn.a)()).subscribe(e=>{this.performed=e,this.step="done",Object(s.A)()})}confirmDataRequest(){const e=Object(ft.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=i.db.SCHEDULED,t.installmentsCount=1;break;case i.db.SCHEDULED:e.firstInstallmentIsNow&&(t.firstInstallmentDate=null);break;case i.db.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null),e.firstOccurrenceIsNow&&(t.firstOccurrenceDate=null)}return delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,this.pos?this.posService.previewReceivePayment({body:t}):this.paymentsService.previewPayment({owner:this.fromParam,body:t})}get doneTitle(){if(this.performed)return this.performed.authorizationStatus===i.Db.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}get doneMobileTitle(){if(this.performed)return this.performed.authorizationStatus===i.Db.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}reload(){this.step=null,this.currency=null,this.paymentTypeData=null,super.reload()}locateControl(e){return Object(s.v)(this.form,e)}get customValuesControlGetter(){return e=>{const t=e.internalName;let n=this.customValuesControls.get(t);return null==n&&(n=this.formBuilder.control(e.defaultValue,e.required?v.F.required:null),this.customValuesControls.set(t,n)),n}}resolveMenu(e){return this.pos?l.b.POS:this.fromSystem?this.toSystem?l.b.PAYMENT_TO_SYSTEM:l.b.PAYMENT_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?l.b.PAYMENT_TO_SYSTEM:this.toSelf?l.b.PAYMENT_TO_SELF:l.b.PAYMENT_TO_USER)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(Sn.a),m.Kb(kn.a),m.Kb(m.h))},e.\u0275cmp=m.Eb({type:e,selectors:[["payment"]],features:[m.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","pos","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"pos","preview","confirmationPassword","showPaymentType","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],["outline","",3,"label","action"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,An,7,17,"page-content",1),m.Bc(4,Zn,9,15,"page-content",2),m.Bc(5,Mn,6,8,"page-content",2),m.Bc(6,Hn,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,5,t.data$))("ngSwitch",m.bc(2,7,t.step$)),m.xb(3),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","confirm"),m.xb(1),m.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var jn=n("DvBi"),Gn=n("+MtR"),Kn=n("Mfq2"),_n=n("cvAk"),Xn=n("nznZ"),Wn=n("lS/A"),Yn=n("bBjs");function Jn(e,t){if(1&e&&(m.Qb(0,"notification",9),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.xb(1),m.Fc(" ",e.i18n.transaction.requiresAuthorization,"\n")}}function ei(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Lb(1,"user-link",11),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.fromUser),m.xb(1),m.gc("user",e.fromUser)}}function ti(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.fromAccount),m.xb(1),m.Fc(" ",e.preview.fromAccount.type.name,"\n")}}function ni(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Lb(1,"user-link",11),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toUser),m.xb(1),m.gc("user",e.toUser)}}function ii(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toAccount),m.xb(1),m.Fc(" ",e.preview.toAccount.type.name,"\n")}}function ai(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.type),m.xb(1),m.Fc(" ",e.preview.paymentType.name,"\n")}}function ci(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(2,2,e.preview.mainAmount,e.preview.currency),"\n")}}function ri(e,t){if(1&e&&(m.Qb(0,"div"),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(1),m.Gc(" ",e.fee.name,": ",m.cc(2,2,e.amount,n.preview.currency)," ")}}function oi(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Bc(1,ri,3,5,"div",12),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.appliedFees),m.xb(1),m.gc("ngForOf",e.fees)}}function si(e,t){1&e&&m.Lb(0,"custom-field-value",13),2&e&&m.gc("fieldValue",t.$implicit)}function li(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Dc(1),m.ac(2,"date"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.dueDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.preview.installments[0].dueDate),"\n")}}function ui(e,t){if(1&e&&(m.Qb(0,"thead"),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th",15),m.Dc(6),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.transaction.dueDate),m.xb(2),m.Ec(e.i18n.transaction.amount)}}function bi(e,t){if(1&e&&(m.Qb(0,"tr"),m.Qb(1,"td"),m.Dc(2),m.Pb(),m.Qb(3,"td"),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Qb(6,"td",15),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(2),m.Fc(" ",e.number," "),m.xb(2),m.Fc(" ",m.bc(5,3,e.dueDate)," "),m.xb(3),m.Fc(" ",m.cc(8,5,e.mainAmount,n.preview.currency)," ")}}function di(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Qb(1,"table",14),m.Bc(2,ui,7,3,"thead",4),m.ac(3,"async"),m.Qb(4,"tbody"),m.Bc(5,bi,9,8,"tr",12),m.Pb(),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.installments),m.xb(2),m.gc("ngIf",m.bc(3,3,e.layout.gtxs$)),m.xb(3),m.gc("ngForOf",e.preview.installments)}}function mi(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentNowManual," ")}}function fi(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentNowFixed(e.preview.payment.occurrencesCount)," ")}}function gi(e,t){if(1&e&&(m.Ob(0),m.Bc(1,mi,2,1,"ng-container",4),m.Bc(2,fi,2,1,"ng-container",4),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",null==e.preview.payment.occurrencesCount),m.xb(1),m.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function pi(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.ac(2,"date"),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentDateManual(m.bc(2,1,e.preview.payment.firstOccurrenceDate))," ")}}const hi=function(e,t){return{date:e,count:t}};function yi(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.ac(2,"date"),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentDateFixed(m.kc(3,hi,m.bc(2,1,e.preview.payment.firstOccurrenceDate),e.preview.payment.occurrencesCount))," ")}}function xi(e,t){if(1&e&&(m.Bc(0,pi,3,3,"ng-container",4),m.Bc(1,yi,3,6,"ng-container",4)),2&e){const e=m.Zb(2);m.gc("ngIf",null==e.preview.payment.occurrencesCount),m.xb(1),m.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function vi(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Bc(1,gi,3,2,"ng-container",16),m.Bc(2,xi,2,2,"ng-template",null,17,m.Cc),m.Pb()),2&e){const e=m.qc(3),t=m.Zb();m.gc("label",t.i18n.transaction.recurringPayment),m.xb(1),m.gc("ngIf",null==t.preview.payment.firstOccurrenceDate)("ngIfElse",e)}}function Pi(e,t){if(1&e&&m.Lb(0,"label-value",18),2&e){const e=m.Zb();m.gc("label",e.i18n.general.description)("value",e.preview.payment.description)}}function Di(e,t){1&e&&m.Lb(0,"hr")}function Li(e,t){1&e&&m.Lb(0,"hr")}function wi(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Li,1,0,"hr",4),m.ac(2,"async"),m.Qb(3,"div",19),m.Dc(4),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,2,e.layout.gtxxs$)),m.xb(3),m.Ec(e.preview.confirmationMessage)}}function Ci(e,t){1&e&&m.Lb(0,"hr")}function Qi(e,t){1&e&&m.Lb(0,"hr")}function Ii(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Bc(1,Qi,1,0,"hr",4),m.ac(2,"async"),m.Qb(3,"confirmation-password",20),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().confirmed.emit(t)})),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,3,e.layout.gtxxs$)),m.xb(2),m.gc("passwordInput",e.preview.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let Fi=(()=>{class e extends k.a{constructor(e){super(e),this.confirmationModeChanged=new m.n,this.confirmed=new m.n}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===i.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===i.a.SYSTEM,this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(s.i)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>({type:i.r.MANAGE_PAYMENT_REQUEST,transaction:this.transaction,paymentRequestAction:i.ab.ACCEPT}),this.preview.confirmationPasswordInput||this.addShortcut(Gn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["accept-payment-request-step-confirm"]],inputs:{form:"form",preview:"preview",transaction:"transaction",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[m.ub],decls:25,vars:30,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],[3,"formGroup"],["labelPosition","side","formControlName","processDate","minDate","tomorrow","maxDate","future100","fieldSize","full",3,"label","tooltip"],["formControlName","comments",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(m.Bc(0,Jn,2,1,"notification",0),m.Bc(1,ei,2,2,"label-value",1),m.Bc(2,ti,2,2,"label-value",1),m.Bc(3,ni,2,2,"label-value",1),m.Bc(4,ii,2,2,"label-value",1),m.Bc(5,ai,2,2,"label-value",1),m.Bc(6,ci,3,5,"label-value",1),m.Bc(7,oi,2,2,"label-value",1),m.Bc(8,si,1,1,"custom-field-value",2),m.Bc(9,li,3,4,"label-value",1),m.Bc(10,di,6,5,"label-value",1),m.Bc(11,vi,4,3,"label-value",1),m.Bc(12,Pi,1,2,"label-value",3),m.Bc(13,Di,1,0,"hr",4),m.ac(14,"async"),m.Qb(15,"label-value",5),m.Dc(16),m.ac(17,"currency"),m.Pb(),m.Bc(18,wi,5,4,"ng-container",4),m.Qb(19,"form",6),m.Bc(20,Ci,1,0,"hr",4),m.ac(21,"async"),m.Lb(22,"date-field",7),m.Lb(23,"textarea-field",8),m.Bc(24,Ii,4,5,"ng-container",4),m.Pb()),2&e&&(m.gc("ngIf",t.preview.pendingAuthorization),m.xb(1),m.gc("ngIf",!t.fromSelf&&t.fromUser),m.xb(1),m.gc("ngIf",t.fromSystem),m.xb(1),m.gc("ngIf",t.toUser),m.xb(1),m.gc("ngIf",t.toSystem),m.xb(1),m.gc("ngIf",t.showPaymentType),m.xb(1),m.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),m.xb(1),m.gc("ngIf",(null==t.fees?null:t.fees.length)>0),m.xb(1),m.gc("ngForOf",t.preview.customValues),m.xb(1),m.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),m.xb(1),m.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),m.xb(1),m.gc("ngIf","recurring"===t.preview.payment.scheduling),m.xb(1),m.gc("ngIf",t.preview.payment.description),m.xb(1),m.gc("ngIf",m.bc(14,23,t.layout.gtxxs$)),m.xb(2),m.gc("label",t.i18n.transaction.totalAmount),m.xb(1),m.Fc(" ",m.cc(17,25,t.preview.totalAmount,t.preview.currency),"\n"),m.xb(2),m.gc("ngIf",(t.preview.confirmationMessage||"").length>0),m.xb(1),m.gc("formGroup",t.form),m.xb(1),m.gc("ngIf",m.bc(21,28,t.layout.gtxxs$)),m.xb(2),m.gc("label",t.i18n.transaction.processDate)("tooltip",t.i18n.transaction.processDateTooltip),m.xb(1),m.gc("label",t.i18n.general.comments),m.xb(1),m.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[g.t,g.s,P.a,v.H,v.v,v.n,Q.a,v.u,v.l,Kn.b,ht.a,_n.a,D.a,Xn.a,Wn.a,Yn.a],pipes:[g.b,O.a,G.a],encapsulation:2,changeDetection:0}),e})();var Ti=n("H4pW");let Si=(()=>{class e extends k.a{constructor(e,t){super(e),this.bankingHelper=t}ngOnInit(){var e,t;super.ngOnInit();let n=!0;(null===(e=this.performed)||void 0===e?void 0:e.kind)===i.Eb.PAYMENT_REQUEST?(this.icon=d.a.Check2,this.message=this.performed.kind?this.i18n.transaction.processedPaymentRequestWithNumber(this.performed.transactionNumber):this.i18n.transaction.processedPaymentRequest):(null===(t=this.performed)||void 0===t?void 0:t.authorizationStatus)===i.Db.PENDING?(this.icon=d.a.CalendarEvent,this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):this.performed?(this.icon=d.a.Check2,this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed):(this.icon=d.a.CalendarEvent,this.message=this.i18n.transaction.acceptedScheduledPaymentRequest(this.processDate),n=!1),n&&this.addShortcut(Gn.k,()=>this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)]))}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["request-payment-step-done"]],inputs:{performed:"performed",processDate:"processDate"},features:[m.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.Qb(2,"div",2),m.Lb(3,"icon",3),m.Pb(),m.Qb(4,"div",4),m.Dc(5),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.xb(3),m.gc("icon",t.icon),m.xb(2),m.Ec(t.message))},directives:[Ti.a],encapsulation:2,changeDetection:0}),e})();function ki(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",9),m.Xb("action",(function(){return m.sc(e),m.Zb(2).perform()})),m.ac(1,"async"),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("disabled",!e.canConfirm||m.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function Oi(e,t){1&e&&m.Dc(0,"\xa0")}function Ni(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Qb(2,"accept-payment-request-step-confirm",5),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().perform(t)})),m.Pb(),m.Qb(3,"actions",6),m.Bc(4,ki,2,4,"action-button",7),m.ac(5,"async"),m.Bc(6,Oi,1,0,"ng-template",null,8,m.Cc),m.Pb(),m.Pb()}if(2&e){const e=m.qc(7),t=m.Zb();m.gc("heading",t.i18n.transaction.title.paymentConfirmation)("mobileHeading",t.i18n.transaction.mobileTitle.paymentConfirmation)("mode",m.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("transaction",t.transactionKey)("preview",t.data)("confirmationPassword",t.confirmationPassword)("form",t.form)("showPaymentType",!0),m.xb(2),m.gc("ngIf",m.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e)}}function Bi(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",10),m.ac(1,"async"),m.Lb(2,"request-payment-step-done",11),m.ac(3,"date"),m.Qb(4,"actions",6),m.Qb(5,"action-button",12),m.Xb("action",(function(){return m.sc(e),m.Zb().viewPerformed()})),m.Pb(),m.Qb(6,"action-button",13),m.Xb("action",(function(){return m.sc(e),m.Zb().reload()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.doneTitle)("mobileHeading",e.doneMobileTitle)("mode",m.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("performed",e.performed)("processDate",m.bc(3,9,e.form.value.processDate)),m.xb(3),m.gc("label",e.i18n.transaction.doneView),m.xb(1),m.gc("label",e.i18n.transaction.doneNew)}}function Ai(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let Ei=(()=>{class e extends mt.a{constructor(e,t,n){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.ConfirmationMode=On.a,this.steps=["confirm","done"],this.step$=new u.a(null),this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.transactionKey=this.route.snapshot.params.key,this.addSub(this.paymentRequestsService.previewPaymentRequest({key:this.transactionKey}).subscribe(e=>this.data=e))}onDataInitialized(e){this.form=this.formBuilder.group({processDate:null,comments:null}),this.confirmationPassword=this.formBuilder.control(null),this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?v.F.required:null)}perform(e){if(!Object(s.I)(this.form)||!Object(s.I)(this.confirmationPassword))return;e&&this.confirmationPassword.setValue(e);const t=Object(ft.a)(this.form.value);this.addSub(this.paymentRequestsService.acceptPaymentRequest({key:this.transactionKey,confirmationPassword:this.confirmationPassword.value,body:t}).subscribe(e=>{this.performed=e,this.step="done",Object(s.A)()}))}get doneTitle(){if(this.performed)return this.performed.authorizationStatus===i.Db.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}get doneMobileTitle(){if(this.performed)return this.performed.authorizationStatus===i.Db.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}locateControl(e){return Object(s.v)(this.form,e)}resolveMenu(){return l.b.PAYMENT_REQUESTS}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(jn.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["accept-payment-request"]],features:[m.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"transaction","preview","confirmationPassword","form","showPaymentType","confirmationModeChanged","confirmed"],["forceRow",""],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed","processDate"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,Ni,8,14,"page-content",1),m.Bc(4,Bi,7,11,"page-content",2),m.Bc(5,Ai,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,4,t.data$))("ngSwitch",m.bc(2,6,t.step$)),m.xb(3),m.gc("ngSwitchCase","confirm"),m.xb(1),m.gc("ngSwitchCase","done"))},directives:[f.a,g.x,g.y,g.z,p.a,Fi,gt.a,g.t,pt.a,Si,U.a],pipes:[g.b,G.a],encapsulation:2,changeDetection:0}),e})();var $i=n("a/z7"),Ri=n("/uUt"),Zi=n("Kj3r"),Mi=n("Xel3"),Hi=n("Y+zs"),qi=n("Zcpn"),Ui=n("yHfF"),Vi=n("wR2l");const zi=["toUser"],ji=["amount"];function Gi(e,t){if(1&e&&(m.Qb(0,"label-value",13),m.Lb(1,"user-link",14),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.toSystem?e.i18n.transaction.receiver:e.i18n.transaction.fromUser),m.xb(1),m.gc("user",e.fromUser)}}function Ki(e,t){1&e&&m.Lb(0,"br")}function _i(e,t){1&e&&m.Dc(0," - ")}function Xi(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Ki,1,0,"br",24),m.ac(2,"async"),m.Bc(3,_i,1,0,"ng-template",null,25,m.Cc),m.Dc(5),m.Nb()),2&e){const e=m.qc(4),t=m.Zb().$implicit,n=m.Zb(2);m.xb(1),m.gc("ngIf",m.bc(2,3,n.layout.ltsm$))("ngIfElse",e),m.xb(4),m.Fc(" ",t.number," ")}}function Wi(e,t){if(1&e){const e=m.Rb();m.Qb(0,"div",18),m.Qb(1,"div",19),m.Qb(2,"input",20,21),m.Xb("keyup.enter",(function(){return m.sc(e),m.qc(3).click()})),m.Pb(),m.Qb(4,"label",22),m.Qb(5,"div",23),m.Dc(6),m.Bc(7,Xi,6,5,"ng-container",2),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit;m.xb(2),m.gc("id","from_"+e.id)("value",e.type.id),m.xb(2),m.gc("for","from_"+e.id),m.xb(2),m.Fc(" ",e.type.name," "),m.xb(1),m.gc("ngIf",e.number)}}function Yi(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"label-value",15),m.Bc(2,Wi,8,5,"div",16),m.Lb(3,"field-errors",17),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.transaction.toAccount),m.xb(1),m.gc("ngForOf",e.data.accounts),m.xb(1),m.gc("control",e.form.get("account"))}}function Ji(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.display)}}function ea(e,t){if(1&e&&(m.Qb(0,"single-selection-field",29),m.Bc(1,Ji,1,2,"field-option",30),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngForOf",e.data.allowedUsers)}}const ta=function(e){return[e]},na=function(e){return{usersToExclude:e}};function ia(e,t){if(1&e){const e=m.Rb();m.Qb(0,"user-field",32,33),m.Xb("selected",(function(t){m.sc(e);const n=m.Zb(2);return t?n.setFocus(n.amountField):null})),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("autoSearch",!e.allowPrincipal)("filters",m.jc(9,na,e.fromUser&&!e.fromSelf?m.jc(7,ta,e.fromParam):null))("allowContacts",e.allowContacts)("allowSearch",e.allowSearch)("allowPrincipal",e.allowPrincipal)("allowQrCode",e.allowQrCode)("principalTypes",e.data.principalTypes)}}function aa(e,t){if(1&e&&(m.Qb(0,"label-value",26),m.Bc(1,ea,2,1,"single-selection-field",27),m.Bc(2,ia,2,11,"ng-template",null,28,m.Cc),m.Pb()),2&e){const e=m.qc(3),t=m.Zb();m.gc("label",t.i18n.transaction.receiver),m.xb(1),m.gc("ngIf",t.fixedUsersList)("ngIfElse",e)}}function ca(e,t){if(1&e&&(m.Qb(0,"label-value",34),m.Lb(1,"user-link",14),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.receiver),m.xb(1),m.gc("user",e.toUser)}}function ra(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function oa(e,t){if(1&e&&(m.Qb(0,"single-selection-field",35,36),m.Bc(2,ra,1,2,"field-option",30),m.ac(3,"async"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.type),m.xb(2),m.gc("ngForOf",m.bc(3,2,e.paymentTypes$))}}function sa(e,t){if(1&e&&(m.Qb(0,"label-value",34),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(2,2,e.paymentTypeData$.value.fixedAmount,e.paymentTypeData$.value.currency)," ")}}function la(e,t){if(1&e&&m.Lb(0,"decimal-field",37,38),2&e){const e=m.Zb();m.gc("focused",e.fixedDestination)("label",e.i18n.transaction.amount)("scale",null==e.currency?null:e.currency.decimalDigits)("prefix",null==e.currency?null:e.currency.prefix)("suffix",null==e.currency?null:e.currency.suffix)}}function ua(e,t){if(1&e&&m.Lb(0,"date-field",39),2&e){const e=m.Zb();m.gc("label",e.i18n.general.expirationDate)}}function ba(e,t){if(1&e&&(m.Qb(0,"label-value",40),m.Lb(1,"custom-field-input",41),m.Pb()),2&e){const e=t.$implicit,n=m.Zb();m.gc("label",e.name)("kind","field")("labelPosition","boolean"===e.type?"sideForced":"auto")("fieldSize",n.fieldSize(e))("required",e.required),m.xb(1),m.gc("field",e)("formControl",n.customValuesControlGetter(e))}}function da(e,t){if(1&e&&m.Lb(0,"field-option",47),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingSingle)}}function ma(e,t){if(1&e&&m.Lb(0,"field-option",48),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingInstallments)}}function fa(e,t){if(1&e&&m.Lb(0,"field-option",49),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingRecurring)}}function ga(e,t){if(1&e&&(m.Qb(0,"single-selection-field",42),m.Lb(1,"field-option",43),m.Bc(2,da,1,1,"field-option",44),m.Bc(3,ma,1,1,"field-option",45),m.Bc(4,fa,1,1,"field-option",46),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.scheduling),m.xb(1),m.gc("text",e.i18n.transaction.schedulingDirect),m.xb(1),m.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>0),m.xb(1),m.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>1),m.xb(1),m.gc("ngIf",null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.allowsRecurringPayments)}}function pa(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"input-field",50),m.Lb(2,"boolean-field",51),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.transaction.installmentsCount),m.xb(1),m.gc("label",e.i18n.transaction.firstInstallmentIsImmediate)}}function ha(e,t){if(1&e&&m.Lb(0,"input-field",55),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.occurrencesCount)}}function ya(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"boolean-field",52),m.Qb(2,"radio-group-field",53),m.Lb(3,"field-option",31),m.Lb(4,"field-option",31),m.Pb(),m.Bc(5,ha,1,1,"input-field",54),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.transaction.firstOccurrenceIsImmediate),m.xb(1),m.gc("label",e.i18n.transaction.repeatUntil),m.xb(1),m.gc("value",!0)("text",e.i18n.transaction.repeatUntilManual),m.xb(1),m.gc("value",!1)("text",e.i18n.transaction.repeatUntilFixed),m.xb(1),m.gc("ngIf",!1===e.form.value.repeatUntilCanceled)}}function xa(e,t){if(1&e&&m.Lb(0,"textarea-field",57),2&e){const e=m.Zb().ngIf,t=m.Zb();m.gc("required","required"===e)("label",t.i18n.general.description)}}function va(e,t){if(1&e&&(m.Ob(0),m.Bc(1,xa,1,2,"textarea-field",56),m.Nb()),2&e){const e=t.ngIf;m.xb(1),m.gc("ngIf","disabled"!==e)}}const Pa=[$i.a.FORBIDDEN,$i.a.UNAUTHORIZED,$i.a.NOT_FOUND];let Da=(()=>{class e extends k.a{constructor(e,t,n){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.setFocus=s.k,this.availablePaymentTypes=new m.n,this.accountBalanceLabel$=new u.a(null),this.fixedDestination=!1,this.paymentTypes$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>this.fetchPaymentTypeData(e))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const e=r.a.escapeNumeric(this.form.value.subject);""!==e&&this.errorHandler.requestWithCustomErrorHandler(t=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:e,fields:["toUser","paymentTypes","paymentTypeData"]}).subscribe(e=>{this.setFetchedPaymentTypes(e)},e=>{if(this.allowPrincipal&&this.userField&&e.status===$i.a.NOT_FOUND){let t=e.error;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){t={}}const i=t.entityType;if(!Object(s.b)(i)&&i.endsWith("User"))return void this.userField.search()}Pa.includes(e.status)||t(e)}))})}adjustPaymentTypes(){const e=this.form.value;if(0===(e.subject||"").trim().length)return;const t=this.fetchedPaymentTypes||[];Object(s.i)(t)&&this.notification.error(this.i18n.transaction.noTypes);const n=t.filter(t=>t.to.id===e.account);let i=this.form.value.type,a=null;Object(s.i)(n)?a={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find(e=>e.id===i)||(i=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:i}),this.form.get("account").setErrors(a),this.form.get("account").markAsTouched(),Object(s.i)(i)||this.fetchPaymentTypeData(i),this.availablePaymentTypes.emit(n)}setFetchedPaymentTypes(e){this.userField&&(this.userField.user=e.toUser),this.fetchedPaymentTypes=e.paymentTypes;const t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}fetchPaymentTypeData(e){const t=this.form.value;if(Object(s.i)(t.subject)||Object(s.i)(e))return;const n=this.dataCache.get(e);n?this.setPaymentTypeData(n):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(n=>{this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:t.subject,type:e,fields:["paymentTypeData"]}).subscribe(e=>{this.setPaymentTypeData(e.paymentTypeData)},e=>{Pa.includes(e.status)||n(e)}))}))}setPaymentTypeData(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(s.k)(this.amountField),e.fixedAmount&&this.form.patchValue({amount:e.fixedAmount})),this.paymentTypeData$.next(e))}fieldSize(e){return this.fieldHelper.fieldSize(e)}get fixedUsersList(){return!Object(s.i)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!Object(s.i)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const e=this.data.accounts||[];return 1===e.length?e[0]:null}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(jn.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["request-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(m.Hc(zi,!0),m.yc(ji,!0)),2&e&&(m.pc(n=m.Yb())&&(t.userField=n.first),m.pc(n=m.Yb())&&(t.amountField=n.first))},inputs:{data:"data",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",toSystem:"toSystem",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[m.ub],decls:23,vars:29,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf"],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],[3,"label","kind","labelPosition","fieldSize","required",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["kind","field",3,"label"],[3,"user"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],[4,"ngIf","ngIfElse"],["separator",""],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],["formControlName","expirationDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],[3,"label","kind","labelPosition","fieldSize","required"],["hideLabel","",3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsImmediate",3,"label"],["formControlName","firstOccurrenceIsImmediate",3,"label"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(m.Ob(0,0),m.Bc(1,Gi,2,2,"label-value",1),m.Bc(2,Yi,4,3,"ng-container",2),m.Bc(3,aa,4,3,"label-value",3),m.Bc(4,ca,2,2,"label-value",4),m.Bc(5,oa,4,4,"single-selection-field",5),m.ac(6,"async"),m.Bc(7,sa,3,5,"label-value",6),m.ac(8,"async"),m.Bc(9,la,2,5,"ng-template",null,7,m.Cc),m.Bc(11,ua,1,1,"date-field",8),m.ac(12,"async"),m.Bc(13,ba,2,7,"label-value",9),m.ac(14,"async"),m.Bc(15,ga,5,5,"single-selection-field",10),m.ac(16,"async"),m.ac(17,"async"),m.Ob(18,11),m.Bc(19,pa,3,2,"ng-container",12),m.Bc(20,ya,6,7,"ng-container",12),m.Nb(),m.Bc(21,va,2,1,"ng-container",2),m.ac(22,"async"),m.Nb()),2&e){const e=m.qc(10);var n,i,a,c,r,o=null;m.gc("formGroup",t.form),m.xb(1),m.gc("ngIf",t.fromUser&&!t.fromSelf),m.xb(1),m.gc("ngIf",!t.singleAccount),m.xb(1),m.gc("ngIf",!t.fixedDestination),m.xb(1),m.gc("ngIf",t.fixedDestination&&t.toUser),m.xb(1),m.gc("ngIf",(null==(n=m.bc(6,15,t.paymentTypes$))?null:n.length)>1),m.xb(2),m.gc("ngIf",null==(i=m.bc(8,17,t.paymentTypeData$))?null:i.fixedAmount)("ngIfElse",e),m.xb(4),m.gc("ngIf",!(null!=(a=m.bc(12,19,t.paymentTypeData$))&&a.hideExpirationDate)),m.xb(2),m.gc("ngForOf",null==(c=m.bc(14,21,t.paymentTypeData$))?null:c.customFields),m.xb(2),m.gc("ngIf",(null==(o=m.bc(16,23,t.paymentTypeData$))?null:o.allowsRecurringPayments)||(null==(o=m.bc(17,25,t.paymentTypeData$))?null:o.maxInstallments)>0),m.xb(3),m.gc("ngSwitch",t.form.value.scheduling),m.xb(1),m.gc("ngSwitchCase","scheduled"),m.xb(1),m.gc("ngSwitchCase","recurring"),m.xb(1),m.gc("ngIf",(null==(r=m.bc(22,27,t.paymentTypeData$))?null:r.descriptionAvailability)||"disabled")}},directives:[v.v,v.n,g.t,g.s,g.x,g.y,P.a,D.a,Mi.a,v.z,v.e,v.u,v.l,L.a,Yn.a,w.a,T.a,v.C,I.a,Q.a,Hi.a,v.k,F.a,qi.a,Ui.a,Vi.a,ht.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function La(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Qb(2,"request-payment-step-form",5),m.Xb("availablePaymentTypes",(function(t){return m.sc(e),m.Zb().availablePaymentTypes=t})),m.ac(3,"async"),m.Pb(),m.Qb(4,"actions",6),m.Qb(5,"action-button",7),m.Xb("action",(function(){return m.sc(e),m.Zb().perform()})),m.ac(6,"async"),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.title)("mobileHeading",e.mobileTitle)("mode",m.bc(1,11,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("data",e.data)("form",e.form)("currency",m.bc(3,13,e.currency$))("paymentTypeData$",e.paymentTypeData$)("toSystem",e.toSystem)("customValuesControlGetter",e.customValuesControlGetter),m.xb(3),m.gc("disabled",m.bc(6,15,e.requesting$))("label",e.i18n.general.confirm)}}function wa(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",8),m.ac(1,"async"),m.Lb(2,"request-payment-step-done",9),m.Qb(3,"actions",6),m.Qb(4,"action-button",10),m.Xb("action",(function(){return m.sc(e),m.Zb().viewPerformed()})),m.Pb(),m.Qb(5,"action-button",11),m.Xb("action",(function(){return m.sc(e),m.Zb().reload()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.paymentRequestSent)("mobileHeading",e.i18n.transaction.mobileTitle.paymentRequestSent)("mode",m.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("performed",e.performed),m.xb(2),m.gc("label",e.i18n.transaction.doneView),m.xb(1),m.gc("label",e.i18n.transaction.doneNew)}}function Ca(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}const Qa=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,a=t.get("repeatUntilCanceled").value;if(n===i.db.RECURRING&&!a){const t=parseInt(e.value,10);return isNaN(t)?{required:!0}:v.F.min(2)(e)}}return null};let Ia=(()=>{class e extends mt.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.paymentRequestsService=n,this.changeDetector=i,this.steps=["form","done"],this.step$=new u.a(null),this.currency$=new u.a(null),this.paymentTypeData$=new u.a(null),this.customValuesControls=new Map}get step(){return this.step$.value}set step(e){this.step$.next(e)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.fromParam=e.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=e.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam),this.fromSystem?(this.title=this.i18n.transaction.title.paymentRequestSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestSystemToUser):this.toSystem?(this.title=this.i18n.transaction.title.paymentRequestToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToSystem):(this.title=this.i18n.transaction.title.paymentRequestToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentRequestToUser),this.form=this.buildForm(),this.addSub(this.paymentRequestsService.dataForSendPaymentRequest({owner:this.fromParam,to:this.toParam}).subscribe(e=>this.data=e)),this.addSub(this.form.get("account").valueChanges.subscribe(e=>this.updateCurrency(this.data,e))),this.addSub(this.paymentTypeData$.subscribe(e=>{null!=this.lastPaymentTypeData&&Object(Nn.a)(this.lastPaymentTypeData,e)||this.adjustForm(e),this.lastPaymentTypeData=e})),this.addSub(this.form.valueChanges.subscribe(e=>this.adjustFormValidators(e)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.toParam,v.F.required],type:[null,v.F.required],amount:[null,v.F.required],expirationDate:[null,v.F.required],description:null,scheduling:[i.db.DIRECT,v.F.required],installmentsCount:null,firstInstallmentIsImmediate:!1,repeatUntilCanceled:!0,occurrencesCount:[null,Qa],firstOccurrenceIsImmediate:!1})}updateCurrency(e,t){let n=null;!Object(s.i)(t)&&e&&e.accounts&&(n=e.accounts.find(e=>e.type.id===t)),this.currency=n?n.currency:null}adjustForm(e){const t=this.form.get("description");(e||{}).descriptionAvailability===i.h.REQUIRED?t.setValidators(v.F.required):Object(s.d)(t),(e||{}).defaultExpirationDate&&this.form.get("expirationDate").setValue(e.defaultExpirationDate)}adjustFormValidators(e){if(this.lastValue&&Object(Nn.a)(this.lastValue,e))return;this.lastValue=e;const t=this.form.get("installmentsCount");e.scheduling===i.db.SCHEDULED?t.setValidators(v.F.compose([v.F.required,v.F.min(2)])):Object(s.d)(t);const n=this.form.get("occurrencesCount");e.scheduling===i.db.RECURRING?e.repeatUntilCanceled?Object(s.d)(n):n.setValidators(v.F.compose([v.F.required,v.F.min(2)])):Object(s.d)(n),this.changeDetector.detectChanges()}onDataInitialized(e){if(Object(s.i)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";const t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}updatePaymentTypeData(e){const t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}perform(){const e={},t=this.paymentTypeData;if(t&&t.customFields)for(const n of t.customFields)e[n.internalName]=this.customValuesControlGetter(n);this.form.setControl("customValues",new v.m(e)),Object(s.I)(this.form)&&this.notification.confirm({title:this.i18n.general.confirm,message:this.i18n.transaction.confirmPaymentRequest,callback:()=>this.paymentRequestsService.sendPaymentRequest({owner:this.fromParam,body:this.confirmDataRequest()}).pipe(Object(Bn.a)()).subscribe(e=>{this.performed=e,this.step="done",Object(s.A)()})})}confirmDataRequest(){const e=Object(ft.a)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=i.bb.SCHEDULED,t.installmentsCount=1;break;case i.bb.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null)}return t.expirationDate=r.a.shiftToDayEnd(t.expirationDate),delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,t}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}reload(){this.step=null,this.currency=null,this.paymentTypeData=null,super.reload()}locateControl(e){return Object(s.v)(this.form,e)}get customValuesControlGetter(){return e=>{const t=e.internalName;let n=this.customValuesControls.get(t);return null==n&&(n=this.formBuilder.control(e.defaultValue,e.required?v.F.required:null),this.customValuesControls.set(t,n)),n}}resolveMenu(e){return this.fromSystem?l.b.PAYMENT_REQUEST_TO_USER:this.menu.userMenu(e.fromUser,this.toSystem?l.b.PAYMENT_REQUEST_TO_SYSTEM:l.b.PAYMENT_REQUEST_TO_USER)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(jn.a),m.Kb(m.h))},e.\u0275cmp=m.Eb({type:e,selectors:[["request-payment"]],features:[m.ub],decls:6,vars:8,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","currency","paymentTypeData$","toSystem","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[3,"label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,La,7,17,"page-content",1),m.Bc(4,wa,6,8,"page-content",2),m.Bc(5,Ca,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,4,t.data$))("ngSwitch",m.bc(2,6,t.step$)),m.xb(3),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","done"))},directives:[f.a,g.x,g.y,g.z,p.a,Da,gt.a,pt.a,Si,U.a],pipes:[g.b],encapsulation:2,changeDetection:0}),e})();var Fa=n("cBGn"),Ta=n("/q9M");function Sa(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Lb(2,"receive-qr-payment-step-form",5),m.ac(3,"async"),m.ac(4,"async"),m.ac(5,"async"),m.Qb(6,"actions",6),m.Qb(7,"action-button",7),m.Xb("action",(function(){return m.sc(e),m.Zb().toPending()})),m.ac(8,"async"),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",m.bc(1,10,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("data",e.data)("form",e.form)("transferTypes",m.bc(3,12,e.paymentTypes$))("type",m.bc(4,14,e.paymentType$))("typeData",m.bc(5,16,e.paymentTypeData$)),m.xb(5),m.gc("disabled",m.bc(8,18,e.requesting$))("label",e.i18n.general.next)}}function ka(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",13),m.Xb("action",(function(){return m.sc(e),m.Zb(2).share()})),m.ac(1,"async"),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.share)("disabled",m.bc(1,2,e.requesting$))}}function Oa(e,t){1&e&&m.Lb(0,"span")}function Na(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",8),m.ac(1,"async"),m.Lb(2,"receive-qr-payment-step-pending",9),m.ac(3,"async"),m.ac(4,"async"),m.Qb(5,"actions",6),m.Bc(6,ka,2,4,"action-button",10),m.Bc(7,Oa,1,0,"ng-template",null,11,m.Cc),m.Qb(9,"action-button",12),m.Xb("action",(function(){return m.sc(e),m.Zb().reload()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.qc(8),t=m.Zb();m.gc("heading",t.i18n.transaction.title.receiveQrPayment)("mobileHeading",t.i18n.transaction.mobileTitle.receiveQrPayment)("mode",m.bc(1,8,t.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("ticket",m.bc(3,10,t.ticket$))("qrCodeUrl",m.bc(4,12,t.qrCodeUrl$)),m.xb(4),m.gc("ngIf",t.supportsShare)("ngIfElse",e),m.xb(3),m.gc("label",t.i18n.general.previous)}}function Ba(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",8),m.ac(1,"async"),m.Lb(2,"receive-qr-payment-step-done",14),m.ac(3,"async"),m.Qb(4,"actions",6),m.Qb(5,"action-button",15),m.Xb("action",(function(){return m.sc(e),m.Zb().viewPerformed()})),m.Pb(),m.Qb(6,"action-button",12),m.Xb("action",(function(){return m.sc(e),m.Zb().reload()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",m.bc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("payment",m.bc(3,8,e.payment$)),m.xb(3),m.gc("label",e.i18n.transaction.doneView),m.xb(1),m.gc("label",e.i18n.transaction.doneNew)}}function Aa(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let Ea=(()=>{class e extends mt.a{constructor(e,t,n,i){super(e),this.ticketsService=t,this.pushNotifications=n,this.bankingHelper=i,this.step$=new u.a(null),this.ticket$=new u.a(null),this.paymentTypes$=new u.a([]),this.paymentType$=new u.a(null),this.paymentTypeData$=new u.a(null),this.payment$=new u.a(null),this.paymentTypeDataCache=new Map,this.qrCodeUrl$=new u.a(null),this.supportsShare=Object(s.E)()}ngOnInit(){super.ngOnInit(),this.addSub(this.ticketsService.dataForNewTicket({user:r.a.SELF}).subscribe(e=>this.data=e)),this.addSub(this.step$.subscribe(e=>this.onStepChanged(e)))}ngOnDestroy(){super.ngOnDestroy(),this.unsubscribePush(),this.destroyQrCode()}onDataInitialized(e){Object(s.i)(e.accounts)||Object(s.i)(e.paymentTypes)?this.notification.error(this.i18n.transaction.noAccounts):(this.form=this.formBuilder.group({account:[null,v.F.required],type:[null,v.F.required],amount:[null,v.F.required],description:null}),this.paymentTypeDataCache.set(e.paymentTypes[0].id,e.paymentTypeData),this.addSub(this.form.controls.type.valueChanges.pipe(Object(Ri.a)()).subscribe(e=>this.onPaymentTypeChange(e))),this.addSub(this.form.controls.account.valueChanges.pipe(Object(Ri.a)()).subscribe(t=>this.onAccountChange(t,e))),this.form.patchValue({account:e.accounts[0].id}),this.step$.next("form"))}onAccountChange(e,t){const n=t.accounts.find(t=>t.id===e),i=n?t.paymentTypes.filter(e=>e.to.id===n.type.id):[];this.paymentTypes$.next(i),this.form.patchValue({type:0===i.length?null:i[0].id})}onPaymentTypeChange(e){const t=(this.paymentTypes$.value||[]).find(t=>t.id===e);if(!t)return void this.notification.error(this.i18n.transaction.noTypes);const n=n=>{(this.paymentType$.value||{}).id!==e&&(this.paymentTypeDataCache.set(e,n),this.paymentType$.next(t),this.paymentTypeData$.next(n),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(n.customFields)),this.form.controls.type.setValidators(n.descriptionAvailability===i.h.REQUIRED?v.F.required:null),(null==n?void 0:n.fixedAmount)&&this.form.patchValue({amount:n.fixedAmount}))},a=this.paymentTypeDataCache.get(e);a?n(a):this.addSub(this.ticketsService.dataForNewTicket({user:r.a.SELF,type:e}).subscribe(e=>{n(e.paymentTypeData)}))}toPending(){Object(s.I)(this.form)&&this.addSub(this.ticketsService.newTicket({user:r.a.SELF,body:this.form.value}).subscribe(e=>{this.ticket$.next(e),this.addSub(this.ticketsService.getTicketQrCode({ticket:e.ticketNumber,size:i.I.MEDIUM}).subscribe(e=>{this.qrCodeUrl$.next(URL.createObjectURL(e))})),this.step$.next("pending")}))}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.payment$.value)])}onStepChanged(e){"pending"===e?this.pushSub=this.pushNotifications.ticket$.subscribe(e=>{const t=this.ticket$.value;t&&t.id===e.id&&(this.payment$.next(e.transaction),this.step$.next("done"))}):(this.unsubscribePush(),this.destroyQrCode())}unsubscribePush(){this.pushSub&&(this.pushSub.unsubscribe(),this.pushSub=null)}destroyQrCode(){this.qrCodeUrl$.value&&(URL.revokeObjectURL(this.qrCodeUrl$.value),this.qrCodeUrl$.next(null))}share(){const e=this.ticket$.value;navigator.share&&navigator.share({url:e.approveUrl,title:this.i18n.transaction.ticketShareTitle,text:this.i18n.transaction.ticketShareText({user:e.to.user.display,amount:this.format.formatAsCurrency(e.currency,e.amount)})})}resolveMenu(){return l.b.RECEIVE_QR_PAYMENT}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Fa.a),m.Kb(Ta.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["receive-qr-payment"]],features:[m.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","transferTypes","type","typeData"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[3,"ticket","qrCodeUrl"],[3,"label","disabled","action",4,"ngIf","ngIfElse"],["empty",""],["outline","",3,"label","action"],[3,"label","disabled","action"],[3,"payment"],[3,"label","action"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,Sa,9,20,"page-content",1),m.Bc(4,Na,10,14,"page-content",2),m.Bc(5,Ba,7,10,"page-content",2),m.Bc(6,Aa,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,5,t.data$))("ngSwitch",m.bc(2,7,t.step$)),m.xb(3),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","pending"),m.xb(1),m.gc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var $a=n("QnlI");function Ra(e,t){1&e&&m.Mb(0)}function Za(e,t){1&e&&m.Lb(0,"div",7)}function Ma(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",7),m.Qb(2,"label-value",13),m.Lb(3,"user-link",14),m.Pb(),m.Pb(),m.Bc(4,Za,1,0,"div",9),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("ngIf",e.layout.gtsm$)}}function Ha(e,t){if(1&e&&m.Lb(0,"field-option",17),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function qa(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"single-selection-field",15),m.Bc(2,Ha,1,2,"field-option",16),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.data.accountTypes)}}function Ua(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"input-field",24),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Va(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",7),m.Qb(2,"single-selection-field",18),m.Lb(3,"field-option",19),m.Lb(4,"field-option",20),m.Pb(),m.Pb(),m.Bc(5,Ua,2,2,"div",9),m.Qb(6,"div",7),m.Lb(7,"date-field",21),m.Pb(),m.Qb(8,"div",7),m.Lb(9,"date-field",22),m.Pb(),m.Qb(10,"div",7),m.Lb(11,"user-field",23),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.gc("label",e.i18n.account.direction)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("text",e.i18n.account.incoming),m.xb(1),m.gc("text",e.i18n.account.outgoing),m.xb(1),m.gc("ngIf",e.hasTransactionNumber),m.xb(2),m.gc("label",e.i18n.general.beginDate),m.xb(2),m.gc("label",e.i18n.general.endDate),m.xb(2),m.gc("label",e.i18n.general.user)}}function za(e,t){if(1&e&&(m.Qb(0,"mobile-result",25),m.Qb(1,"div",26),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("date",e.date)("amount",e.amount)("avatarImage",n.bankingHelper.avatarImage(e.transaction.related))("avatarIcon",n.bankingHelper.avatarIcon(e.transaction.related))("currency",n.currencies.get(e.currency)),m.xb(2),m.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," ")}}const ja=function(e){return{"pb-0":e}},Ga=function(e,t){return{positive:e,negative:t}};function Ka(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",31),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n.transaction))})),m.Qb(2,"td",32),m.ac(3,"async"),m.Lb(4,"avatar",33),m.Pb(),m.Qb(5,"td"),m.Qb(6,"a",34),m.Dc(7),m.ac(8,"date"),m.Pb(),m.Pb(),m.Qb(9,"td"),m.Qb(10,"a",34),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"td"),m.Qb(13,"a",35),m.Dc(14),m.Pb(),m.Pb(),m.Qb(15,"td",29),m.Qb(16,"a",36),m.Dc(17),m.ac(18,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.gc("ngClass",m.jc(20,ja,m.bc(3,12,n.layout.xxs$))),m.xb(2),m.gc("image",n.bankingHelper.avatarImage(e.transaction.related))("icon",n.bankingHelper.avatarIcon(e.transaction.related)),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),m.xb(1),m.Fc(" ",m.bc(8,14,e.dueDate)," "),m.xb(3),m.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),m.xb(1),m.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," "),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e.transaction)),m.xb(1),m.Fc(" ",n.number(e)," "),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e.transaction))("ngClass",m.kc(22,Ga,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),m.xb(1),m.Fc(" ",m.dc(18,16,e.amount,n.currencies.get(e.transaction.currency),!0)," ")}}function _a(e,t){if(1&e&&(m.Qb(0,"table",27),m.Qb(1,"thead"),m.Lb(2,"th",28),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Qb(7,"th"),m.Dc(8),m.Pb(),m.Qb(9,"th",29),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"tbody"),m.Bc(12,Ka,19,25,"ng-container",30),m.ac(13,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(4),m.Ec(e.i18n.transaction.dueDate),m.xb(2),m.Ec(e.i18n.transaction.fromTo),m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(13,5,e.results$))?null:n.results)}}function Xa(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"form",4),m.Qb(3,"div",5),m.Bc(4,Ma,5,3,"ng-container",6),m.Qb(5,"div",7),m.Lb(6,"single-selection-field",8),m.Pb(),m.Bc(7,qa,3,3,"div",9),m.Bc(8,Va,12,8,"ng-container",6),m.ac(9,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(10,"results-layout",10),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(11,"async"),m.Bc(12,za,3,6,"mobile-result",11),m.Bc(13,_a,14,7,"table",12),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.scheduled)("mobileHeading",e.i18n.transaction.mobileTitle.scheduled)("headingActions",m.bc(1,12,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",e.data.user&&!e.self),m.xb(2),m.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),m.xb(1),m.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(1),m.gc("ngIf",m.bc(9,14,e.moreFilters$)),m.xb(2),m.gc("results",m.bc(11,16,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Wa=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.installmentsService=t,this.bankingHelper=n,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.self=this.authHelper.isSelf(this.param),this.stateManager.cache("data",this.installmentsService.getInstallmentsDataForSearch({owner:this.param,fields:["user","accountTypes","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.i)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e})}onDataInitialized(e){super.onDataInitialized(e);const t=(e.accountTypes||[]).map(e=>{var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern}).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.status=i.L.SCHEDULED,t}get statusOptions(){return Object.values(i.L).map(e=>({value:e,text:this.apiI18n.installmentStatus(e)}))}toSearchParams(e){const t=e;return t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SCHEDULED_PAYMENTS)}doSearch(e){return this.installmentsService.searchInstallments$Response(e)}get toLink(){return e=>this.bankingHelper.transactionPath(e.transaction)}number(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb($a.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-owner-installments"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[3,"routerLink","ngClass"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Ra,1,0,"ng-container",1),m.Pb(),m.Bc(3,Xa,14,18,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,L.a,v.u,v.l,h.a,y.a,x.a,P.a,D.a,g.s,w.a,Q.a,T.a,F.a,S.a,V.a,g.q,z.a,j.h],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();var Ya=n("v6Le");function Ja(e,t){1&e&&m.Mb(0)}function ec(e,t){1&e&&m.Lb(0,"div",7)}function tc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",7),m.Qb(2,"label-value",14),m.Lb(3,"user-link",15),m.Pb(),m.Pb(),m.Bc(4,ec,1,0,"div",9),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("ngIf",e.layout.gtsm$)}}function nc(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"single-selection-field",16),m.Lb(2,"field-option",17),m.Lb(3,"field-option",18),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.transaction.direction)("emptyOption",e.i18n.general.all),m.xb(1),m.gc("text",e.i18n.transaction.sent),m.xb(1),m.gc("text",e.i18n.transaction.received)}}function ic(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"input-field",19),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function ac(e,t){if(1&e&&m.Lb(0,"field-option",22),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function cc(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"single-selection-field",20),m.Bc(2,ac,1,2,"field-option",21),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.data.accountTypes)}}function rc(e,t){if(1&e&&m.Lb(0,"field-option",25),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e)("text",e.name)}}function oc(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"single-selection-field",23),m.Bc(2,rc,1,3,"field-option",24),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.period),m.xb(1),m.gc("ngForOf",e.data.preselectedPeriods)}}function sc(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",26),m.Qb(2,"div",7),m.Lb(3,"date-field",27),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(3),m.gc("label",e.i18n.general.beginDate)}}function lc(e,t){if(1&e&&(m.Qb(0,"div",7),m.Lb(1,"date-field",28),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.endDate)}}function uc(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("value",e)("id",e.id)("text",e.name)}}function bc(e,t){if(1&e&&(m.Qb(0,"div",7),m.Qb(1,"single-selection-field",29),m.Bc(2,uc,1,3,"field-option",30),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.account.transferFilter)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.transferFilters$.value)}}function dc(e,t){if(1&e&&(m.Qb(0,"mobile-result",32),m.Qb(1,"div",33),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("avatarImage",n.bankingHelper.avatarImage(e.related))("avatarIcon",n.bankingHelper.avatarIcon(e.related))("date",e.date)("amount",e.amount)("currency",n.currencies.get(e.currency)),m.xb(2),m.Fc(" ",n.bankingHelper.subjectName(e.related)," ")}}function mc(e,t){if(1&e&&(m.Qb(0,"th"),m.Dc(1),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.Ec(e.i18n.transaction.fromTo)}}function fc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.Ec(e.i18n.transaction.senderOrReceiver),m.xb(2),m.Ec(e.i18n.general.status)}}function gc(e,t){if(1&e&&(m.Qb(0,"td"),m.Dc(1),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(3);m.xb(1),m.Fc(" ",t.apiI18n.transactionStatus(e)," ")}}const pc=function(e,t,n){return{"pb-0":e,positive:t,negative:n}};function hc(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",38),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n))})),m.Qb(2,"td",35),m.Lb(3,"avatar",39),m.Pb(),m.Qb(4,"td"),m.Dc(5),m.ac(6,"date"),m.Pb(),m.Qb(7,"td"),m.Dc(8),m.Pb(),m.Bc(9,gc,2,1,"td",6),m.Qb(10,"td"),m.Dc(11),m.Pb(),m.Qb(12,"td",40),m.ac(13,"async"),m.Dc(14),m.ac(15,"currency"),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("image",n.bankingHelper.avatarImage(e.related))("icon",n.bankingHelper.avatarIcon(e.related)),m.xb(2),m.Fc(" ",m.bc(6,8,e.date)," "),m.xb(3),m.Fc(" ",n.bankingHelper.subjectName(e.related)," "),m.xb(1),m.gc("ngIf",n.isPaymentRequest()),m.xb(2),m.Fc(" ",n.bankingHelper.scheduling(e)," "),m.xb(1),m.gc("ngClass",m.lc(16,pc,m.bc(13,10,n.layout.xxs$),n.format.isPositive(e.amount),n.format.isNegative(e.amount))),m.xb(2),m.Fc(" ",m.dc(15,12,e.amount,n.currencies.get(e.currency),!0)," ")}}function yc(e,t){if(1&e&&(m.Qb(0,"table",34),m.Qb(1,"thead"),m.Lb(2,"th",35),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Bc(5,mc,2,1,"th",6),m.Bc(6,fc,5,2,"ng-container",6),m.Qb(7,"th"),m.Dc(8),m.Pb(),m.Qb(9,"th",36),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"tbody"),m.Bc(12,hc,16,20,"ng-container",37),m.ac(13,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(4),m.Ec(e.i18n.general.date),m.xb(1),m.gc("ngIf",!e.isPaymentRequest()),m.xb(1),m.gc("ngIf",e.isPaymentRequest()),m.xb(2),m.Ec(e.i18n.transaction.scheduling),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(13,6,e.results$))?null:n.results)}}function xc(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.Qb(1,"form",4),m.Qb(2,"div",5),m.Bc(3,tc,5,3,"ng-container",6),m.Qb(4,"div",7),m.Lb(5,"single-selection-field",8),m.Pb(),m.Bc(6,nc,4,4,"div",9),m.Bc(7,ic,2,2,"div",9),m.Bc(8,cc,3,3,"div",9),m.Bc(9,oc,3,2,"div",9),m.Bc(10,sc,4,1,"ng-container",6),m.ac(11,"async"),m.Bc(12,lc,2,1,"div",9),m.ac(13,"async"),m.Bc(14,bc,3,3,"div",9),m.ac(15,"async"),m.Qb(16,"div",7),m.Lb(17,"user-field",10),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(18,"results-layout",11),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(19,"async"),m.Bc(20,dc,3,6,"mobile-result",12),m.Bc(21,yc,14,8,"table",13),m.Pb()}if(2&e){const e=m.Zb();var n=null,i=null;m.gc("heading",e.heading)("mobileHeading",e.mobileHeading),m.xb(1),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",e.data.user&&!e.self),m.xb(2),m.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngIf",e.isPaymentRequest()),m.xb(1),m.gc("ngIf",e.hasTransactionNumber),m.xb(1),m.gc("ngIf",!e.isPaymentRequest()&&(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(1),m.gc("ngIf",e.usePreselectedPeriods&&(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),m.xb(1),m.gc("ngIf",!e.usePreselectedPeriods||null==(null==(n=e.form.value||m.bc(11,18,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),m.xb(2),m.gc("ngIf",!e.usePreselectedPeriods||null==(null==(i=e.form.value||m.bc(13,20,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),m.xb(2),m.gc("ngIf",m.bc(15,22,e.transferFilters$).length>0),m.xb(3),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("results",m.bc(19,24,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let vc=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transactionsService=t,this.bankingHelper=n,this.transferFilters$=new u.a([]),this.currencies=new Map,this.usePreselectedPeriods=!1}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;switch(this.kind=e.data.kind,this.param=e.params.owner,this.self=this.authHelper.isSelf(this.param),this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations,this.usePreselectedPeriods=!0;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequests,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequests}this.stateManager.cache("data",this.transactionsService.getTransactionsDataForSearch({owner:this.param,fields:["user","accountTypes","visibleKinds","transferFilters",...this.usePreselectedPeriods?["preselectedPeriods"]:[],"query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.i)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e}),this.addSub(this.form.get("accountType").valueChanges.subscribe(e=>{this.form.patchValue({transferFilter:null},{emitEvent:!1});const t=this.data.transferFilters.filter(t=>t.accountType.id===e);this.transferFilters$.next(t)}))}onDataInitialized(e){super.onDataInitialized(e);const t=Array.from(this.currencies.values()).map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactions$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))}isPaymentRequest(){return"payment-request"===this.kind}doSearch(e){return this.transactionsService.searchTransactions$Response(e)}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=i.Db.PENDING;break;case"payment-request":t.status=i.cb.OPEN}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(i.Db).map(e=>({value:e,text:this.apiI18n.authorizationStatus(e)}));case"payment-request":return Object.values(i.cb).map(e=>({value:e,text:this.apiI18n.paymentRequestStatus(e)}))}}toSearchParams(e){const t=e;switch(t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[i.Eb.PAYMENT_REQUEST]}return t}resolveMenu(e){let t;switch(this.kind){case"authorized":t=l.b.AUTHORIZED_PAYMENTS;break;case"payment-request":t=l.b.PAYMENT_REQUESTS}return this.menu.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Ya.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-owner-transactions"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferFilter",3,"label","emptyOption"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[1,"amount",3,"ngClass"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Ja,1,0,"ng-container",1),m.Pb(),m.Bc(3,xc,22,26,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,L.a,v.u,v.l,T.a,h.a,y.a,x.a,P.a,D.a,w.a,F.a,S.a,g.s,Q.a,V.a,z.a,g.q],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();function Pc(e,t){1&e&&m.Mb(0)}function Dc(e,t){if(1&e&&(m.Qb(0,"div",11),m.Lb(1,"single-selection-field",12),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyOption",e.i18n.general.notApplied)}}function Lc(e,t){if(1&e&&m.Lb(0,"field-option",15),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function wc(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",13),m.Bc(2,Lc,1,2,"field-option",14),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.currencies)}}function Cc(e,t){if(1&e&&m.Lb(0,"field-option",21),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Qc(e,t){if(1&e&&m.Lb(0,"field-option",21),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ic(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",17),m.Qb(2,"div",11),m.Qb(3,"single-selection-field",18),m.Bc(4,Cc,1,4,"field-option",19),m.Pb(),m.Pb(),m.Qb(5,"div",11),m.Qb(6,"single-selection-field",20),m.Bc(7,Qc,1,4,"field-option",19),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(3),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),m.xb(1),m.gc("ngForOf",e.accountTypes()),m.xb(2),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),m.xb(1),m.gc("ngForOf",e.accountTypes())}}function Fc(e,t){if(1&e&&(m.Qb(0,"div",11),m.Lb(1,"input-field",22),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Tc(e,t){if(1&e&&m.Lb(0,"field-option",25),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e)("text",e.name)}}function Sc(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"single-selection-field",23),m.Bc(2,Tc,1,3,"field-option",24),m.Pb(),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("label",e.i18n.general.period),m.xb(1),m.gc("ngForOf",e.data.preselectedPeriods)}}function kc(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",17),m.Qb(2,"div",11),m.Lb(3,"date-field",26),m.Pb(),m.Nb()),2&e){const e=m.Zb(4);m.xb(3),m.gc("label",e.i18n.general.beginDate)}}function Oc(e,t){if(1&e&&(m.Qb(0,"div",11),m.Lb(1,"date-field",27),m.Pb()),2&e){const e=m.Zb(4);m.xb(1),m.gc("label",e.i18n.general.endDate)}}function Nc(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Sc,3,2,"div",6),m.Bc(2,kc,4,1,"ng-container",7),m.ac(3,"async"),m.Bc(4,Oc,2,1,"div",6),m.ac(5,"async"),m.Nb()),2&e){const e=m.Zb(3);var n=null,i=null;m.xb(1),m.gc("ngIf",e.usePreselectedPeriod&&(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),m.xb(1),m.gc("ngIf",!e.usePreselectedPeriod||null==(null==(n=e.form.value||m.bc(3,3,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),m.xb(2),m.gc("ngIf",!e.usePreselectedPeriod||null==(null==(i=e.form.value||m.bc(5,5,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end))}}function Bc(e,t){if(1&e&&m.Lb(0,"field-option",30),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("category",e.from.name)}}function Ac(e,t){if(1&e&&(m.Qb(0,"div",11),m.Qb(1,"multi-selection-field",28),m.Bc(2,Bc,1,5,"field-option",29),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.account.transferFilter),m.xb(1),m.gc("ngForOf",e.data.authorizablePaymentTypes)}}function Ec(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",11),m.Lb(2,"date-field",31),m.Pb(),m.Qb(3,"div",11),m.Lb(4,"date-field",32),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.gc("label",e.i18n.general.expirationBeginDate),m.xb(2),m.gc("label",e.i18n.general.expirationEndDate)}}function $c(e,t){if(1&e&&(m.Qb(0,"div",11),m.Lb(1,"user-field",33),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.transaction.actionPerformedBy)}}function Rc(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Ic,8,6,"ng-container",7),m.Bc(2,Fc,2,2,"div",6),m.Bc(3,Nc,6,7,"ng-container",7),m.Bc(4,Ac,3,3,"div",6),m.Bc(5,Ec,5,2,"ng-container",7),m.Qb(6,"div",11),m.Lb(7,"user-field",16),m.Pb(),m.Bc(8,$c,2,1,"div",6),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",(e.isAuthorized()||e.isPaymentRequest())&&(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(1),m.gc("ngIf",!e.isMyAuth()&&e.hasTransactionNumber),m.xb(1),m.gc("ngIf",e.usePeriod),m.xb(1),m.gc("ngIf",e.isMyAuth()&&(null==e.data.authorizablePaymentTypes?null:e.data.authorizablePaymentTypes.length)>0),m.xb(1),m.gc("ngIf",e.isPaymentRequest()),m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("ngIf",e.isAuthorized())}}const Zc=function(e,t){return{from:e,to:t}};function Mc(e,t){if(1&e&&(m.Qb(0,"mobile-result",34),m.Qb(1,"div",35),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("date",e.date)("amount",e.amount)("currency",n.currenciesByKey.get(e.currency)),m.xb(2),m.Fc(" ",n.i18n.transaction.fromToText(m.kc(4,Zc,n.bankingHelper.subjectName(n.isPaymentRequest()?e.to:e.from),n.bankingHelper.subjectName(n.isPaymentRequest()?e.from:e.to)))," ")}}function Hc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.Ec(e.i18n.transaction.from),m.xb(2),m.Ec(e.i18n.transaction.to),m.xb(2),m.Ec(e.i18n.transaction.scheduling)}}function qc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Qb(7,"th"),m.Dc(8),m.Pb(),m.Qb(9,"th"),m.Dc(10),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.Ec(e.i18n.transaction.number),m.xb(2),m.Ec(e.i18n.transaction.sender),m.xb(2),m.Ec(e.i18n.transaction.receiver),m.xb(2),m.Ec(e.i18n.general.status),m.xb(2),m.Ec(e.i18n.general.expirationDate)}}function Uc(e,t){if(1&e&&(m.Qb(0,"td"),m.Qb(1,"a",40),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(3);m.xb(1),m.gc("routerLink",t.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",e.transactionNumber," ")}}function Vc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"td"),m.Qb(2,"a",42),m.Dc(3),m.Pb(),m.Pb(),m.Qb(4,"td"),m.Qb(5,"a",40),m.Dc(6),m.ac(7,"date"),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb().$implicit,t=m.Zb(3);m.xb(2),m.gc("routerLink",t.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",t.apiI18n.transactionStatus(e)," "),m.xb(2),m.gc("routerLink",t.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",m.bc(7,4,e.expirationDate)," ")}}function zc(e,t){if(1&e&&(m.Qb(0,"td"),m.Qb(1,"a",42),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(3);m.xb(1),m.gc("routerLink",t.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",t.bankingHelper.scheduling(e)," ")}}const jc=function(e){return{"pb-0":e}};function Gc(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",39),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n))})),m.Qb(2,"td"),m.Qb(3,"a",40),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Pb(),m.Bc(6,Uc,3,2,"td",7),m.Qb(7,"td"),m.Qb(8,"a",40),m.Dc(9),m.Pb(),m.Pb(),m.Qb(10,"td"),m.Qb(11,"a",40),m.Dc(12),m.Pb(),m.Pb(),m.Bc(13,Vc,8,6,"ng-container",7),m.Bc(14,zc,3,2,"td",7),m.Qb(15,"td",41),m.ac(16,"async"),m.Qb(17,"a",40),m.Dc(18),m.ac(19,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("routerLink",n.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",m.bc(5,12,e.date)," "),m.xb(2),m.gc("ngIf",n.isPaymentRequest()),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",n.bankingHelper.subjectName(n.isPaymentRequest()?e.to:e.from)," "),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",n.bankingHelper.subjectName(n.isPaymentRequest()?e.from:e.to)," "),m.xb(1),m.gc("ngIf",n.isPaymentRequest()),m.xb(1),m.gc("ngIf",!n.isPaymentRequest()),m.xb(1),m.gc("ngClass",m.jc(19,jc,m.bc(16,14,n.layout.xxs$))),m.xb(2),m.gc("routerLink",n.bankingHelper.transactionPath(e)),m.xb(1),m.Fc(" ",m.cc(19,16,e.amount,n.currenciesByKey.get(e.currency))," ")}}function Kc(e,t){if(1&e&&(m.Qb(0,"table",36),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Bc(4,Hc,7,3,"ng-container",7),m.Bc(5,qc,11,5,"ng-container",7),m.Qb(6,"th",37),m.Dc(7),m.Pb(),m.Pb(),m.Qb(8,"tbody"),m.Bc(9,Gc,20,21,"ng-container",38),m.ac(10,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.date),m.xb(1),m.gc("ngIf",!e.isPaymentRequest()),m.xb(1),m.gc("ngIf",e.isPaymentRequest()),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(10,5,e.results$))?null:n.results)}}function _c(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"form",4),m.Qb(3,"div",5),m.Bc(4,Dc,2,3,"div",6),m.Bc(5,wc,3,3,"div",6),m.Bc(6,Rc,9,7,"ng-container",7),m.ac(7,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(8,"results-layout",8),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(9,"async"),m.Bc(10,Mc,3,7,"mobile-result",9),m.Bc(11,Kc,11,7,"table",10),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.heading)("mobileHeading",e.mobileHeading)("headingActions",m.bc(1,10,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",(null==e.statusOptions?null:e.statusOptions.length)>0),m.xb(1),m.gc("ngIf",!e.isMyAuth()&&(null==e.currencies?null:e.currencies.length)>1),m.xb(1),m.gc("ngIf",m.bc(7,12,e.moreFilters$)||e.isMyAuth()),m.xb(2),m.gc("results",m.bc(9,14,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Xc=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transactionsService=t,this.bankingHelper=n,this.usePeriod=!0,this.usePreselectedPeriod=!0,this.currenciesByKey=new Map}ngOnInit(){switch(super.ngOnInit(),this.kind=this.route.snapshot.data.kind,this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations;break;case"myAuth":this.heading=this.i18n.transaction.title.pendingMyAuthorization,this.mobileHeading=this.i18n.transaction.mobileTitle.pendingMyAuthorization;break;case"payment-request":this.heading=this.i18n.transaction.title.paymentRequestsOverview,this.mobileHeading=this.i18n.transaction.mobileTitle.paymentRequestsOverview}this.stateManager.cache("data",this.transactionsService.getTransactionsOverviewDataForSearch({fields:["user","accountTypes",...this.usePreselectedPeriod?["preselectedPeriods"]:[],"query"],pendingMyAuthorization:"myAuth"===this.kind})).subscribe(e=>{this.usePeriod&&this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.currencies=[...new Set(e.accountTypes.map(e=>e.currency))],this.currencies.sort((e,t)=>e.name.localeCompare(t.name)),this.currenciesByKey=new Map,this.currencies.forEach(e=>this.currenciesByKey.set(e.id,e));const t=this.currencies.map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=this.isMyAuth?[]:[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactionsOverview$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e)),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e)))}updateAccountTypes(e){var t,n;const i=this.form.controls.fromAccountTypes.value,a=this.form.controls.toAccountTypes.value;e&&i&&this.form.controls.fromAccountTypes.setValue((null===(t=this.data.accountTypes.find(e=>e.id===i).currency)||void 0===t?void 0:t.id)===e?i:null),e&&a&&this.form.controls.toAccountTypes.setValue((null===(n=this.data.accountTypes.find(e=>e.id===a).currency)||void 0===n?void 0:n.id)===e?a:null)}doSearch(e){return this.transactionsService.searchTransactionsOverview$Response(e)}getFormControlNames(){return["status","currency","user","preselectedPeriod","periodBegin","periodEnd","transactionNumber","expirationBegin","expirationEnd","transferTypes","authorizationPerformedBy","fromAccountTypes","toAccountTypes"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=i.Db.PENDING;break;case"payment-request":t.status=i.cb.OPEN}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(i.Db).map(e=>({value:e,text:this.apiI18n.authorizationStatus(e)}));case"payment-request":return Object.values(i.cb).map(e=>({value:e,text:this.apiI18n.paymentRequestStatus(e)}));case"myAuth":return null}}toSearchParams(e){const t=e;switch(t.currencies=e.currency?[e.currency]:[],this.usePeriod&&(t.datePeriod=this.bankingHelper.resolveDatePeriod(e)),this.isPaymentRequest()&&(t.paymentRequestExpiration=r.a.dateRangeFilter(e.expirationBegin,e.expirationEnd)),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"myAuth":t.pendingMyAuthorization=!0;break;case"payment-request":t.paymentRequestStatuses=[e.status],t.kinds=[i.Eb.PAYMENT_REQUEST]}return t}accountTypes(){const e=this.form.controls.currency.value,t=this.data.accountTypes||[];return e?t.filter(t=>t.currency.id===e):t}isPaymentRequest(){return"payment-request"===this.kind}isMyAuth(){return"myAuth"===this.kind}isAuthorized(){return"authorized"===this.kind}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){let t;switch(this.kind){case"authorized":t=this.dataForFrontendHolder.role===i.pb.BROKER?l.b.BROKER_AUTHORIZED_PAYMENTS_OVERVIEW:l.b.AUTHORIZED_PAYMENTS_OVERVIEW;break;case"myAuth":t=l.b.PENDING_MY_AUTHORIZATION;break;case"payment-request":t=l.b.PAYMENT_REQUESTS_OVERVIEW}return this.menu.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Ya.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-transactions-overview"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountTypes",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transferTypes",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","future100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","authorizationPerformedBy",3,"label"],[3,"date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"amount",3,"ngClass"],[1,"d-inline-block",3,"routerLink"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Pc,1,0,"ng-container",1),m.Pb(),m.Bc(3,_c,12,16,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,h.a,y.a,x.a,L.a,v.u,v.l,g.s,w.a,T.a,F.a,S.a,Q.a,C.a,V.a,j.h,g.q],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();var Wc=n("Pm8L"),Yc=n("/kmK");function Jc(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"label-value",5),m.Dc(2),m.Pb(),m.Lb(3,"hr"),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.transaction.number),m.xb(1),m.Fc(" ",e.transaction.transactionNumber," ")}}function er(e,t){1&e&&m.Lb(0,"hr")}function tr(e,t){if(1&e&&(m.Qb(0,"label-value",5),m.Dc(1),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.gc("label",t.i18n.general.performedBy),m.xb(1),m.Fc(" ",e.by.display," ")}}function nr(e,t){if(1&e&&m.Lb(0,"label-value",8),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.gc("label",t.i18n.general.comments)("value",e.comments)}}function ir(e,t){if(1&e&&(m.Ob(0),m.Bc(1,er,1,0,"hr",3),m.Qb(2,"label-value",5),m.Dc(3),m.Pb(),m.Bc(4,tr,2,2,"label-value",6),m.Qb(5,"label-value",5),m.Dc(6),m.ac(7,"dateTime"),m.Pb(),m.Bc(8,nr,1,2,"label-value",7),m.Nb()),2&e){const e=t.$implicit,n=t.first,i=m.Zb(2);m.xb(1),m.gc("ngIf",!n),m.xb(1),m.gc("label",i.i18n.general.action),m.xb(1),m.Fc(" ",i.actionLabel(e)," "),m.xb(1),m.gc("ngIf",e.by),m.xb(1),m.gc("label",i.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(7,7,e.date)," "),m.xb(2),m.gc("ngIf",e.comments)}}function ar(e,t){if(1&e&&(m.Qb(0,"page-content",2),m.Bc(1,Jc,4,2,"ng-container",3),m.Bc(2,ir,9,9,"ng-container",4),m.Pb()),2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.authorizationHistory)("mobileHeading",e.i18n.transaction.mobileTitle.authorizationHistory),m.xb(1),m.gc("ngIf",e.transaction.transactionNumber),m.xb(1),m.gc("ngForOf",e.transaction.authorizations)}}let cr=(()=>{class e extends Wc.a{constructor(e,t){super(e),this.transactionsService=t}get transaction(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.transactionsService.viewTransaction({key:e,fields:["transactionNumber","date","amount","kind","type","from","to","authorizations"]}).subscribe(e=>{this.data=e}))}actionLabel(e){return this.apiI18n.authorizationAction(e.action)}resolveMenu(e){return this.menu.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Ya.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["view-authorization-history"]],features:[m.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],["valueFormat","break",3,"label","value"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,ar,3,4,"page-content",1),m.Pb()),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,g.s,P.a],pipes:[g.b,Yc.a],encapsulation:2,changeDetection:0}),e})();var rr=n("mK/S"),or=n("w0j7"),sr=n("Bp6V"),lr=n("0D+q"),ur=n("Ewue"),br=n("R8pA");function dr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.number),m.xb(1),m.Fc(" ",e.transfer.transactionNumber,"\n")}}function mr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Qb(1,"a",7),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.chargedBackBy),m.xb(1),m.gc("routerLink",e.path(e.transfer.chargedBackBy)),m.xb(1),m.Fc(" ",e.transfer.chargedBackBy.display," ")}}function fr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Qb(1,"a",7),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.chargebackOf),m.xb(1),m.gc("routerLink",e.path(e.transfer.chargebackOf)),m.xb(1),m.Fc(" ",e.transfer.chargebackOf.display," ")}}function gr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.general.performedBy),m.xb(1),m.Fc(" ",e.transfer.transaction.by.display,"\n")}}function pr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.receivedBy),m.xb(1),m.Fc(" ",e.transfer.transaction.receivedBy.display,"\n")}}function hr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.channel),m.xb(1),m.Fc(" ",e.transfer.transaction.channel.name,"\n")}}function yr(e,t){1&e&&m.Lb(0,"custom-field-value",8),2&e&&m.gc("fieldValue",t.$implicit)}function xr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=t.$implicit;m.gc("label",e.flow.name),m.xb(1),m.Fc(" ",e.name,"\n")}}function vr(e,t){if(1&e&&m.Lb(0,"label-value",9),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function Pr(e,t){if(1&e&&m.Lb(0,"label-value",9),2&e){const e=m.Zb();m.gc("label",e.i18n.general.description)("value",e.transfer.transaction.description)}}function Dr(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.number),m.xb(1),m.Fc(" ",e.transfer.parent.transactionNumber," ")}}function Lr(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"h2",10),m.Dc(2),m.ac(3,"async"),m.Pb(),m.Bc(4,Dr,2,2,"label-value",0),m.Qb(5,"label-value",1),m.Dc(6),m.ac(7,"dateTime"),m.Pb(),m.Qb(8,"label-value",1),m.Dc(9),m.ac(10,"currency"),m.Pb(),m.Qb(11,"label-value",1),m.Lb(12,"user-link",2),m.Pb(),m.Qb(13,"label-value",1),m.Lb(14,"user-link",2),m.Pb(),m.Qb(15,"label-value",1),m.Dc(16),m.Pb(),m.Qb(17,"actions"),m.Qb(18,"a",11),m.Dc(19),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(2),m.Ec(m.bc(3,14,e.layout.gtxs$)?e.i18n.transaction.title.parentTransfer:e.i18n.transaction.mobileTitle.parentTransfer),m.xb(2),m.gc("ngIf",e.transfer.parent.transactionNumber),m.xb(1),m.gc("label",e.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(7,16,e.transfer.parent.date)," "),m.xb(2),m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(10,18,e.transfer.parent.amount,e.transfer.parent.currency)," "),m.xb(2),m.gc("label",e.i18n.transaction.from),m.xb(1),m.gc("account",e.transfer.parent.from),m.xb(1),m.gc("label",e.i18n.transaction.to),m.xb(1),m.gc("account",e.transfer.parent.to),m.xb(1),m.gc("label",e.i18n.transaction.type),m.xb(1),m.Fc(" ",e.transfer.parent.type.name," "),m.xb(2),m.gc("routerLink",e.path(e.transfer.parent)),m.xb(1),m.Fc(" ",e.i18n.transaction.viewThisTransfer," ")}}function wr(e,t){if(1&e&&(m.Qb(0,"div"),m.Dc(1),m.Lb(2,"user-link",2),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.xb(1),m.Fc(" ",t.i18n.transaction.from," "),m.xb(1),m.gc("account",e.from)}}function Cr(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.to,"")}}function Qr(e,t){if(1&e&&(m.Qb(0,"mobile-result",16),m.Qb(1,"div",17),m.Bc(2,wr,3,2,"div",6),m.Qb(3,"div"),m.Bc(4,Cr,2,1,"ng-container",6),m.Lb(5,"user-link",2),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("date",e.date)("amount",((null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id)?"-":"")+e.amount)("amountColor",(null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id))("currency",e.currency),m.xb(2),m.gc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),m.xb(2),m.gc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),m.xb(1),m.gc("account",e.to)}}function Ir(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",21),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(1,"td"),m.Qb(2,"a",7),m.Dc(3),m.ac(4,"date"),m.Pb(),m.Pb(),m.Qb(5,"td"),m.Qb(6,"a",7),m.Lb(7,"user-link",2),m.Pb(),m.Pb(),m.Qb(8,"td"),m.Qb(9,"a",7),m.Lb(10,"user-link",2),m.Pb(),m.Pb(),m.Qb(11,"td",19),m.Qb(12,"a",7),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.bc(4,8,e.date)," "),m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.gc("account",e.from),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.gc("account",e.to),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.cc(14,10,e.amount,e.currency)," ")}}function Fr(e,t){if(1&e&&(m.Qb(0,"table",18),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th",19),m.Dc(9),m.Pb(),m.Pb(),m.Qb(10,"tbody"),m.Bc(11,Ir,15,13,"tr",20),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(3),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.transaction.from),m.xb(2),m.Ec(e.i18n.transaction.to),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",e.transfer.children)}}function Tr(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"h2",12),m.Dc(2),m.ac(3,"async"),m.Pb(),m.Qb(4,"results-layout",13),m.Bc(5,Qr,6,7,"mobile-result",14),m.Bc(6,Fr,12,5,"table",15),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(2),m.Ec(m.bc(3,3,e.layout.gtxs$)?e.i18n.transaction.title.childTransfers:e.i18n.transaction.mobileTitle.childTransfers),m.xb(2),m.gc("results",e.transfer.children)("toLink",e.toLink)}}let Sr=(()=>{class e extends k.a{constructor(e,t,n){super(e),this.login=t,this.bankingHelper=n}ngOnInit(){super.ngOnInit();const e=this.transfer.transaction||{};Object(s.i)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments),this.hasAdditionalData=!Object(s.i)(this.lastAuthComment)||!!this.transfer.parent||!Object(s.i)(this.transfer.children)}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(br.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["transfer-details"]],inputs:{transfer:"transfer",headingActions:"headingActions"},features:[m.ub],decls:24,vars:27,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"account"],[3,"fieldValue",4,"ngFor","ngForOf"],[3,"label",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"routerLink"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"mt-4"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-4","mb-0"],[3,"results","toLink"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"date","amount","amountColor","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(m.Bc(0,dr,2,2,"label-value",0),m.Qb(1,"label-value",1),m.Dc(2),m.ac(3,"dateTime"),m.Pb(),m.Qb(4,"label-value",1),m.Dc(5),m.ac(6,"currency"),m.Pb(),m.Bc(7,mr,3,3,"label-value",0),m.Bc(8,fr,3,3,"label-value",0),m.Bc(9,gr,2,2,"label-value",0),m.Bc(10,pr,2,2,"label-value",0),m.Qb(11,"label-value",1),m.Lb(12,"user-link",2),m.Pb(),m.Qb(13,"label-value",1),m.Lb(14,"user-link",2),m.Pb(),m.Qb(15,"label-value",1),m.Dc(16),m.Pb(),m.Bc(17,hr,2,2,"label-value",0),m.Bc(18,yr,1,1,"custom-field-value",3),m.Bc(19,xr,2,2,"label-value",4),m.Bc(20,vr,1,2,"label-value",5),m.Bc(21,Pr,1,2,"label-value",5),m.Bc(22,Lr,20,21,"ng-container",6),m.Bc(23,Tr,7,5,"ng-container",6)),2&e&&(m.gc("ngIf",t.transfer.transactionNumber),m.xb(1),m.gc("label",t.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(3,22,t.transfer.date),"\n"),m.xb(2),m.gc("label",t.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(6,24,t.transfer.amount,t.transfer.currency),"\n"),m.xb(2),m.gc("ngIf",t.transfer.chargedBackBy),m.xb(1),m.gc("ngIf",t.transfer.chargebackOf),m.xb(1),m.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.by),m.xb(1),m.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.receivedBy),m.xb(1),m.gc("label",t.i18n.transaction.from),m.xb(1),m.gc("account",t.transfer.from),m.xb(1),m.gc("label",t.i18n.transaction.to),m.xb(1),m.gc("account",t.transfer.to),m.xb(1),m.gc("label",t.i18n.transaction.type),m.xb(1),m.Fc(" ",t.transfer.type.name,"\n"),m.xb(1),m.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.channel),m.xb(1),m.gc("ngForOf",null==t.transfer.transaction?null:t.transfer.transaction.customValues),m.xb(1),m.gc("ngForOf",t.transfer.statuses),m.xb(1),m.gc("ngIf",t.lastAuthComment),m.xb(1),m.gc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.description),m.xb(1),m.gc("ngIf",t.transfer.parent),m.xb(1),m.gc("ngIf",(null==t.transfer.children?null:t.transfer.children.length)>0))},directives:[g.t,P.a,D.a,g.s,j.h,Xn.a,gt.a,h.a,y.a,x.a,V.a],pipes:[Yc.a,O.a,g.b,G.a],encapsulation:2,changeDetection:0}),e})();var kr=n("Wpnw");function Or(e,t){if(1&e&&m.Lb(0,"transfer-details",5),2&e){const e=m.Zb(2);m.gc("transfer",e.transaction.transfer)}}function Nr(e,t){if(1&e&&(m.Qb(0,"page-content",3),m.ac(1,"async"),m.Bc(2,Or,1,1,"transfer-details",4),m.Pb()),2&e){const e=m.Zb(),t=m.qc(4);m.gc("heading",e.title)("mobileHeading",e.mobileTitle)("headingActions",m.bc(1,5,e.headingActions$)),m.xb(2),m.gc("ngIf",e.transaction.transfer)("ngIfElse",t)}}function Br(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.number),m.xb(1),m.Fc(" ",e.transaction.transactionNumber," ")}}function Ar(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"dateTime"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.expirationDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.transaction.expirationDate)," ")}}function Er(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"dateTime"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.processDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.transaction.processDate)," ")}}function $r(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.dueAmount),m.xb(1),m.Fc(" ",m.cc(2,2,e.transaction.dueAmount,e.transaction.currency)," ")}}function Rr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.performedBy),m.xb(1),m.Fc(" ",e.transaction.by.display," ")}}function Zr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.receivedBy),m.xb(1),m.Fc(" ",e.transaction.receivedBy.display," ")}}function Mr(e,t){if(1&e&&m.Lb(0,"user-link",15),2&e){const e=m.Zb(2);m.gc("user",e.transaction.fromUser)}}function Hr(e,t){if(1&e&&m.Dc(0),2&e){const e=m.Zb(2);m.Fc(" ",e.transaction.type.from.name," ")}}function qr(e,t){if(1&e&&m.Lb(0,"user-link",15),2&e){const e=m.Zb(2);m.gc("user",e.transaction.toUser)}}function Ur(e,t){if(1&e&&m.Dc(0),2&e){const e=m.Zb(2);m.Fc(" ",e.transaction.type.to.name," ")}}function Vr(e,t){1&e&&m.Lb(0,"custom-field-value",16),2&e&&m.gc("fieldValue",t.$implicit)}function zr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.channel),m.xb(1),m.Fc(" ",e.transaction.channel.name," ")}}function jr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"date"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.dueDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.transaction.installments[0].dueDate)," ")}}function Gr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"date"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.nextOccurrence),m.xb(1),m.Fc(" ",m.bc(2,2,e.transaction.nextOccurrenceDate)," ")}}function Kr(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.occurrencesCount),m.xb(1),m.Fc(" ",e.transaction.occurrencesCount," ")}}function _r(e,t){if(1&e&&m.Lb(0,"label-value",17),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function Xr(e,t){if(1&e&&m.Lb(0,"label-value",17),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.description)("value",e.transaction.description)}}function Wr(e,t){if(1&e&&m.Lb(0,"label-value",17),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.comments)("value",e.transaction.comments)}}function Yr(e,t){1&e&&m.Lb(0,"th",23)}function Jr(e,t){if(1&e&&(m.Qb(0,"thead"),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Qb(7,"th",21),m.Dc(8),m.Pb(),m.Bc(9,Yr,1,0,"th",22),m.Pb()),2&e){const e=m.Zb(3);m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.transaction.dueDate),m.xb(2),m.Ec(e.i18n.general.status),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(1),m.gc("ngIf",e.hasActions)}}function eo(e,t){if(1&e){const e=m.Rb();m.Qb(0,"button",31),m.Xb("click",(function(){m.sc(e);const t=m.Zb(2).$implicit;return m.Zb(3).processInstallment(t)})),m.Lb(1,"icon",32),m.Pb()}if(2&e){const e=m.Zb(5);m.gc("tooltip",e.i18n.transaction.processInstallment),m.xb(1),m.gc("icon",e.SvgIcon.Play)}}const to=function(e){return{"ml-2":e}};function no(e,t){if(1&e){const e=m.Rb();m.Qb(0,"button",33),m.Xb("click",(function(){m.sc(e);const t=m.Zb(2).$implicit;return m.Zb(3).settleInstallment(t)})),m.Lb(1,"icon",32),m.Pb()}if(2&e){const e=m.Zb(2).$implicit,t=m.Zb(3);m.gc("tooltip",t.i18n.transaction.settleInstallment)("ngClass",m.jc(3,to,e.canProcess)),m.xb(1),m.gc("icon",t.SvgIcon.Check2)}}function io(e,t){if(1&e&&(m.Qb(0,"td",28),m.Bc(1,eo,2,2,"button",29),m.Bc(2,no,2,5,"button",30),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.gc("ngIf",e.canProcess),m.xb(1),m.gc("ngIf",e.canSettle)}}const ao=function(e){return{"cursor-pointer":e}};function co(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",24),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.path(n)?i.router.navigate(i.path(n)):null})),m.Qb(1,"td"),m.Qb(2,"maybe-link",25),m.Dc(3),m.Pb(),m.Pb(),m.Qb(4,"td"),m.Qb(5,"maybe-link",25),m.Dc(6),m.ac(7,"date"),m.Pb(),m.Pb(),m.Qb(8,"td"),m.Qb(9,"maybe-link",25),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"td",26),m.Qb(12,"maybe-link",25),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Pb(),m.Bc(15,io,3,2,"td",27),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.gc("ngClass",m.jc(15,ao,n.path(e))),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",e.number," "),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",m.bc(7,10,e.dueDate)," "),m.xb(3),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",n.installmentStatus(e.status)," "),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",m.cc(14,12,e.amount,n.transaction.currency)," "),m.xb(2),m.gc("ngIf",n.hasActions)}}function ro(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"h2",18),m.Dc(2),m.Pb(),m.Qb(3,"table",19),m.Bc(4,Jr,10,5,"thead",14),m.ac(5,"async"),m.Qb(6,"tbody"),m.Bc(7,co,16,17,"tr",20),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.Ec(e.i18n.transaction.installments),m.xb(2),m.gc("ngIf",m.bc(5,3,e.layout.gtxs$)),m.xb(3),m.gc("ngForOf",e.transaction.installments)}}function oo(e,t){1&e&&m.Lb(0,"th",23)}function so(e,t){if(1&e&&(m.Qb(0,"thead"),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Qb(7,"th",26),m.Dc(8),m.Pb(),m.Bc(9,oo,1,0,"th",22),m.Pb()),2&e){const e=m.Zb(3);m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.general.status),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(1),m.gc("ngIf",e.hasActions)}}function lo(e,t){if(1&e){const e=m.Rb();m.Qb(0,"button",31),m.Xb("click",(function(){m.sc(e);const t=m.Zb(2).$implicit;return m.Zb(3).processOccurrence(t)})),m.Lb(1,"icon",32),m.Pb()}if(2&e){const e=m.Zb(5);m.gc("tooltip",e.i18n.transaction.processFailedOccurrence),m.xb(1),m.gc("icon",e.SvgIcon.Play)}}function uo(e,t){if(1&e&&(m.Qb(0,"td",23),m.Bc(1,lo,2,2,"button",29),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.gc("ngIf",e.canProcess)}}function bo(e,t){if(1&e){const e=m.Rb();m.Qb(0,"tr",24),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.path(n)?i.router.navigate(i.path(n)):null})),m.Qb(1,"td"),m.Qb(2,"maybe-link",25),m.Dc(3),m.Pb(),m.Pb(),m.Qb(4,"td"),m.Qb(5,"maybe-link",25),m.Dc(6),m.ac(7,"date"),m.Pb(),m.Pb(),m.Qb(8,"td"),m.Qb(9,"maybe-link",25),m.Dc(10),m.Pb(),m.Pb(),m.Qb(11,"td",26),m.Qb(12,"maybe-link",25),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Pb(),m.Bc(15,uo,2,1,"td",22),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.gc("ngClass",m.jc(15,ao,n.path(e))),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",e.number," "),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",m.bc(7,10,e.dueDate)," "),m.xb(3),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",n.installmentStatus(e.status)," "),m.xb(2),m.gc("link",n.path(e)),m.xb(1),m.Fc(" ",m.cc(14,12,e.amount,n.transaction.currency)," "),m.xb(2),m.gc("ngIf",n.hasActions)}}function mo(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"h2",18),m.Dc(2),m.Pb(),m.Qb(3,"table",34),m.Bc(4,so,10,5,"thead",14),m.ac(5,"async"),m.Qb(6,"tbody"),m.Bc(7,bo,16,17,"tr",20),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.Fc(" ",e.i18n.transaction.occurrences," "),m.xb(2),m.gc("ngIf",m.bc(5,3,e.layout.gtxs$)),m.xb(3),m.gc("ngForOf",e.transaction.occurrences)}}const fo=function(){return[]};function go(e,t){if(1&e&&(m.Bc(0,Br,2,2,"label-value",6),m.Lb(1,"label-value",7),m.Qb(2,"label-value",8),m.Dc(3),m.ac(4,"dateTime"),m.Pb(),m.Bc(5,Ar,3,4,"label-value",6),m.Bc(6,Er,3,4,"label-value",6),m.Qb(7,"label-value",8),m.Dc(8),m.ac(9,"currency"),m.Pb(),m.Bc(10,$r,3,5,"label-value",6),m.Bc(11,Rr,2,2,"label-value",6),m.Bc(12,Zr,2,2,"label-value",6),m.Qb(13,"label-value",8),m.Bc(14,Mr,1,1,"user-link",9),m.Bc(15,Hr,1,1,"ng-template",null,10,m.Cc),m.Pb(),m.Qb(17,"label-value",8),m.Bc(18,qr,1,1,"user-link",9),m.Bc(19,Ur,1,1,"ng-template",null,11,m.Cc),m.Pb(),m.Qb(21,"label-value",8),m.Dc(22),m.Pb(),m.Bc(23,Vr,1,1,"custom-field-value",12),m.Bc(24,zr,2,2,"label-value",6),m.Bc(25,jr,3,4,"label-value",6),m.Bc(26,Gr,3,4,"label-value",6),m.Bc(27,Kr,2,2,"label-value",6),m.Bc(28,_r,1,2,"label-value",13),m.Bc(29,Xr,1,2,"label-value",13),m.Bc(30,Wr,1,2,"label-value",13),m.Bc(31,ro,8,5,"ng-container",14),m.Bc(32,mo,8,5,"ng-container",14)),2&e){const e=m.qc(16),t=m.qc(20),n=m.Zb();m.gc("ngIf",n.transaction.transactionNumber),m.xb(1),m.gc("label",n.i18n.general.status)("value",n.status),m.xb(1),m.gc("label",n.i18n.general.date),m.xb(1),m.Fc(" ",m.bc(4,30,n.transaction.date)," "),m.xb(2),m.gc("ngIf",n.isPaymentRequest()),m.xb(1),m.gc("ngIf",n.isPaymentRequest()&&n.transaction.processDate),m.xb(1),m.gc("label",n.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(9,32,n.transaction.amount,n.transaction.currency)," "),m.xb(2),m.gc("ngIf",n.hasDueAmount),m.xb(1),m.gc("ngIf",n.transaction.by),m.xb(1),m.gc("ngIf",null==n.transaction?null:n.transaction.receivedBy),m.xb(1),m.gc("label",n.isPaymentRequest()?n.i18n.transaction.sender:n.i18n.transaction.from),m.xb(1),m.gc("ngIf",n.transaction.fromUser)("ngIfElse",e),m.xb(3),m.gc("label",n.isPaymentRequest()?n.i18n.transaction.receiver:n.i18n.transaction.to),m.xb(1),m.gc("ngIf",n.transaction.toUser)("ngIfElse",t),m.xb(3),m.gc("label",n.i18n.transaction.type),m.xb(1),m.Fc(" ",n.transaction.type.name," "),m.xb(1),m.gc("ngForOf",n.transaction.customValues),m.xb(1),m.gc("ngIf",n.transaction.channel),m.xb(1),m.gc("ngIf",1===(n.transaction.installments||m.ic(35,fo)).length),m.xb(1),m.gc("ngIf",n.transaction.nextOccurrenceDate),m.xb(1),m.gc("ngIf",n.transaction.occurrencesCount),m.xb(1),m.gc("ngIf",n.lastAuthComment),m.xb(1),m.gc("ngIf",n.transaction.description),m.xb(1),m.gc("ngIf",n.transaction.comments),m.xb(1),m.gc("ngIf",(n.transaction.installments||m.ic(36,fo)).length>1),m.xb(1),m.gc("ngIf",(n.transaction.occurrences||m.ic(37,fo)).length>0)}}let po=(()=>{class e extends Wc.a{constructor(e,t,n,i,a,c,r,o,s){super(e),this.transactionsService=t,this.installmentsService=n,this.pendingPaymentsService=i,this.scheduledPaymentsService=a,this.recurringPaymentsService=c,this.paymentRequestsService=r,this.transfersService=o,this.operationHelper=s,this.hasDueAmount=!1,this.hasActions=!1}get status(){return this.apiI18n.transactionStatus(this.transaction)}get transaction(){return this.data}get key(){return this.route.snapshot.paramMap.get("key")}ngOnInit(){super.ngOnInit(),this.addSub(this.transactionsService.viewTransaction({key:this.key}).subscribe(e=>{[this.title,this.mobileTitle]=this.titles(e.kind),this.headingActions=this.initActions(e),this.hasDueAmount=e.dueAmount&&!this.format.isZero(e.dueAmount),this.hasActions=!!(e.installments||e.occurrences||[]).find(e=>e.canProcess||e.canSettle),this.data=e,e.transfer&&(e.transfer.transaction=e),Object(s.i)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments)}))}initActions(e){var t,n;const a=this.exportHelper.headingActions(e.exportFormats,t=>this.transactionsService.exportTransaction$Response({format:t.internalName,key:e.id})),c=e.authorizationPermissions||{};Object(s.i)(e.authorizations)||a.push(new zt.c(d.a.CheckCircle,this.i18n.transaction.viewAuthorizations,()=>this.router.navigate(["banking","transaction",this.key,"authorization-history"]))),c.authorize&&a.push(new zt.c(d.a.HandThumbsUp,this.i18n.transaction.authorizePending,()=>this.authorize())),c.deny&&a.push(new zt.c(d.a.HandThumbsDown,this.i18n.transaction.denyPending,()=>this.deny())),c.cancel&&a.push(new zt.c(d.a.XCircle,this.i18n.transaction.cancelAuthorization,()=>this.cancelAuthorization()));const r=e.scheduledPaymentPermissions||{};r.block&&a.push(new zt.c(d.a.CalendarX,this.i18n.transaction.blockScheduling,()=>this.blockScheduled())),r.unblock&&a.push(new zt.c(d.a.CalendarCheck,this.i18n.transaction.unblockScheduling,()=>this.unblockScheduled())),r.cancel&&a.push(new zt.c(d.a.XCircle,this.i18n.transaction.cancelScheduled,()=>this.cancelScheduled())),r.settle&&a.push(new zt.c(d.a.Check2All,this.i18n.transaction.settleScheduled,()=>this.settleScheduled())),e.kind===i.Eb.SCHEDULED_PAYMENT&&1===e.installments.length&&e.installments[0].canProcess&&a.push(new zt.c(d.a.FilePlay,this.i18n.transaction.processScheduled,()=>this.processScheduled(e.installments[0]))),(null===(t=e.recurringPaymentPermissions)||void 0===t?void 0:t.cancel)&&a.push(new zt.c(d.a.XCircle,this.i18n.transaction.cancelRecurring,()=>this.cancelRecurring()));const o=e.paymentRequestPermissions||{};o.accept&&a.push(new zt.c(d.a.HandThumbsUp,this.i18n.transaction.acceptPaymentRequest,()=>this.acceptPaymentRequest())),o.reject&&a.push(new zt.c(d.a.HandThumbsDown,this.i18n.transaction.rejectPaymentRequest,()=>this.rejectPaymentRequest())),o.cancel&&a.push(new zt.c(d.a.XCircle,this.i18n.transaction.cancelPaymentRequest,()=>this.cancelPaymentRequest())),o.reschedule&&a.push(new zt.c(d.a.CalendarEvent,this.i18n.transaction.reschedulePaymentRequest,()=>this.reschedulePaymentRequest())),o.changeExpiration&&a.push(new zt.c(d.a.CalendarEvent,this.i18n.transaction.changePaymentRequestExpiration,()=>this.changePaymentRequestExpiration())),(null===(n=e.transfer)||void 0===n?void 0:n.canChargeback)&&a.push(new zt.c(d.a.ArrowCounterclockwise,this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const i of(e.transfer||{}).operations||[])a.push(this.operationHelper.headingAction(i,e.transfer.id));return a}get authorizationFields(){return[{internalName:"comments",name:this.i18n.general.comments,type:i.o.TEXT}]}authDeviceConfirmation(e){return()=>({type:i.r.MANAGE_AUTHORIZATION,transaction:this.transaction.id,authorizationAction:e})}authorize(){this.notification.confirm({title:this.i18n.transaction.authorizePending,labelPosition:"above",customFields:this.authorizationFields,passwordInput:this.transaction.confirmationPasswordInput,createDeviceConfirmation:this.authDeviceConfirmation(i.g.AUTHORIZE),callback:e=>{this.addSub(this.pendingPaymentsService.authorizePendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(e=>{e?this.notification.warning(this.i18n.transaction.authorizePendingDoneStillPending):this.notification.snackBar(this.i18n.transaction.authorizePendingDone),this.reload()}))}})}deny(){this.notification.confirm({title:this.i18n.transaction.denyPending,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(i.g.DENY),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.denyPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.denyPendingDone)))}})}cancelAuthorization(){this.notification.confirm({title:this.i18n.transaction.cancelAuthorization,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(i.g.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.cancelPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelAuthorizationDone)))}})}schedDeviceConfirmation(e){return()=>({type:i.r.MANAGE_SCHEDULED_PAYMENT,transaction:this.transaction.id,scheduledPaymentAction:e})}blockScheduled(){this.notification.confirm({title:this.i18n.transaction.blockScheduling,message:this.i18n.transaction.blockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.qb.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.blockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.blockSchedulingDone)))}})}unblockScheduled(){this.notification.confirm({title:this.i18n.transaction.unblockScheduling,message:this.i18n.transaction.unblockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.qb.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.unblockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.unblockSchedulingDone)))}})}cancelScheduled(){this.notification.confirm({title:this.i18n.transaction.cancelScheduled,message:this.i18n.transaction.cancelScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.qb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.cancelScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelScheduledDone)))}})}settleScheduled(){this.notification.confirm({title:this.i18n.transaction.settleScheduled,message:this.i18n.transaction.settleScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(i.qb.SETTLE),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.settleScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleScheduledDone)))}})}recurringDeviceConfirmation(e){return()=>({type:i.r.MANAGE_RECURRING_PAYMENT,transaction:this.transaction.id,recurringPaymentAction:e})}cancelRecurring(){this.notification.confirm({title:this.i18n.transaction.cancelRecurring,message:this.i18n.transaction.cancelRecurringMessage,createDeviceConfirmation:this.recurringDeviceConfirmation(i.kb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.recurringPaymentsService.cancelRecurringPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelRecurringDone)))}})}paymentRequestDeviceConfirmation(e){return()=>({type:i.r.MANAGE_PAYMENT_REQUEST,transaction:this.transaction.id,paymentRequestAction:e})}cancelPaymentRequest(){this.notification.confirm({title:this.i18n.transaction.cancelPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.ab.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:i.o.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.cancelPaymentRequest({key:this.transaction.id,body:e.customValues.comments,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelPaymentRequestDone)))}})}rejectPaymentRequest(){this.notification.confirm({title:this.i18n.transaction.rejectPaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.ab.DENY),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"comments",name:this.i18n.general.comments,type:i.o.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.rejectPaymentRequest({key:this.transaction.id,body:e.customValues.comments,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.rejectPaymentRequestDone)))}})}changePaymentRequestExpiration(){this.notification.confirm({title:this.i18n.transaction.changePaymentRequestExpiration,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.ab.CHANGE_EXPIRATION),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:i.o.DATE,required:!0},{internalName:"comments",defaultValue:this.data.changeExpirationDateComments,name:this.i18n.general.comments,type:i.o.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.changePaymentRequestExpirationDate({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments,newExpirationDate:r.a.shiftToDayEnd(e.customValues.expiry)}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.changePaymentRequestExpirationDone)))}})}reschedulePaymentRequest(){this.notification.confirm({title:this.i18n.transaction.reschedulePaymentRequest,createDeviceConfirmation:this.paymentRequestDeviceConfirmation(i.ab.RESCHEDULE),passwordInput:this.transaction.confirmationPasswordInput,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:i.o.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:i.o.TEXT}],callback:e=>{this.addSub(this.paymentRequestsService.reschedulePaymentRequest({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments,processDate:e.customValues.expiry}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.reschedulePaymentRequestDone)))}})}acceptPaymentRequest(){this.router.navigate(["/banking","payment-request",this.data.id,"accept"])}chargebackDeviceConfirmation(){return()=>({type:i.r.CHARGEBACK,transfer:this.transaction.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transaction.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.chargebackTransferDone)))}})}titles(e){switch(e){case i.Eb.SCHEDULED_PAYMENT:return[this.i18n.transaction.title.detailsScheduled,this.i18n.transaction.mobileTitle.detailsScheduled];case i.Eb.RECURRING_PAYMENT:return[this.i18n.transaction.title.detailsRecurring,this.i18n.transaction.mobileTitle.detailsRecurring];case i.Eb.PAYMENT_REQUEST:return[this.i18n.transaction.title.detailsRequest,this.i18n.transaction.mobileTitle.detailsRequest];case i.Eb.CHARGEBACK:return[this.i18n.transaction.title.detailsChargeback,this.i18n.transaction.mobileTitle.detailsChargeback];case i.Eb.TICKET:return[this.i18n.transaction.title.detailsTicket,this.i18n.transaction.mobileTitle.detailsTicket];case i.Eb.EXTERNAL_PAYMENT:return[this.i18n.transaction.title.detailsExternal,this.i18n.transaction.mobileTitle.detailsExternal];default:return[this.i18n.transaction.title.detailsPayment,this.i18n.transaction.mobileTitle.detailsPayment]}}installmentStatus(e){return this.apiI18n.installmentStatus(e)}path(e){const t=e.transferTransactionNumber||e.transferId;if(t)return["/banking","transfer",t]}installmentDeviceConfirmation(e,t){return()=>({type:i.r.MANAGE_INSTALLMENT,installment:t.id,installmentAction:e})}settleInstallment(e){this.notification.confirm({title:this.i18n.transaction.settleInstallment,message:this.i18n.transaction.settleInstallmentMessage(String(e.number)),createDeviceConfirmation:this.installmentDeviceConfirmation(i.K.SETTLE,e),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.installmentsService.settleInstallment({key:e.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleInstallmentDone)))}})}isScheduledPayment(){return this.data.kind===i.Eb.SCHEDULED_PAYMENT}isPaymentRequest(){return this.data.kind===i.Eb.PAYMENT_REQUEST}processInstallment(e){this.notification.confirm({title:this.i18n.transaction.processInstallment,message:this.i18n.transaction.processInstallmentMessage(e.number),createDeviceConfirmation:this.installmentDeviceConfirmation(i.K.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processInstallmentDone)})}processOccurrence(e){this.notification.confirm({title:this.i18n.transaction.processFailedOccurrence,message:this.i18n.transaction.processFailedOccurrenceMessage(e.number),createDeviceConfirmation:this.failedOccurreneceDeviceConfirmation(i.w.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processFailedOccurrenceDone)})}processScheduled(e){this.notification.confirm({title:this.i18n.transaction.processScheduled,message:this.i18n.transaction.processScheduledMessage,createDeviceConfirmation:this.installmentDeviceConfirmation(i.K.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processScheduledDone)})}processCallback(e,t){return n=>this.addSub(this.installmentsService.processInstallment({key:e,confirmationPassword:n.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(t)))}sendNotificationAndReload(e){this.notification.snackBar(e),this.reload()}failedOccurreneceDeviceConfirmation(e,t){return()=>({type:i.r.MANAGE_FAILED_OCCURRENCE,failedOccurrence:t.id,failedOccurrenceAction:e})}resolveMenu(e){return this.menu.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Ya.a),m.Kb($a.a),m.Kb(or.a),m.Kb(lr.a),m.Kb(sr.a),m.Kb(jn.a),m.Kb(rr.a),m.Kb(ur.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["view-transaction"]],features:[m.ub],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["transactionFields",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"transfer",4,"ngIf","ngIfElse"],[3,"transfer"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],["toSystem",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"border-0","mt-4"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"amount"],["class","actions",4,"ngIf"],[1,"actions"],[3,"ngClass","click"],[3,"link"],[1,"text-right"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["class","btn btn-icon align-items-center",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon align-items-center",3,"tooltip","ngClass","click",4,"ngIf"],[1,"btn","btn-icon","align-items-center",3,"tooltip","click"],[3,"icon"],[1,"btn","btn-icon","align-items-center",3,"tooltip","ngClass","click"],[1,"table","table-hover","cursor-pointer"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Nr,3,7,"page-content",1),m.Pb(),m.Bc(3,go,33,38,"ng-template",null,2,m.Cc)),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,Sr,P.a,g.s,D.a,Xn.a,g.q,kr.a,Kn.b,Ti.a],pipes:[g.b,Yc.a,O.a,G.a],encapsulation:2,changeDetection:0}),e})();function ho(e,t){1&e&&m.Mb(0)}function yo(e,t){if(1&e&&m.Lb(0,"field-option",15),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e)("text",e.name)}}function xo(e,t){if(1&e&&(m.Qb(0,"div",12),m.Qb(1,"single-selection-field",13),m.Bc(2,yo,1,3,"field-option",14),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.period),m.xb(1),m.gc("ngForOf",e.data.preselectedPeriods)}}function vo(e,t){if(1&e&&m.Lb(0,"field-option",18),2&e){const e=t.$implicit,n=m.Zb(3);m.gc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function Po(e,t){if(1&e&&(m.Qb(0,"div",12),m.Qb(1,"multi-selection-field",16),m.Bc(2,vo,1,5,"field-option",17),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),m.xb(1),m.gc("ngForOf",e.data.groups)}}function Do(e,t){if(1&e&&m.Lb(0,"field-option",21),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function Lo(e,t){if(1&e&&(m.Qb(0,"div",12),m.Qb(1,"single-selection-field",19),m.Bc(2,Do,1,2,"field-option",20),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),m.xb(1),m.gc("ngForOf",e.data.currencies)}}function wo(e,t){if(1&e&&m.Lb(0,"field-option",39),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Co(e,t){if(1&e&&m.Lb(0,"field-option",39),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Qo(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",22),m.Qb(2,"div",12),m.Qb(3,"single-selection-field",36),m.Bc(4,wo,1,4,"field-option",37),m.Pb(),m.Pb(),m.Qb(5,"div",12),m.Qb(6,"single-selection-field",38),m.Bc(7,Co,1,4,"field-option",37),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(3),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),m.xb(1),m.gc("ngForOf",e.accountTypes()),m.xb(2),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),m.xb(1),m.gc("ngForOf",e.accountTypes())}}function Io(e,t){if(1&e&&m.Lb(0,"field-option",42),2&e){const e=t.$implicit,n=m.Zb(4);m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("category",n.singleAccount||null==e.accountType?null:e.accountType.name)}}function Fo(e,t){if(1&e&&(m.Qb(0,"div",12),m.Qb(1,"multi-selection-field",40),m.Bc(2,Io,1,5,"field-option",41),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.account.transferFilter),m.xb(1),m.gc("ngForOf",e.transferFilters())}}function To(e,t){if(1&e&&m.Lb(0,"field-option",45),2&e){const e=t.$implicit;m.gc("id",e.id)("internalName",e.internalName)("value",e.internalName)("text",e.name)}}function So(e,t){if(1&e&&(m.Qb(0,"div",12),m.Qb(1,"multi-selection-field",43),m.Bc(2,To,1,4,"field-option",44),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.channel),m.xb(1),m.gc("ngForOf",e.data.channels)}}function ko(e,t){if(1&e&&(m.Qb(0,"div",12),m.Lb(1,"date-field",46),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.beginDate)}}function Oo(e,t){if(1&e&&(m.Qb(0,"div",12),m.Lb(1,"date-field",47),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.endDate)}}function No(e,t){if(1&e&&(m.Qb(0,"div",12),m.Lb(1,"input-field",48),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function Bo(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Qo,8,6,"ng-container",8),m.Bc(2,Fo,3,3,"div",7),m.Bc(3,So,3,3,"div",7),m.Lb(4,"div",22),m.Bc(5,ko,2,1,"div",7),m.ac(6,"async"),m.Bc(7,Oo,2,1,"div",7),m.ac(8,"async"),m.Qb(9,"div",12),m.Lb(10,"decimal-field",23),m.Pb(),m.Qb(11,"div",12),m.Lb(12,"decimal-field",24),m.Pb(),m.Qb(13,"div",12),m.Lb(14,"user-field",25),m.Pb(),m.Bc(15,No,2,2,"div",7),m.Qb(16,"div",12),m.Lb(17,"user-field",26),m.Pb(),m.Qb(18,"div",12),m.Lb(19,"multi-selection-field",27),m.Pb(),m.Qb(20,"div",12),m.Qb(21,"single-selection-field",28),m.Lb(22,"field-option",29),m.Lb(23,"field-option",30),m.Pb(),m.Pb(),m.Qb(24,"div",12),m.Qb(25,"single-selection-field",31),m.Lb(26,"field-option",32),m.Lb(27,"field-option",33),m.Lb(28,"field-option",34),m.Lb(29,"field-option",35),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);var n,i;m.xb(1),m.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(1),m.gc("ngIf",e.transferFilters().length>0),m.xb(1),m.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),m.xb(2),m.gc("ngIf",null==(null==(n=e.form.value||m.bc(6,30,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),m.xb(2),m.gc("ngIf",null==(null==(i=e.form.value||m.bc(8,32,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end)),m.xb(3),m.gc("label",e.i18n.account.minAmount)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("label",e.i18n.account.maxAmount)("scale",e.currencyDecimalDigits())("prefix",e.currencyPrefix())("suffix",e.currencySuffix()),m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("ngIf",e.hasTransactionNumber),m.xb(2),m.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters())("allowContacts",!1),m.xb(2),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.transferKinds)("fieldOptions",e.kindOptions),m.xb(2),m.gc("label",e.i18n.transaction.chargedBack)("emptyOption",e.i18n.general.all),m.xb(1),m.gc("text",e.i18n.general.yes),m.xb(1),m.gc("text",e.i18n.general.no),m.xb(2),m.gc("label",e.i18n.general.orderBy),m.xb(1),m.gc("text",e.i18n.account.orderBy.dateDesc),m.xb(1),m.gc("text",e.i18n.account.orderBy.dateAsc),m.xb(1),m.gc("text",e.i18n.account.orderBy.amountAsc),m.xb(1),m.gc("text",e.i18n.account.orderBy.amountDesc)}}const Ao=function(e,t){return{from:e,to:t}};function Eo(e,t){if(1&e&&(m.Qb(0,"mobile-result",49),m.Qb(1,"div",50),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("date",e.date)("amount",e.amount)("currency",e.currency),m.xb(2),m.Fc(" ",n.i18n.transaction.fromToText(m.kc(4,Ao,n.bankingHelper.ownerName(e.from),n.bankingHelper.ownerName(e.to))),"")}}function $o(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",54),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td"),m.Qb(3,"a",55),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Pb(),m.Qb(6,"td"),m.Qb(7,"a",55),m.Dc(8),m.Pb(),m.Pb(),m.Qb(9,"td"),m.Qb(10,"a",55),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"td",52),m.Qb(13,"a",55),m.Dc(14),m.ac(15,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.bc(5,8,e.date)," "),m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",n.bankingHelper.ownerName(e.from)," "),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",n.bankingHelper.ownerName(e.to)," "),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.cc(15,10,n.format.abs(e.amount),e.currency)," ")}}function Ro(e,t){if(1&e&&(m.Qb(0,"table",51),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th",52),m.Dc(9),m.Pb(),m.Pb(),m.Qb(10,"tbody"),m.Bc(11,$o,16,13,"ng-container",53),m.ac(12,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.date),m.xb(2),m.Ec(e.i18n.transaction.from),m.xb(2),m.Ec(e.i18n.transaction.to),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(12,5,e.results$))?null:n.results)}}function Zo(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",4),m.ac(1,"async"),m.Qb(2,"form",5),m.Qb(3,"div",6),m.Bc(4,xo,3,2,"div",7),m.Bc(5,Po,3,3,"div",7),m.Bc(6,Lo,3,3,"div",7),m.Bc(7,Bo,30,34,"ng-container",8),m.ac(8,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(9,"results-layout",9),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(10,"async"),m.Bc(11,Eo,3,7,"mobile-result",10),m.Bc(12,Ro,13,7,"table",11),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.transfersOverview)("mobileHeading",e.i18n.transaction.mobileTitle.transfersOverview)("headingActions",m.bc(1,11,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.currencies?null:e.data.currencies.length)>1),m.xb(1),m.gc("ngIf",m.bc(8,13,e.moreFilters$)),m.xb(2),m.gc("results",m.bc(10,15,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function Mo(e,t){1&e&&m.Lb(0,"spinner",56)}let Ho=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transfersService=t,this.bankingHelper=n,this.filters$=new u.a([])}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}getFormControlNames(){return["preselectedPeriod","periodBegin","periodEnd","groups","currency","channels","fromAccountType","toAccountType","transferFilters","kinds","chargedBack","minAmount","maxAmount","transactionNumber","user","by","orderBy","brokers"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.orderBy=t.orderBy||i.Bb.DATE_DESC,t}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.transfersService.getTransferDataForSearch()).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.singleCurrency=1===(e.currencies||[]).length?e.currencies[0]:null,this.singleAccount=1===(e.accountTypes||[]).length?e.accountTypes[0]:null;const t=(e.currencies||[]).map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.fromAccountType.valueChanges.subscribe(e=>this.updateTransferFilters(e))),this.addSub(this.form.controls.currency.valueChanges.subscribe(e=>this.updateAccountTypes(e))),this.headingActions=[this.moreFiltersAction],this.exportHelper.headingActions(e.exportFormats,e=>this.transfersService.exportTransfers$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))).forEach(e=>this.headingActions.push(e))}updateTransferFilters(e){const t=this.form.controls.transferFilters.value;e&&t&&this.form.controls.transferFilters.setValue(t.filter(t=>this.data.transferFilters.find(e=>e.id===t).accountType.id===e))}updateAccountTypes(e){const t=this.form.controls.fromAccountType.value,n=this.form.controls.toAccountType.value;if(e&&t){const n=this.data.accountTypes.find(e=>e.id===t).currency;this.form.controls.fromAccountType.setValue(n&&n.id!==e?null:t)}if(e&&n){const t=this.data.accountTypes.find(e=>e.id===n).currency;this.form.controls.toAccountType.setValue(t&&t.id!==e?null:n)}}userSearchFilters(){return{roles:[i.pb.BROKER]}}findCurrency(e){var t;if(this.singleCurrency)return this.singleCurrency;const n=this.form.controls.currency.value;if(n)return this.data.currencies.find(e=>e.id===n);const i=this.form.controls.fromAccountType.value;return e&&i?null===(t=this.data.accountTypes.find(e=>e.id===i))||void 0===t?void 0:t.currency:null}transferFilters(){const e=this.form.controls.fromAccountType.value,t=this.data.transferFilters||[];if(e)return t.filter(t=>t.accountType.id===e);if(this.findCurrency(!0)){const e=this.accountTypes().map(e=>e.id);return t.filter(t=>e.includes(t.accountType.id))}return t}accountTypes(){const e=this.findCurrency(!1),t=this.data.accountTypes||[];return e?t.filter(t=>!t.currency||t.currency.id===e.id):t}currencyDecimalDigits(){const e=this.findCurrency(!0);return e?e.decimalDigits:2}currencyPrefix(){const e=this.findCurrency(!0);return e?e.prefix:null}currencySuffix(){const e=this.findCurrency(!0);return e?e.suffix:null}toSearchParams(e){const t=e;return t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],e.chargedBack&&(t.chargedBack="yes"===e.chargedBack),t}doSearch(e){return this.transfersService.searchTransfers$Response(e)}get kindOptions(){return Object.values(i.Fb).map(e=>({value:e,text:this.apiI18n.transferKind(e)}))}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return this.dataForFrontendHolder.role===i.pb.ADMINISTRATOR?l.b.ADMIN_TRANSFERS_OVERVIEW:l.b.BROKER_TRANSFERS_OVERVIEW}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(rr.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-transfers-overview"]],features:[m.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters","allowContacts"],["labelPosition","side","formControlName","kinds",3,"emptyLabel","label","fieldOptions"],["labelPosition","side","formControlName","chargedBack",3,"label","emptyOption"],["value","yes",3,"text"],["value","no",3,"text"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transferFilters",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,ho,1,0,"ng-container",1),m.Pb(),m.Bc(3,Zo,13,17,"ng-template",null,2,m.Cc),m.Bc(5,Mo,1,0,"ng-template",null,3,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,h.a,y.a,x.a,L.a,v.u,v.l,g.s,w.a,C.a,I.a,T.a,Q.a,F.a,S.a,V.a,j.h,U.a],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();function qo(e,t){if(1&e&&(m.Qb(0,"page-content",2),m.ac(1,"async"),m.Lb(2,"transfer-details",3),m.ac(3,"async"),m.Pb()),2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.detailsTransfer)("mobileHeading",e.i18n.transaction.mobileTitle.detailsTransfer)("headingActions",m.bc(1,5,e.headingActions$)),m.xb(2),m.gc("headingActions",m.bc(3,7,e.headingActions$))("transfer",e.transfer)}}let Uo=(()=>{class e extends Wc.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.transfersService=n,this.operationHelper=i}get transfer(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.accountId=e.params.account,this.addSub(this.transfersService.viewTransfer({key:e.params.key}).subscribe(e=>{this.headingActions=this.initActions(e),this.data=e}))}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.transfersService.exportTransfer$Response({format:t.internalName,key:e.id})),n=e.transaction||{};Object(s.i)(n.authorizations)||t.push(new zt.c(d.a.CheckCircle,this.i18n.transaction.viewAuthorizations,()=>{this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(n),"authorization-history"])})),e.canChargeback&&t.push(new zt.c(d.a.ArrowCounterclockwise,this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const i of e.operations||[])t.push(this.operationHelper.headingAction(i,e.id));return t}chargebackDeviceConfirmation(){return()=>({type:i.r.CHARGEBACK,transfer:this.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transfer.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>{this.notification.snackBar(this.i18n.transaction.chargebackTransferDone),this.reload()}))}})}resolveMenu(e){return this.menu.transferMenu(e,this.accountId)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(rr.a),m.Kb(ur.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["view-transfer"]],features:[m.ub],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"headingActions","transfer"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,qo,4,9,"page-content",1),m.Pb()),2&e&&(m.gc("ready",m.bc(1,2,t.data$)),m.xb(2),m.gc("ngIf",t.data))},directives:[f.a,g.t,p.a,Sr],pipes:[g.b],encapsulation:2,changeDetection:0}),e})();var Vo=n("xVDN");function zo(e,t){if(1&e&&m.Lb(0,"user-info",5),2&e){const e=m.Zb();m.gc("user",e.user)}}function jo(e,t){if(1&e&&(m.Qb(0,"mobile-result",6),m.Qb(1,"div",7),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb();m.gc("avatarImage",e.image)("avatarIcon",n.SvgIcon.Person),m.xb(2),m.Fc(" ",e.voucherTitle," ")}}function Go(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",10),m.Xb("click",(function(){m.sc(e);const n=t.$implicit;return m.Zb(2).selectType(n)})),m.Qb(2,"td",11),m.Lb(3,"avatar",12),m.Pb(),m.Qb(4,"td"),m.Qb(5,"div"),m.Qb(6,"a",13),m.Xb("click",(function(){m.sc(e);const n=t.$implicit;return m.Zb(2).selectType(n)})),m.Dc(7),m.Pb(),m.Qb(8,"div"),m.Dc(9),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("image",e.image)("icon",n.SvgIcon.Ticket),m.xb(4),m.Fc(" ",e.voucherTitle," "),m.xb(2),m.Fc(" ",e.voucherDescription," ")}}function Ko(e,t){if(1&e&&(m.Qb(0,"table",8),m.Qb(1,"tbody"),m.Bc(2,Go,10,4,"ng-container",9),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.xb(2),m.gc("ngForOf",e.types)}}let _o=(()=>{class e extends k.a{constructor(e){super(e),this.typeSelected=new m.n}get selectType(){return e=>this.typeSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["buy-vouchers-step-list-types"]],inputs:{types:"types",user:"user"},outputs:{typeSelected:"typeSelected"},features:[m.ub],decls:5,vars:6,consts:[[3,"mode","heading","mobileHeading"],["labelCols","2",3,"user",4,"ngIf"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false",3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelCols","2",3,"user"],["avatarRoundBorders","false",3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["size","xlarge","roundBorders","false",3,"image","icon"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(m.Qb(0,"page-content",0),m.Bc(1,zo,1,1,"user-info",1),m.Pb(),m.Qb(2,"results-layout",2),m.Bc(3,jo,3,3,"mobile-result",3),m.Bc(4,Ko,3,1,"table",4),m.Pb()),2&e&&(m.gc("mode",t.user&&!t.authHelper.isSelf(t.user)?"normal":"empty")("heading",t.i18n.voucher.title.buy)("mobileHeading",t.i18n.voucher.mobileTitle.buy),m.xb(1),m.gc("ngIf",t.user&&!t.authHelper.isSelf(t.user)),m.xb(1),m.gc("results",t.types)("onClick",t.selectType))},directives:[p.a,g.t,h.a,y.a,x.a,vt.a,V.a,g.s,z.a,g.q],encapsulation:2,changeDetection:0}),e})();function Xo(e,t){if(1&e&&m.Lb(0,"user-info",8),2&e){const e=m.Zb();m.gc("user",e.data.user)}}function Wo(e,t){if(1&e&&(m.Qb(0,"label-value",2),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.voucher.buy.minTimeToRedeem),m.xb(1),m.Fc(" ",e.i18n.voucher.buy.minTimeToRedeemAfterBuy(e.format.formatTimeInterval(e.data.minimumTimeToRedeem))," ")}}const Yo=function(e,t){return{min:e,max:t}};function Jo(e,t){if(1&e&&(m.Lb(0,"label-value",9),m.ac(1,"currency"),m.ac(2,"currency")),2&e){const e=m.Zb();m.gc("label",e.i18n.voucher.buy.amountRange)("value",e.format.formatRange(m.kc(8,Yo,m.cc(1,2,e.data.amountRange.min,e.currency),m.cc(2,5,e.data.amountRange.max,e.currency))))}}function es(e,t){if(1&e&&(m.Qb(0,"label-value",10),m.Lb(1,"custom-field-input",11),m.Pb()),2&e){const e=t.$implicit,n=m.Zb();m.gc("label",e.name)("kind","field")("fieldSize",n.fieldSize(e))("required",e.required)("labelPosition","boolean"===e.type?"sideForced":"auto"),m.xb(1),m.gc("field",e)("formControl",n.customFieldControlsMap.get(e.internalName))}}let ts=(()=>{class e extends k.a{constructor(e){super(e)}get currency(){return this.data.account.currency}fieldSize(e){return this.fieldHelper.fieldSize(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["buy-vouchers-step-form"]],inputs:{data:"data",form:"form",customFieldControlsMap:"customFieldControlsMap"},features:[m.ub],decls:12,vars:17,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf"],[3,"label","kind","fieldSize","required","labelPosition",4,"ngFor","ngForOf"],[3,"user"],["kind","fieldView",3,"label","value"],[3,"label","kind","fieldSize","required","labelPosition"],["hideLabel","",3,"field","formControl"]],template:function(e,t){1&e&&(m.Ob(0,0),m.Bc(1,Xo,1,1,"user-info",1),m.Qb(2,"label-value",2),m.Dc(3),m.Pb(),m.Qb(4,"label-value",2),m.Dc(5),m.ac(6,"currency"),m.Pb(),m.Bc(7,Wo,2,2,"label-value",3),m.Lb(8,"input-field",4),m.Lb(9,"decimal-field",5),m.Bc(10,Jo,3,11,"label-value",6),m.Bc(11,es,2,7,"label-value",7),m.Nb()),2&e&&(m.gc("formGroup",t.form),m.xb(1),m.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),m.xb(1),m.gc("label",t.i18n.voucher.originAccount),m.xb(1),m.Fc(" ",t.data.account.type.name," "),m.xb(1),m.gc("label",t.i18n.account.availableBalance),m.xb(1),m.Fc(" ",m.cc(6,14,t.data.account.status.availableBalance,t.currency)," "),m.xb(2),m.gc("ngIf",t.data.minimumTimeToRedeem),m.xb(1),m.gc("label",t.i18n.voucher.numberOfVouchers),m.xb(1),m.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),m.xb(1),m.gc("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)||(null==t.data.amountRange?null:t.data.amountRange.max)),m.xb(1),m.gc("ngForOf",t.data.customFields))},directives:[v.v,v.n,g.t,P.a,F.a,v.u,v.l,v.C,I.a,g.s,vt.a,Hi.a,v.k],pipes:[O.a],encapsulation:2,changeDetection:0}),e})();var ns=n("5Wk5");function is(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"user-info",3),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("user",e.data.user)}}function as(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"label-value",4),m.ac(2,"async"),m.Lb(3,"format-field-value",5,6),m.Pb(),m.Nb()),2&e){const e=t.$implicit,n=m.qc(4),i=m.Zb();m.xb(1),m.gc("hidden",!n.hasValue)("label",e.name)("labelPosition",i.labelOnTop(m.bc(2,6,i.layout.ltsm$),e)?"top":"auto"),m.xb(2),m.gc("object",i.buyVoucher)("fields",i.data.customFields)("fieldName",e.internalName)}}function cs(e,t){1&e&&m.Lb(0,"hr")}function rs(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Bc(1,cs,1,0,"hr",0),m.ac(2,"async"),m.Qb(3,"form",7),m.Qb(4,"confirmation-password",8),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().confirmed.emit(t)})),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,4,e.layout.gtxxs$)),m.xb(2),m.gc("formGroup",e.form),m.xb(1),m.gc("passwordInput",e.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let os=(()=>{class e extends k.a{constructor(e){super(e),this.confirmationModeChanged=new m.n,this.confirmed=new m.n}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:i.r.BUY_VOUCHERS,amount:this.buyVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.buyVoucher.count}),this.confirmationPasswordInput||this.addShortcut(Gn.k,()=>this.confirmed.emit())}labelOnTop(e,t){return!!e&&[i.o.RICH_TEXT,i.o.TEXT].includes(t?t.type:null)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["buy-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",buyVoucher:"buyVoucher",data:"data"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[m.ub],decls:10,vars:12,consts:[[4,"ngIf"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"hidden","label","labelPosition"],[3,"object","fields","fieldName"],["formatFieldValue",""],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(m.Bc(0,is,2,1,"ng-container",0),m.Qb(1,"label-value",1),m.Dc(2),m.Pb(),m.Qb(3,"label-value",1),m.Dc(4),m.Pb(),m.Qb(5,"label-value",1),m.Dc(6),m.ac(7,"currency"),m.Pb(),m.Bc(8,as,5,8,"ng-container",2),m.Bc(9,rs,5,6,"ng-container",0)),2&e&&(m.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),m.xb(1),m.gc("label",t.i18n.general.type),m.xb(1),m.Fc(" ",t.data.type.voucherTitle,"\n"),m.xb(1),m.gc("label",t.i18n.voucher.numberOfVouchers),m.xb(1),m.Fc(" ",t.buyVoucher.count,"\n"),m.xb(1),m.gc("label",t.i18n.voucher.amountPerVoucher),m.xb(1),m.Fc(" ",m.cc(7,9,t.buyVoucher.amount,t.data.account.currency),"\n"),m.xb(2),m.gc("ngForOf",t.data.customFields),m.xb(1),m.gc("ngIf",t.confirmationPasswordInput))},directives:[g.t,P.a,g.s,vt.a,ns.a,v.H,v.v,v.n,Wn.a,Yn.a,v.u,v.l],pipes:[O.a,g.b],encapsulation:2,changeDetection:0}),e})();function ss(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"buy-vouchers-step-list-types",4),m.Xb("typeSelected",(function(t){return m.sc(e),m.Zb().toForm(t)})),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("user",e.data.user)("types",e.data.types)}}function ls(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",10),m.Xb("action",(function(){return m.sc(e),m.Zb(2).backToSelectType()})),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.previous)}}function us(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",5),m.ac(1,"async"),m.Lb(2,"buy-vouchers-step-form",6),m.Qb(3,"actions",7),m.Qb(4,"action-button",8),m.Xb("action",(function(){return m.sc(e),m.Zb().toConfirm()})),m.ac(5,"async"),m.Pb(),m.Bc(6,ls,1,1,"action-button",9),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.dataTypeForBuy.type.voucherTitle)("mobileHeading",e.dataTypeForBuy.type.voucherTitle)("mode",m.bc(1,9,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("data",e.dataTypeForBuy)("form",e.form)("customFieldControlsMap",e.customFieldControlsMap),m.xb(2),m.gc("disabled",m.bc(5,11,e.requesting$))("label",e.i18n.general.next),m.xb(2),m.gc("ngIf",!e.singleType)}}function bs(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",8),m.Xb("action",(function(){return m.sc(e),m.Zb(2).buy()})),m.ac(1,"async"),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("disabled",!e.canConfirm||m.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function ds(e,t){1&e&&m.Dc(0,"\xa0")}function ms(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",5),m.ac(1,"async"),m.Qb(2,"buy-vouchers-step-confirm",11),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().buy(t)})),m.Pb(),m.Qb(3,"actions",7),m.Bc(4,bs,2,4,"action-button",12),m.ac(5,"async"),m.Bc(6,ds,1,0,"ng-template",null,13,m.Cc),m.Qb(8,"action-button",10),m.Xb("action",(function(){return m.sc(e),m.Zb().backToForm()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.qc(7),t=m.Zb();m.gc("heading",t.i18n.voucher.title.buyConfirmation)("mobileHeading",t.i18n.voucher.mobileTitle.buyConfirmation)("mode",m.bc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("buyVoucher",t.form.value)("data",t.dataTypeForBuy)("confirmationPasswordInput",t.dataTypeForBuy.confirmationPasswordInput)("confirmationPassword",t.confirmationPassword),m.xb(2),m.gc("ngIf",m.bc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),m.xb(4),m.gc("label",t.i18n.general.previous)}}function fs(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let gs=(()=>{class e extends mt.a{constructor(e,t){super(e),this.voucherService=t,this.ConfirmationMode=On.a,this.step$=new u.a(null),this.singleType=!1,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.user=this.authHelper.isSelf(e.user)?this.ApiHelper.SELF:e.user,this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){const t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}get currency(){return this.dataTypeForBuy.account.currency}buy(e){if(e&&this.confirmationPassword.setValue(e),this.confirmationPasswordInput&&!Object(s.I)(this.confirmationPassword))return;const t=this.form.value;t.type=this.dataTypeForBuy.type.id,this.addSub(this.voucherService.buyVouchers({user:this.user,confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:t}).subscribe(e=>{this.router.navigate(1===e.length?["banking","vouchers","view",e[0]]:["banking",this.user,"vouchers","bought"]),this.notification.snackBar(this.i18n.voucher.buy.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(e){this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user,type:e.id}).subscribe(e=>{this.dataTypeForBuy=e,this.buildForm(),this.step="form"}))}toConfirm(){Object(s.I)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(v.F.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}get confirmationPasswordInput(){return this.dataTypeForBuy.confirmationPasswordInput}buildForm(){if(this.form)this.form.reset();else if(this.customFieldControlsMap=this.fieldHelper.customValuesFormControlMap(this.dataTypeForBuy.customFields),this.form=this.formBuilder.group({count:new v.j(""),amount:new v.j("")}),this.customFieldControlsMap.size>0){const e=new v.m({});for(const t of this.customFieldControlsMap)e.addControl(t[0],t[1]);this.form.setControl("customValues",e)}this.form.get("count").setValue(1)}resolveMenu(e){return this.menu.userMenu(e.user,l.b.BUY_VOUCHER)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["buy-vouchers"]],features:[m.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form","customFieldControlsMap"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"buyVoucher","data","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,ss,2,2,"ng-container",1),m.Bc(4,us,7,13,"page-content",2),m.Bc(5,ms,9,14,"page-content",2),m.Bc(6,fs,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,5,t.data$))("ngSwitch",m.bc(2,7,t.step$)),m.xb(3),m.gc("ngSwitchCase","select-type"),m.xb(1),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","confirm"))},directives:[f.a,g.x,g.y,g.z,_o,p.a,ts,gt.a,pt.a,g.t,os,U.a],pipes:[g.b],encapsulation:2,changeDetection:0}),e})();var ps=n("5pUo"),hs=n("K3ix"),ys=n("pBnU");const xs=["inputField"];function vs(e,t){if(1&e){const e=m.Rb();m.Qb(0,"button",14,15),m.Xb("click",(function(){return m.sc(e),m.Zb(3).showScanQrCode()})),m.Lb(2,"icon",16),m.Pb()}if(2&e){const e=m.Zb(3);m.gc("tooltip",e.i18n.field.user.scanQrCodeTooltip),m.xb(2),m.gc("icon",e.SvgIcon.QrcodeScan)}}function Ps(e,t){if(1&e){const e=m.Rb();m.Qb(0,"div"),m.Mb(1,6),m.Qb(2,"div",7),m.Qb(3,"div",8),m.Qb(4,"label-value",9),m.Lb(5,"input-field",10,11),m.Bc(7,vs,3,2,"button",12),m.Pb(),m.Pb(),m.Pb(),m.Qb(8,"actions"),m.Qb(9,"action-button",13),m.Xb("action",(function(){return m.sc(e),m.Zb(2).submit()})),m.ac(10,"async"),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.Zb(2),t=m.qc(6);m.xb(1),m.gc("ngTemplateOutlet",t),m.xb(3),m.gc("label",e.i18n.voucher.token),m.xb(1),m.gc("mask",e.mask)("formControl",e.token)("placeholder",e.mask),m.xb(4),m.gc("disabled",m.bc(10,7,e.requesting$))("label",e.i18n.general.submit)}}function Ds(e,t){if(1&e&&(m.Qb(0,"page-content",4),m.ac(1,"async"),m.Bc(2,Ps,11,9,"div",5),m.ac(3,"async"),m.Pb()),2&e){const e=m.Zb(),t=m.qc(8);m.gc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",m.bc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("ngIf",m.bc(3,7,e.data$))("ngIfElse",t)}}const Ls=function(e){return{"flex-grow-1":e}};function ws(e,t){if(1&e&&(m.Qb(0,"div",27),m.Lb(1,"avatar",28),m.Pb()),2&e){const e=m.Zb(3);m.gc("ngClass",m.jc(2,Ls,!e.dataForRedeem.type.voucherDescription)),m.xb(1),m.gc("image",e.dataForRedeem.type.image)}}function Cs(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",29),m.Dc(2),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(2),m.Fc("",e.dataForRedeem.type.voucherDescription," ")}}function Qs(e,t){if(1&e&&(m.Qb(0,"label-value",23),m.Lb(1,"user-link",30),m.Pb()),2&e){const e=m.Zb(3);m.gc("label",e.i18n.voucher.buy.buyer),m.xb(1),m.gc("user",e.dataForRedeem.buyer)}}function Is(e,t){if(1&e&&(m.Qb(0,"label-value",31),m.Lb(1,"custom-field-input",32),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(3);m.gc("label",e.name)("kind","field")("fieldSize",n.fieldSize(e))("required",e.required)("labelPosition","boolean"===e.type?"sideForced":"auto"),m.xb(1),m.gc("field",e)("formControl",n.form.get(e.internalName))}}const Fs=function(e){return{"d-flex flex-row-reverse justify-content-between":e}};function Ts(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Mb(1,6),m.Qb(2,"notification",17),m.Dc(3),m.Pb(),m.Qb(4,"div",18),m.Qb(5,"div",19),m.ac(6,"async"),m.Bc(7,ws,2,4,"div",20),m.Bc(8,Cs,3,1,"ng-container",21),m.Pb(),m.Lb(9,"hr",22),m.Qb(10,"label-value",23),m.Dc(11),m.Pb(),m.Qb(12,"label-value",23),m.Dc(13),m.Pb(),m.Bc(14,Qs,2,2,"label-value",24),m.Qb(15,"label-value",23),m.Dc(16),m.ac(17,"currency"),m.Pb(),m.Bc(18,Is,2,7,"label-value",25),m.Pb(),m.Qb(19,"actions"),m.Qb(20,"action-button",13),m.Xb("action",(function(){return m.sc(e),m.Zb(2).submit()})),m.ac(21,"async"),m.Pb(),m.Qb(22,"action-button",26),m.Xb("action",(function(){return m.sc(e),m.Zb(2).backToForm()})),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=m.Zb(2),t=m.qc(6);m.xb(1),m.gc("ngTemplateOutlet",t),m.xb(2),m.Fc(" ",e.i18n.voucher.redeem.confirm," "),m.xb(2),m.gc("ngClass",m.jc(23,Fs,m.bc(6,16,e.layout.gtsm$)&&e.dataForRedeem.type.image)),m.xb(2),m.gc("ngIf",e.dataForRedeem.type.image),m.xb(1),m.gc("ngIf",e.dataForRedeem.type.voucherDescription),m.xb(2),m.gc("label",e.i18n.general.type),m.xb(1),m.Fc(" ",e.dataForRedeem.type.name," "),m.xb(1),m.gc("label",e.i18n.voucher.token),m.xb(1),m.Fc(" ",e.dataForRedeem.token," "),m.xb(1),m.gc("ngIf",e.dataForRedeem.buyer),m.xb(1),m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(17,18,e.dataForRedeem.amount,e.dataForRedeem.type.configuration.currency)," "),m.xb(2),m.gc("ngForOf",e.dataForRedeem.customFields),m.xb(2),m.gc("disabled",m.bc(21,21,e.requesting$))("label",e.i18n.general.submit),m.xb(2),m.gc("label",e.i18n.general.previous)}}function Ss(e,t){if(1&e&&(m.Qb(0,"page-content",4),m.ac(1,"async"),m.Bc(2,Ts,23,25,"ng-container",5),m.ac(3,"async"),m.Pb()),2&e){const e=m.Zb(),t=m.qc(8);m.gc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",m.bc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("ngIf",m.bc(3,7,e.dataForRedeem$))("ngIfElse",t)}}function ks(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"user-info",30),m.Lb(2,"hr"),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("user",e.data.user)}}function Os(e,t){if(1&e&&m.Bc(0,ks,3,1,"ng-container",21),2&e){const e=m.Zb();m.gc("ngIf",!e.self)}}function Ns(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let Bs=(()=>{class e extends mt.a{constructor(e,t,n){super(e),this.voucherService=t,this.modal=n,this.step$=new u.a(null),this.token=new v.j("",v.F.required),this.mask="",this.dataForRedeem$=new u.a(null)}get dataForRedeem(){return this.dataForRedeem$.value}set dataForRedeem(e){this.dataForRedeem$.next(e)}get step(){return this.step$.value}set step(e){this.step$.next(e)}submit(){if("form"===this.step){if(!Object(s.I)(this.token))return;this.addSub(this.voucherService.getVoucherDataForRedeem({user:this.userId,token:this.token.value}).subscribe(e=>{this.dataForRedeem=e,this.form=this.fieldHelper.customValuesFormGroup(this.dataForRedeem.customFields),this.step="confirm"}))}else this.addSub(this.voucherService.redeemVoucher({user:this.userId,token:this.token.value,body:{customValues:this.form.value}}).subscribe(e=>{this.router.navigate(["banking","vouchers","view",e.voucherId]),this.notification.info(this.i18n.voucher.redeem.done)}))}backToForm(){this.step="form"}ngOnInit(){super.ngOnInit(),this.userId=this.route.snapshot.paramMap.get("user"),this.addSub(this.voucherService.getVoucherInitialDataForRedeem({user:this.userId}).subscribe(e=>{this.data=e,this.mask=this.data.mask?this.data.mask:"",this.self=this.authHelper.isSelf(e.user)})),this.step="form"}reload(){this.step="form",super.reload()}resolveMenu(e){return this.menu.userMenu(e.user,l.b.REDEEM_VOUCHER)}showScanQrCode(){this.modal.show(ps.a,{class:"modal-form"}).content.select.pipe(Object(Bn.a)()).subscribe(e=>{this.token.setValue(e),this.submit()}),this.modal.onHide.pipe(Object(Bn.a)()).subscribe(()=>Object(s.k)(this.inputField,!0))}fieldSize(e){return this.fieldHelper.fieldSize(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a),m.Kb(hs.b))},e.\u0275cmp=m.Eb({type:e,selectors:[["app-redeem-voucher"]],viewQuery:function(e,t){var n;1&e&&m.Hc(xs,!0),2&e&&m.pc(n=m.Yb())&&(t.inputField=n.first)},features:[m.ub],decls:9,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["active_user",""],["loading",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"ngTemplateOutlet"],[1,"d-flex","flex-grow-1"],[1,"flex-grow-1"],["kind","field",3,"label"],["type","text","focused","","required","",3,"mask","formControl","placeholder"],["inputField",""],["class","btn btn-icon",3,"tooltip","click",4,"extraCell"],[3,"disabled","label","action"],[1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],[3,"icon"],["ngClass","mb-3","type","warning"],[1,"d-flex","flex-grow-1","flex-column"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"mt-3"],[3,"label"],[3,"label",4,"ngIf"],[3,"label","kind","fieldSize","required","labelPosition",4,"ngFor","ngForOf"],["outline","",3,"label","action"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"break-nl"],[3,"user"],[3,"label","kind","fieldSize","required","labelPosition"],["hideLabel","",3,"field","formControl"]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,Ds,4,9,"page-content",1),m.Bc(4,Ss,4,9,"page-content",1),m.Pb(),m.Bc(5,Os,1,1,"ng-template",null,2,m.Cc),m.Bc(7,Ns,2,0,"ng-template",null,3,m.Cc)),2&e&&(m.gc("ready",m.bc(1,4,t.data$))("ngSwitch",m.bc(2,6,t.step$)),m.xb(3),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","confirm"))},directives:[f.a,g.x,g.y,p.a,g.t,g.A,P.a,F.a,Yn.a,v.C,S.a,v.u,v.k,ys.a,gt.a,pt.a,Kn.b,Ti.a,_n.a,g.q,g.s,z.a,D.a,Hi.a,vt.a,U.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})();function As(e,t){1&e&&m.Mb(0)}function Es(e,t){1&e&&m.Lb(0,"div",7)}function $s(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",7),m.Qb(2,"label-value",14),m.Lb(3,"user-link",15),m.Pb(),m.Pb(),m.Bc(4,Es,1,0,"div",16),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("ngIf",e.layout.gtsm$)}}function Rs(e,t){if(1&e&&m.Lb(0,"field-option",17),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Zs(e,t){if(1&e&&(m.Qb(0,"mobile-result",18),m.Qb(1,"div",19),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit;m.gc("date",e.creationDate)("amount",e.amount)("amountColor",!1)("currency",e.type.configuration.currency),m.xb(2),m.Fc(" ",e.type.name," ")}}function Ms(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",23),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td"),m.Qb(3,"a",24),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Pb(),m.Qb(6,"td"),m.Qb(7,"a",24),m.Dc(8),m.ac(9,"date"),m.Pb(),m.Pb(),m.Qb(10,"td"),m.Qb(11,"a",24),m.Dc(12),m.Pb(),m.Pb(),m.Qb(13,"td"),m.Qb(14,"a",24),m.Dc(15),m.Pb(),m.Pb(),m.Qb(16,"td",21),m.Qb(17,"a",24),m.Dc(18),m.ac(19,"currency"),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Ec(m.bc(5,10,e.creationDate)),m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Ec(m.bc(9,12,e.expirationDate)),m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Ec(n.voucherStatus(e.status)),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Ec(e.type.name),m.xb(2),m.gc("routerLink",n.path(e)),m.xb(1),m.Ec(m.cc(19,14,e.amount,e.type.configuration.currency))}}function Hs(e,t){if(1&e&&(m.Qb(0,"table",20),m.Qb(1,"tbody"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th",21),m.Dc(11),m.Pb(),m.Bc(12,Ms,20,17,"ng-container",22),m.ac(13,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.creationDate),m.xb(2),m.Ec(e.i18n.general.expirationDate),m.xb(2),m.Ec(e.i18n.general.status),m.xb(2),m.Ec(e.i18n.general.type),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(1),m.gc("ngForOf",null==(n=m.bc(13,6,e.results$))?null:n.results)}}function qs(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.Qb(1,"form",4),m.Qb(2,"div",5),m.Bc(3,$s,5,3,"ng-container",6),m.Qb(4,"div",7),m.Qb(5,"multi-selection-field",8),m.Bc(6,Rs,1,4,"field-option",9),m.Pb(),m.Pb(),m.Qb(7,"div",7),m.Lb(8,"multi-selection-field",10),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(9,"results-layout",11),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(10,"async"),m.Bc(11,Zs,3,5,"mobile-result",12),m.Bc(12,Hs,14,8,"table",13),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.voucher.title.searchBought)("mobileHeading",e.i18n.voucher.mobileTitle.bought),m.xb(1),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",e.data.user&&!e.self),m.xb(2),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.type),m.xb(1),m.gc("ngForOf",e.data.types),m.xb(2),m.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.status)("fieldOptions",e.statusOptions),m.xb(1),m.gc("results",m.bc(10,13,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}let Us=(()=>{class e extends o.a{constructor(e,t){super(e),this.vouchersService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.self=this.authHelper.isSelf(e.user),this.user=this.self?this.ApiHelper.SELF:e.user,this.addSub(this.vouchersService.getUserVouchersDataForSearch({user:this.user,relation:i.Vb.BOUGHT}).subscribe(e=>{this.form.patchValue(e.query),this.data=e}))}get statusOptions(){return Object.values(i.Wb).map(e=>({value:e,text:this.voucherStatus(e)}))}getFormControlNames(){return["types","statuses"]}toSearchParams(e){const t=Object(ft.a)(e);return t.user=this.user,t}doSearch(e){return this.vouchersService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}voucherStatus(e){switch(e){case i.Wb.CANCELED:return this.i18n.voucher.status.canceled;case i.Wb.EXPIRED:return this.i18n.voucher.status.expired;case i.Wb.OPEN:return this.i18n.voucher.status.open;case i.Wb.PENDING:return this.i18n.voucher.status.pending;case i.Wb.REDEEMED:return this.i18n.voucher.status.redeemed}}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SEARCH_BOUGHT_VOUCHERS)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-bought-vouchers"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","types",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[3,"value","internalName","id","text"],[3,"date","amount","amountColor","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,As,1,0,"ng-container",1),m.Pb(),m.Bc(3,qs,13,15,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,C.a,v.u,v.l,g.s,h.a,y.a,x.a,P.a,D.a,w.a,V.a,j.h],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();function Vs(e,t){1&e&&m.Mb(0)}function zs(e,t){1&e&&m.Lb(0,"div",9)}function js(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",9),m.Qb(2,"label-value",15),m.Lb(3,"user-link",16),m.Pb(),m.Pb(),m.Bc(4,zs,1,0,"div",7),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.data.user),m.xb(1),m.gc("ngIf",e.layout.gtsm$)}}function Gs(e,t){if(1&e&&m.Lb(0,"field-option",19),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ks(e,t){if(1&e&&(m.Qb(0,"div",9),m.Qb(1,"multi-selection-field",17),m.Bc(2,Gs,1,4,"field-option",18),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.general.type),m.xb(1),m.gc("ngForOf",e.data.types)}}function _s(e,t){if(1&e&&m.Lb(0,"field-option",22),2&e){const e=t.$implicit;m.gc("value",e.id)("id",e.id)("text",e.display)}}function Xs(e,t){if(1&e&&(m.Qb(0,"div",9),m.Qb(1,"single-selection-field",20),m.Bc(2,_s,1,3,"field-option",21),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.general.operator),m.xb(1),m.gc("ngForOf",e.data.operators)}}function Ws(e,t){if(1&e&&(m.Qb(0,"mobile-result",23),m.Qb(1,"div",24),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit;m.gc("date",e.redeemDate)("amount",e.amount)("currency",e.type.configuration.currency)("amountColor",!1),m.xb(2),m.Fc(" ",e.type.name," ")}}function Ys(e,t){if(1&e&&(m.Qb(0,"th"),m.Dc(1),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.Ec(e.i18n.general.operator)}}function Js(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(2).$implicit;m.xb(1),m.Fc(" ",null!=e.redeemBy&&e.redeemBy.user?e.redeemBy.display:""," ")}}function el(e,t){if(1&e&&(m.Qb(0,"td"),m.Bc(1,Js,2,1,"ng-container",6),m.Pb()),2&e){const e=m.Zb().$implicit;m.xb(1),m.gc("ngIf",e.redeemBy)}}function tl(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",28),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td"),m.Qb(3,"a",29),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Pb(),m.Bc(6,el,2,1,"td",6),m.Qb(7,"td"),m.Dc(8),m.Pb(),m.Qb(9,"td",26),m.Dc(10),m.ac(11,"currency"),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.gc("routerLink",n.path(e)),m.xb(1),m.Fc(" ",m.bc(5,5,e.redeemDate)," "),m.xb(2),m.gc("ngIf",n.data.operators.length>0),m.xb(2),m.Fc(" ",e.type.name," "),m.xb(2),m.Fc(" ",m.cc(11,7,e.amount,e.type.configuration.currency)," ")}}function nl(e,t){if(1&e&&(m.Qb(0,"table",25),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Bc(4,Ys,2,1,"th",6),m.Qb(5,"th"),m.Dc(6),m.Pb(),m.Qb(7,"th",26),m.Dc(8),m.Pb(),m.Pb(),m.Qb(9,"tbody"),m.Bc(10,tl,12,10,"ng-container",27),m.ac(11,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.voucher.redeem.date),m.xb(1),m.gc("ngIf",e.data.operators.length>0),m.xb(2),m.Ec(e.i18n.general.type),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(11,5,e.results$))?null:n.results)}}function il(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.Qb(1,"form",4),m.Qb(2,"div",5),m.Bc(3,js,5,3,"ng-container",6),m.Bc(4,Ks,3,2,"div",7),m.Bc(5,Xs,3,3,"div",7),m.Qb(6,"div",8),m.Qb(7,"div",9),m.Lb(8,"date-field",10),m.Pb(),m.Qb(9,"div",9),m.Lb(10,"date-field",11),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(11,"results-layout",12),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(12,"async"),m.Bc(13,Ws,3,5,"mobile-result",13),m.Bc(14,nl,12,7,"table",14),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.voucher.title.redeemed)("mobileHeading",e.i18n.voucher.mobileTitle.redeemed),m.xb(1),m.gc("formGroup",e.form),m.xb(2),m.gc("ngIf",e.data.user&&!e.self),m.xb(1),m.gc("ngIf",(null==e.data.types?null:e.data.types.length)>1),m.xb(1),m.gc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),m.xb(3),m.gc("label",e.i18n.general.beginDate),m.xb(2),m.gc("label",e.i18n.general.endDate),m.xb(1),m.gc("results",m.bc(12,11,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let al=(()=>{class e extends o.a{constructor(e,t){super(e),this.voucherService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("user");this.addSub(this.voucherService.getUserVouchersDataForSearch({user:e,relation:i.Vb.REDEEMED}).subscribe(e=>{this.data=e,this.self=this.authHelper.isSelf(e.user)}))}getFormControlNames(){return["types","periodBegin","periodEnd","operator"]}toSearchParams(e){const t=e;return t.user=this.route.snapshot.paramMap.get("user"),t.relation=i.Vb.REDEEMED,t.redeemBy=e.operator,(e.periodBegin||e.periodEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),t}doSearch(e){return this.voucherService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}resolveMenu(e){return this.menu.userMenu(e.user,l.b.SEARCH_REDEEMED)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["app-search-redeemed-vouchers"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","operator",3,"emptyOption","label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],[3,"date","amount","currency","amountColor"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Vs,1,0,"ng-container",1),m.Pb(),m.Bc(3,il,15,13,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,Q.a,v.u,v.l,h.a,y.a,x.a,P.a,D.a,C.a,g.s,w.a,L.a,V.a,j.h],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();function cl(e,t){if(1&e&&m.Lb(0,"field-option",15),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function rl(e,t){if(1&e&&(m.Qb(0,"div",4),m.Qb(1,"multi-selection-field",13),m.Bc(2,cl,1,4,"field-option",14),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.general.type),m.xb(1),m.gc("ngForOf",e.data.types)}}function ol(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function sl(e,t){if(1&e&&(m.Qb(0,"div",4),m.Qb(1,"multi-selection-field",29),m.Bc(2,ol,1,5,"field-option",30),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.voucher.buyerGroups),m.xb(1),m.gc("ngForOf",e.data.userGroups)}}function ll(e,t){if(1&e&&m.Lb(0,"field-option",31),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function ul(e,t){if(1&e&&(m.Qb(0,"div",4),m.Qb(1,"multi-selection-field",32),m.Bc(2,ll,1,5,"field-option",30),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("label",e.i18n.voucher.redeemerGroups),m.xb(1),m.gc("ngForOf",e.data.userGroups)}}function bl(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"div",16),m.Qb(2,"div",4),m.Lb(3,"date-field",17),m.Pb(),m.Qb(4,"div",4),m.Lb(5,"date-field",18),m.Pb(),m.Pb(),m.Qb(6,"div",16),m.Qb(7,"div",4),m.Lb(8,"date-field",19),m.Pb(),m.Qb(9,"div",4),m.Lb(10,"date-field",20),m.Pb(),m.Pb(),m.Qb(11,"div",16),m.Qb(12,"div",4),m.Lb(13,"date-field",21),m.Pb(),m.Qb(14,"div",4),m.Lb(15,"date-field",22),m.Pb(),m.Pb(),m.Qb(16,"div",16),m.Qb(17,"div",4),m.Lb(18,"decimal-field",23,24),m.Pb(),m.Qb(20,"div",4),m.Lb(21,"decimal-field",25,24),m.Pb(),m.Pb(),m.Bc(23,sl,3,2,"div",3),m.Qb(24,"div",4),m.Qb(25,"label-value",26),m.Lb(26,"user-field",27),m.Pb(),m.Pb(),m.Bc(27,ul,3,2,"div",3),m.Qb(28,"div",4),m.Qb(29,"label-value",26),m.Lb(30,"user-field",28),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(3),m.gc("label",e.i18n.general.creationDate),m.xb(2),m.gc("label",e.i18n.general.to),m.xb(3),m.gc("label",e.i18n.general.expirationDate),m.xb(2),m.gc("label",e.i18n.general.to),m.xb(3),m.gc("label",e.i18n.voucher.redeem.date),m.xb(2),m.gc("label",e.i18n.general.to),m.xb(3),m.gc("label",e.i18n.transaction.amount)("scale",e.maxScale),m.xb(3),m.gc("label",e.i18n.general.to)("scale",e.maxScale),m.xb(2),m.gc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),m.xb(2),m.gc("label",e.i18n.voucher.buy.buyer),m.xb(1),m.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1),m.xb(1),m.gc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),m.xb(2),m.gc("label",e.i18n.voucher.redeem.redeemer),m.xb(1),m.gc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1)}}function dl(e,t){if(1&e&&m.Lb(0,"field-option",9),2&e){const e=t.$implicit,n=m.Zb();m.gc("value",e)("text",n.orderBy(e))}}let ml=(()=>{class e extends k.a{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.mask=this.data.mask?this.data.mask:""}get statusOptions(){return Object.values(i.Wb).map(e=>({value:e,text:this.apiI18n.voucherStatus(e)}))}get creationTypeOptions(){const e=Object.values(i.Tb);return[].concat(e.map(e=>({value:e,text:this.apiI18n.voucherCreationType(e)})))}get maxScale(){return this.data.types.map(e=>e.configuration.currency.decimalDigits).reduce((e,t,n,i)=>e>t?e:t)}orderByOptions(){return Object.values(i.Ub)}orderBy(e){switch(e){case i.Ub.CREATION_DATE_ASC:return this.i18n.voucher.sort.creationDateAsc;case i.Ub.CREATION_DATE_DESC:return this.i18n.voucher.sort.creationDateDesc;case i.Ub.EXPIRATION_DATE_ASC:return this.i18n.voucher.sort.expirationDateAsc;case i.Ub.EXPIRATION_DATE_DESC:return this.i18n.voucher.sort.expirationDateDesc;case i.Ub.REDEEM_DATE_ASC:return this.i18n.voucher.sort.redeemDateAsc;case i.Ub.REDEEM_DATE_DESC:return this.i18n.voucher.sort.redeemDateDesc}}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["voucher-filters"]],inputs:{data:"data",heading:"heading",mobileHeading:"mobileHeading",form:"form",moreFilters:"moreFilters",headingActions:"headingActions"},features:[m.ub],decls:18,vars:23,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["type","text","formControlName","token",3,"label","mask","placeholder"],["labelPosition","side","formControlName","creationType",3,"label","fieldOptions","emptyOption"],["labelPosition","side","formControlName","printed",3,"label","emptyOption"],[3,"value","text"],[4,"ngIf"],["labelPosition","side","formControlName","orderBy",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","creationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","creationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","redeemBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","redeemEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","amountMin",3,"label","scale"],["amount",""],["formControlName","amountMax",3,"label","scale"],["kind","field",3,"label"],["formControlName","buyer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["formControlName","redeemer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","buyerGroups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","redeemerGroups",3,"label"]],template:function(e,t){1&e&&(m.Qb(0,"page-content",0),m.Qb(1,"form",1),m.Qb(2,"div",2),m.Bc(3,rl,3,2,"div",3),m.Qb(4,"div",4),m.Lb(5,"multi-selection-field",5),m.Pb(),m.Qb(6,"div",4),m.Lb(7,"input-field",6),m.Pb(),m.Qb(8,"div",4),m.Lb(9,"single-selection-field",7),m.Pb(),m.Qb(10,"div",4),m.Qb(11,"single-selection-field",8),m.Lb(12,"field-option",9),m.Lb(13,"field-option",9),m.Pb(),m.Pb(),m.Bc(14,bl,31,22,"ng-container",10),m.Qb(15,"div",4),m.Qb(16,"single-selection-field",11),m.Bc(17,dl,1,2,"field-option",12),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.gc("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",t.headingActions),m.xb(1),m.gc("formGroup",t.form),m.xb(2),m.gc("ngIf",(null==t.data.types?null:t.data.types.length)>1),m.xb(2),m.gc("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyLabel",t.i18n.general.notApplied),m.xb(2),m.gc("label",t.i18n.voucher.token)("mask",t.mask)("placeholder",t.mask),m.xb(2),m.gc("label",t.i18n.voucher.creationType)("fieldOptions",t.creationTypeOptions)("emptyOption",t.i18n.general.all),m.xb(2),m.gc("label",t.i18n.general.printed)("emptyOption",t.i18n.general.all),m.xb(1),m.gc("value","true")("text",t.i18n.general.yes),m.xb(1),m.gc("value","false")("text",t.i18n.general.no),m.xb(1),m.gc("ngIf",t.moreFilters),m.xb(2),m.gc("label",t.i18n.general.orderBy),m.xb(1),m.gc("ngForOf",t.orderByOptions()))},directives:[p.a,v.H,v.v,v.n,g.t,C.a,v.u,v.l,F.a,S.a,L.a,w.a,g.s,Q.a,I.a,P.a,T.a],encapsulation:2,changeDetection:0}),e})();function fl(e,t){1&e&&m.Mb(0)}function gl(e,t){if(1&e&&(m.Qb(0,"mobile-result"),m.Qb(1,"div"),m.Qb(2,"div",7),m.Qb(3,"div",8),m.Dc(4),m.Pb(),m.Qb(5,"div",8),m.Dc(6),m.Pb(),m.Pb(),m.Qb(7,"div",9),m.Dc(8),m.ac(9,"currency"),m.Pb(),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(4),m.Fc(" ",e.type.name," "),m.xb(2),m.Fc(" ",n.apiI18n.voucherStatus(e.status)," "),m.xb(2),m.Fc(" ",m.cc(9,3,e.amount,e.type.configuration.currency)," ")}}function pl(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",13),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.path(n))})),m.Qb(2,"td"),m.Dc(3),m.ac(4,"date"),m.Pb(),m.Qb(5,"td"),m.Dc(6),m.ac(7,"date"),m.Pb(),m.Qb(8,"td"),m.Dc(9),m.Pb(),m.Qb(10,"td"),m.Dc(11),m.Pb(),m.Qb(12,"td",11),m.Dc(13),m.ac(14,"currency"),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.Ec(m.bc(4,5,e.creationDate)),m.xb(3),m.Fc(" ",m.bc(7,7,e.expirationDate),""),m.xb(3),m.Fc(" ",n.apiI18n.voucherStatus(e.status)," "),m.xb(2),m.Fc(" ",e.type.name," "),m.xb(2),m.Fc(" ",m.cc(14,9,e.amount,e.type.configuration.currency)," ")}}function hl(e,t){if(1&e&&(m.Qb(0,"table",10),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th",11),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"tbody"),m.Bc(13,pl,15,12,"ng-container",12),m.ac(14,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.general.creationDate),m.xb(2),m.Ec(e.i18n.general.expirationDate),m.xb(2),m.Ec(e.i18n.general.status),m.xb(2),m.Ec(e.i18n.general.type),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(14,6,e.results$))?null:n.results)}}function yl(e,t){if(1&e){const e=m.Rb();m.Lb(0,"voucher-filters",3),m.ac(1,"async"),m.ac(2,"async"),m.Qb(3,"results-layout",4),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(4,"async"),m.Bc(5,gl,10,6,"mobile-result",5),m.Bc(6,hl,15,8,"table",6),m.Pb()}if(2&e){const e=m.Zb();m.gc("data",e.data)("form",e.form)("heading",e.i18n.voucher.title.search)("mobileHeading",e.i18n.voucher.mobileTitle.search)("moreFilters",m.bc(1,9,e.moreFilters$))("headingActions",m.bc(2,11,e.headingActions$)),m.xb(3),m.gc("results",m.bc(4,13,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let xl=(()=>{class e extends o.a{constructor(e,t){super(e),this.voucherService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVouchersDataForSearch({}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["types","creationBegin","creationEnd","statuses","token","creationType","printed","amountMin","amountMax","expirationBegin","expirationEnd","redeemBegin","redeemEnd","buyer","redeemer","buyerGroups","redeemerGroups","orderBy"]}toSearchParams(e){const t=e;return(e.redeemBegin||e.redeemEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.redeemBegin,e.redeemEnd)),(e.creationBegin||e.creationEnd)&&(t.creationPeriod=this.ApiHelper.dateRangeFilter(e.creationBegin,e.creationEnd)),(e.expirationBegin||e.expirationEnd)&&(t.expirationPeriod=this.ApiHelper.dateRangeFilter(e.expirationBegin,e.expirationEnd)),(e.amountMin||e.amountMax)&&(t.amountRange=this.ApiHelper.rangeFilter(e.amountMin,e.amountMax)),t}doSearch(e){return this.voucherService.searchVouchers$Response(e)}get statusOptions(){return Object.values(i.Wb).map(e=>({value:e,text:this.apiI18n.voucherStatus(e)}))}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/view/",e.id]}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(e){return l.b.SEARCH_VOUCHERS}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-vouchers"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"data","form","heading","mobileHeading","moreFilters","headingActions"],["resultType","list",3,"results","toLink","rendering$","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"cell-main","float-left"],[1,"cell-text"],[1,"float-right"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,fl,1,0,"ng-container",1),m.Pb(),m.Bc(3,yl,7,15,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,ml,h.a,y.a,x.a,V.a,g.s],pipes:[g.b,O.a,G.a],encapsulation:2,changeDetection:0}),e})();var vl=n("cyUc");function Pl(e,t){if(1&e&&(m.Qb(0,"div",14),m.Lb(1,"avatar",15),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("image",e.data.type.image)}}function Dl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.creationType),m.xb(1),m.Fc(" ",e.apiI18n.voucherCreationType(e.data.creationType)," ")}}function Ll(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.owner),m.xb(1),m.gc("user",e.data.owner)}}function wl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.buy.buyer),m.xb(1),m.gc("user",e.data.buyer)}}function Cl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Qb(1,"a",17),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.buy.payment),m.xb(1),m.gc("routerLink",e.transferPath(e.data.buy)),m.xb(1),m.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.buy)," ")}}function Ql(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"dateTime"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.redeem.date),m.xb(1),m.Fc(" ",m.bc(2,2,e.data.redeemDate)," ")}}function Il(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.redeem.redeemer),m.xb(1),m.gc("user",e.data.redeemer)}}function Fl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.operator),m.xb(1),m.gc("user",e.data.redeemBy)}}function Tl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Qb(1,"a",17),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.redeem.payment),m.xb(1),m.gc("routerLink",e.transferPath(e.data.redeem)),m.xb(1),m.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.redeem)," ")}}function Sl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.status),m.xb(1),m.Fc(" ",e.data.redeemAfterDate," ")}}function kl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"dateTime"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.expirationDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.data.expirationDate)," ")}}function Ol(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Dc(1),m.ac(2,"dateTime"),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.refundDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.data.refund.date)," ")}}function Nl(e,t){if(1&e&&(m.Qb(0,"label-value",8),m.Qb(1,"a",17),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",e.i18n.voucher.refundPayment),m.xb(1),m.gc("routerLink",e.transferPath(e.data.refund)),m.xb(1),m.Fc(" ",e.bankingHelper.transactionNumberOrId(e.data.refund)," ")}}function Bl(e,t){if(1&e&&(m.Ob(0,18),m.Qb(1,"h2",11),m.Dc(2),m.Pb(),m.Qb(3,"div",19),m.Dc(4),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(2),m.Fc(" ",e.i18n.general.description," "),m.xb(2),m.Fc(" ",e.data.description," ")}}function Al(e,t){1&e&&(m.Lb(0,"img",20),m.ac(1,"trust")),2&e&&m.gc("src",m.cc(1,1,t.ngIf,"url"),m.uc)}function El(e,t){if(1&e&&(m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"div",4),m.Qb(3,"div",5),m.Bc(4,Pl,2,1,"div",6),m.Qb(5,"div",7),m.Qb(6,"label-value",8),m.Dc(7),m.Pb(),m.Qb(8,"label-value",8),m.Dc(9),m.Pb(),m.Qb(10,"label-value",8),m.Dc(11),m.ac(12,"currency"),m.Pb(),m.Bc(13,Dl,2,2,"label-value",9),m.Qb(14,"label-value",8),m.Dc(15),m.ac(16,"dateTime"),m.Pb(),m.Bc(17,Ll,2,2,"label-value",9),m.Bc(18,wl,2,2,"label-value",9),m.Bc(19,Cl,3,3,"label-value",9),m.Qb(20,"label-value",8),m.Dc(21),m.Pb(),m.Bc(22,Ql,3,4,"label-value",9),m.Bc(23,Il,2,2,"label-value",9),m.Bc(24,Fl,2,2,"label-value",9),m.Bc(25,Tl,3,3,"label-value",9),m.Bc(26,Sl,2,2,"label-value",9),m.Bc(27,kl,3,4,"label-value",9),m.Bc(28,Ol,3,4,"label-value",9),m.Bc(29,Nl,3,3,"label-value",9),m.Pb(),m.Pb(),m.Bc(30,Bl,5,2,"ng-container",10),m.Lb(31,"hr",11),m.Qb(32,"div",12),m.Bc(33,Al,2,4,"img",13),m.ac(34,"async"),m.Pb(),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.gc("heading",e.data.title)("mobileHeading",e.data.title)("headingActions",m.bc(1,28,e.headingActions$)),m.xb(4),m.gc("ngIf",e.data.type.image),m.xb(2),m.gc("label",e.i18n.general.type),m.xb(1),m.Fc(" ",e.data.type.name," "),m.xb(1),m.gc("label",e.i18n.voucher.token),m.xb(1),m.Fc(" ",e.data.token," "),m.xb(1),m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(12,30,e.data.amount,e.data.type.configuration.currency)," "),m.xb(2),m.gc("ngIf",e.data.creationType),m.xb(1),m.gc("label",e.i18n.general.creationDate),m.xb(1),m.Fc(" ",m.bc(16,33,e.data.creationDate)," "),m.xb(2),m.gc("ngIf",e.data.owner),m.xb(1),m.gc("ngIf",e.data.buyer),m.xb(1),m.gc("ngIf",e.data.buy),m.xb(1),m.gc("label",e.i18n.general.status),m.xb(1),m.Fc(" ",e.apiI18n.voucherStatus(e.data.status)," "),m.xb(1),m.gc("ngIf",e.data.redeemDate),m.xb(1),m.gc("ngIf",e.data.redeemer),m.xb(1),m.gc("ngIf",null==e.data.redeemBy?null:e.data.redeemBy.user),m.xb(1),m.gc("ngIf",e.data.redeem),m.xb(1),m.gc("ngIf",!e.data.redeemAfterDateReached),m.xb(1),m.gc("ngIf",e.data.expirationDate),m.xb(1),m.gc("ngIf",e.data.refund),m.xb(1),m.gc("ngIf",e.data.refund),m.xb(1),m.gc("ngIf",e.data.description),m.xb(3),m.gc("ngIf",m.bc(34,35,e.qrCodeUrl$))}}function $l(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let Rl=(()=>{class e extends Wc.a{constructor(e,t,n){super(e),this.voucherService=t,this.bankingHelper=n,this.qrCodeUrl$=new u.a(null)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.voucherService.viewVoucher({key:e}).subscribe(e=>this.data=e))}onDataInitialized(e){this.addSub(this.voucherService.getVoucherQrCode({key:e.id,size:i.I.MEDIUM}).subscribe(e=>this.qrCodeUrl$.next(URL.createObjectURL(e)))),this.createCancelDeviceConfirmation=()=>({type:i.r.MANAGE_VOUCHER,voucher:e.id,voucherAction:i.Rb.CANCEL}),this.createChangeExpirationDeviceConfirmation=()=>({type:i.r.MANAGE_VOUCHER,voucher:e.id,voucherAction:i.Rb.CHANGE_EXPIRATION}),this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("confirmationPassword",v.F.required)),this.headingActions=this.initActions(e)}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.voucherService.exportVoucher$Response({format:t.internalName,key:e.id}));return e.cancelAction&&t.push(new zt.c(d.a.XCircle,e.cancelAction===i.Sb.CANCEL_AND_REFUND?this.i18n.voucher.cancelAndRefund:this.i18n.general.cancel,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({title:this.cancelConfirmationTitle(e.cancelAction),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createCancelDeviceConfirmation,callback:e=>this.cancel(e.confirmationPassword)})})),e.canChangeExpirationDate&&t.push(new zt.c(d.a.CalendarEvent,this.i18n.voucher.changeExpirationDate,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createChangeExpirationDeviceConfirmation,customFields:this.changeExpirationFields,callback:t=>{this.addSub(this.voucherService.changeVoucherExpirationDate({key:e.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,newExpirationDate:t.customValues.newExpirationDate}}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.expirationDateChanged),this.reload()}))}})})),t}cancel(e){!e&&this.confirmationPassword&&(e=this.confirmationPassword.value),Object(s.I)(this.confirmationPassword)&&this.addSub(this.voucherService.cancelVoucher({key:this.data.id,confirmationPassword:e}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.cancel.done)}))}cancelConfirmationTitle(e){switch(e){case i.Sb.CANCEL_AND_REFUND:return this.i18n.voucher.cancel.refundConfirmation;case i.Sb.CANCEL_PENDING_PACK:return this.i18n.voucher.cancel.packConfirmation;case i.Sb.CANCEL_GENERATED:case i.Sb.CANCEL_PENDING_SINGLE:return this.i18n.voucher.cancel.confirmation}}get changeExpirationFields(){return[{internalName:"newExpirationDate",name:this.i18n.general.newExpirationDate,type:i.o.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:i.o.TEXT}]}transferPath(e){return null===e.authorizationStatus||e.authorizationStatus===i.Db.AUTHORIZED?["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]:["/banking","transaction",this.bankingHelper.transactionNumberOrId(e)]}resolveMenu(e){return e.redeemer&&this.authHelper.isSelfOrOwner(e.redeemer)?l.b.SEARCH_REDEEMED:e.buyer&&this.authHelper.isSelfOrOwner(e.buyer)?l.b.SEARCH_BOUGHT_VOUCHERS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["app-view-voucher"]],features:[m.ub],decls:6,vars:7,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["loading",""],[3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[1,"d-flex","flex-column","flex-sm-row-reverse","justify-content-sm-between"],["class","image d-flex justify-content-center mt-2 mb-4 align-self-center",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[3,"label"],[3,"label",4,"ngIf"],["class","d-flex justify-content-start",4,"ngIf"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4","align-self-center"],["size","160","imageSize","200","useLightbox","",3,"image"],[3,"user"],[3,"routerLink"],[1,"d-flex","justify-content-start"],[1,"break-nl"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,El,35,37,"page-content",1),m.ac(3,"async"),m.Pb(),m.Bc(4,$l,2,0,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(5);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",m.bc(3,5,t.data$))("ngIfElse",e)}},directives:[f.a,g.t,p.a,P.a,z.a,D.a,j.h,U.a],pipes:[g.b,O.a,Yc.a,vl.a],encapsulation:2,changeDetection:0}),e})();var Zl=n("IbW5");function Ml(e,t){1&e&&m.Mb(0)}function Hl(e,t){if(1&e&&m.Lb(0,"field-option",16),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function ql(e,t){if(1&e&&m.Lb(0,"field-option",16),2&e){const e=t.$implicit;m.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Ul(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",12),m.Qb(2,"div",6),m.Qb(3,"single-selection-field",13),m.Bc(4,Hl,1,4,"field-option",14),m.Pb(),m.Pb(),m.Qb(5,"div",6),m.Qb(6,"single-selection-field",15),m.Bc(7,ql,1,4,"field-option",14),m.Pb(),m.Pb(),m.Nb()),2&e){const e=m.Zb(2);m.xb(3),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),m.xb(1),m.gc("ngForOf",e.data.accountTypes),m.xb(2),m.gc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),m.xb(1),m.gc("ngForOf",e.data.accountTypes)}}function Vl(e,t){if(1&e&&(m.Qb(0,"div",6),m.Lb(1,"input-field",19),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}function zl(e,t){if(1&e&&m.Lb(0,"field-option",22),2&e){const e=t.$implicit;m.gc("id",e.id)("value",e)("text",e.name)}}function jl(e,t){if(1&e&&(m.Qb(0,"div",6),m.Qb(1,"single-selection-field",20),m.Bc(2,zl,1,3,"field-option",21),m.Pb(),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.period),m.xb(1),m.gc("ngForOf",e.data.preselectedPeriods)}}function Gl(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"div",12),m.Qb(2,"div",6),m.Lb(3,"date-field",23),m.Pb(),m.Nb()),2&e){const e=m.Zb(3);m.xb(3),m.gc("label",e.i18n.general.beginDate)}}function Kl(e,t){if(1&e&&(m.Qb(0,"div",6),m.Lb(1,"date-field",24),m.Pb()),2&e){const e=m.Zb(3);m.xb(1),m.gc("label",e.i18n.general.endDate)}}function _l(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Vl,2,2,"div",17),m.Qb(2,"div",6),m.Lb(3,"user-field",18),m.Pb(),m.Ob(4),m.Bc(5,jl,3,2,"div",17),m.Bc(6,Gl,4,1,"ng-container",8),m.ac(7,"async"),m.Bc(8,Kl,2,1,"div",17),m.ac(9,"async"),m.Nb(),m.Nb()),2&e){const e=m.Zb(2);var n,i;m.xb(1),m.gc("ngIf",e.hasTransactionNumber),m.xb(2),m.gc("label",e.i18n.general.user),m.xb(2),m.gc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),m.xb(1),m.gc("ngIf",null==(null==(n=e.form.value||m.bc(7,5,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin)),m.xb(2),m.gc("ngIf",null==(null==(i=e.form.value||m.bc(9,7,e.form.valueChanges))||null==i.preselectedPeriod?null:i.preselectedPeriod.end))}}function Xl(e,t){if(1&e&&(m.Qb(0,"mobile-result",25),m.Qb(1,"div",26),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("date",e.date)("amount",e.amount)("avatarImage",n.bankingHelper.avatarImage(e.transaction.related))("avatarIcon",n.bankingHelper.avatarIcon(e.transaction.related))("currency",n.currencies.get(e.currency)),m.xb(2),m.Fc(" ",n.bankingHelper.subjectName(e.transaction.related)," ")}}function Wl(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",30),m.Xb("click",(function(){m.sc(e);const n=t.$implicit,i=m.Zb(3);return i.router.navigate(i.bankingHelper.transactionPath(n.transaction))})),m.Qb(2,"td"),m.Dc(3),m.ac(4,"date"),m.Pb(),m.Qb(5,"td"),m.Dc(6),m.Pb(),m.Qb(7,"td"),m.Dc(8),m.Pb(),m.Qb(9,"td"),m.Dc(10),m.Pb(),m.Qb(11,"td",28),m.Dc(12),m.ac(13,"currency"),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(3);m.xb(3),m.Ec(m.bc(4,5,e.dueDate)),m.xb(3),m.Ec(n.bankingHelper.subjectName(e.transaction.from)),m.xb(2),m.Ec(n.bankingHelper.subjectName(e.transaction.to)),m.xb(2),m.Ec(n.number(e)),m.xb(2),m.Fc(" ",m.cc(13,7,e.amount,n.currencies.get(e.transaction.currency))," ")}}function Yl(e,t){if(1&e&&(m.Qb(0,"table",27),m.Qb(1,"thead"),m.Qb(2,"th"),m.Dc(3),m.Pb(),m.Qb(4,"th"),m.Dc(5),m.Pb(),m.Qb(6,"th"),m.Dc(7),m.Pb(),m.Qb(8,"th"),m.Dc(9),m.Pb(),m.Qb(10,"th",28),m.Dc(11),m.Pb(),m.Pb(),m.Qb(12,"tbody"),m.Bc(13,Wl,14,10,"ng-container",29),m.ac(14,"async"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);var n;m.xb(3),m.Ec(e.i18n.transaction.dueDate),m.xb(2),m.Ec(e.i18n.transaction.from),m.xb(2),m.Ec(e.i18n.transaction.to),m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.transaction.amount),m.xb(2),m.gc("ngForOf",null==(n=m.bc(14,6,e.results$))?null:n.results)}}function Jl(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",3),m.ac(1,"async"),m.Qb(2,"form",4),m.Qb(3,"div",5),m.Qb(4,"div",6),m.Lb(5,"single-selection-field",7),m.Pb(),m.Bc(6,Ul,8,6,"ng-container",8),m.Bc(7,_l,10,9,"ng-container",8),m.ac(8,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(9,"results-layout",9),m.Xb("update",(function(t){return m.sc(e),m.Zb().update(t)})),m.ac(10,"async"),m.Bc(11,Xl,3,6,"mobile-result",10),m.Bc(12,Yl,15,8,"table",11),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.i18n.transaction.title.scheduled)("mobileHeading",e.i18n.transaction.mobileTitle.scheduled)("headingActions",m.bc(1,11,e.headingActions$)),m.xb(2),m.gc("formGroup",e.form),m.xb(3),m.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),m.xb(1),m.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),m.xb(1),m.gc("ngIf",m.bc(8,13,e.moreFilters$)),m.xb(2),m.gc("results",m.bc(10,15,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let eu=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.installmentsService=t,this.bankingHelper=n,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.installmentsService.getInstallmentsOverviewDataForSearch({fields:["accountTypes","preselectedPeriods","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.i)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e})}onDataInitialized(e){super.onDataInitialized(e);const t=(e.accountTypes||[]).map(e=>{var t;return null===(t=e.currency)||void 0===t?void 0:t.transactionNumberPattern}).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.headingActions=[this.moreFiltersAction]}getFormControlNames(){return["status","fromAccountType","toAccountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd","direction","transactionNumber"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.status=i.L.SCHEDULED,t}get statusOptions(){return Object.values(i.L).map(e=>({value:e,text:this.apiI18n.installmentStatus(e)}))}toSearchParams(e){const t=e;return t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}showMoreFiltersLabel(){return this.i18n.general.moreFilters}showLessFiltersLabel(){return this.i18n.general.lessFilters}resolveMenu(){return l.b.SCHEDULED_PAYMENTS_OVERVIEW}doSearch(e){return this.installmentsService.searchInstallmentsOverview$Response(e)}get toLink(){return e=>this.bankingHelper.transactionPath(e.transaction)}number(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb($a.a),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["search-installments"]],features:[m.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"w-100","d-none","d-sm-block"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.Bc(2,Ml,1,0,"ng-container",1),m.Pb(),m.Bc(3,Jl,13,17,"ng-template",null,2,m.Cc)),2&e){const e=m.qc(4);m.gc("ready",m.bc(1,3,t.data$)),m.xb(2),m.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,g.t,p.a,v.H,v.v,v.n,L.a,v.u,v.l,h.a,y.a,x.a,g.s,w.a,T.a,F.a,S.a,Q.a,V.a],pipes:[g.b,G.a,O.a],encapsulation:2,changeDetection:0}),e})();function tu(e,t){if(1&e&&(m.Qb(0,"mobile-result",4),m.Qb(1,"div",5),m.Dc(2),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb();m.gc("avatarImage",e.image)("avatarIcon",n.SvgIcon.Person),m.xb(2),m.Fc(" ",e.voucherTitle," ")}}function nu(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"tr",8),m.Xb("click",(function(){m.sc(e);const n=t.$implicit;return m.Zb(2).selectType(n)})),m.Qb(2,"td",9),m.Lb(3,"avatar",10),m.Pb(),m.Qb(4,"td"),m.Qb(5,"div"),m.Qb(6,"a",11),m.Xb("click",(function(){m.sc(e);const n=t.$implicit;return m.Zb(2).selectType(n)})),m.Dc(7),m.Pb(),m.Qb(8,"div"),m.Dc(9),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(3),m.gc("image",e.image)("icon",n.SvgIcon.Ticket),m.xb(4),m.Fc(" ",e.voucherTitle," "),m.xb(2),m.Fc(" ",e.voucherDescription," ")}}function iu(e,t){if(1&e&&(m.Qb(0,"table",6),m.Qb(1,"tbody"),m.Bc(2,nu,10,4,"ng-container",7),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.xb(2),m.gc("ngForOf",e.types)}}let au=(()=>{class e extends k.a{constructor(e){super(e),this.typeSelected=new m.n}get selectType(){return e=>this.typeSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["generate-vouchers-step-list-types"]],inputs:{types:"types"},outputs:{typeSelected:"typeSelected"},features:[m.ub],decls:4,vars:5,consts:[[3,"mode","heading","mobileHeading"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false",3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarRoundBorders","false",3,"avatarImage","avatarIcon"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["size","xlarge","roundBorders","false",3,"image","icon"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(m.Lb(0,"page-content",0),m.Qb(1,"results-layout",1),m.Bc(2,tu,3,3,"mobile-result",2),m.Bc(3,iu,3,1,"table",3),m.Pb()),2&e&&(m.gc("mode","empty")("heading",t.i18n.voucher.title.generate)("mobileHeading",t.i18n.voucher.mobileTitle.generate),m.xb(1),m.gc("results",t.types)("onClick",t.selectType))},directives:[p.a,h.a,y.a,x.a,V.a,g.s,z.a,g.q],encapsulation:2,changeDetection:0}),e})();function cu(e,t){if(1&e&&(m.Qb(0,"label-value",1),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.account.availableBalance),m.xb(1),m.Fc(" ",m.cc(2,2,e.data.account.status.availableBalance,e.currency)," ")}}let ru=(()=>{class e extends k.a{constructor(e){super(e)}ngOnInit(){super.ngOnInit(),this.addSub(this.form.get("user").valueChanges.subscribe(()=>this.saveUserData()))}saveUserData(){this.userField.user&&this.form.get("userData").setValue(this.userField.user)}get currency(){return this.data.account.currency}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["generate-vouchers-step-form"]],viewQuery:function(e,t){var n;1&e&&m.Hc(T.a,!0),2&e&&m.pc(n=m.Yb())&&(t.userField=n.first)},inputs:{data:"data",form:"form"},features:[m.ub],decls:8,vars:11,consts:[[3,"formGroup"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["formControlName","user",3,"label","allowContacts"],["user",""]],template:function(e,t){1&e&&(m.Ob(0,0),m.Qb(1,"label-value",1),m.Dc(2),m.Pb(),m.Bc(3,cu,3,5,"label-value",2),m.Lb(4,"input-field",3),m.Lb(5,"decimal-field",4),m.Lb(6,"user-field",5,6),m.Nb()),2&e&&(m.gc("formGroup",t.form),m.xb(1),m.gc("label",t.i18n.voucher.originAccount),m.xb(1),m.Fc(" ",t.data.account.type.name," "),m.xb(1),m.gc("ngIf",t.data.account.status.availableBalance),m.xb(1),m.gc("label",t.i18n.voucher.numberOfVouchers),m.xb(1),m.gc("label",t.i18n.voucher.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),m.xb(1),m.gc("label",t.i18n.general.user)("allowContacts",!1))},directives:[v.v,v.n,P.a,g.t,F.a,v.u,v.l,v.C,I.a,T.a],pipes:[O.a],encapsulation:2,changeDetection:0}),e})();function ou(e,t){if(1&e&&(m.Qb(0,"label-value",0),m.Lb(1,"user-link",3),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.general.user),m.xb(1),m.gc("user",e.user)}}function su(e,t){1&e&&m.Lb(0,"hr")}function lu(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Bc(1,su,1,0,"hr",2),m.ac(2,"async"),m.Qb(3,"form",4),m.Qb(4,"confirmation-password",5),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().confirmed.emit(t)})),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,4,e.layout.gtxxs$)),m.xb(2),m.gc("formGroup",e.form),m.xb(1),m.gc("passwordInput",e.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let uu=(()=>{class e extends k.a{constructor(e){super(e),this.confirmationModeChanged=new m.n,this.confirmed=new m.n}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:i.r.GENERATE_VOUCHERS,amount:this.generateVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.generateVoucher.count}),this.confirmationPasswordInput||this.addShortcut(Gn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["generate-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",generateVoucher:"generateVoucher",data:"data",user:"user"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[m.ub],decls:9,vars:11,consts:[[3,"label"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(m.Qb(0,"label-value",0),m.Dc(1),m.Pb(),m.Qb(2,"label-value",0),m.Dc(3),m.Pb(),m.Qb(4,"label-value",0),m.Dc(5),m.ac(6,"currency"),m.Pb(),m.Bc(7,ou,2,2,"label-value",1),m.Bc(8,lu,5,6,"ng-container",2)),2&e&&(m.gc("label",t.i18n.general.type),m.xb(1),m.Fc(" ",t.data.type.voucherTitle,"\n"),m.xb(1),m.gc("label",t.i18n.voucher.numberOfVouchers),m.xb(1),m.Fc(" ",t.generateVoucher.count,"\n"),m.xb(1),m.gc("label",t.i18n.voucher.amountPerVoucher),m.xb(1),m.Fc(" ",m.cc(6,8,t.generateVoucher.amount,t.data.account.currency),"\n"),m.xb(2),m.gc("ngIf",t.user),m.xb(1),m.gc("ngIf",t.confirmationPasswordInput))},directives:[P.a,g.t,D.a,v.H,v.v,v.n,Wn.a,Yn.a,v.u,v.l],pipes:[O.a,g.b],encapsulation:2,changeDetection:0}),e})();function bu(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Qb(1,"generate-vouchers-step-list-types",4),m.Xb("typeSelected",(function(t){return m.sc(e),m.Zb().toForm(t)})),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("types",e.data.types)}}function du(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",10),m.Xb("action",(function(){return m.sc(e),m.Zb(2).backToSelectType()})),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("label",e.i18n.general.previous)}}function mu(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",5),m.ac(1,"async"),m.Lb(2,"generate-vouchers-step-form",6),m.Qb(3,"actions",7),m.Qb(4,"action-button",8),m.Xb("action",(function(){return m.sc(e),m.Zb().toConfirm()})),m.ac(5,"async"),m.Pb(),m.Bc(6,du,1,1,"action-button",9),m.Pb(),m.Pb()}if(2&e){const e=m.Zb();m.gc("heading",e.dataTypeForGenerate.type.voucherTitle)("mobileHeading",e.dataTypeForGenerate.type.voucherTitle)("mode",m.bc(1,8,e.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("data",e.dataTypeForGenerate)("form",e.form),m.xb(2),m.gc("disabled",m.bc(5,10,e.requesting$))("label",e.i18n.general.next),m.xb(2),m.gc("ngIf",!e.singleType)}}function fu(e,t){if(1&e){const e=m.Rb();m.Qb(0,"action-button",8),m.Xb("action",(function(){return m.sc(e),m.Zb(2).generate()})),m.ac(1,"async"),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("disabled",!e.canConfirm||m.bc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function gu(e,t){1&e&&m.Dc(0,"\xa0")}function pu(e,t){if(1&e){const e=m.Rb();m.Qb(0,"page-content",5),m.ac(1,"async"),m.Qb(2,"generate-vouchers-step-confirm",11),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationMode$.next(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().generate(t)})),m.Pb(),m.Qb(3,"actions",7),m.Bc(4,fu,2,4,"action-button",12),m.ac(5,"async"),m.Bc(6,gu,1,0,"ng-template",null,13,m.Cc),m.Qb(8,"action-button",10),m.Xb("action",(function(){return m.sc(e),m.Zb().backToForm()})),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.qc(7),t=m.Zb();m.gc("heading",t.i18n.voucher.title.generateConfirmation)("mobileHeading",t.i18n.voucher.mobileTitle.generateConfirmation)("mode",m.bc(1,11,t.layout.ltsm$)?"fullHeight":"normal"),m.xb(2),m.gc("generateVoucher",t.form.value)("data",t.dataTypeForGenerate)("user",t.form.get("userData").value)("confirmationPasswordInput",t.dataTypeForGenerate.confirmationPasswordInput)("confirmationPassword",t.confirmationPassword),m.xb(2),m.gc("ngIf",m.bc(5,13,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),m.xb(4),m.gc("label",t.i18n.general.previous)}}function hu(e,t){1&e&&(m.Qb(0,"page-content"),m.Lb(1,"spinner"),m.Pb())}let yu=(()=>{class e extends mt.a{constructor(e,t){super(e),this.voucherService=t,this.ConfirmationMode=On.a,this.step$=new u.a(null),this.singleType=!1,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVoucherDataForGenerate().subscribe(e=>this.data=e))}onDataInitialized(e){const t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}get currency(){return this.dataTypeForGenerate.account.currency}generate(e){if(e&&this.confirmationPassword.setValue(e),this.confirmationPasswordInput&&!Object(s.I)(this.confirmationPassword))return;const t=this.form.value;t.type=this.dataTypeForGenerate.type.id,delete t.userData,this.addSub(this.voucherService.generateVouchers({confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:t}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.generate.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(e){this.addSub(this.voucherService.getVoucherDataForGenerate({type:e.id}).subscribe(e=>{this.dataTypeForGenerate=e,this.buildForm(),this.step="form"}))}toConfirm(){Object(s.I)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(v.F.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}get confirmationPasswordInput(){return this.dataTypeForGenerate.confirmationPasswordInput}buildForm(){this.form?this.form.reset():this.form=this.formBuilder.group({count:new v.j(""),amount:new v.j(""),user:new v.j(""),userData:new v.j("")}),this.form.get("count").setValue(1)}resolveMenu(){return l.b.GENERATE_VOUCHER}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Vo.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["generate-vouchers"]],features:[m.ub],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[1,"flex-grow-1",3,"generateVoucher","data","user","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(m.Qb(0,"page-layout",0),m.ac(1,"async"),m.ac(2,"async"),m.Bc(3,bu,2,1,"ng-container",1),m.Bc(4,mu,7,12,"page-content",2),m.Bc(5,pu,9,15,"page-content",2),m.Bc(6,hu,2,0,"page-content",3),m.Pb()),2&e&&(m.gc("ready",m.bc(1,5,t.data$))("ngSwitch",m.bc(2,7,t.step$)),m.xb(3),m.gc("ngSwitchCase","select-type"),m.xb(1),m.gc("ngSwitchCase","form"),m.xb(1),m.gc("ngSwitchCase","confirm"))},directives:[f.a,g.x,g.y,g.z,au,p.a,ru,gt.a,pt.a,g.t,uu,U.a],pipes:[g.b],encapsulation:2,changeDetection:0}),e})();const xu=[{path:"",canActivateChild:[Zl.a],children:[{path:":owner/account/:type",component:Ie},{path:":owner/accounts-summary",component:kt},{path:"transfer/:key",component:Uo},{path:"transfer/:account/:key",component:Uo},{path:"transaction/:key",component:po},{path:"transfers-overview",component:Ho},{path:"transaction/:key/authorization-history",component:cr},{path:":from/payment",component:zn},{path:":from/payment/:to",component:zn},{path:":from/payment-request",component:Ia},{path:"payment-request/:key/accept",component:Ei},{path:":from/payment-request/:to",component:Ia},{path:":owner/payment-requests",component:vc,data:{kind:"payment-request"}},{path:"payment-requests",component:Xc,data:{kind:"payment-request"}},{path:"pos",component:zn},{path:"qr",component:Ea},{path:":owner/installments",component:Wa},{path:"installments-overview",component:eu},{path:":owner/authorized-payments",component:vc,data:{kind:"authorized"}},{path:"authorized-payments",component:Xc,data:{kind:"authorized"}},{path:"pending-my-authorization",component:Xc,data:{kind:"myAuth"}},{path:":user/vouchers/redeem",component:Bs},{path:":user/vouchers/redeemed",component:al},{path:":user/vouchers/buy",component:gs},{path:":user/vouchers/bought",component:Us},{path:"vouchers/view/:key",component:Rl},{path:"vouchers",component:xl},{path:":user/account-balance-limits",component:Ct},{path:":user/account-balance-limits/:accountType",component:Jt},{path:":user/account-balance-limits/:accountType/edit",component:xt},{path:"account-balance-limits-overview",component:Vt},{path:":user/account-payment-limits",component:sn},{path:":user/account-payment-limits/:accountType",component:Tn},{path:":user/account-payment-limits/:accountType/edit",component:nn},{path:"account-payment-limits-overview",component:Pn},{path:"user-balances-overview",component:bt},{path:"vouchers/generate",component:yu}]}];let vu=(()=>{class e{}return e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({factory:function(t){return new(t||e)},imports:[[j.i.forChild(xu)],j.i]}),e})();function Pu(e,t){if(1&e&&(m.Qb(0,"notification",6),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.xb(1),m.Fc(" ",e.i18n.transaction.requiresAuthorization,"\n")}}function Du(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Lb(1,"user-link",8),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.fromUser),m.xb(1),m.gc("user",e.fromUser)}}function Lu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.fromAccount),m.xb(1),m.Fc(" ",e.preview.fromAccount.type.name,"\n")}}function wu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Lb(1,"user-link",8),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toUser),m.xb(1),m.gc("user",e.toUser)}}function Cu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toAccount),m.xb(1),m.Fc(" ",e.preview.toAccount.type.name,"\n")}}function Qu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Dc(1),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.type),m.xb(1),m.Fc(" ",e.preview.paymentType.name,"\n")}}function Iu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(2,2,e.preview.mainAmount,e.preview.currency),"\n")}}function Fu(e,t){if(1&e&&(m.Qb(0,"div"),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(1),m.Gc(" ",e.fee.name,": ",m.cc(2,2,e.amount,n.preview.currency)," ")}}function Tu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Bc(1,Fu,3,5,"div",9),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.appliedFees),m.xb(1),m.gc("ngForOf",e.fees)}}function Su(e,t){1&e&&m.Lb(0,"custom-field-value",10),2&e&&m.gc("fieldValue",t.$implicit)}function ku(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Dc(1),m.ac(2,"date"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.dueDate),m.xb(1),m.Fc(" ",m.bc(2,2,e.preview.installments[0].dueDate),"\n")}}function Ou(e,t){if(1&e&&(m.Qb(0,"thead"),m.Qb(1,"th"),m.Dc(2),m.Pb(),m.Qb(3,"th"),m.Dc(4),m.Pb(),m.Qb(5,"th",12),m.Dc(6),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.xb(2),m.Ec(e.i18n.transaction.installmentNumber),m.xb(2),m.Ec(e.i18n.transaction.dueDate),m.xb(2),m.Ec(e.i18n.transaction.amount)}}function Nu(e,t){if(1&e&&(m.Qb(0,"tr"),m.Qb(1,"td"),m.Dc(2),m.Pb(),m.Qb(3,"td"),m.Dc(4),m.ac(5,"date"),m.Pb(),m.Qb(6,"td",12),m.Dc(7),m.ac(8,"currency"),m.Pb(),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.xb(2),m.Fc(" ",e.number," "),m.xb(2),m.Fc(" ",m.bc(5,3,e.dueDate)," "),m.xb(3),m.Fc(" ",m.cc(8,5,e.mainAmount,n.preview.currency)," ")}}function Bu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Qb(1,"table",11),m.Bc(2,Ou,7,3,"thead",4),m.ac(3,"async"),m.Qb(4,"tbody"),m.Bc(5,Nu,9,8,"tr",9),m.Pb(),m.Pb(),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.installments),m.xb(2),m.gc("ngIf",m.bc(3,3,e.layout.gtxs$)),m.xb(3),m.gc("ngForOf",e.preview.installments)}}function Au(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentNowManual," ")}}function Eu(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentNowFixed(e.preview.payment.occurrencesCount)," ")}}function $u(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Au,2,1,"ng-container",4),m.Bc(2,Eu,2,1,"ng-container",4),m.Nb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngIf",null==e.preview.payment.occurrencesCount),m.xb(1),m.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function Ru(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.ac(2,"date"),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentDateManual(m.bc(2,1,e.preview.payment.firstOccurrenceDate))," ")}}const Zu=function(e,t){return{date:e,count:t}};function Mu(e,t){if(1&e&&(m.Ob(0),m.Dc(1),m.ac(2,"date"),m.Nb()),2&e){const e=m.Zb(3);m.xb(1),m.Fc(" ",e.i18n.transaction.recurringPaymentDateFixed(m.kc(3,Zu,m.bc(2,1,e.preview.payment.firstOccurrenceDate),e.preview.payment.occurrencesCount))," ")}}function Hu(e,t){if(1&e&&(m.Bc(0,Ru,3,3,"ng-container",4),m.Bc(1,Mu,3,6,"ng-container",4)),2&e){const e=m.Zb(2);m.gc("ngIf",null==e.preview.payment.occurrencesCount),m.xb(1),m.gc("ngIf",null!=e.preview.payment.occurrencesCount)}}function qu(e,t){if(1&e&&(m.Qb(0,"label-value",7),m.Bc(1,$u,3,2,"ng-container",13),m.Bc(2,Hu,2,2,"ng-template",null,14,m.Cc),m.Pb()),2&e){const e=m.qc(3),t=m.Zb();m.gc("label",t.i18n.transaction.recurringPayment),m.xb(1),m.gc("ngIf",null==t.preview.payment.firstOccurrenceDate)("ngIfElse",e)}}function Uu(e,t){if(1&e&&m.Lb(0,"label-value",15),2&e){const e=m.Zb();m.gc("label",e.i18n.general.description)("value",e.preview.payment.description)}}function Vu(e,t){1&e&&m.Lb(0,"hr")}function zu(e,t){1&e&&m.Lb(0,"hr")}function ju(e,t){if(1&e&&(m.Ob(0),m.Bc(1,zu,1,0,"hr",4),m.ac(2,"async"),m.Qb(3,"div",16),m.Dc(4),m.Pb(),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,2,e.layout.gtxxs$)),m.xb(3),m.Ec(e.preview.confirmationMessage)}}function Gu(e,t){1&e&&m.Lb(0,"hr")}function Ku(e,t){if(1&e){const e=m.Rb();m.Ob(0),m.Bc(1,Gu,1,0,"hr",4),m.ac(2,"async"),m.Qb(3,"form",17),m.Qb(4,"confirmation-password",18),m.Xb("confirmationModeChanged",(function(t){return m.sc(e),m.Zb().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return m.sc(e),m.Zb().confirmed.emit(t)})),m.Pb(),m.Pb(),m.Nb()}if(2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",m.bc(2,6,e.layout.gtxxs$)),m.xb(2),m.gc("formGroup",e.form),m.xb(1),m.gc("pos",e.pos)("passwordInput",e.preview.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)("paymentPreview",e.preview)}}let _u=(()=>{class e extends k.a{constructor(e,t){super(e),this.bankingHelper=t,this.confirmationModeChanged=new m.n,this.confirmed=new m.n}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===i.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===i.a.SYSTEM,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(s.i)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>this.pos?this.preview.payment:{type:i.r.PERFORM_PAYMENT,from:r.a.accountOwner(this.preview.fromAccount),to:r.a.accountOwner(this.preview.toAccount),paymentType:this.preview.paymentType.id,amount:this.preview.payment.amount},this.preview.confirmationPasswordInput||this.addShortcut(Gn.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["payment-step-confirm"]],inputs:{pos:"pos",preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[m.ub],decls:20,vars:23,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"pos","passwordInput","createDeviceConfirmation","paymentPreview","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(m.Bc(0,Pu,2,1,"notification",0),m.Bc(1,Du,2,2,"label-value",1),m.Bc(2,Lu,2,2,"label-value",1),m.Bc(3,wu,2,2,"label-value",1),m.Bc(4,Cu,2,2,"label-value",1),m.Bc(5,Qu,2,2,"label-value",1),m.Bc(6,Iu,3,5,"label-value",1),m.Bc(7,Tu,2,2,"label-value",1),m.Bc(8,Su,1,1,"custom-field-value",2),m.Bc(9,ku,3,4,"label-value",1),m.Bc(10,Bu,6,5,"label-value",1),m.Bc(11,qu,4,3,"label-value",1),m.Bc(12,Uu,1,2,"label-value",3),m.Bc(13,Vu,1,0,"hr",4),m.ac(14,"async"),m.Qb(15,"label-value",5),m.Dc(16),m.ac(17,"currency"),m.Pb(),m.Bc(18,ju,5,4,"ng-container",4),m.Bc(19,Ku,5,8,"ng-container",4)),2&e&&(m.gc("ngIf",t.preview.pendingAuthorization),m.xb(1),m.gc("ngIf",!t.fromSelf&&t.fromUser),m.xb(1),m.gc("ngIf",t.fromSystem),m.xb(1),m.gc("ngIf",t.toUser),m.xb(1),m.gc("ngIf",t.toSystem),m.xb(1),m.gc("ngIf",t.showPaymentType),m.xb(1),m.gc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),m.xb(1),m.gc("ngIf",(null==t.fees?null:t.fees.length)>0),m.xb(1),m.gc("ngForOf",t.preview.customValues),m.xb(1),m.gc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),m.xb(1),m.gc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),m.xb(1),m.gc("ngIf","recurring"===t.preview.payment.scheduling),m.xb(1),m.gc("ngIf",t.preview.payment.description),m.xb(1),m.gc("ngIf",m.bc(14,18,t.layout.gtxxs$)),m.xb(2),m.gc("label",t.i18n.transaction.totalAmount),m.xb(1),m.Fc(" ",m.cc(17,20,t.preview.totalAmount,t.preview.currency),"\n"),m.xb(2),m.gc("ngIf",(t.preview.confirmationMessage||"").length>0),m.xb(1),m.gc("ngIf",t.preview.confirmationPasswordInput))},directives:[g.t,g.s,P.a,_n.a,D.a,Xn.a,v.H,v.v,v.n,Wn.a,Yn.a,v.u,v.l],pipes:[g.b,O.a,G.a],encapsulation:2,changeDetection:0}),e})(),Xu=(()=>{class e extends k.a{constructor(e,t){super(e),this.performPayment=t}ngOnInit(){super.ngOnInit(),this.performed.authorizationStatus===i.Db.PENDING?(this.icon=d.a.CalendarEvent,this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):(this.icon=d.a.Check2,this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed),this.addShortcut(Gn.k,()=>this.performPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(zn))},e.\u0275cmp=m.Eb({type:e,selectors:[["payment-step-done"]],inputs:{performed:"performed"},features:[m.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.Qb(2,"div",2),m.Lb(3,"icon",3),m.Pb(),m.Qb(4,"div",4),m.Dc(5),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.xb(3),m.gc("icon",t.icon),m.xb(2),m.Ec(t.message))},directives:[Ti.a],encapsulation:2,changeDetection:0}),e})();const Wu=["toUser"],Yu=["amount"];function Ju(e,t){if(1&e&&(m.Qb(0,"label-value",15),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.fromUser),m.xb(1),m.gc("user",e.fromUser)}}const eb=function(e,t,n){return{positive:e,negative:t,"text-right":n}};function tb(e,t){if(1&e&&(m.Qb(0,"label-value",18),m.ac(1,"async"),m.Qb(2,"div",19),m.ac(3,"async"),m.Dc(4),m.ac(5,"currency"),m.Pb(),m.Pb()),2&e){const e=m.Zb(2);m.gc("label",m.bc(1,3,e.accountBalanceLabel$)),m.xb(2),m.gc("ngClass",m.lc(10,eb,e.format.isPositive(e.singleAccount.status.balance),e.format.isNegative(e.singleAccount.status.balance),m.bc(3,5,e.layout.ltsm$))),m.xb(2),m.Fc(" ",m.cc(5,7,e.singleAccount.status.balance,e.singleAccount.currency)," ")}}function nb(e,t){if(1&e&&(m.Ob(0),m.Bc(1,tb,6,14,"label-value",17),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("ngIf",e.singleAccount.status)}}function ib(e,t){1&e&&m.Lb(0,"br")}function ab(e,t){1&e&&m.Dc(0," - ")}function cb(e,t){if(1&e&&(m.Ob(0),m.Bc(1,ib,1,0,"br",2),m.ac(2,"async"),m.Bc(3,ab,1,0,"ng-template",null,30,m.Cc),m.Dc(5),m.Nb()),2&e){const e=m.qc(4),t=m.Zb().$implicit,n=m.Zb(2);m.xb(1),m.gc("ngIf",m.bc(2,3,n.layout.ltsm$))("ngIfElse",e),m.xb(4),m.Fc(" ",t.number," ")}}const rb=function(e,t){return{positive:e,negative:t}};function ob(e,t){if(1&e&&(m.Qb(0,"div",31),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb().$implicit,t=m.Zb(2);m.gc("ngClass",m.kc(5,rb,t.format.isPositive(e.status.balance),t.format.isNegative(e.status.balance))),m.xb(1),m.Fc(" ",m.cc(2,2,e.status.balance,e.currency)," ")}}function sb(e,t){if(1&e){const e=m.Rb();m.Qb(0,"div",23),m.Qb(1,"div"),m.Qb(2,"div",24),m.Qb(3,"input",25,26),m.Xb("keyup.enter",(function(){return m.sc(e),m.qc(4).click()})),m.Pb(),m.Qb(5,"label",27),m.Qb(6,"div",28),m.Dc(7),m.Bc(8,cb,6,5,"ng-container",14),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Bc(9,ob,3,8,"div",29),m.Pb()}if(2&e){const e=t.$implicit,n=m.Zb(2);m.xb(1),m.zb(n.pos?"col":"col-7 col-sm-8 col-md-5"),m.xb(2),m.gc("id","from_"+e.id)("value",e.type.id),m.xb(2),m.gc("for","from_"+e.id),m.xb(2),m.Fc(" ",e.type.name," "),m.xb(1),m.gc("ngIf",e.number),m.xb(1),m.gc("ngIf",!n.pos&&e.status)}}function lb(e,t){if(1&e&&(m.Qb(0,"label-value",20),m.Bc(1,sb,10,8,"div",21),m.Lb(2,"field-errors",22),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.pos?e.i18n.transaction.toAccount:e.i18n.transaction.fromAccount),m.xb(1),m.gc("ngForOf",e.data.accounts),m.xb(1),m.gc("control",e.form.get("account"))}}function ub(e,t){if(1&e&&m.Lb(0,"field-option",37),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.display)}}function bb(e,t){if(1&e&&(m.Qb(0,"single-selection-field",35),m.Bc(1,ub,1,2,"field-option",36),m.Pb()),2&e){const e=m.Zb(2);m.xb(1),m.gc("ngForOf",e.data.allowedUsers)}}const db=function(e){return[e]},mb=function(e){return{usersToExclude:e}};function fb(e,t){if(1&e){const e=m.Rb();m.Qb(0,"user-field",38,39),m.Xb("selected",(function(t){m.sc(e);const n=m.Zb(2);return t?n.setFocus(n.amountField):null})),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("autoSearch",!e.allowPrincipal)("filters",m.jc(9,mb,e.fromUser&&!e.fromSelf?m.jc(7,db,e.fromParam):null))("allowContacts",e.allowContacts)("allowSearch",e.allowSearch)("allowPrincipal",e.allowPrincipal)("allowQrCode",e.allowQrCode)("principalTypes",e.data.principalTypes)}}function gb(e,t){if(1&e&&(m.Qb(0,"label-value",32),m.Bc(1,bb,2,1,"single-selection-field",33),m.Bc(2,fb,2,11,"ng-template",null,34,m.Cc),m.Pb()),2&e){const e=m.qc(3),t=m.Zb();m.gc("label",t.pos?t.i18n.transaction.fromUser:t.i18n.transaction.toUser),m.xb(1),m.gc("ngIf",t.fixedUsersList)("ngIfElse",e)}}function pb(e,t){if(1&e&&(m.Qb(0,"label-value",40),m.Lb(1,"user-link",16),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toUser),m.xb(1),m.gc("user",e.toUser)}}function hb(e,t){if(1&e&&m.Lb(0,"field-option",37),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function yb(e,t){if(1&e&&(m.Qb(0,"single-selection-field",41,42),m.Bc(2,hb,1,2,"field-option",36),m.ac(3,"async"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.type),m.xb(2),m.gc("ngForOf",m.bc(3,2,e.paymentTypes$))}}function xb(e,t){if(1&e&&(m.Qb(0,"label-value",40),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(2,2,e.paymentTypeData$.value.fixedAmount,e.paymentTypeData$.value.currency)," ")}}function vb(e,t){if(1&e&&m.Lb(0,"decimal-field",43,44),2&e){const e=m.Zb();m.gc("focused",e.fixedDestination)("label",e.i18n.transaction.amount)("scale",null==e.currency?null:e.currency.decimalDigits)("prefix",null==e.currency?null:e.currency.prefix)("suffix",null==e.currency?null:e.currency.suffix)}}function Pb(e,t){if(1&e&&(m.Qb(0,"label-value",45),m.Lb(1,"custom-field-input",46),m.Pb()),2&e){const e=t.$implicit,n=m.Zb();m.gc("label",e.name)("kind","field")("labelPosition","boolean"===e.type?"sideForced":"auto")("fieldSize",n.fieldSize(e))("required",e.required),m.xb(1),m.gc("field",e)("formControl",n.customValuesControlGetter(e))}}function Db(e,t){if(1&e&&m.Lb(0,"field-option",52),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingSingle)}}function Lb(e,t){if(1&e&&m.Lb(0,"field-option",53),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingInstallments)}}function wb(e,t){if(1&e&&m.Lb(0,"field-option",54),2&e){const e=m.Zb(2);m.gc("text",e.i18n.transaction.schedulingRecurring)}}function Cb(e,t){if(1&e&&(m.Qb(0,"single-selection-field",47),m.Lb(1,"field-option",48),m.Bc(2,Db,1,1,"field-option",49),m.Bc(3,Lb,1,1,"field-option",50),m.Bc(4,wb,1,1,"field-option",51),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.scheduling),m.xb(1),m.gc("text",e.i18n.transaction.schedulingDirect),m.xb(1),m.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>0),m.xb(1),m.gc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>1),m.xb(1),m.gc("ngIf",null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.allowsRecurringPayments)}}function Qb(e,t){if(1&e&&m.Lb(0,"date-field",55),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.dueDate)}}function Ib(e,t){if(1&e&&m.Lb(0,"date-field",55),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.firstInstallmentDate)}}function Fb(e,t){if(1&e&&(m.Ob(0),m.Lb(1,"input-field",56),m.Qb(2,"radio-group-field",57),m.Lb(3,"field-option",37),m.Lb(4,"field-option",37),m.Pb(),m.Bc(5,Ib,1,1,"date-field",58),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.transaction.installmentsCount),m.xb(1),m.gc("label",e.i18n.transaction.firstInstallment),m.xb(1),m.gc("value",!0)("text",e.i18n.general.now),m.xb(1),m.gc("value",!1)("text",e.i18n.general.futureDate),m.xb(1),m.gc("ngIf",!1===e.form.value.firstInstallmentIsNow)}}function Tb(e,t){if(1&e&&m.Lb(0,"date-field",63),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.firstOccurrenceDate)}}function Sb(e,t){if(1&e&&m.Lb(0,"input-field",64),2&e){const e=m.Zb(2);m.gc("label",e.i18n.transaction.occurrencesCount)}}function kb(e,t){if(1&e&&(m.Ob(0),m.Qb(1,"radio-group-field",59),m.Lb(2,"field-option",37),m.Lb(3,"field-option",37),m.Pb(),m.Bc(4,Tb,1,1,"date-field",60),m.Qb(5,"radio-group-field",61),m.Lb(6,"field-option",37),m.Lb(7,"field-option",37),m.Pb(),m.Bc(8,Sb,1,1,"input-field",62),m.Nb()),2&e){const e=m.Zb();m.xb(1),m.gc("label",e.i18n.transaction.firstOccurrence),m.xb(1),m.gc("value",!0)("text",e.i18n.general.now),m.xb(1),m.gc("value",!1)("text",e.i18n.general.futureDate),m.xb(1),m.gc("ngIf",!1===e.form.value.firstOccurrenceIsNow),m.xb(1),m.gc("label",e.i18n.transaction.repeatUntil),m.xb(1),m.gc("value",!0)("text",e.i18n.transaction.repeatUntilManual),m.xb(1),m.gc("value",!1)("text",e.i18n.transaction.repeatUntilFixed),m.xb(1),m.gc("ngIf",!1===e.form.value.repeatUntilCanceled)}}function Ob(e,t){if(1&e&&m.Lb(0,"textarea-field",66),2&e){const e=m.Zb().ngIf,t=m.Zb();m.gc("required","required"===e)("label",t.i18n.general.description)}}function Nb(e,t){if(1&e&&(m.Ob(0),m.Bc(1,Ob,1,2,"textarea-field",65),m.Nb()),2&e){const e=t.ngIf;m.xb(1),m.gc("ngIf","disabled"!==e)}}const Bb=[$i.a.FORBIDDEN,$i.a.UNAUTHORIZED,$i.a.NOT_FOUND];let Ab=(()=>{class e extends k.a{constructor(e,t,n,i){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=i,this.setFocus=s.k,this.availablePaymentTypes=new m.n,this.accountBalanceLabel$=new u.a(null),this.fixedDestination=!1,this.paymentTypes$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe(Object(Ri.a)(),Object(Zi.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>this.fetchPaymentTypeData(e))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const e=r.a.escapeNumeric(this.form.value.subject);""!==e&&this.errorHandler.requestWithCustomErrorHandler(t=>{let n;n=this.pos?this.posService.dataForReceivePayment({from:e,fields:["fromUser","paymentTypes","paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:e,fields:["toUser","paymentTypes","paymentTypeData"]}),n.pipe(Object(Bn.a)()).subscribe(e=>{this.setFetchedPaymentTypes(e)},e=>{if(this.allowPrincipal&&this.userField&&e.status===$i.a.NOT_FOUND){let t=e.error;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){t={}}const i=t.entityType;if(!Object(s.b)(i)&&i.endsWith("User"))return void this.userField.search()}Bb.includes(e.status)||t(e)})})}adjustPaymentTypes(){const e=this.form.value;if(0===(e.subject||"").trim().length)return;const t=this.fetchedPaymentTypes||[];Object(s.i)(t)&&this.notification.error(this.i18n.transaction.noTypes);const n=t.filter(t=>t.from.id===e.account);let i=this.form.value.type,a=null;Object(s.i)(n)?a={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find(e=>e.id===i)||(i=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:i}),this.form.get("account").setErrors(a),this.form.get("account").markAsTouched(),Object(s.i)(i)||this.fetchPaymentTypeData(i),this.availablePaymentTypes.emit(n)}setFetchedPaymentTypes(e){this.userField&&(this.userField.user=this.pos?e.fromUser:e.toUser),this.fetchedPaymentTypes=e.paymentTypes;const t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}fetchPaymentTypeData(e){const t=this.form.value;if(Object(s.i)(t.subject)||Object(s.i)(e))return;const n=this.dataCache.get(e);n?this.setPaymentTypeData(n):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(n=>{let i;i=this.pos?this.posService.dataForReceivePayment({from:t.subject,type:e,fields:["paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:t.subject,type:e,fields:["paymentTypeData"]}),i.pipe(Object(Bn.a)()).subscribe(e=>{this.setPaymentTypeData(e.paymentTypeData)},e=>{Bb.includes(e.status)||n(e)})}))}setPaymentTypeData(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(s.k)(this.amountField),e.fixedAmount&&this.form.patchValue({amount:e.fixedAmount})),this.paymentTypeData$.next(e))}fieldSize(e){return this.fieldHelper.fieldSize(e)}get fixedUsersList(){return!Object(s.i)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!Object(s.i)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const e=this.data.accounts||[];return 1===e.length?e[0]:null}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(c.a),m.Kb(Sn.a),m.Kb(kn.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(m.Hc(Wu,!0),m.yc(Yu,!0)),2&e&&(m.pc(n=m.Yb())&&(t.userField=n.first),m.pc(n=m.Yb())&&(t.amountField=n.first))},inputs:{data:"data",pos:"pos",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[m.ub],decls:24,vars:28,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleAccounts",""],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],[3,"label","kind","labelPosition","fieldSize","required",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngIf"],["kind","field",3,"label"],[3,"user"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],["class","col-5 col-sm-4 col-md-7 pl-2 text-right text-xs-left font-weight-bold",3,"ngClass",4,"ngIf"],["separator",""],[1,"col-5","col-sm-4","col-md-7","pl-2","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],[3,"label","kind","labelPosition","fieldSize","required"],["hideLabel","",3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsNow",3,"label"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","firstOccurrenceIsNow",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(m.Ob(0,0),m.Bc(1,Ju,2,2,"label-value",1),m.Bc(2,nb,2,1,"ng-container",2),m.Bc(3,lb,3,3,"ng-template",null,3,m.Cc),m.Bc(5,gb,4,3,"label-value",4),m.Bc(6,pb,2,2,"label-value",5),m.Bc(7,yb,4,4,"single-selection-field",6),m.ac(8,"async"),m.Bc(9,xb,3,5,"label-value",7),m.ac(10,"async"),m.Bc(11,vb,2,5,"ng-template",null,8,m.Cc),m.Bc(13,Pb,2,7,"label-value",9),m.ac(14,"async"),m.Bc(15,Cb,5,5,"single-selection-field",10),m.ac(16,"async"),m.ac(17,"async"),m.Ob(18,11),m.Bc(19,Qb,1,1,"date-field",12),m.Bc(20,Fb,6,7,"ng-container",13),m.Bc(21,kb,9,12,"ng-container",13),m.Nb(),m.Bc(22,Nb,2,1,"ng-container",14),m.ac(23,"async"),m.Nb()),2&e){const e=m.qc(4),o=m.qc(12);var n,i,a,c,r=null;m.gc("formGroup",t.form),m.xb(1),m.gc("ngIf",t.fromUser&&!t.fromSelf),m.xb(1),m.gc("ngIf",t.singleAccount)("ngIfElse",e),m.xb(3),m.gc("ngIf",!t.fixedDestination),m.xb(1),m.gc("ngIf",t.fixedDestination&&t.toUser),m.xb(1),m.gc("ngIf",(null==(n=m.bc(8,16,t.paymentTypes$))?null:n.length)>1),m.xb(2),m.gc("ngIf",null==(i=m.bc(10,18,t.paymentTypeData$))?null:i.fixedAmount)("ngIfElse",o),m.xb(4),m.gc("ngForOf",null==(a=m.bc(14,20,t.paymentTypeData$))?null:a.customFields),m.xb(2),m.gc("ngIf",(null==(r=m.bc(16,22,t.paymentTypeData$))?null:r.allowsRecurringPayments)||(null==(r=m.bc(17,24,t.paymentTypeData$))?null:r.maxInstallments)>0),m.xb(3),m.gc("ngSwitch",t.form.value.scheduling),m.xb(1),m.gc("ngSwitchCase","futureDate"),m.xb(1),m.gc("ngSwitchCase","scheduled"),m.xb(1),m.gc("ngSwitchCase","recurring"),m.xb(1),m.gc("ngIf",(null==(c=m.bc(23,26,t.paymentTypeData$))?null:c.descriptionAvailability)||"disabled")}},directives:[v.v,v.n,g.t,g.s,g.x,g.y,P.a,D.a,g.q,Mi.a,v.z,v.e,v.u,v.l,L.a,Yn.a,w.a,T.a,v.C,I.a,Hi.a,v.k,Q.a,F.a,qi.a,Vi.a,ht.a],pipes:[g.b,O.a],encapsulation:2,changeDetection:0}),e})(),Eb=(()=>{class e extends k.a{constructor(e,t){super(e),this.receiveQrPayment=t}ngOnInit(){super.ngOnInit(),this.payment.authorizationStatus===i.Db.PENDING?(this.icon=d.a.CalendarEvent,this.message=this.payment.transactionNumber?this.i18n.transaction.pendingWithNumber(this.payment.transactionNumber):this.i18n.transaction.pending):(this.icon=d.a.Check2,this.message=this.payment.transactionNumber?this.i18n.transaction.processedWithNumber(this.payment.transactionNumber):this.i18n.transaction.processed),this.addShortcut(Gn.k,()=>this.receiveQrPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r),m.Kb(Ea))},e.\u0275cmp=m.Eb({type:e,selectors:[["receive-qr-payment-step-done"]],inputs:{payment:"payment"},features:[m.ub],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4","positive"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.Qb(2,"div",2),m.Lb(3,"icon",3),m.Pb(),m.Qb(4,"div",4),m.Dc(5),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.xb(3),m.gc("icon",t.icon),m.xb(2),m.Ec(t.message))},directives:[Ti.a],encapsulation:2,changeDetection:0}),e})();const $b=["amount"];function Rb(e,t){if(1&e&&m.Lb(0,"field-option",9),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.type.name)}}function Zb(e,t){if(1&e&&(m.Qb(0,"radio-group-field",7),m.Bc(1,Rb,1,2,"field-option",8),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.toAccount),m.xb(1),m.gc("ngForOf",e.data.accounts)}}function Mb(e,t){if(1&e&&m.Lb(0,"field-option",9),2&e){const e=t.$implicit;m.gc("value",e.id)("text",e.name)}}function Hb(e,t){if(1&e&&(m.Qb(0,"single-selection-field",10),m.Bc(1,Mb,1,2,"field-option",8),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.type),m.xb(1),m.gc("ngForOf",e.transferTypes)}}function qb(e,t){if(1&e&&(m.Qb(0,"label-value",11),m.Dc(1),m.ac(2,"currency"),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount),m.xb(1),m.Fc(" ",m.cc(2,2,e.typeData.fixedAmount,e.currency)," ")}}function Ub(e,t){if(1&e&&m.Lb(0,"decimal-field",12),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.amount)("prefix",null==e.currency?null:e.currency.prefix)("suffix",null==e.currency?null:e.currency.suffix)("scale",null==e.currency?null:e.currency.decimalDigits)}}function Vb(e,t){if(1&e&&(m.Qb(0,"label-value",14),m.Lb(1,"custom-field-input",15),m.Pb()),2&e){const e=t.$implicit,n=m.Zb(2);m.gc("label",e.name)("kind","field")("labelPosition","boolean"===e.type?"sideForced":"auto")("fieldSize",n.fieldSize(e))("required",e.required),m.xb(1),m.gc("field",e)("formControlName",e.internalName)}}function zb(e,t){if(1&e&&(m.Ob(0,0),m.Bc(1,Vb,2,7,"label-value",13),m.Nb()),2&e){const e=m.Zb();m.gc("formGroup",e.form.controls.customValues),m.xb(1),m.gc("ngForOf",e.typeData.customFields)}}function jb(e,t){if(1&e&&m.Lb(0,"textarea-field",16),2&e){const e=m.Zb();m.gc("label",e.i18n.general.description)("required","required"===(null==e.typeData?null:e.typeData.descriptionAvailability))}}let Gb=(()=>{class e extends k.a{constructor(e){super(e)}get singleAccount(){return 1===this.data.accounts.length}get currency(){return null==this.typeData?null:this.typeData.currency}fieldSize(e){return this.fieldHelper.fieldSize(e)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["receive-qr-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&m.yc($b,!0),2&e&&m.pc(n=m.Yb())&&(t.amountField=n.first)},inputs:{data:"data",form:"form",transferTypes:"transferTypes",type:"type",typeData:"typeData"},features:[m.ub],decls:8,vars:7,consts:[[3,"formGroup"],["formControlName","account","required","","asColumn","",3,"label",4,"ngIf"],["formControlName","type",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf","ngIfElse"],["amountTemplate",""],[3,"formGroup",4,"ngIf"],["formControlName","description",3,"label","required",4,"ngIf"],["formControlName","account","required","","asColumn","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type",3,"label"],["kind","fieldView",3,"label"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],[3,"label","kind","labelPosition","fieldSize","required",4,"ngFor","ngForOf"],[3,"label","kind","labelPosition","fieldSize","required"],["hideLabel","",3,"field","formControlName"],["formControlName","description",3,"label","required"]],template:function(e,t){if(1&e&&(m.Ob(0,0),m.Bc(1,Zb,2,2,"radio-group-field",1),m.Bc(2,Hb,2,2,"single-selection-field",2),m.Bc(3,qb,3,5,"label-value",3),m.Bc(4,Ub,1,4,"ng-template",null,4,m.Cc),m.Bc(6,zb,2,2,"ng-container",5),m.Bc(7,jb,1,2,"textarea-field",6),m.Nb()),2&e){const e=m.qc(5);m.gc("formGroup",t.form),m.xb(1),m.gc("ngIf",!t.singleAccount),m.xb(1),m.gc("ngIf",(null==t.transferTypes?null:t.transferTypes.length)>1),m.xb(1),m.gc("ngIf",null==t.typeData?null:t.typeData.fixedAmount)("ngIfElse",e),m.xb(3),m.gc("ngIf",(null==t.typeData||null==t.typeData.customFields?null:t.typeData.customFields.length)>0),m.xb(1),m.gc("ngIf","disabled"!==(null==t.typeData?null:t.typeData.descriptionAvailability))}},directives:[v.v,v.n,g.t,Vi.a,v.u,v.l,v.C,g.s,w.a,L.a,P.a,I.a,Yn.a,Hi.a,ht.a],pipes:[O.a],encapsulation:2,changeDetection:0}),e})();function Kb(e,t){if(1&e){const e=m.Rb();m.Qb(0,"button",10),m.Xb("click",(function(){return m.sc(e),m.Zb(2).copyUrl()})),m.Lb(1,"icon",11),m.Pb()}if(2&e){const e=m.Zb(2);m.gc("tooltip",e.i18n.general.copyToClipboard),m.xb(1),m.gc("icon",e.SvgIcon.Share)}}function _b(e,t){if(1&e&&(m.Qb(0,"label-value",3),m.Qb(1,"div",8),m.Dc(2),m.Pb(),m.Bc(3,Kb,2,2,"button",9),m.Pb()),2&e){const e=m.Zb();m.gc("label",e.i18n.transaction.ticketShareUrl),m.xb(2),m.Ec(e.ticket.approveUrl)}}let Xb=(()=>{class e extends k.a{constructor(e){super(e),this.supportsShare=Object(s.E)()}copyUrl(){Object(s.g)(this.ticket.approveUrl),this.notification.snackBar(this.i18n.general.copyToClipboardDone)}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(m.r))},e.\u0275cmp=m.Eb({type:e,selectors:[["receive-qr-payment-step-pending"]],inputs:{ticket:"ticket",qrCodeUrl:"qrCodeUrl"},features:[m.ub],decls:10,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"mb-3",3,"src"],[3,"label","value"],[3,"label"],[1,"d-flex"],[1,"flex-grow-1"],["bootstrap","","size","1.5rem",1,"p-0","ml-2","min-size"],[3,"label",4,"ngIf"],[1,"w-100"],["class","btn btn-icon","type","button",3,"tooltip","click",4,"extraCell"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Lb(1,"img",1),m.ac(2,"trust"),m.Pb(),m.Lb(3,"label-value",2),m.Qb(4,"label-value",3),m.Qb(5,"div",4),m.Qb(6,"div",5),m.Dc(7),m.Pb(),m.Lb(8,"spinner",6),m.Pb(),m.Pb(),m.Bc(9,_b,4,2,"label-value",7)),2&e&&(m.xb(1),m.gc("src",m.cc(2,6,t.qrCodeUrl,"url"),m.uc),m.xb(2),m.gc("label",t.i18n.transaction.amount)("value",t.format.formatAsCurrency(t.ticket.currency,t.ticket.amount)),m.xb(1),m.gc("label",t.i18n.general.status),m.xb(3),m.Ec(t.i18n.transaction.status.pending),m.xb(2),m.gc("ngIf",!t.supportsShare))},directives:[P.a,U.a,g.t,ys.a,Kn.b,Ti.a],pipes:[vl.a],encapsulation:2,changeDetection:0}),e})();var Wb=n("Se2V"),Yb=n("psEu"),Jb=n("s3T5"),ed=n("Lm2G"),td=n("yyhP"),nd=n("mzC4"),id=n("dZIy"),ad=n("ojQa"),cd=n("QKVY"),rd=n("yThH"),od=n("vdzA"),sd=n("o/nJ"),ld=n("AH7H"),ud=n("lrfU"),bd=n("aVfl"),dd=n("G1xJ"),md=n("VpKs"),fd=n("yk18"),gd=n("nGVv"),pd=n("559x"),hd=n("0C6t"),yd=n("z332"),xd=n("pz1b"),vd=n("bER3"),Pd=n("ZJXG"),Dd=n("wUcZ"),Ld=n("yRWz"),wd=n("/edM"),Cd=n("vHbw"),Qd=n("USuC"),Id=n("Y49Y"),Fd=n("2V/7"),Td=n("HZ9B"),Sd=n("g9Ug"),kd=n("tjxP"),Od=n("jOM4"),Nd=n("qONT"),Bd=n("DFH8"),Ad=n("csas"),Ed=n("TTRT"),$d=n("UnhA"),Rd=n("N7zh"),Zd=n("sGzL"),Md=n("eNTF"),Hd=n("Kiu2"),qd=n("vOpc"),Ud=n("T6RQ"),Vd=n("U4Kh"),zd=n("ugYG"),jd=n("MNyf"),Gd=n("CyT4"),Kd=n("x741"),_d=n("BTg0"),Xd=n("BUNh"),Wd=n("podT"),Yd=n("oOvo"),Jd=n("L/K/"),em=n("7nZW"),tm=n("9uOH"),nm=n("dCJh"),im=n("g1uo"),am=n("cLCZ"),cm=n("kmyw"),rm=n("/NTq");let om=(()=>{class e{}return e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({factory:function(t){return new(t||e)},imports:[[vu,Wb.a]]}),e})();m.vc(zn,[j.j,j.f,j.h,j.g,j.k,g.q,g.r,g.s,g.t,g.A,g.w,g.x,g.y,g.z,g.u,g.v,v.H,v.w,v.G,v.e,v.x,v.A,v.b,v.D,v.E,v.z,v.u,v.v,v.C,v.q,v.p,v.y,v.c,v.f,v.k,v.n,v.l,v.o,v.h,Yb.a,hs.c,hs.d,Jb.a,Jb.b,Jb.c,ed.a,ed.b,td.a,td.b,nd.a,Kn.b,id.b,id.d,id.a,ad.b,cd.a,rd.a,_n.a,od.a,Ti.a,kr.a,z.a,U.a,gt.a,sd.a,Wn.a,P.a,ys.a,ld.a,ns.a,Xn.a,Ui.a,F.a,ud.a,bd.a,dd.a,md.a,fd.a,ht.a,Mi.a,w.a,L.a,C.a,gd.a,Vi.a,pd.a,Q.a,hd.a,I.a,Hi.a,Ne.a,Oe.a,yd.a,xd.a,vd.a,Pd.a,Dd.a,Ld.a,wd.a,T.a,Cd.a,Qd.a,Id.a,Fd.a,Td.a,Sd.a,ps.a,kd.a,Od.a,Nd.a,Bd.a,Ad.a,pt.a,Yn.a,qi.a,S.a,Ed.a,$d.a,Rd.a,Zd.a,Md.a,Hd.a,D.a,vt.a,qd.a,Ud.a,Vd.a,zd.a,jd.a,Gd.a,$e.a,V.a,Kd.a,f.a,p.a,_d.a,Xd.a,Wd.a,h.a,Yd.a,Jd.a,x.a,y.a,em.a,Se.a,tm.a,ke.a,Te.a,nm.a,Ie,q,Uo,Sr,cr,Ho,bt,Ee,kt,vc,Xc,Wa,eu,po,zn,Ab,_u,Xu,Ea,Gb,Xb,Eb,gs,Us,_o,ts,os,Bs,Rl,al,xl,ml,yu,au,ru,uu,Jt,xt,Ct,Vt,Tn,nn,sn,Pn,Ia,Da,Si,Ei,Fi],[g.b,g.G,g.p,g.k,g.E,g.g,g.C,g.F,g.d,g.f,g.i,g.j,g.l,vl.a,G.a,Yc.a,im.a,am.a,O.a,cm.a,rm.a]),m.vc(Ea,[j.j,j.f,j.h,j.g,j.k,g.q,g.r,g.s,g.t,g.A,g.w,g.x,g.y,g.z,g.u,g.v,v.H,v.w,v.G,v.e,v.x,v.A,v.b,v.D,v.E,v.z,v.u,v.v,v.C,v.q,v.p,v.y,v.c,v.f,v.k,v.n,v.l,v.o,v.h,Yb.a,hs.c,hs.d,Jb.a,Jb.b,Jb.c,ed.a,ed.b,td.a,td.b,nd.a,Kn.b,id.b,id.d,id.a,ad.b,cd.a,rd.a,_n.a,od.a,Ti.a,kr.a,z.a,U.a,gt.a,sd.a,Wn.a,P.a,ys.a,ld.a,ns.a,Xn.a,Ui.a,F.a,ud.a,bd.a,dd.a,md.a,fd.a,ht.a,Mi.a,w.a,L.a,C.a,gd.a,Vi.a,pd.a,Q.a,hd.a,I.a,Hi.a,Ne.a,Oe.a,yd.a,xd.a,vd.a,Pd.a,Dd.a,Ld.a,wd.a,T.a,Cd.a,Qd.a,Id.a,Fd.a,Td.a,Sd.a,ps.a,kd.a,Od.a,Nd.a,Bd.a,Ad.a,pt.a,Yn.a,qi.a,S.a,Ed.a,$d.a,Rd.a,Zd.a,Md.a,Hd.a,D.a,vt.a,qd.a,Ud.a,Vd.a,zd.a,jd.a,Gd.a,$e.a,V.a,Kd.a,f.a,p.a,_d.a,Xd.a,Wd.a,h.a,Yd.a,Jd.a,x.a,y.a,em.a,Se.a,tm.a,ke.a,Te.a,nm.a,Ie,q,Uo,Sr,cr,Ho,bt,Ee,kt,vc,Xc,Wa,eu,po,zn,Ab,_u,Xu,Ea,Gb,Xb,Eb,gs,Us,_o,ts,os,Bs,Rl,al,xl,ml,yu,au,ru,uu,Jt,xt,Ct,Vt,Tn,nn,sn,Pn,Ia,Da,Si,Ei,Fi],[g.b,g.G,g.p,g.k,g.E,g.g,g.C,g.F,g.d,g.f,g.i,g.j,g.l,vl.a,G.a,Yc.a,im.a,am.a,O.a,cm.a,rm.a])},v4xg:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=n("3Pt+"),a=n("mwYl"),c=n("tAww"),r=n("rCAV"),o=n("uuU0"),s=n("Ky6R"),l=n("TFmz"),u=n("Muja"),b=n("2Vo4"),d=n("Kj3r"),m=n("xdKd"),f=n("fXoL");let g=(()=>{class e extends o.a{constructor(e){super(e),this.ResultType=l.a,this.resultType$=new b.a(null),this.resultTypeControl=new i.j(null),this.results$=new b.a(null),this.allowedResultTypes$=new b.a([l.a.LIST]),this.rendering$=new b.a(!1),this.moreFilters$=new b.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=e.get(a.a);const t={page:0};t.resultType=this.getInitialResultType();for(const n of this.getFormControlNames()||[])t[n]=null;this.form=this.formBuilder.group(t)}getInitialFormValue(e){return e.query||{}}onDataInitialized(e){this.form.patchValue(this.getInitialFormValue(e)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(e=>{const t=this.previousResultType;this.previousResultType=e,this.resultType$.next(e),this.shouldUpdateOnResultTypeChange(e,t)&&this.update(),null!=t&&t===e||(this.rendering=!0,this.stateManager.set("resultType",e),this.onResultTypeChanged(e,t))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(d.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>{this.shouldUpdateOnChange(e)&&this.update(),this.previousValue=e}),!0),this.previousResultType!==l.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(e,t){return e!==l.a.CATEGORIES&&([l.a.LIST,l.a.TILES].includes(t)!==[l.a.LIST,l.a.TILES].includes(e)||t===l.a.MAP!=(e===l.a.MAP))}shouldUpdateOnChange(e){return!Object(u.a)(this.previousValue,e)}get results(){return this.results$.value}set results(e){this.onBeforeRender(e),this.results$.next(e)}onBeforeRender(e){}get rendering(){return this.rendering$.value}set rendering(e){this.rendering$.next(e)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(e){this.allowedResultTypes$.next(e)}get moreFilters(){return this.moreFilters$.value}set moreFilters(e){this.moreFilters$.next(e)}get pageData(){const e=this.form.value;return{page:e.page,pageSize:e.pageSize}}set pageData(e){this.form.patchValue(e)}get resultType(){return this.resultTypeControl.value}set resultType(e){null==e&&(e=this.getInitialResultType()),this.resultTypeControl.setValue(e)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new c.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return m.a.Funnel}showLessFiltersIcon(){return m.a.Funnel}onResultTypeChanged(e,t){}getInitialResultType(){return l.a.LIST}update(e){if(this.ignoreNextUpdate)return;e&&(this.form.patchValue(e,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const t=this.form.value;t.pageSize=this.uiLayout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(t)).subscribe(e=>{this.resultType===l.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(e=>e!==l.a.CATEGORIES)),this.results=s.a.from(e)}))}resetPage(e=!1){this.form.patchValue({page:0},{emitEvent:e})}doIgnoringUpdate(e){this.ignoreNextUpdate=!0;try{e()}finally{this.ignoreNextUpdate=!1}}}return e.\u0275fac=function(t){return new(t||e)(f.Kb(f.r))},e.\u0275dir=f.Fb({type:e,features:[f.ub]}),e})()}}]);