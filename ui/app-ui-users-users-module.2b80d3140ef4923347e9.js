(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{RsAj:function(e,t,i){"use strict";i.r(t),i.d(t,"UsersModule",(function(){return Zd}));var n=i("Se2V"),a=i("tyNb"),s=i("bkl+"),o=i("IbW5"),r=i("q8SF"),c=i("rCAV"),l=i("uuU0"),b=i("ObUu"),u=i("QH++"),d=i("XIp8"),g=i("fXoL"),f=i("3qho"),m=i("I0FJ"),p=i("ofXK"),h=i("3Pt+"),v=i("yHfF"),x=i("UXR7"),y=i("OTwK"),P=i("s7Af"),I=i("Mfq2");function E(e,t){if(1&e&&(g.Qb(0,"li"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit;g.xb(1),g.Ec(e)}}function A(e,t){if(1&e&&g.Lb(0,"user-info",9),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function C(e,t){if(1&e&&g.Lb(0,"boolean-field",11),2&e){const e=t.$implicit;g.gc("formControlName",e.id)("label",e.name)("tooltip",e.informationText)("placement","left")}}function O(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Bc(3,C,1,4,"boolean-field",10),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.privacySettings.controlsSection),g.xb(1),g.gc("ngForOf",e.data.availableControls)}}function S(e,t){if(1&e){const e=g.Rb();g.Ob(0,2),g.Qb(1,"div"),g.Dc(2),g.Pb(),g.Qb(3,"div"),g.Dc(4),g.Pb(),g.Qb(5,"ul"),g.Bc(6,E,2,1,"li",3),g.Pb(),g.Bc(7,A,1,1,"user-info",4),g.Lb(8,"boolean-field",5,6),g.Bc(10,O,4,2,"ng-container",7),g.Qb(11,"actions"),g.Qb(12,"action-button",8),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(13,"async"),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.qc(9),t=g.Zb();g.gc("formGroup",t.form),g.xb(2),g.Ec(t.i18n.privacySettings.information),g.xb(2),g.Ec(t.i18n.privacySettings.dataSubjectToControls),g.xb(2),g.gc("ngForOf",t.fields()),g.xb(1),g.gc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),g.xb(1),g.gc("formControlName","enabled")("label",t.i18n.general.enabled),g.xb(2),g.gc("ngIf",e.value),g.xb(2),g.gc("label",t.i18n.general.save)("disabled",g.bc(13,10,t.requesting$))}}let D=(()=>{class e extends l.a{constructor(e,t){super(e),this.privacySettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user?this.user:c.a.SELF}).subscribe(e=>this.data=e))}fields(){return this.data.controlledFields.map(e=>this.fieldHelper.fieldDisplay(e,this.data.customFields))}onDataInitialized(e){this.form=this.formBuilder.group({enabled:e.enabled}),e.availableControls.forEach(t=>this.form.addControl(t.id,this.formBuilder.control({value:e.selectedControls.includes(t.id)||t.fieldsAlwaysVisible,disabled:t.fieldsAlwaysVisible})))}save(){if(Object(b.I)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value),t=e.enabled;delete e.enabled;const i={enabled:t,selectedControls:[]};this.data.availableControls.forEach(t=>{e[t.id]&&i.selectedControls.push(t.id)}),this.addSub(this.privacySettingsService.savePrivacySettings({user:this.user?this.user:c.a.SELF,body:i}).subscribe(()=>this.notification.snackBar(this.i18n.privacySettings.saved)))}resolveMenu(){return this.authHelper.isSelf(this.user)?u.b.PRIVACY_SETTINGS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(r.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-privacy-settings"]],features:[g.ub],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"formControlName","label"],["enabled",""],[4,"ngIf"],[3,"label","disabled","action"],[3,"user"],[3,"formControlName","label","tooltip","placement",4,"ngFor","ngForOf"],[3,"formControlName","label","tooltip","placement"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout"),g.Qb(1,"page-content",0),g.ac(2,"async"),g.Bc(3,S,14,12,"ng-container",1),g.ac(4,"async"),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.gc("heading",t.i18n.privacySettings.title)("mobileHeading",t.i18n.privacySettings.mobileTitle)("headingActions",g.bc(2,4,t.headingActions$)),g.xb(2),g.gc("ngIf",g.bc(4,6,t.data$)))},directives:[f.a,m.a,p.t,h.v,h.n,p.s,v.a,h.u,h.l,x.a,y.a,P.a,I.b],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Q=i("JFlR");function F(e,t){if(1&e&&(g.Qb(0,"li"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit;g.xb(1),g.Ec(e)}}function w(e,t){if(1&e&&g.Lb(0,"user-info",5),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function L(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Dc(1),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("label",e.name)("tooltip",e.informationText)("placement","left"),g.xb(1),g.Fc(" ",e.fieldsAlwaysVisible||i.data.selectedControls.includes(e.id)?i.i18n.general.yes:i.i18n.general.no," ")}}function N(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Bc(3,L,2,4,"label-value",6),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.privacySettings.controlsSection),g.xb(1),g.gc("ngForOf",e.data.availableControls)}}function B(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div"),g.Dc(2),g.Pb(),g.Qb(3,"div"),g.Dc(4),g.Pb(),g.Qb(5,"ul"),g.Bc(6,F,2,1,"li",2),g.Pb(),g.Bc(7,w,1,1,"user-info",3),g.Qb(8,"label-value",4),g.Dc(9),g.Pb(),g.Bc(10,N,4,2,"ng-container",1),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.privacySettings.information),g.xb(2),g.Ec(e.i18n.privacySettings.dataSubjectToControls),g.xb(2),g.gc("ngForOf",e.fields()),g.xb(1),g.gc("ngIf",e.data.user&&!e.authHelper.isSelf(e.data.user)),g.xb(1),g.gc("label",e.i18n.general.enabled),g.xb(1),g.Fc(" ",e.data.enabled?e.i18n.general.yes:e.i18n.general.no,""),g.xb(1),g.gc("ngIf",e.data.enabled)}}let k=(()=>{class e extends l.a{constructor(e,t){super(e),this.privacySettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.privacySettingsService.getPrivacySettingsData({user:this.user?this.user:c.a.SELF}).subscribe(e=>{e.canEdit&&this.router.navigate(["/users",this.user,"privacy-settings","edit"],{replaceUrl:!0}),this.data=e}))}fields(){return this.data.controlledFields.map(e=>this.fieldHelper.fieldDisplay(e,this.data.customFields))}resolveMenu(){return this.authHelper.isSelf(this.user)?u.b.PRIVACY_SETTINGS:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(r.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-privacy-settings"]],features:[g.ub],decls:5,vars:8,consts:[[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user",4,"ngIf"],[3,"label"],[3,"user"],[3,"label","tooltip","placement",4,"ngFor","ngForOf"],[3,"label","tooltip","placement"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout"),g.Qb(1,"page-content",0),g.ac(2,"async"),g.Bc(3,B,11,7,"ng-container",1),g.ac(4,"async"),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.gc("heading",t.i18n.privacySettings.title)("mobileHeading",t.i18n.privacySettings.mobileTitle)("headingActions",g.bc(2,4,t.headingActions$)),g.xb(2),g.gc("ngIf",g.bc(4,6,t.data$)))},directives:[f.a,m.a,p.t,p.s,Q.a,P.a,I.b],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var R=i("cutz"),T=i("tzq7"),Z=i("ugYG"),M=i("Pm8L"),_=i("K3ix"),$=i("Zilp"),H=i("IbGL"),U=i("Ae/X"),G=i("iM3x"),q=i("H4pW"),K=i("yL40"),V=i("/kmK"),j=i("kmyw");function z(e,t){1&e&&g.Mb(0)}function X(e,t){if(1&e&&g.Lb(0,"user-info",8),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function Y(e,t){if(1&e&&(g.Qb(0,"del"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.agreement.name," ")}}function W(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb().$implicit;g.Fc(" ",e.agreement.name," ")}}function J(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div"),g.Qb(2,"div",9),g.Dc(3),g.ac(4,"date"),g.Pb(),g.Qb(5,"div",10),g.Bc(6,Y,2,1,"del",11),g.Bc(7,W,1,1,"ng-template",null,12,g.Cc),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.qc(8);g.xb(3),g.Fc(" ",g.bc(4,3,e.date)," "),g.xb(3),g.gc("ngIf",!e.accepted)("ngIfElse",i)}}function ee(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Ec(e.i18n.agreements.accepted)}}function te(e,t){if(1&e&&(g.Qb(0,"th",18),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.general.remoteAddress,"")}}function ie(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.ac(2,"boolean"),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(g.bc(2,1,e.accepted))}}function ne(e,t){if(1&e&&(g.Qb(0,"td",18),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.remoteAddress,"")}}function ae(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",21),g.Xb("click",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).showAgreement(t)})),g.Lb(1,"icon",22),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.view),g.xb(1),g.gc("icon",e.SvgIcon.Search)}}const se=function(e){return{"cursor-pointer":e}};function oe(e,t){if(1&e&&(g.Qb(0,"tr",19),g.Qb(1,"td"),g.Dc(2),g.ac(3,"dateTime"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Bc(6,ie,3,3,"td",14),g.Bc(7,ne,2,1,"td",15),g.Qb(8,"td",16),g.Bc(9,ae,2,2,"button",20),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("ngClass",g.jc(8,se,e.accepted)),g.xb(2),g.Ec(g.bc(3,6,e.date)),g.xb(3),g.Ec(e.agreement.name),g.xb(1),g.gc("ngIf",i.hasAccepted),g.xb(1),g.gc("ngIf",i.hasRemoteAddress),g.xb(2),g.gc("ngIf",e.accepted)}}function re(e,t){if(1&e&&(g.Qb(0,"table",13),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Bc(6,ee,2,1,"th",14),g.Bc(7,te,2,1,"th",15),g.Lb(8,"th",16),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,oe,10,10,"tr",17),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.agreements.agreement),g.xb(1),g.gc("ngIf",e.hasAccepted),g.xb(1),g.gc("ngIf",e.hasRemoteAddress),g.xb(3),g.gc("ngForOf",e.data.history)}}function ce(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,X,1,1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,J,9,5,"mobile-result",6),g.Bc(4,re,11,5,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.agreements.title.history)("mobileHeading",e.i18n.agreements.mobileTitle.history)("mode",e.self?"empty":"normal"),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.history)("onClick",e.showAgreement)}}let le=(()=>{class e extends M.a{constructor(e,t,i,n){super(e),this.agreementsService=t,this.userHelper=i,this.modal=n}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.history||[];this.hasAccepted=t.findIndex(e=>!e.accepted)>=0,this.hasRemoteAddress=t.findIndex(e=>e.remoteAddress)>=0}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.userMenu(e.user,u.b.AGREEMENTS)}get showAgreement(){return e=>{e.accepted&&this.modal.show(Z.a,{ignoreBackdropClick:!0,class:"modal-form modal-form-large",initialState:{agreement:e.agreement,version:e.acceptedVersion}})}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(R.a),g.Kb(T.a),g.Kb(_.b))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-agreements-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","mode"],[3,"user",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"user"],[1,"cell-text","float-left"],[1,"cell-main","float-right"],[4,"ngIf","ngIfElse"],["accepted",""],[1,"table","table-hover"],[4,"ngIf"],["class","align-center",4,"ngIf"],[1,"actions"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"align-center"],[3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,z,1,0,"ng-container",1),g.Pb(),g.Bc(3,ce,5,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,$.a,H.a,U.a,P.a,G.a,p.s,p.q,I.b,q.a],pipes:[p.b,K.a,V.a,j.a],encapsulation:2,changeDetection:0}),e})();var be=i("tAww"),ue=i("xdKd"),de=i("T6RQ"),ge=i("U4Kh");function fe(e,t){if(1&e&&g.Lb(0,"user-info",9),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function me(e,t){if(1&e&&g.Lb(0,"accept-agreements",10),2&e){const e=g.Zb(2);g.gc("label",e.i18n.agreements.optional)("formControl",e.optionalControl)("agreements",e.allOptional)}}function pe(e,t){1&e&&g.Mb(0)}const he=function(e){return{$implicit:e}};function ve(e,t){if(1&e&&(g.Qb(0,"label-value",11),g.Bc(1,pe,1,0,"ng-container",12),g.Pb()),2&e){const e=g.Zb(3),t=g.qc(4);g.gc("label",e.i18n.agreements.optional),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(3,he,e.acceptedOptional))}}function xe(e,t){if(1&e&&g.Bc(0,ve,2,5,"label-value",7),2&e){const e=g.Zb(2);g.gc("ngIf",(null==e.acceptedOptional?null:e.acceptedOptional.length)>0)}}function ye(e,t){1&e&&g.Mb(0)}function Pe(e,t){if(1&e&&(g.Qb(0,"label-value",11),g.Bc(1,ye,1,0,"ng-container",12),g.Pb()),2&e){const e=g.Zb(2),t=g.qc(4);g.gc("label",e.i18n.agreements.required),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(3,he,e.acceptedRequired))}}function Ie(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"hr"),g.Dc(2),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc(" ",e.i18n.agreements.noAccepted," ")}}function Ee(e,t){if(1&e){const e=g.Rb();g.Qb(0,"actions"),g.Qb(1,"action-button",13),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.ac(2,"async"),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("disabled",g.bc(2,2,e.requesting$))("label",e.i18n.general.save)}}function Ae(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Bc(2,fe,1,1,"user-info",4),g.Bc(3,me,1,3,"accept-agreements",5),g.Bc(4,xe,1,1,"ng-template",null,6,g.Cc),g.Bc(6,Pe,2,5,"label-value",7),g.Bc(7,Ie,3,1,"ng-container",8),g.Bc(8,Ee,3,4,"actions",8),g.Pb()),2&e){const e=g.qc(5),t=g.Zb();g.gc("heading",t.i18n.agreements.title.accepted)("mobileHeading",t.i18n.agreements.mobileTitle.accepted)("headingActions",g.bc(1,9,t.headingActions$)),g.xb(2),g.gc("ngIf",!t.self),g.xb(1),g.gc("ngIf",t.optionalControl)("ngIfElse",e),g.xb(3),g.gc("ngIf",(null==t.acceptedRequired?null:t.acceptedRequired.length)>0),g.xb(1),g.gc("ngIf",t.noAgreements),g.xb(1),g.gc("ngIf",t.optionalControl)}}const Ce=function(e){return{"mt-2":e}};function Oe(e,t){if(1&e&&(g.Qb(0,"div",15),g.Lb(1,"agreement-link",16),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.gc("ngClass",g.jc(3,Ce,!i)),g.xb(1),g.gc("agreement",e)("version",null==n.data.accepted[e.id]?null:n.data.accepted[e.id].acceptedVersion)}}function Se(e,t){1&e&&g.Bc(0,Oe,2,5,"div",14),2&e&&g.gc("ngForOf",t.$implicit)}let De=(()=>{class e extends M.a{constructor(e,t){super(e),this.agreementsService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=Object.keys(e.accepted||{}),i=(e.agreements||[]).filter(e=>t.includes(e.id));this.allOptional=(e.agreements||[]).filter(e=>!e.required),this.acceptedOptional=i.filter(e=>!e.required),this.acceptedRequired=i.filter(e=>e.required),e.canEdit?this.optionalControl=this.formBuilder.control(this.acceptedOptional.map(e=>e.id)):this.noAgreements=0===i.length,this.noAgreements||(this.headingActions=[new be.c(ue.a.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"agreements","history"]),!0)])}save(){Object(b.I)(this.optionalControl)&&this.addSub(this.agreementsService.acceptOptionalAgreements({agreements:this.optionalControl.value}).subscribe(()=>{this.notification.snackBar(this.i18n.agreements.optionalSaved),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.AGREEMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(R.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-agreements"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],["agreementLinks",""],[3,"heading","mobileHeading","headingActions"],[3,"user",4,"ngIf"],[3,"label","formControl","agreements",4,"ngIf","ngIfElse"],["optionalNotEditable",""],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"label","formControl","agreements"],[3,"label"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"disabled","label","action"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["ignoreRequired","",3,"agreement","version"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ae,9,11,"page-content",1),g.Pb(),g.Bc(3,Se,1,1,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,de.a,h.u,h.k,Q.a,p.A,x.a,y.a,p.s,p.q,ge.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Qe=i("hQUc"),Fe=i("v4xg"),we=i("6g1M"),Le=i("WYBn"),Ne=i("chz4"),Be=i("JbOn"),ke=i("sifq");function Re(e,t){if(1&e&&(g.Qb(0,"mobile-result",25),g.Qb(1,"div",26),g.Dc(2),g.Pb(),g.Qb(3,"div",27),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"div",28),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("avatarImage",null==e.user?null:e.user.image)("avatarIcon",i.SvgIcon.Person),g.xb(1),g.gc("tooltip",e.user.display),g.xb(1),g.Fc(" ",e.user.display,""),g.xb(2),g.Fc(" ",g.bc(5,6,e.date)," "),g.xb(3),g.Ec(e.text)}}const Te=function(e,t){return{"pb-0":e,"border-0":t}};function Ze(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",32),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(2);return n.router.navigate(n.path(i))})),g.Qb(2,"td",33),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",34),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"dateTime"),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.gc("ngClass",g.kc(12,Te,g.bc(3,6,i.layout.xxs$),g.bc(4,8,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.user?null:e.user.image)("tooltip",null==e.user?null:e.user.display),g.xb(2),g.Ec(e.user.display),g.xb(2),g.Ec(e.text),g.xb(2),g.Ec(g.bc(12,10,e.date))}}function Me(e,t){if(1&e&&(g.Qb(0,"table",29),g.Qb(1,"thead"),g.Lb(2,"th",30),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,Ze,13,15,"ng-container",31),g.ac(11,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb();var i;g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.i18n.userAlert.text),g.xb(2),g.Ec(e.i18n.general.date),g.xb(2),g.gc("ngForOf",null==(i=g.bc(11,4,e.results$))?null:i.results)}}let _e=(()=>{class e extends Fe.a{constructor(e,t){super(e),this.alertsService=t}ngOnInit(){super.ngOnInit(),this.data={}}getFormControlNames(){return["types","user","beginDate","endDate"]}toSearchParams(e){return{datePeriod:c.a.dateRangeFilter(e.beginDate,e.endDate),page:e.page,pageSize:e.pageSize,types:e.types,user:e.user}}doSearch(e){return this.alertsService.searchUserAlerts$Response(e)}resolveMenu(){return u.b.USER_ALERTS}path(e){return["/users",e.user.id,"profile"]}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Qe.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-user-alerts"]],features:[g.ub],decls:30,vars:28,consts:[[3,"ready"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","beginDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","types",3,"label","emptyOption"],["value","custom",3,"text"],["value","givenVeryBadRefs",3,"text"],["value","insufficientBalanceForInitialCredit",3,"text"],["value","maxDeviceActivationAttemptsReached",3,"text"],["value","maxDeviceConfirmationCheckAttemptsReached",3,"text"],["value","maxTokenActivationAttemptsReached",3,"text"],["value","maxUserLocalizationAttemptsReached",3,"text"],["value","maxVoucherRedeemAttemptsReached",3,"text"],["value","moveUserAutomaticallyFailed",3,"text"],["value","passwordDisabledByTries",3,"text"],["value","passwordTemporarilyBlocked",3,"text"],["value","receivedVeryBadRefs",3,"text"],["value","scheduledPaymentFailed",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","rendering$","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"avatarImage","avatarIcon"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.Qb(3,"form",2),g.Qb(4,"div",3),g.Qb(5,"div",4),g.Lb(6,"date-field",5),g.Pb(),g.Qb(7,"div",4),g.Lb(8,"date-field",6),g.Pb(),g.Qb(9,"div",4),g.Qb(10,"single-selection-field",7),g.Lb(11,"field-option",8),g.Lb(12,"field-option",9),g.Lb(13,"field-option",10),g.Lb(14,"field-option",11),g.Lb(15,"field-option",12),g.Lb(16,"field-option",13),g.Lb(17,"field-option",14),g.Lb(18,"field-option",15),g.Lb(19,"field-option",16),g.Lb(20,"field-option",17),g.Lb(21,"field-option",18),g.Lb(22,"field-option",19),g.Lb(23,"field-option",20),g.Pb(),g.Pb(),g.Qb(24,"div",4),g.Lb(25,"user-field",21),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(26,"results-layout",22),g.Xb("update",(function(e){return t.update(e)})),g.ac(27,"async"),g.Bc(28,Re,8,8,"mobile-result",23),g.Bc(29,Me,12,6,"table",24),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,24,t.data$)),g.xb(2),g.gc("heading",t.i18n.userAlert.title)("mobileHeading",t.i18n.userAlert.mobileTitle),g.xb(1),g.gc("formGroup",t.form),g.xb(3),g.gc("label",t.i18n.general.beginDate),g.xb(2),g.gc("label",t.i18n.general.endDate),g.xb(2),g.gc("label",t.i18n.userAlert.type.title)("emptyOption",t.i18n.general.notApplied),g.xb(1),g.gc("text",t.i18n.userAlert.type.custom),g.xb(1),g.gc("text",t.i18n.userAlert.type.givenVeryBadRefs),g.xb(1),g.gc("text",t.i18n.userAlert.type.insufficientBalanceForInitialCredit),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxDeviceActivationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxTokenActivationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxUserLocalizationAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.maxVoucherRedeemAttemptsReached),g.xb(1),g.gc("text",t.i18n.userAlert.type.moveUserAutomaticallyFailed),g.xb(1),g.gc("text",t.i18n.userAlert.type.passwordDisabledByTries),g.xb(1),g.gc("text",t.i18n.userAlert.type.passwordTemporarilyBlocked),g.xb(1),g.gc("text",t.i18n.userAlert.type.receivedVeryBadRefs),g.xb(1),g.gc("text",t.i18n.userAlert.type.receivedVeryBadRefs),g.xb(2),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("results",g.bc(27,26,t.results$))("rendering$",t.rendering$))},directives:[f.a,m.a,h.H,h.v,h.n,we.a,h.u,h.l,Le.a,Ne.a,Be.a,$.a,H.a,U.a,G.a,I.b,p.s,p.q,ke.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var $e=i("XDzf"),He=i("Dhej");function Ue(e,t){if(1&e&&g.Lb(0,"boolean-field",7),2&e){const e=g.Zb(2);g.gc("label",e.i18n.brokers.mainBroker)}}function Ge(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.Qb(2,"form",3),g.Lb(3,"user-field",4),g.Bc(4,Ue,1,1,"boolean-field",5),g.Pb(),g.Qb(5,"actions"),g.Qb(6,"action-button",6),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.brokers.title.new)("mobileHeading",e.i18n.brokers.mobileTitle.new),g.xb(1),g.gc("formGroup",e.form),g.xb(1),g.gc("filters",e.userQuery)("allowContacts",!1)("label",e.i18n.brokers.broker),g.xb(1),g.gc("ngIf",e.data.brokers),g.xb(2),g.gc("disabled",g.bc(7,9,e.requesting$))("label",e.i18n.general.save)}}let qe=(()=>{class e extends l.a{constructor(e,t){super(e),this.brokeringService=t,this.form=this.formBuilder.group({})}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.brokeringService.getBrokerDataForAdd({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.userQuery={roles:[$e.pb.BROKER],usersToExclude:e.brokers.map(e=>e.id),groups:e.brokerGroups.map(e=>e.id)},e.brokers&&this.form.setControl("mainBroker",this.formBuilder.control(!1)),this.form.setControl("broker",this.formBuilder.control(null,h.F.required))}save(){if(Object(b.I)(this.form),!this.form.valid)return;const e=this.form.value;this.addSub(this.brokeringService.addBroker({broker:e.broker,user:this.user,main:e.mainBroker}).subscribe(()=>{this.notification.snackBar(this.i18n.brokers.brokerAdded),this.router.navigate(["/users",this.user,"brokers"])}))}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(He.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["broker-form"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","broker",3,"filters","allowContacts","label"],["formControlName","mainBroker",3,"label",4,"ngIf"],[3,"disabled","label","action"],["formControlName","mainBroker",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ge,8,11,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Be.a,h.u,h.l,x.a,y.a,v.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Ke=i("Wpnw");function Ve(e,t){if(1&e&&g.Lb(0,"user-info",7),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function je(e,t){if(1&e&&g.Lb(0,"icon",15),2&e){const e=g.Zb(3);g.gc("icon",e.SvgIcon.Check2)}}function ze(e,t){if(1&e){const e=g.Rb();g.Qb(0,"a",16),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).setMain(i),t.stopPropagation(),t.preventDefault()})),g.Dc(1),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.Fc("",e.i18n.brokers.setMain," ")}}function Xe(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",17),g.Qb(1,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(2,"icon",19),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(2),g.gc("icon",e.SvgIcon.Trash)}}function Ye(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Qb(2,"div"),g.Qb(3,"div",10),g.Dc(4),g.Pb(),g.Qb(5,"div",11),g.Bc(6,je,1,1,"icon",12),g.Bc(7,ze,2,1,"a",13),g.Pb(),g.Pb(),g.Bc(8,Xe,3,1,"div",14),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",null==e.broker?null:e.broker.image)("avatarIcon",i.SvgIcon.Person),g.xb(4),g.Fc(" ",e.broker.display," "),g.xb(2),g.gc("ngIf",e.main),g.xb(1),g.gc("ngIf",i.canSetMain(e)),g.xb(1),g.gc("ngIf",i.canRemove(e))}}function We(e,t){1&e&&g.Lb(0,"th",25)}function Je(e,t){if(1&e&&g.Lb(0,"icon",15),2&e){const e=g.Zb(4);g.gc("icon",e.SvgIcon.Check2)}}function et(e,t){if(1&e){const e=g.Rb();g.Qb(0,"a",16),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).setMain(i),t.stopPropagation(),t.preventDefault()})),g.Dc(1),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.Fc("",e.i18n.brokers.setMain," ")}}function tt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"td",32),g.Qb(1,"button",33),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).remove(i),t.stopPropagation()})),g.Lb(2,"icon",19),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}const it=function(e){return{"cursor-default":e}},nt=function(e,t){return{"pb-0":e,"border-0":t}};function at(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",26),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.path(i)?n.router.navigate(n.path(i)):null})),g.Qb(2,"td",27),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",28),g.Pb(),g.Qb(6,"td"),g.Qb(7,"maybe-link",29),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"td",30),g.Bc(10,Je,1,1,"icon",12),g.Bc(11,et,2,1,"a",13),g.Pb(),g.Bc(12,tt,3,2,"td",31),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngClass",g.jc(13,it,!i.path(e))),g.xb(1),g.gc("ngClass",g.kc(15,nt,g.bc(3,9,i.layout.xxs$),g.bc(4,11,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.broker?null:e.broker.image)("icon",i.SvgIcon.Person),g.xb(2),g.gc("link",i.path(e)),g.xb(1),g.Fc(" ",e.broker.display," "),g.xb(2),g.gc("ngIf",e.main),g.xb(1),g.gc("ngIf",i.canSetMain(e)),g.xb(1),g.gc("ngIf",i.canRemove(e))}}function st(e,t){if(1&e&&(g.Qb(0,"table",20),g.Qb(1,"thead"),g.Lb(2,"th",21),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th",22),g.Dc(6),g.Pb(),g.Bc(7,We,1,0,"th",23),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,at,13,18,"ng-container",24),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Fc("",e.i18n.brokers.mainBroker," "),g.xb(1),g.gc("ngIf",e.hasActions),g.xb(2),g.gc("ngForOf",e.data.brokers)}}function ot(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,Ve,1,1,"user-info",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,Ye,9,6,"mobile-result",5),g.Bc(6,st,10,4,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.brokers.title.list)("mobileHeading",e.i18n.brokers.mobileTitle.list)("headingActions",g.bc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.brokers)("toLink",e.toLink)}}let rt=(()=>{class e extends l.a{constructor(e,t){super(e),this.brokeringService=t,this.hasActions=!1}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param}).subscribe(e=>{this.data=e}))}path(e){if(e.broker.id)return["/users",e.broker.id,"profile"]}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.brokers=e.brokers,this.headingActions=[],e.editable&&this.headingActions.push(new be.c(ue.a.PersonPlus,this.i18n.general.addNew,()=>this.router.navigate(["/users",this.param,"brokers","new"]),!0)),e.history&&this.headingActions.push(new be.c(ue.a.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.param,"brokers","history"]),!0)),this.hasActions=e.brokers.findIndex(e=>this.canRemove(e))>=0}get toLink(){return e=>this.path(e)}setMain(e){this.addSub(this.brokeringService.setMainBroker({broker:e.broker.id,user:this.param}).subscribe(()=>{this.reload()}))}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.broker.display),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.brokeringService.removeBroker({broker:e.broker.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.broker.display)),this.reload()}))}resolveMenu(){return this.menu.searchUsersMenu()}canRemove(e){var t;return(null===(t=this.data)||void 0===t?void 0:t.editable)&&!this.authHelper.isSelfOrOwner(e.broker)&&e.broker.id}canSetMain(e){var t;return(null===(t=this.data)||void 0===t?void 0:t.editable)&&!e.main&&e.broker.id}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(He.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-user-brokers"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","d-inline-block",3,"icon",4,"ngIf"],["class","decorated",3,"click",4,"ngIf"],["class","ml-auto",4,"ngIf"],[1,"d-inline-block",3,"icon"],[1,"decorated",3,"click"],[1,"ml-auto"],[1,"btn","btn-icon",3,"click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","20%",1,"text-center"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"ngClass","click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"link"],[1,"text-center"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,ot,7,9,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,H.a,U.a,P.a,G.a,q.a,p.s,p.q,ke.a,Ke.a,I.b],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var ct=i("zisa");function lt(e,t){1&e&&g.Mb(0)}function bt(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Qb(3,"div",10),g.Dc(4),g.ac(5,"date"),g.Pb(),g.Qb(6,"div",11),g.Dc(7),g.Pb(),g.Qb(8,"div",11),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",null==e.broker?null:e.broker.image)("avatarIcon",i.SvgIcon.Person),g.xb(2),g.Fc(" ",e.broker.display," "),g.xb(2),g.Fc(" ",g.bc(5,8,e.date)," "),g.xb(3),g.Gc(" ",i.i18n.general.action,": ",i.showActionLabel(e)," "),g.xb(2),g.Gc(" ",i.i18n.general.performedBy,": ",e.by?e.by.display:i.i18n.brokers.administration," ")}}const ut=function(e,t){return{"pb-0":e,"border-0":t}};function dt(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td",15),g.ac(2,"async"),g.ac(3,"async"),g.Lb(4,"avatar",16),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.Pb(),g.Qb(7,"td"),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.Pb(),g.Qb(12,"td"),g.Dc(13),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngClass",g.kc(13,ut,g.bc(2,7,i.layout.xxs$),g.bc(3,9,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.broker?null:e.broker.image)("tooltip",null==e.broker?null:e.broker.display),g.xb(2),g.Ec(e.broker.display),g.xb(2),g.Ec(g.bc(9,11,e.date)),g.xb(3),g.Ec(i.showActionLabel(e)),g.xb(2),g.Fc(" ",e.by?e.by.display:i.i18n.brokers.administration," ")}}function gt(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Lb(2,"th",13),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Pb(),g.Qb(11,"tbody"),g.Bc(12,dt,14,16,"tr",14),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.brokers.broker),g.xb(2),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.action),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function ft(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,bt,10,10,"mobile-result",6),g.Bc(4,gt,13,5,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.brokers.title.history)("mobileHeading",e.i18n.brokers.mobileTitle.history),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)("onClick",e.onClick)}}let mt=(()=>{class e extends M.a{constructor(e,t){super(e),this.brokeringService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}showActionLabel(e){switch(e.action){case ct.a.ADD:return this.i18n.brokers.action.add;case ct.a.REMOVE:return this.i18n.brokers.action.remove;case ct.a.SET_MAIN:return this.i18n.brokers.action.setMain}}get onClick(){return e=>null!=e}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(He.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-broker-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results","onClick"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"avatarImage","avatarIcon"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,lt,1,0,"ng-container",1),g.Pb(),g.Bc(3,ft,5,5,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,H.a,U.a,G.a,p.s,p.q,ke.a,I.b],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();var pt=i("5Qz4"),ht=i("4APx");function vt(e,t){if(1&e&&g.Lb(0,"field-option",13),2&e){const e=t.$implicit;g.gc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function xt(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",11),g.Bc(2,vt,1,4,"field-option",12),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.connectedUser.channel),g.xb(1),g.gc("ngForOf",e.data.channels)}}function yt(e,t){if(1&e&&g.Lb(0,"field-option",16),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",e)("text",i.showConnectedLabel(e))}}function Pt(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",14),g.Bc(2,yt,1,2,"field-option",15),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.connectedUser.showConnected),g.xb(1),g.gc("ngForOf",e.data.roles)}}function It(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",24),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).disconnect(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",25),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.gc("icon",e.SvgIcon.BoxArrowRight)}}function Et(e,t){if(1&e&&(g.Qb(0,"mobile-result",17),g.Qb(1,"div",18),g.Qb(2,"div"),g.Qb(3,"div",19),g.Dc(4),g.Pb(),g.Qb(5,"div",20),g.Dc(6),g.ac(7,"dateTime"),g.Pb(),g.Qb(8,"div",21),g.Dc(9),g.Pb(),g.Pb(),g.Qb(10,"div",22),g.Bc(11,It,2,1,"button",23),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",null==e.user?null:e.user.image)("avatarIcon",i.SvgIcon.Person),g.xb(4),g.Fc(" ",e.user.display," "),g.xb(2),g.Fc(" ",g.bc(7,6,e.creationDate)," "),g.xb(3),g.Fc(" ",e.channel.name," "),g.xb(2),g.gc("ngIf",i.canDisconnect(e))}}function At(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",33),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).disconnect(i),t.stopPropagation()})),g.Lb(1,"icon",25),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.connectedUser.disconnect),g.xb(1),g.gc("icon",e.SvgIcon.BoxArrowRight)}}const Ct=function(e,t){return{"pb-0":e,"border-0":t}};function Ot(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"tr"),g.Qb(2,"td",30),g.ac(3,"async"),g.ac(4,"async"),g.Lb(5,"avatar",31),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"dateTime"),g.Pb(),g.Qb(13,"td"),g.Dc(14),g.Pb(),g.Qb(15,"td",28),g.Bc(16,At,2,2,"button",32),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.gc("ngClass",g.kc(14,Ct,g.bc(3,8,i.layout.xxs$),g.bc(4,10,i.layout.xxs$))),g.xb(3),g.gc("image",null==e.user?null:e.user.image)("tooltip",null==e.user?null:e.user.display),g.xb(2),g.Ec(e.user.display),g.xb(2),g.Ec(e.channel.name),g.xb(2),g.Ec(g.bc(12,12,e.creationDate)),g.xb(3),g.Ec(e.remoteAddress),g.xb(2),g.gc("ngIf",i.canDisconnect(e))}}function St(e,t){if(1&e&&(g.Qb(0,"table",26),g.Qb(1,"thead"),g.Lb(2,"th",27),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Lb(11,"th",28),g.Pb(),g.Qb(12,"tbody"),g.Bc(13,Ot,17,17,"ng-container",29),g.ac(14,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(4),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.i18n.connectedUser.channel),g.xb(2),g.Ec(e.i18n.connectedUser.loggedInAt),g.xb(2),g.Ec(e.i18n.connectedUser.ipAddress),g.xb(3),g.gc("ngForOf",null==(i=g.bc(14,5,e.results$))?null:i.results)}}function Dt(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.Qb(2,"form",3),g.Qb(3,"div",4),g.Bc(4,xt,3,2,"div",5),g.Bc(5,Pt,3,2,"div",5),g.Qb(6,"div",6),g.Lb(7,"user-field",7),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"results-layout",8),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(9,"async"),g.Bc(10,Et,12,8,"mobile-result",9),g.Bc(11,St,15,7,"table",10),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.connectedUser.title)("mobileHeading",e.i18n.connectedUser.mobileTitle),g.xb(1),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),g.xb(1),g.gc("ngIf",(null==e.data.roles?null:e.data.roles.length)>1),g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("results",g.bc(9,9,e.results$))("onClick",e.onClick)("rendering$",e.rendering$)}}let Qt=(()=>{class e extends Fe.a{constructor(e,t){super(e),this.sessionsService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.sessionsService.getSessionDataForSearch().subscribe(e=>{this.form.patchValue(e.query,{emitEvent:!1}),this.data=e}))}toSearchParams(e){return e}disconnect(e){this.addSub(this.sessionsService.disconnectSession({sessionToken:e.sessionToken}).subscribe(()=>{this.notification.snackBar(this.i18n.connectedUser.disconnected(e.user.display)),this.update()}))}canDisconnect(e){return this.login.auth.permissions.sessions.disconnect&&this.login.auth.sessionToken!==e.sessionToken}get onClick(){return e=>null!=e}getFormControlNames(){return["channels","roles","user"]}doSearch(e){return this.sessionsService.searchSessions$Response(e)}showConnectedLabel(e){switch(e){case $e.pb.ADMINISTRATOR:return this.i18n.connectedUser.viewConnected.admin;case $e.pb.BROKER:return this.i18n.connectedUser.viewConnected.broker;case $e.pb.MEMBER:return this.i18n.connectedUser.viewConnected.member;case $e.pb.OPERATOR:return this.i18n.connectedUser.viewConnected.operator}}resolveMenu(){return this.dataForFrontendHolder.role===$e.pb.BROKER?u.b.BROKER_CONNECTED_USERS:u.b.CONNECTED_USERS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(pt.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-connected"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","formControlName","channels",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","roles",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],["class","btn btn-icon",3,"click",4,"ngIf"],[1,"btn","btn-icon",3,"click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],[3,"image","tooltip"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Dt,12,11,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Be.a,h.u,h.l,$.a,H.a,U.a,ht.a,p.s,Ne.a,G.a,q.a,p.q,ke.a,I.b],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var Ft=i("2S6i"),wt=i("2Vo4"),Lt=i("Ls5z"),Nt=i("DIHi"),Bt=i("YG2p"),kt=i("ZJXG");function Rt(e,t){if(1&e&&g.Lb(0,"boolean-field",16),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerManageable)}}function Tt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",17),g.Qb(1,"div"),g.Qb(2,"span"),g.Dc(3),g.ac(4,"async"),g.Pb(),g.Qb(5,"button",18),g.Xb("click",(function(t){return g.sc(e),g.Zb(2).download(),t.stopPropagation()})),g.Lb(6,"icon",19),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.document),g.xb(3),g.Fc(" ",g.bc(4,4,e.fileName$)," "),g.xb(2),g.gc("tooltip",e.i18n.general.download),g.xb(1),g.gc("icon",e.SvgIcon.Download)}}function Zt(e,t){if(1&e&&(g.Ob(0,4),g.Qb(1,"label-value",5),g.Lb(2,"user-link",6),g.Pb(),g.Lb(3,"input-field",7),g.Lb(4,"textarea-field",8),g.Lb(5,"boolean-field",9),g.Lb(6,"boolean-field",10),g.Lb(7,"boolean-field",11,12),g.Bc(9,Rt,1,1,"boolean-field",13),g.Bc(10,Tt,7,6,"label-value",14),g.ac(11,"async"),g.Lb(12,"file-field",15),g.ac(13,"async"),g.Nb()),2&e){const e=g.qc(8),t=g.Zb();g.gc("formGroup",t.form),g.xb(1),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("user",t.data.user),g.xb(1),g.gc("label",t.i18n.general.name),g.xb(1),g.gc("label",t.i18n.general.description),g.xb(1),g.gc("label",t.i18n.document.enable),g.xb(1),g.gc("label",t.i18n.document.userVisible),g.xb(1),g.gc("label",t.i18n.document.brokerVisible),g.xb(2),g.gc("ngIf",e.value),g.xb(1),g.gc("ngIf",!t.create&&g.bc(11,13,t.fileName$)),g.xb(2),g.gc("required",t.create)("label",t.create||null!==g.bc(13,15,t.fileName$)?t.i18n.document.newDocument:t.i18n.document.replaceDocument)("formControl",t.fileControl)}}let Mt=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t,this.fileName$=new wt.a(null)}isOwner(){return this.authHelper.isSelf(this.data.user)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.user=e.params.user,this.id=e.params.id,this.create=null==this.id;const t=this.create?this.documentsService.getUserDocumentDataForNew({user:this.user}):this.documentsService.getDocumentDataForEdit({id:this.id});this.addSub(t.subscribe(e=>this.data=e))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(b.h))}onDataInitialized(e){var t;super.onDataInitialized(e);const i=e.document,n=e.document;this.create||this.fileName$.next(null===(t=e.file)||void 0===t?void 0:t.name),this.fileControl=this.formBuilder.control(null,this.create?h.F.required:null),this.form=this.formBuilder.group({name:[i.name,h.F.required],description:i.description,enabled:i.enabled,userVisible:i.userVisible,brokerVisible:i.brokerVisible,brokerManageable:i.brokerManageable,version:n.version})}asEdit(){return this.data}asNew(){return this.data}save(){Object(b.I)(this.form);const e=this.fileControl.value;if((this.create||e)&&Object(b.I)(this.fileControl),!this.form.valid||!this.fileControl.valid)return;const t=Object(d.a)(this.form.value);t.brokerVisible||(t.brokerManageable=!1),this.addSub(this.create?this.documentsService.createUserDocumentWithUpload({user:this.user,body:{document:t,file:e}}).subscribe(e=>this.notifySavedAndReload(e)):this.fileControl.value?this.documentsService.updateDocumentWithUpload({id:this.id,body:{document:t,file:e}}).subscribe(()=>this.notifySavedAndReload(this.id)):this.documentsService.updateDocument({id:this.id,body:t}).subscribe(()=>this.notifySavedAndReload(this.id)))}notifySavedAndReload(e){this.notification.snackBar(this.i18n.document.savedSuccessfully),this.router.navigate(["/users","documents","edit",e])}formControl(e){return this.form.get(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ft.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-document"]],features:[g.ub],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading"],[3,"formGroup",4,"ngIf"],[3,"disabled","label","action"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["fieldSize","full","required","","formControlName","name",3,"label"],["formControlName","description",3,"label"],["formControlName","enabled",3,"label"],["formControlName","userVisible",3,"label"],["formControlName","brokerVisible",3,"label"],["brokerVisible",""],["formControlName","brokerManageable",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],[3,"required","label","formControl"],["formControlName","brokerManageable",3,"label"],[3,"label"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"],[3,"icon"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.Bc(3,Zt,14,17,"ng-container",2),g.Qb(4,"actions"),g.Qb(5,"action-button",3),g.Xb("action",(function(){return t.save()})),g.ac(6,"async"),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,6,t.data$)),g.xb(2),g.gc("heading",t.create?t.i18n.document.title.new:t.i18n.document.title.edit)("mobileHeading",t.create?t.i18n.document.mobileTitle.new:t.i18n.document.mobileTitle.edit),g.xb(1),g.gc("ngIf",t.data),g.xb(2),g.gc("disabled",g.bc(6,8,t.requesting$))("label",t.i18n.general.save))},directives:[f.a,m.a,p.t,x.a,y.a,h.v,h.n,Q.a,Lt.a,Nt.a,h.C,h.u,h.l,Bt.a,v.a,kt.a,h.k,I.b,q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function _t(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).download(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.download),g.xb(1),g.gc("icon",e.SvgIcon.Download)}}function $t(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(2);return n.router.navigate(n.path(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.document.process),g.xb(1),g.gc("icon",e.SvgIcon.FileEarmarkText)}}function Ht(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",6),g.Qb(2,"div"),g.Qb(3,"label-value",7),g.Dc(4),g.Pb(),g.Qb(5,"label-value",7),g.Dc(6),g.Pb(),g.Pb(),g.Qb(7,"div",8),g.Bc(8,_t,2,2,"button",9),g.Bc(9,$t,2,2,"button",9),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.name),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("label",i.i18n.general.description),g.xb(1),g.Fc(" ",e.description," "),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind))}}function Ut(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).download(i),t.stopPropagation()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.download),g.xb(1),g.gc("icon",e.SvgIcon.Download)}}function Gt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",10),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(3);return n.router.navigate(n.path(i)),t.stopPropagation()})),g.Lb(1,"icon",11),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.document.process),g.xb(1),g.gc("icon",e.SvgIcon.FileEarmarkText)}}function qt(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",15),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.isStatic(n.kind)?a.download(n):a.router.navigate(a.path(n)),i.stopPropagation()})),g.Qb(1,"td",16),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td",17),g.Bc(6,Ut,2,2,"button",9),g.Bc(7,Gt,2,2,"button",9),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(2),g.Ec(e.description),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind))}}function Kt(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Lb(6,"th",13),g.Pb(),g.Qb(7,"tbody"),g.Bc(8,qt,8,4,"tr",14),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.general.description),g.xb(3),g.gc("ngForOf",e.data)}}function Vt(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"results-layout",3),g.Bc(4,Ht,10,6,"mobile-result",4),g.Bc(5,Kt,9,3,"table",5),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("mode","empty")("heading",e.i18n.document.title.list)("mobileHeading",e.i18n.document.mobileTitle.list)("headingActions",g.bc(2,5,e.headingActions$)),g.xb(2),g.gc("results",e.data)}}let jt=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.documentsService.listUserDocuments({user:c.a.SELF}).subscribe(e=>this.data=e))}isStatic(e){return e!==$e.t.DYNAMIC}download(e){e.file?this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(b.h)):this.notification.info(this.i18n.document.errorNoFile)}path(e){return["/users","documents","process-dynamic",e.id]}resolveMenu(){return this.menu.userMenu(null,u.b.MY_DOCUMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ft.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-documents"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Vt,6,7,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,H.a,U.a,G.a,Q.a,I.b,q.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var zt=i("OoS4"),Xt=i("bBjs"),Yt=i("Y+zs"),Wt=i("cyUc");function Jt(e,t){if(1&e&&(g.Qb(0,"label-value",6),g.Lb(1,"custom-field-input",7),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.gc("label",e.name)("kind","field")("fieldSize",n.fieldSize(e))("required",e.required)("focused",i)("labelPosition","boolean"===e.type?"sideForced":"auto"),g.xb(1),g.gc("field",e)("formControl",n.formControl(e.internalName))}}function ei(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.Bc(1,Jt,2,8,"label-value",4),g.Qb(2,"actions"),g.Qb(3,"action-button",5),g.Xb("action",(function(){return g.sc(e),g.Zb().process()})),g.ac(4,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.data.document.name)("mobileHeading",e.data.document.name),g.xb(1),g.gc("ngForOf",e.formFields),g.xb(2),g.gc("disabled",g.bc(4,5,e.requesting$))("label",e.i18n.general.submit)}}function ti(e,t){if(1&e&&(g.Qb(0,"page-content",8),g.ac(1,"async"),g.Lb(2,"div",9),g.ac(3,"trust"),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.data.document.name)("mobileHeading",e.data.document.name)("headingActions",g.bc(1,4,e.headingActions$)),g.xb(2),g.gc("innerHTML",g.bc(3,6,e.result),g.tc)}}let ii=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.fieldsHelper=t,this.documentsService=i,this.step$=new wt.a(null),this.result$=new wt.a(null)}get result(){return this.result$.value}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit(),this.documentId=this.route.snapshot.params.id,this.addSub(this.documentsService.getDataForDynamicDocument({id:this.documentId,user:c.a.SELF}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.formFields=e.formFields||[],this.form=this.fieldsHelper.customValuesFormGroup(this.formFields),this.formFields.length>0?this.step="form":this.process()}process(){Object(b.I)(this.form),this.form.valid&&this.addSub(this.documentsService.processDynamicDocument({id:this.documentId,user:c.a.SELF,body:{formFields:this.form.value}}).subscribe(e=>{this.result$.next(e);const t=[];t.push(this.exportHelper.printAction()),t[0].maybeRoot=!0,this.headingActions=t,this.step="preview"}))}formControl(e){return this.form.get(e)}fieldSize(e){return this.fieldHelper.fieldSize(e)}resolveMenu(){return this.menu.userMenu(null,u.b.MY_DOCUMENTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(zt.a),g.Kb(Ft.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["process-dynamic-document"]],features:[g.ub],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading",4,"ngSwitchCase"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[3,"heading","mobileHeading"],[3,"label","kind","fieldSize","required","focused","labelPosition",4,"ngFor","ngForOf"],[3,"disabled","label","action"],[3,"label","kind","fieldSize","required","focused","labelPosition"],["hideLabel","",3,"field","formControl"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions"],[3,"innerHTML"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.ac(2,"async"),g.Bc(3,ei,5,7,"page-content",1),g.Bc(4,ti,4,8,"page-content",2),g.Pb()),2&e&&(g.gc("ready",g.bc(1,4,t.data$))("ngSwitch",g.bc(2,6,t.step$)),g.xb(3),g.gc("ngSwitchCase","form"),g.xb(1),g.gc("ngSwitchCase","preview"))},directives:[f.a,p.x,p.y,m.a,p.s,x.a,y.a,Q.a,Xt.a,Yt.a,h.u,h.k],pipes:[p.b,Wt.a],encapsulation:2,changeDetection:0}),e})();function ni(e,t){1&e&&g.Lb(0,"div",5)}function ai(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",5),g.Qb(2,"label-value",10),g.Lb(3,"user-link",11),g.Pb(),g.Pb(),g.Bc(4,ni,1,0,"div",12),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("ngIf",e.layout.gtsm$)}}function si(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).navigateToView(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.view),g.xb(1),g.gc("icon",e.SvgIcon.Pencil)}}function oi(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",20),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).download(i),t.stopPropagation()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.download),g.xb(1),g.gc("icon",e.SvgIcon.Download)}}function ri(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(2);return n.router.navigate(n.process(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.document.process),g.xb(1),g.gc("icon",e.SvgIcon.FileEarmarkText)}}function ci(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",20),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(2).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}function li(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",13),g.Qb(2,"div"),g.Qb(3,"label-value",14),g.Dc(4),g.Pb(),g.Qb(5,"label-value",14),g.Dc(6),g.Pb(),g.Pb(),g.Qb(7,"div",15),g.Bc(8,si,2,2,"button",16),g.Bc(9,oi,2,2,"button",17),g.Bc(10,ri,2,2,"button",16),g.Bc(11,ci,2,2,"button",17),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.name),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("label",i.i18n.general.description),g.xb(1),g.Fc(" ",e.description," "),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.isUserKind(e))}}function bi(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).download(i),t.stopPropagation()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.download),g.xb(1),g.gc("icon",e.SvgIcon.Download)}}function ui(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",18),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit,n=g.Zb(3);return n.router.navigate(n.process(i)),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.document.process),g.xb(1),g.gc("icon",e.SvgIcon.FileEarmarkText)}}function di(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",28),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(3).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(1,"icon",19),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}function gi(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",24),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.isStatic(n.kind)?a.navigateToView(n):a.router.navigate(a.process(n)),i.stopPropagation(),i.preventDefault()})),g.Qb(1,"td",25),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td",26),g.Bc(6,bi,2,2,"button",16),g.Bc(7,ui,2,2,"button",16),g.Bc(8,di,2,2,"button",27),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(2),g.Ec(e.description),g.xb(2),g.gc("ngIf",i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",!i.isStatic(e.kind)),g.xb(1),g.gc("ngIf",i.data.canManageIndividual&&i.isUserKind(e))}}function fi(e,t){if(1&e&&(g.Qb(0,"table",21),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Lb(6,"th",22),g.Pb(),g.Qb(7,"tbody"),g.Bc(8,gi,9,5,"tr",23),g.ac(9,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.general.description),g.xb(3),g.gc("ngForOf",null==(i=g.bc(9,3,e.results$))?null:i.results)}}function mi(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"form",3),g.Qb(4,"div",4),g.Bc(5,ai,5,3,"ng-container",1),g.Qb(6,"div",5),g.Lb(7,"input-field",6),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"results-layout",7),g.ac(9,"async"),g.Bc(10,li,12,8,"mobile-result",8),g.Bc(11,fi,10,5,"table",9),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.document.title.search)("mobileHeading",e.i18n.document.mobileTitle.search)("headingActions",g.bc(2,8,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.authHelper.isSelf(e.data.user)),g.xb(2),g.gc("label",e.i18n.general.keywords),g.xb(1),g.gc("results",g.bc(9,10,e.results$))("rendering$",e.rendering$)}}let pi=(()=>{class e extends Fe.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.documentsService.getDocumentsDataForSearch({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=[new be.c(ue.a.PlusCircle,this.i18n.general.add,()=>{this.router.navigate(["/users",this.user,"documents","new"])},!0)]}doSearch(e){return this.documentsService.searchDocuments$Response(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.documentsService.deleteDocument({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.update()}))}toSearchParams(e){return e}getFormControlNames(){return["brokers","categories","enabled","groups","keywords","range","user"]}isStatic(e){return e!==$e.t.DYNAMIC}download(e){e.file?this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(b.h)):this.notification.info(this.i18n.document.errorNoFile)}process(e){return["/users","documents","process-dynamic",e.id]}view(e){return["/users","documents","view",e.id]}isUserKind(e){return e.kind===$e.t.USER}navigateToView(e){this.router.navigate(this.view(e))}get toProcessLink(){return e=>this.process(e)}resolveMenu(){return this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ft.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-documents"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["resultType","list",3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon mt-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"],["class","btn btn-icon ml-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,mi,12,12,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Nt.a,h.u,h.l,$.a,H.a,U.a,Q.a,Lt.a,G.a,I.b,q.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function hi(e,t){if(1&e&&(g.Qb(0,"label-value",8),g.Lb(1,"user-link",9),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function vi(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.category),g.xb(1),g.Fc(" ",e.data.category.name," ")}}function xi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.userVisible),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.userVisible)," ")}}function yi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerVisible),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.brokerVisible)," ")}}function Pi(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.brokerManageable),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.brokerManageable)," ")}}function Ii(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.document),g.xb(1),g.Fc(" ",e.data.file.name," ")}}function Ei(e,t){if(1&e&&(g.Ob(0),g.Bc(1,hi,2,2,"label-value",4),g.Qb(2,"label-value",5),g.Dc(3),g.Pb(),g.Qb(4,"label-value",5),g.Dc(5),g.Pb(),g.Bc(6,vi,2,2,"label-value",6),g.Qb(7,"label-value",5),g.Dc(8),g.Pb(),g.Bc(9,xi,2,2,"label-value",7),g.Bc(10,yi,2,2,"label-value",7),g.Bc(11,Pi,2,2,"label-value",7),g.Bc(12,Ii,2,2,"label-value",7),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("ngIf",e.data.user),g.xb(1),g.gc("label",e.i18n.general.name),g.xb(1),g.Fc(" ",e.data.name," "),g.xb(1),g.gc("label",e.i18n.general.description),g.xb(1),g.Fc(" ",e.data.description," "),g.xb(1),g.gc("ngIf",e.data.category),g.xb(1),g.gc("label",e.i18n.document.enable),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.data.enabled)," "),g.xb(1),g.gc("ngIf",e.data.userVisible),g.xb(1),g.gc("ngIf",e.data.brokerVisible),g.xb(1),g.gc("ngIf",e.data.brokerVisible),g.xb(1),g.gc("ngIf",e.data.file)}}function Ai(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",11),g.Xb("action",(function(){return g.sc(e),g.Zb().download()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("disabled",g.bc(1,2,e.requesting$))("label",e.i18n.general.download)}}let Ci=(()=>{class e extends l.a{constructor(e,t){super(e),this.documentsService=t}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.documentsService.viewDocument({id:this.id}).subscribe(e=>this.data=e))}onDataInitialized(e){if(super.onDataInitialized(e),this.dataForFrontendHolder.auth.role!==$e.pb.BROKER||e.brokerManageable){const e=[new be.c(ue.a.Pencil,this.i18n.general.edit,()=>this.navigateToEdit(),!0)];e.push(new be.c(ue.a.Trash,this.i18n.general.remove,()=>this.remove(),!0)),this.headingActions=e}}remove(){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>this.doRemove()})}doRemove(){this.addSub(this.documentsService.deleteDocument({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.router.navigate(["/users",this.data.user.id,"documents","search"])}))}download(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(b.h))}navigateToEdit(){this.router.navigate(["/users","documents","edit",this.id])}resolveMenu(e){return e.kind===$e.t.USER&&this.authHelper.isSelf(e.user)?this.menu.userMenu(null,u.b.MY_DOCUMENTS):this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ft.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-document"]],features:[g.ub],decls:7,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],["ng","",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["ng","",3,"label"],[3,"disabled","label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.ac(3,"async"),g.Bc(4,Ei,13,12,"ng-container",2),g.Qb(5,"actions"),g.Bc(6,Ai,2,4,"action-button",3),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,6,t.data$)),g.xb(2),g.gc("heading",t.i18n.document.title.view)("mobileHeading",t.i18n.document.mobileTitle.view)("headingActions",g.bc(3,8,t.headingActions$)),g.xb(2),g.gc("ngIf",t.data),g.xb(2),g.gc("ngIf",t.data.file))},directives:[f.a,m.a,p.t,x.a,Q.a,Lt.a,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Oi=i("j79m");function Si(e,t){1&e&&g.Mb(0)}function Di(e,t){if(1&e&&(g.Qb(0,"div",11),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Gc(" ",t.i18n.general.performedBy,": ",e.by.display," ")}}function Qi(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Bc(3,Di,2,2,"div",10),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("date",null==e.period?null:e.period.date),g.xb(2),g.Gc(" ",i.i18n.user.group,": ",e.group?e.group.name:i.i18n.user.operatorNoGroup," "),g.xb(1),g.gc("ngIf",e.by)}}function Fi(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"date"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,3,null==e.period?null:e.period.begin)),g.xb(3),g.Fc("",e.group?e.group.name:i.i18n.user.operatorNoGroup," "),g.xb(2),g.Ec(null==e.by?null:e.by.display)}}function wi(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,Fi,8,5,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function Li(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,Qi,4,4,"mobile-result",6),g.Bc(4,wi,10,4,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.groupMembership.title.historyOperator:e.i18n.groupMembership.title.historyUser)("mobileHeading",e.operator?e.i18n.groupMembership.mobileTitle.historyOperator:e.i18n.groupMembership.mobileTitle.historyUser),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)}}let Ni=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.groupMembershipService=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Oi.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-group-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Si,1,0,"ng-container",1),g.Pb(),g.Bc(3,Li,5,4,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,H.a,U.a,G.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function Bi(e,t){if(1&e&&g.Lb(0,"field-option",11),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function ki(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"hr"),g.Qb(2,"form",6),g.Qb(3,"single-selection-field",7),g.Bc(4,Bi,1,4,"field-option",8),g.Pb(),g.Lb(5,"textarea-field",9),g.Pb(),g.Qb(6,"actions"),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(2);g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("label",e.i18n.groupMembership.new)("required",!e.allowEmptyGroup)("emptyOption",e.allowEmptyGroup?e.i18n.user.operatorNoGroup:null),g.xb(1),g.gc("ngForOf",e.data.possibleNewGroups),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("label",e.i18n.general.submit)}}function Ri(e,t){if(1&e&&(g.Qb(0,"page-content",2),g.ac(1,"async"),g.Lb(2,"user-info",3),g.Qb(3,"label-value",4),g.Dc(4),g.Pb(),g.Bc(5,ki,8,7,"ng-container",5),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.groupMembership.title.groupOperator:e.i18n.groupMembership.title.groupUser)("mobileHeading",e.operator?e.i18n.groupMembership.mobileTitle.groupOperator:e.i18n.groupMembership.mobileTitle.groupUser)("headingActions",g.bc(1,7,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("label",e.i18n.groupMembership.current),g.xb(1),g.Fc(" ",e.data.group?e.data.group.name:e.i18n.user.operatorNoGroup," "),g.xb(1),g.gc("ngIf",e.editable)}}let Ti=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.userHelper=t,this.groupMembershipService=i}get editable(){return!Object(b.i)(this.data.possibleNewGroups)}get operator(){return this.userHelper.isOperator(this.data.user)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.allowEmptyGroup=this.userHelper.isOperator(e.user)&&!!e.group,this.form=this.formBuilder.group({group:this.allowEmptyGroup?null:[null,h.F.required],comment:null}),this.headingActions=[new be.c(ue.a.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"group","history"]),!0)]}save(){if(Object(b.I)(this.form),!this.form.valid)return;const e=this.data.possibleNewGroups.find(e=>e.id===this.form.value.group);let t,i;t=this.userHelper.isOperator(this.data.user)?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,i=e?this.i18n.groupMembership.confirm({user:this.data.user.display,group:e?e.name:this.i18n.user.operatorNoGroup}):this.i18n.groupMembership.confirmAliasOperator(this.data.user.display),this.notification.confirm({title:t,message:i,callback:()=>this.submit()})}submit(){this.addSub(this.groupMembershipService.changeGroupMembership({user:this.param,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.operator?this.i18n.groupMembership.doneOperator:this.i18n.groupMembership.doneUser),this.reload()}))}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Oi.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-group"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","group",3,"label","required","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","id","internalName","text"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ri,6,9,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,Q.a,h.H,h.v,h.n,Le.a,h.u,h.l,h.C,p.s,Bt.a,x.a,y.a,Ne.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Zi=i("fGFU");function Mi(e,t){1&e&&g.Mb(0)}function _i(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"user-info",7),g.Lb(2,"hr"),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("user",e.data.user)}}function $i(e,t){1&e&&g.Lb(0,"hr",18)}function Hi(e,t){if(1&e&&g.Lb(0,"avatar",19),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("size",64)("image",e.identityProvider.image)("icon",t.SvgIcon.PersonBadge)}}function Ui(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.Fc(" ",t.i18n.identityProvider.connectedOn(g.bc(2,1,e.linkDate))," ")}}function Gi(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",e.i18n.identityProvider.disconnected," ")}}function qi(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function Ki(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.email," ")}}const Vi=function(e){return{"mb-3":e}};function ji(e,t){if(1&e&&(g.Qb(0,"action-button",20),g.Xb("action",(function(){return t.$implicit.onClick()})),g.Pb()),2&e){const e=t.$implicit;g.gc("ngClass",g.jc(2,Vi,!t.last))("label",e.label)}}const zi=function(e){return{"mt-0":e}};function Xi(e,t){if(1&e&&(g.Ob(0),g.Bc(1,$i,1,0,"hr",9),g.Qb(2,"div",10),g.Qb(3,"div",11),g.Bc(4,Hi,1,3,"avatar",12),g.ac(5,"async"),g.Pb(),g.Qb(6,"div",13),g.Qb(7,"h2",14),g.Dc(8),g.Pb(),g.Qb(9,"div",15),g.Bc(10,Ui,3,3,"div",5),g.Bc(11,Gi,2,1,"div",5),g.Bc(12,qi,2,1,"div",5),g.Bc(13,Ki,2,1,"div",5),g.Pb(),g.Pb(),g.Qb(14,"div",16),g.Bc(15,ji,1,4,"action-button",17),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(3);g.xb(1),g.gc("ngIf",!i),g.xb(3),g.gc("ngIf",g.bc(5,9,n.layout.gtxxs$)),g.xb(3),g.gc("ngClass",g.jc(11,zi,i)),g.xb(1),g.Fc(" ",e.identityProvider.name,""),g.xb(2),g.gc("ngIf",e.linkDate),g.xb(1),g.gc("ngIf","linked"!==e.status),g.xb(1),g.gc("ngIf",e.name),g.xb(1),g.gc("ngIf",e.email),g.xb(2),g.gc("ngForOf",n.actions(e))}}function Yi(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Xi,16,13,"ng-container",8),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("ngForOf",e.data.identityProviders)}}function Wi(e,t){if(1&e&&(g.Qb(0,"page-content",4),g.Bc(1,_i,3,1,"ng-container",5),g.Bc(2,Yi,2,1,"ng-container",6),g.Pb()),2&e){const e=g.Zb(),t=g.qc(6);g.gc("heading",e.title)("mobileHeading",e.mobileTitle),g.xb(1),g.gc("ngIf",e.data.user&&!e.self),g.xb(1),g.gc("ngIf",e.data.identityProviders.length>0)("ngIfElse",t)}}function Ji(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb();g.Fc(" ",e.i18n.identityProvider.noResults,"\n")}}let en=(()=>{class e extends l.a{constructor(e,t){super(e),this.identityProvidersService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.identityProvidersService.getUserIdentityProvidersListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.title=this.self?this.i18n.identityProvider.title.manageSelf:this.i18n.identityProvider.title.manageUser,this.mobileTitle=this.self?this.i18n.identityProvider.mobileTitle.manageSelf:this.i18n.identityProvider.mobileTitle.manageUser}actions(e){const t=[];return e.status!==$e.Kb.LINKED&&this.data.canLink&&t.push(new be.a(this.i18n.identityProvider.action.connect,()=>{this.connect(e)})),e.status===$e.Kb.LINKED&&this.data.canEdit&&t.push(new be.a(this.i18n.identityProvider.action.disconnect,()=>{this.disconnect(e)})),t}connect(e){this.addSub(this.authHelper.identityProviderPopup(e.identityProvider,"link").subscribe(e=>{this.notification.snackBar(this.i18n.identityProvider.action.connectDone({name:e.name,provider:e.identityProvider.name})),this.reload()}))}disconnect(e){this.notification.confirm({title:this.i18n.identityProvider.action.disconnect,message:this.i18n.identityProvider.action.disconnectConfirm(e.identityProvider.name),callback:()=>this.doDisconnect(e)})}doDisconnect(e){const t=e.identityProvider;this.addSub(this.identityProvidersService.deleteUserIdentityProvider({user:this.param,identityProvider:t.internalName,disable:!0}).subscribe(()=>{this.notification.info(this.i18n.identityProvider.action.disconnectDone(t.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.IDENTITY_PROVIDERS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Zi.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["user-identity-providers"]],features:[g.ub],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["noResults",""],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["labelCols","2",3,"user"],[4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-xs-3","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px",3,"size","image","icon",4,"ngIf"],[1,"col-8","col-xs-9","col-md-7"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px",1,"ml-2","mr-5","management",3,"size","image","icon"],[1,"d-block","ml-auto",3,"ngClass","label","action"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Mi,1,0,"ng-container",1),g.Pb(),g.Bc(3,Wi,3,5,"ng-template",null,2,g.Cc),g.Bc(5,Ji,1,1,"ng-template",null,3,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,p.s,p.q,ke.a,y.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var tn=i("+QOm"),nn=i("dCJh"),an=i("iXUt");function sn(e,t){if(1&e&&(g.Qb(0,"label-value",9),g.Lb(1,"boolean-field",10),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.notificationSettings.forwardMessages),g.xb(1),g.gc("disabled",!e.data.editable)}}const on=function(e){return{"border-top-0":e}};function rn(e,t){if(1&e&&(g.Qb(0,"h2",14),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(2,on,!e.data.forwardMessagesAllowed)),g.xb(1),g.Fc(" ",e.i18n.notificationSettings.payments,"")}}function cn(e,t){if(1&e&&(g.Qb(0,"h3",15),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function ln(e,t){1&e&&g.Mb(0)}const bn=function(e){return{$implicit:e}};function un(e,t){if(1&e&&(g.Ob(0),g.Bc(1,rn,2,4,"h2",11),g.Ob(2,4),g.Bc(3,cn,2,1,"h3",12),g.Bc(4,ln,1,0,"ng-container",13),g.Nb(),g.Nb()),2&e){const e=t.ngIf,i=g.Zb(),n=i.first,a=i.$implicit,s=g.Zb(2),o=g.qc(4);g.xb(1),g.gc("ngIf",n),g.xb(1),g.gc("formGroup",e),g.xb(1),g.gc("ngIf",!s.singleAccount),g.xb(1),g.gc("ngTemplateOutlet",o)("ngTemplateOutletContext",g.jc(5,bn,a))}}function dn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,un,5,7,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.gc("ngIf",i.form.get("userAccounts").get(e.id))}}function gn(e,t){if(1&e&&g.Lb(0,"field-option",18),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function fn(e,t){if(1&e&&(g.Qb(0,"multi-selection-field",16),g.Bc(1,gn,1,4,"field-option",17),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.notificationSettings.forwardMessages),g.xb(1),g.gc("ngForOf",e.data.messageCategories)}}const mn=function(e){return{"section-title-action":e}},pn=function(e,t){return{"mr-3":e,"mb-2":t}};function hn(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",14),g.ac(1,"async"),g.Qb(2,"action-button",22),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(2).enableNotifications(t,!0)})),g.ac(3,"async"),g.ac(4,"async"),g.Pb(),g.Qb(5,"action-button",23),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(2).enableNotifications(t,!1)})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(10,mn,g.bc(1,4,e.layout.gtsm$))),g.xb(2),g.gc("ngClass",g.kc(12,pn,!g.bc(3,6,e.layout.ltxs$),g.bc(4,8,e.layout.ltxs$)))("label",e.i18n.notificationSettings.enableAll),g.xb(3),g.gc("label",e.i18n.notificationSettings.disableAll)}}function vn(e,t){if(1&e&&(g.Qb(0,"h2",20),g.Qb(1,"div",21),g.Dc(2),g.Pb(),g.Bc(3,hn,6,15,"div",11),g.Pb()),2&e){const e=g.Zb(),t=e.first,i=e.$implicit,n=g.Zb(2);g.gc("ngClass",g.jc(3,on,t&&0===n.data.userAccounts.length&&0===n.data.messageCategories.length&&!n.data.forwardMessagesAllowed)),g.xb(2),g.Fc(" ",i," "),g.xb(1),g.gc("ngIf",!n.adminSettings&&n.notificationSections.get(i).length>3&&n.data.editable)}}function xn(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"label-value",24),g.Lb(2,"notification-type-setting",25),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("label",i.resolveNotificationLabel(e)),g.xb(1),g.gc("setting",e)("options",i.kindFieldOptionsMap.get(e.kind))("form",i.resolveControl(e.kind))("multiSelectionControl",i.kindControlsMap.get(e.kind))("disabled",!i.data.editable)}}function yn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,vn,4,5,"h2",19),g.Bc(2,xn,3,6,"ng-container",6),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.gc("ngIf",""!==e),g.xb(1),g.gc("ngForOf",i.notificationSections.get(e))}}const Pn=function(e,t){return{count:e,total:t}};function In(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"label"),g.Dc(4),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.general.sendMedium.sms),g.xb(2),g.Ec(e.i18n.notificationSettings.smsCount(g.kc(2,Pn,e.data.smsCountThisMonth,e.data.maxSmsPerMonth)))}}function En(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",26),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("disabled",g.bc(1,2,e.requesting$))("label",e.i18n.general.save)}}function An(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",3),g.Qb(2,"form",4),g.Bc(3,sn,2,2,"label-value",5),g.Bc(4,dn,2,1,"ng-container",6),g.Bc(5,fn,2,2,"multi-selection-field",7),g.Bc(6,yn,3,2,"ng-container",6),g.Bc(7,In,5,5,"ng-container",1),g.Pb(),g.Qb(8,"actions"),g.Bc(9,En,2,4,"action-button",8),g.Pb(),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.notificationSettings.title)("mobileHeading",e.i18n.notificationSettings.mobileTitle),g.xb(1),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",e.data.forwardMessagesAllowed),g.xb(1),g.gc("ngForOf",e.data.userAccounts),g.xb(1),g.gc("ngIf",e.data.messageCategories.length>0),g.xb(1),g.gc("ngForOf",e.notificationSections.keys()),g.xb(1),g.gc("ngIf",e.data.smsAllowed),g.xb(2),g.gc("ngIf",e.data.editable)}}function Cn(e,t){if(1&e&&(g.Ob(0,4),g.Lb(1,"decimal-field",27),g.Lb(2,"decimal-field",28),g.Nb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("userAccounts").get(e.id).get("paymentAmount")),g.xb(1),g.gc("label",i.i18n.notificationSettings.paymentNotificationsAbove)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet),g.xb(1),g.gc("label",i.i18n.notificationSettings.paymentNotificationsBelow)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet)}}let On=(()=>{class e extends l.a{constructor(e,t){super(e),this.notificationSettingsService=t,this.notificationSections=new Map,this.kindControlsMap=new Map,this.kindFieldOptionsMap=new Map}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.notificationSettingsService.getNotificationSettingsDataForEdit({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){if(this.adminSettings=e.role===$e.pb.ADMINISTRATOR,this.form=this.formBuilder.group({version:e.settings.version}),this.adminSettings){if(!this.hasSettings(e))return void this.notification.info(this.i18n.notificationSettings.notAvailableSettings);this.notificationSections.set("",e.settings.notifications),this.form.addControl("forwardMessageCategories",this.formBuilder.control(e.settings.forwardMessageCategories))}e.forwardMessagesAllowed&&this.form.setControl("forwardMessages",this.formBuilder.control(e.settings.forwardMessages));const t=[],i=this.formBuilder.array([]);for(const n of e.settings.notifications){const e=this.formBuilder.group({internal:n.internal,kind:n.kind,sms:void 0===n.sms?null:n.sms,email:void 0===n.email?null:n.email});if(this.addSub(e.controls.internal.valueChanges.subscribe(()=>{this.updateControls(e)})),this.updateControls(e),i.push(e),t.push(n.kind),!this.adminSettings){const e=this.resolveSection(n.kind),t=this.notificationSections.get(e);t?t.push(n):this.notificationSections.set(e,[n])}}if(t.length>0)for(const n of t){let t,i,a;[t,i,a]=this.resolveOptions(n,e);const s=this.formBuilder.control(i);this.kindControlsMap.set(n,s),this.form.setControl(a,s),this.kindFieldOptionsMap.set(n,t)}if(this.form.setControl("notifications",i),!Object(b.i)(e.userAccounts)){this.singleAccount=1===e.userAccounts.length;const t=this.formBuilder.group({});for(const i of e.userAccounts){const n=(e.settings.userAccounts[this.ApiHelper.internalNameOrId(i)]||{}).paymentAmount||{};t.setControl(i.id,this.formBuilder.group({paymentAmount:this.formBuilder.group({min:n.min,max:n.max})}))}this.form.setControl("userAccounts",t)}}updateControls(e){e.controls.internal.value?(e.controls.sms&&e.controls.sms.enable(),e.controls.email&&e.controls.email.enable()):(e.controls.sms&&e.controls.sms.disable(),e.controls.email&&e.controls.email.disable())}save(){const e=this.notificationSettingsService.saveNotificationSettings({user:this.user,body:this.form.value});this.addSub(e.subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.notificationSettings.saved)}))}hasSettings(e){return!(Object(b.i)(e.settings.notifications)||this.adminSettings&&Object(b.i)(e.messageCategories))}resolveSection(e){return e.startsWith("account")?this.i18n.notificationSettings.accounts:e.startsWith("personal")?this.i18n.notificationSettings.personal:e.startsWith("buyer")?this.i18n.notificationSettings.marketplaceAsBuyer:e.startsWith("seller")?this.i18n.notificationSettings.marketplaceAsSeller:e.startsWith("reference")||e.startsWith("feedback")?this.i18n.notificationSettings.feedbackAndReferences:""}resolveMenu(){return this.adminSettings||this.user===this.ApiHelper.SELF?u.b.NOTIFICATIONS_SETTINGS:this.menu.searchUsersMenu()}resolveControl(e){const t=this.form.controls.notifications.controls;for(const i of t){const t=i;if(t.controls.kind.value===e)return t}return null}enableNotifications(e,t){for(const i of this.notificationSections.get(e))this.resolveControl(i.kind).controls.internal.setValue(t)}resolveNotificationLabel(e){switch(e.kind){case $e.O.ADMIN_AD_PENDING_AUTHORIZATION:return this.i18n.notification.admin.adPendingAuthorization;case $e.O.ADMIN_APPLICATION_ERROR:return this.i18n.notification.admin.applicationErrors;case $e.O.ADMIN_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.admin.externalPaymentExpired;case $e.O.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.admin.externalPaymentPerformedFailed;case $e.O.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.generatedVouchersAboutToExpire;case $e.O.ADMIN_GENERATED_VOUCHERS_EXPIRED:return this.i18n.notification.admin.generatedVouchersExpired;case $e.O.ADMIN_NETWORK_CREATED:return this.i18n.notification.admin.networkCreated;case $e.O.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.admin.paymentAwaitingAuthorization;case $e.O.ADMIN_PAYMENT_PERFORMED:return this.i18n.notification.admin.paymentPerformed;case $e.O.ADMIN_SYSTEM_ALERT:return this.i18n.notification.admin.systemAlert;case $e.O.ADMIN_USER_ALERT:return this.i18n.notification.admin.userAlert;case $e.O.ADMIN_USER_IMPORT_REGISTRATION:return"";case $e.O.ADMIN_USER_REGISTRATION:return this.i18n.notification.admin.userRegistration;case $e.O.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.voucherBuyingAboutToExpire;case $e.O.ACCOUNT_ALL_NON_SMS_PERFORMED_PAYMENTS:return this.i18n.notification.user.account.allNonSmsPerformedPayments;case $e.O.ACCOUNT_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.authorizedPaymentCanceled;case $e.O.ACCOUNT_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.authorizedPaymentDenied;case $e.O.ACCOUNT_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.authorizedPaymentExpired;case $e.O.ACCOUNT_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.authorizedPaymentSucceeded;case $e.O.ACCOUNT_BOUGHT_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.user.account.boughtVouchersAboutToExpire;case $e.O.ACCOUNT_BOUGHT_VOUCHERS_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.boughtVouchersExpirationDateChanged;case $e.O.ACCOUNT_BOUGHT_VOUCHERS_EXPIRED:return this.i18n.notification.user.account.boughtVouchersExpired;case $e.O.ACCOUNT_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.user.account.externalPaymentExpired;case $e.O.ACCOUNT_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.user.account.externalPaymentPerformedFailed;case $e.O.ACCOUNT_EXTERNAL_PAYMENT_RECEIVED_FAILED:return this.i18n.notification.user.account.externalPaymentReceivedFailed;case $e.O.ACCOUNT_INCOMING_RECURRING_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingRecurringPaymentCanceled;case $e.O.ACCOUNT_INCOMING_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingRecurringPaymentFailed;case $e.O.ACCOUNT_INCOMING_RECURRING_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingRecurringPaymentReceived;case $e.O.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingScheduledPaymentCanceled;case $e.O.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingScheduledPaymentFailed;case $e.O.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingScheduledPaymentReceived;case $e.O.ACCOUNT_LIMIT_CHANGE:return this.i18n.notification.user.account.limitChange;case $e.O.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_APPROVED_STILL_PENDING:return this.i18n.notification.user.account.operator.authorizedPaymentApprovedStillPending;case $e.O.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.operator.authorizedPaymentCanceled;case $e.O.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.operator.authorizedPaymentDenied;case $e.O.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.operator.authorizedPaymentExpired;case $e.O.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.operator.authorizedPaymentSucceeded;case $e.O.ACCOUNT_OPERATOR_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.operator.paymentAwaitingAuthorization;case $e.O.ACCOUNT_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.paymentAwaitingAuthorization;case $e.O.ACCOUNT_PAYMENT_RECEIVED:return this.i18n.notification.user.account.paymentReceived;case $e.O.ACCOUNT_PAYMENT_REQUEST_CANCELED:return this.i18n.notification.user.account.paymentRequestCanceled;case $e.O.ACCOUNT_PAYMENT_REQUEST_DENIED:return this.i18n.notification.user.account.paymentRequestDenied;case $e.O.ACCOUNT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.paymentRequestExpirationDateChanged;case $e.O.ACCOUNT_PAYMENT_REQUEST_EXPIRED:return this.i18n.notification.user.account.paymentRequestExpired;case $e.O.ACCOUNT_PAYMENT_REQUEST_PROCESSED:return this.i18n.notification.user.account.paymentRequestProcessed;case $e.O.ACCOUNT_PAYMENT_REQUEST_RECEIVED:return this.i18n.notification.user.account.paymentRequestReceived;case $e.O.ACCOUNT_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.recurringPaymentFailed;case $e.O.ACCOUNT_RECURRING_PAYMENT_OCCURRENCE_PROCESSED:return this.i18n.notification.user.account.recurringPaymentOcurrenceProcessed;case $e.O.ACCOUNT_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.scheduledPaymentFailed;case $e.O.ACCOUNT_SCHEDULED_PAYMENT_INSTALLMENT_PROCESSED:return this.i18n.notification.user.account.scheduledPaymentInstallmentProcessed;case $e.O.ACCOUNT_SCHEDULED_PAYMENT_REQUEST_FAILED:return this.i18n.notification.user.account.scheduledPaymentRequestFailed;case $e.O.ACCOUNT_SENT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.sentPaymentRequestExpirationDateChanged;case $e.O.ACCOUNT_SMS_PERFORMED_PAYMENT:return this.i18n.notification.user.account.smsPerformedPayment;case $e.O.ACCOUNT_TICKET_WEBHOOK_FAILED:return this.i18n.notification.user.account.ticketWebhookFailed;case $e.O.BROKERING_AD_PENDING_AUTHORIZATION:return this.i18n.notification.user.brokering.adPendingAuthorization;case $e.O.BROKERING_MEMBER_ASSIGNED:return this.i18n.notification.user.brokering.memberAssigned;case $e.O.BROKERING_MEMBER_UNASSIGNED:return this.i18n.notification.user.brokering.memberUnassigned;case $e.O.BUYER_AD_INTEREST_NOTIFICATION:return this.i18n.notification.user.buyer.adInterestNotification;case $e.O.BUYER_AD_QUESTION_ANSWERED:return this.i18n.notification.user.buyer.adQuestionAnswered;case $e.O.BUYER_ORDER_CANCELED:return this.i18n.notification.user.buyer.orderCanceled;case $e.O.BUYER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.buyer.orderPaymentCanceled;case $e.O.BUYER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.buyer.orderPaymentDenied;case $e.O.BUYER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.buyer.orderPaymentExpired;case $e.O.BUYER_ORDER_PENDING:return this.i18n.notification.user.buyer.orderPending;case $e.O.BUYER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.buyer.orderPendingAuthorization;case $e.O.BUYER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.buyer.orderPendingDeliveryData;case $e.O.BUYER_ORDER_PROCESSED_BY_SELLER:return this.i18n.notification.user.buyer.orderProcessedBySeller;case $e.O.BUYER_ORDER_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.orderRejectedBySeller;case $e.O.BUYER_SALE_PENDING:return this.i18n.notification.user.buyer.buyerSalePending;case $e.O.BUYER_SALE_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.buyerSaleRejectedBySeller;case $e.O.FEEDBACK_CHANGED:return this.i18n.notification.user.feedback.changed;case $e.O.FEEDBACK_CREATED:return this.i18n.notification.user.feedback.created;case $e.O.FEEDBACK_EXPIRATION_REMINDER:return this.i18n.notification.user.feedback.expirationReminder;case $e.O.FEEDBACK_OPTIONAL:return this.i18n.notification.user.feedback.optional;case $e.O.FEEDBACK_REPLY_CREATED:return this.i18n.notification.user.feedback.replyCreated;case $e.O.FEEDBACK_REQUIRED:return this.i18n.notification.user.feedback.required;case $e.O.PERSONAL_BROKER_ASSIGNED:return this.i18n.notification.user.personal.brokerAssigned;case $e.O.PERSONAL_BROKER_UNASSIGNED:return this.i18n.notification.user.personal.brokerUnassigned;case $e.O.PERSONAL_MAX_SMS_PER_MONTH_REACHED:return this.i18n.notification.user.personal.maxSmsPerMonthReached;case $e.O.PERSONAL_NEW_TOKEN:return this.i18n.notification.user.personal.newToken;case $e.O.PERSONAL_NEW_TOKEN_PENDING_ACTIVATION:return this.i18n.notification.user.personal.newTokenPendingActivation;case $e.O.PERSONAL_PASSWORD_STATUS_CHANGED:return this.i18n.notification.user.personal.passwordStatusChanged;case $e.O.PERSONAL_TOKEN_STATUS_CHANGED:return this.i18n.notification.user.personal.tokenStatusChanged;case $e.O.PERSONAL_USER_STATUS_CHANGED:return this.i18n.notification.user.personal.userStatusChanged;case $e.O.REFERENCE_CHANGED:return this.i18n.notification.user.reference.changed;case $e.O.REFERENCE_CREATED:return this.i18n.notification.user.reference.created;case $e.O.SELLER_AD_AUTHORIZED:return this.i18n.notification.user.seller.adAuthorized;case $e.O.SELLER_AD_EXPIRED:return this.i18n.notification.user.seller.adExpired;case $e.O.SELLER_AD_LOW_STOCK:return this.i18n.notification.user.seller.adLowStock;case $e.O.SELLER_AD_OUT_OF_STOCK:return this.i18n.notification.user.seller.adOutOfStock;case $e.O.SELLER_AD_QUESTION_CREATED:return this.i18n.notification.user.seller.adQuestionCreated;case $e.O.SELLER_AD_REJECTED:return this.i18n.notification.user.seller.adRejected;case $e.O.SELLER_ORDER_CANCELED:return this.i18n.notification.user.seller.orderCanceled;case $e.O.SELLER_ORDER_CREATED:return this.i18n.notification.user.seller.orderCreated;case $e.O.SELLER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.seller.orderPaymentCanceled;case $e.O.SELLER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.seller.orderPaymentDenied;case $e.O.SELLER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.seller.orderPaymentExpired;case $e.O.SELLER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.seller.orderPendingAuthorization;case $e.O.SELLER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.seller.orderPendingDeliveryData;case $e.O.SELLER_ORDER_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.orderProcessedByBuyer;case $e.O.SELLER_ORDER_REJECTED_BY_BUYER:return this.i18n.notification.user.seller.orderRejectedByBuyer;case $e.O.SELLER_SALE_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.saleProcessedByBuyer}return""}resolveOptions(e,t){let i,n,a,s,o;switch(e){case $e.O.ADMIN_EXTERNAL_PAYMENT_EXPIRED:i=t.externalPayments,n=t.settings.externalPaymentsExpired,s="externalPaymentsExpired";break;case $e.O.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:i=t.externalPayments,n=t.settings.externalPaymentsFailed,s="externalPaymentsFailed";break;case $e.O.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case $e.O.ADMIN_GENERATED_VOUCHERS_EXPIRED:i=t.voucherConfigurations,n=t.settings.voucherConfigurations,s="voucherConfigurations";break;case $e.O.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:i=t.voucherConfigurations,n=t.settings.voucherConfigurationsBuying,s="voucherConfigurationsBuying";break;case $e.O.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:i=t.authorizablePayments,n=t.settings.authorizablePayments,s="authorizablePayments";break;case $e.O.ADMIN_PAYMENT_PERFORMED:i=t.payments,n=t.settings.payments,s="payments";break;case $e.O.ADMIN_USER_REGISTRATION:i=t.userGroups,n=t.settings.userGroups,s="userGroups";break;case $e.O.ADMIN_SYSTEM_ALERT:a=Object.values($e.wb),n=t.settings.systemAlerts,s="systemAlert";break;case $e.O.ADMIN_USER_ALERT:a=Object.values($e.Jb),n=t.settings.userAlerts,s="userAlert"}return i?o=i.map(e=>({id:e.id,internalName:e.internalName,value:this.ApiHelper.internalNameOrId(e),text:e.name})):a&&(o=a.map(e=>({value:e,text:this.resolveAlertLabel(e)}))),[o,n,s]}resolveAlertLabel(e){switch(e){case $e.wb.ACCOUNT_FEE_CHARGED_NO_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedNoFailures;case $e.wb.ACCOUNT_FEE_CHARGED_WITH_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedWithFailures;case $e.wb.APPLICATION_RESTARTED:return this.i18n.systemAlert.type.applicationRestarted;case $e.wb.CUSTOM:return this.i18n.systemAlert.type.custom;case $e.wb.MAX_GLOBAL_SMS_REACHED:return this.i18n.systemAlert.type.maxGlobalSmsReached;case $e.wb.MAX_INCORRECT_LOGIN_ATTEMPTS:return this.i18n.systemAlert.type.maxIncorrectLoginAttempts;case $e.Jb.CUSTOM:return this.i18n.userAlert.type.custom;case $e.Jb.GIVEN_VERY_BAD_REFS:return this.i18n.userAlert.type.givenVeryBadRefs;case $e.Jb.INSUFFICIENT_BALANCE_FOR_INITIAL_CREDIT:return this.i18n.userAlert.type.insufficientBalanceForInitialCredit;case $e.Jb.MAX_DEVICE_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceActivationAttemptsReached;case $e.Jb.MAX_DEVICE_CONFIRMATION_CHECK_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached;case $e.Jb.MAX_TOKEN_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxTokenActivationAttemptsReached;case $e.Jb.MAX_USER_LOCALIZATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxUserLocalizationAttemptsReached;case $e.Jb.MAX_VOUCHER_REDEEM_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxVoucherRedeemAttemptsReached;case $e.Jb.MOVE_USER_AUTOMATICALLY_FAILED:return this.i18n.userAlert.type.moveUserAutomaticallyFailed;case $e.Jb.PASSWORD_DISABLED_BY_TRIES:return this.i18n.userAlert.type.passwordDisabledByTries;case $e.Jb.PASSWORD_TEMPORARILY_BLOCKED:return this.i18n.userAlert.type.passwordTemporarilyBlocked;case $e.Jb.RECEIVED_VERY_BAD_REFS:return this.i18n.userAlert.type.receivedVeryBadRefs;case $e.Jb.SCHEDULED_PAYMENT_FAILED:return this.i18n.userAlert.type.scheduledPaymentFailed}return""}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(tn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["notification-settings-form"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],[3,"heading","mobileHeading"],[3,"formGroup"],["kind","view",3,"label",4,"ngIf"],[4,"ngFor","ngForOf"],["formControlName","forwardMessageCategories",3,"label",4,"ngIf"],[3,"disabled","label","action",4,"ngIf"],["kind","view",3,"label"],["formControlName","forwardMessages","switch","",3,"disabled"],[3,"ngClass",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[1,"mt-3","mb-0"],["formControlName","forwardMessageCategories",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["class","d-flex flex-column flex-xs-row justify-content-between",3,"ngClass",4,"ngIf"],[1,"d-flex","flex-column","flex-xs-row","justify-content-between",3,"ngClass"],[1,"mb-2","mb-xs-0"],["outline","",3,"ngClass","label","action"],["outline","",3,"label","action"],["kind","field",3,"label"],[3,"setting","options","form","multiSelectionControl","disabled"],[3,"disabled","label","action"],["formControlName","min",3,"label","scale","prefix","suffix","disabled","emptyLabel"],["formControlName","max",3,"label","scale","prefix","suffix","disabled","emptyLabel"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,An,10,9,"ng-container",1),g.Pb(),g.Bc(3,Cn,3,13,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,p.s,x.a,Q.a,v.a,h.u,h.l,p.A,p.q,ht.a,Ne.a,y.a,nn.a,an.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Sn=i("a50p");function Dn(e,t){if(1&e&&(g.Qb(0,"div",7),g.Qb(1,"label-value",8),g.Lb(2,"user-link",9),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Qn(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",10),g.Dc(2),g.Pb(),g.Pb()),2&e){const e=t.$implicit;g.xb(2),g.Ec(e.name)}}function Fn(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",13),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.router.navigate(n.path(i))})),g.Qb(2,"td"),g.Qb(3,"a",14),g.Dc(4),g.Pb(),g.Pb(),g.Qb(5,"td",15),g.Qb(6,"button",16),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit;return g.Zb(3).remove(n),i.stopPropagation()})),g.Lb(7,"icon",17),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.gc("routerLink",i.path(e)),g.xb(1),g.Fc(" ",e.name," "),g.xb(2),g.gc("tooltip",i.i18n.general.removeTooltip(e.name)),g.xb(1),g.gc("icon",i.SvgIcon.Trash)}}function wn(e,t){if(1&e&&(g.Qb(0,"table",11),g.Qb(1,"tbody"),g.Bc(2,Fn,8,4,"ng-container",12),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("ngForOf",e.data.operatorGroups)}}function Ln(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,Dn,3,2,"div",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,Qn,3,1,"mobile-result",5),g.Bc(6,wn,3,1,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("mode",e.self?"empty":"filters")("heading",e.i18n.operatorGroup.title.list)("mobileHeading",e.i18n.operatorGroup.mobileTitle.list)("headingActions",g.bc(2,7,e.headingActions$)),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.operatorGroups)("toLink",e.toLink)}}let Nn=(()=>{class e extends l.a{constructor(e,t){super(e),this.operatorGroupsService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorGroupsService.getUserOperatorGroupsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.groups=e.operatorGroups,e.canCreate&&(this.headingActions=[new be.c(ue.a.PlusCircle,this.i18n.general.addNew,()=>{this.router.navigate(["/users",this.param,"operator-groups","new"])},!0)])}path(e){return["/users","operator-groups",e.id]}get toLink(){return e=>this.path(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Sn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-operator-groups"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover table-no-header cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"cell-main"],[1,"table","table-hover","table-no-header","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"actions"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ln,7,9,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,H.a,U.a,Q.a,Lt.a,G.a,p.s,a.h,I.b,q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Bn=i("vHbw");function kn(e,t){if(1&e&&(g.Qb(0,"label-value",16),g.Lb(1,"user-link",17),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Rn(e,t){1&e&&g.Mb(0)}function Tn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Rn,1,0,"ng-container",19),g.Nb()),2&e){g.Zb(3);const e=g.qc(6);g.xb(1),g.gc("ngTemplateOutlet",e)}}function Zn(e,t){if(1&e&&(g.Qb(0,"h3",9),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.Fc(" ",e.name," ")}}function Mn(e,t){1&e&&g.Mb(0)}const _n=function(e){return{$implicit:e}};function $n(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Mn,1,0,"ng-container",22),g.Nb()),2&e){const e=g.Zb(2).$implicit;g.Zb(3);const t=g.qc(4);g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.jc(2,_n,e))}}function Hn(e,t){if(1&e&&(g.Ob(0),g.Ob(1,5),g.Bc(2,Zn,2,1,"h3",20),g.Lb(3,"single-selection-field",21),g.Bc(4,$n,2,4,"ng-container",1),g.Nb(),g.Nb()),2&e){const e=t.ngIf,i=g.Zb(4);g.xb(1),g.gc("formGroup",e),g.xb(1),g.gc("ngIf",!i.singleAccount),g.xb(1),g.gc("label",i.i18n.operatorGroup.accountAccess)("fieldOptions",i.accountAccessOptions),g.xb(1),g.gc("ngIf","none"!==e.value.access)}}function Un(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Hn,5,5,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",i.form.get("accounts").get(e.id))}}function Gn(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",9),g.Dc(2),g.ac(3,"async"),g.Pb(),g.Bc(4,Tn,2,1,"ng-container",1),g.Bc(5,Un,2,1,"ng-container",18),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc("",g.bc(3,3,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.accountAccess:e.i18n.operatorGroup.title.accountAccess," "),g.xb(2),g.gc("ngIf",!e.singleAccount),g.xb(1),g.gc("ngForOf",e.data.accountTypes)}}function qn(e,t){if(1&e&&g.Lb(0,"boolean-field",23),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.notifications)}}function Kn(e,t){if(1&e&&g.Lb(0,"boolean-field",24),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.viewAdvertisements)}}function Vn(e,t){if(1&e&&g.Lb(0,"field-option",27),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function jn(e,t){if(1&e&&(g.Qb(0,"multi-selection-field",25),g.Bc(1,Vn,1,4,"field-option",26),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.runOperations),g.xb(1),g.gc("ngForOf",e.data.operations)}}function zn(e,t){if(1&e&&g.Lb(0,"boolean-field",28),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.brokering)}}function Xn(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",4),g.ac(2,"async"),g.Qb(3,"form",5),g.Bc(4,kn,2,2,"label-value",6),g.Lb(5,"input-field",7),g.Lb(6,"textarea-field",8),g.Bc(7,Gn,6,5,"ng-container",1),g.Qb(8,"h2",9),g.Dc(9),g.ac(10,"async"),g.Pb(),g.Lb(11,"boolean-field",10),g.Bc(12,qn,1,1,"boolean-field",11),g.Bc(13,Kn,1,1,"boolean-field",12),g.Bc(14,jn,2,2,"multi-selection-field",13),g.Bc(15,zn,1,1,"boolean-field",14),g.Pb(),g.Qb(16,"actions"),g.Qb(17,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(18,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.create?e.i18n.operatorGroup.title.new:e.i18n.operatorGroup.title.edit)("mobileHeading",e.create?e.i18n.operatorGroup.mobileTitle.new:e.i18n.operatorGroup.mobileTitle.edit)("headingActions",g.bc(2,16,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("label",e.i18n.general.name),g.xb(1),g.gc("label",e.i18n.general.description),g.xb(1),g.gc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>0),g.xb(2),g.Fc("",g.bc(10,18,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.permissions:e.i18n.operatorGroup.title.permissions," "),g.xb(2),g.gc("label",e.i18n.operatorGroup.editOwnProfile),g.xb(1),g.gc("ngIf",e.data.canHaveNotifications),g.xb(1),g.gc("ngIf",e.data.canViewAdvertisements),g.xb(1),g.gc("ngIf",(null==e.data.operations?null:e.data.operations.length)>0),g.xb(1),g.gc("ngIf",e.data.broker),g.xb(2),g.gc("disabled",g.bc(18,20,e.requesting$))("label",e.i18n.general.save)}}function Yn(e,t){1&e&&g.Mb(0)}function Wn(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Yn,1,0,"ng-container",19),g.Nb()),2&e){g.Zb(2);const e=g.qc(6);g.xb(1),g.gc("ngTemplateOutlet",e)}}function Jn(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"hr",36),g.Qb(2,"h4",37),g.Dc(3),g.Pb(),g.Nb()),2&e){const e=g.Zb().$implicit;g.xb(3),g.Ec(e.name)}}function ea(e,t){if(1&e&&(g.Ob(0,5),g.Bc(1,Jn,4,1,"ng-container",1),g.Lb(2,"boolean-field",32),g.Lb(3,"boolean-field",33),g.Lb(4,"decimal-field",34),g.Lb(5,"boolean-field",35),g.Nb()),2&e){const e=t.$implicit,n=g.Zb().$implicit,a=g.Zb();var i;g.gc("formGroup",a.form.get("payments").get(e.id)),g.xb(1),g.gc("ngIf",(null==(i=a.paymentTypes(n))?null:i.length)>1),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPayments),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPaymentsRequiresAuthorization),g.xb(1),g.gc("label",a.i18n.operatorGroup.performPaymentsMaxAmountPerDay)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("label",a.i18n.operatorGroup.authorizePayments)}}function ta(e,t){if(1&e&&(g.Ob(0,5),g.Lb(1,"decimal-field",29),g.Lb(2,"decimal-field",30),g.Nb(),g.Bc(3,Wn,2,1,"ng-container",1),g.Bc(4,ea,6,9,"ng-container",31)),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("accounts").get(e.id).get("notificationAmount")),g.xb(1),g.gc("label",i.i18n.operatorGroup.paymentNotificationsAbove)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("label",i.i18n.operatorGroup.paymentNotificationsBelow)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),g.xb(1),g.gc("ngIf",i.singleAccount),g.xb(1),g.gc("ngForOf",i.paymentTypes(e))}}function ia(e,t){if(1&e&&g.Lb(0,"boolean-field",40),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.chargebackPayments)}}function na(e,t){if(1&e&&(g.Ob(0,5),g.Bc(1,ia,1,1,"boolean-field",38),g.Lb(2,"multiple-users-field",39),g.Nb()),2&e){const e=g.Zb();g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",e.data.canChargebackPayments),g.xb(1),g.gc("label",e.i18n.operatorGroup.restrictPaymentsToUsers)("preselectedUsers",e.restrictPaymentsToUsers)}}let aa=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorGroupsService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null!=this.user;const e=this.create?this.operatorGroupsService.getOperatorGroupDataForNew({user:this.user}):this.operatorGroupsService.getOperatorGroupDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}));const t=Object(b.j)($e.U);this.accountAccessOptions=t.map(e=>({value:e,text:this.userHelper.operatorGroupAccountAccess(e)}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.operatorGroup;if(this.form=this.formBuilder.group({name:[t.name,h.F.required],description:t.description}),!Object(b.i)(e.accountTypes)){this.singleAccount=1===e.accountTypes.length;const i=this.formBuilder.group({});for(const n of e.accountTypes){const e=t.accounts[n.id]||t.accounts[n.internalName]||{},a=e.notificationAmount||{};i.setControl(n.id,this.formBuilder.group({access:[e.access||$e.U.NONE,h.F.required],notificationAmount:this.formBuilder.group({min:a.min,max:a.max})}))}this.form.setControl("accounts",i)}if(!Object(b.i)(e.paymentTypes)){const i=this.formBuilder.group({});for(const n of e.paymentTypes){const e=t.payments[n.id]||t.payments[n.internalName]||{};i.setControl(n.id,this.formBuilder.group({perform:e.perform,maxAmountPerDay:e.maxAmountPerDay,requiresAuthorization:e.requiresAuthorization,authorize:e.authorize}))}this.form.setControl("payments",i)}this.form.addControl("editOwnProfile",new h.j(t.editOwnProfile)),this.form.addControl("restrictPaymentsToUsers",new h.j(t.restrictPaymentsToUsers)),e.canHaveNotifications&&this.form.addControl("notifications",new h.j(t.notifications)),e.canChargebackPayments&&this.form.addControl("chargebackPayments",new h.j(t.chargebackPayments)),e.canViewAdvertisements&&this.form.addControl("viewAdvertisements",new h.j(t.viewAdvertisements)),e.broker&&this.form.addControl("brokering",new h.j(t.brokering)),Object(b.i)(e.operations)||this.form.addControl("operations",new h.j(t.operations)),t.version&&this.form.addControl("version",new h.j(t.version))}paymentTypes(e){return(this.data.paymentTypes||[]).filter(t=>t.from.id===e.id)}save(){if(Object(b.I)(this.form),!this.form.valid)return;const e=this.form.value,t=this.create?this.operatorGroupsService.createOperatorGroup({user:this.user,body:e}):this.operatorGroupsService.updateOperatorGroup({id:this.id,body:e});this.addSub(t.subscribe(e=>{this.notification.snackBar(this.create?this.i18n.operatorGroup.created:this.i18n.operatorGroup.saved),this.router.navigate(["/users","operator-groups",e||this.id])}))}get restrictPaymentsToUsers(){return this.data.restrictPaymentsToUsers}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Sn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["operator-group-form"]],features:[g.ub],decls:7,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],["generalAccounts",""],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["mode","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","description",3,"label"],[1,"mt-3","mb-0"],["formControlName","editOwnProfile",3,"label"],["formControlName","notifications",3,"label",4,"ngIf"],["formControlName","viewAdvertisements",3,"label",4,"ngIf"],["formControlName","operations",3,"label",4,"ngIf"],["formControlName","brokering",3,"label",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],["mode","fieldView",3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],["class","mt-3 mb-0",4,"ngIf"],["formControlName","access","required","",3,"label","fieldOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","notifications",3,"label"],["formControlName","viewAdvertisements",3,"label"],["formControlName","operations",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","brokering",3,"label"],["formControlName","min",3,"label","scale","prefix","suffix"],["formControlName","max",3,"label","scale","prefix","suffix"],[3,"formGroup",4,"ngFor","ngForOf"],["formControlName","perform",3,"label"],["formControlName","requiresAuthorization",3,"label"],["formControlName","maxAmountPerDay",3,"label","scale","prefix","suffix"],["formControlName","authorize",3,"label"],[1,"inner-separator"],[1,"mt-3","mb-2"],["formControlName","chargebackPayments",3,"label",4,"ngIf"],["formControlName","restrictPaymentsToUsers",3,"label","preselectedUsers"],["formControlName","chargebackPayments",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Xn,19,22,"ng-container",1),g.Pb(),g.Bc(3,ta,5,11,"ng-template",null,2,g.Cc),g.Bc(5,na,3,4,"ng-template",null,3,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Nt.a,h.u,h.l,h.C,Bt.a,v.a,x.a,y.a,Q.a,Lt.a,p.s,p.A,Le.a,ht.a,Ne.a,an.a,Bn.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var sa=i("I9hm");function oa(e,t){if(1&e&&(g.Qb(0,"label-value",9),g.Lb(1,"user-link",10),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.group.user)}}function ra(e,t){if(1&e&&g.Lb(0,"label-value",11),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.description)("value",e.group.description)}}function ca(e,t){if(1&e&&(g.Qb(0,"h3",12),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.accountType.name," ")}}function la(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Nb()),2&e){const e=g.Zb(6);g.xb(1),g.Ec(e.i18n.operatorGroup.performPaymentsRequiresAuthorizationView)}}function ba(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.ac(2,"currency"),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb(5);g.xb(1),g.Ec(t.i18n.operatorGroup.performPaymentsMaxAmountPerDayView(g.cc(2,1,e.maxAmountPerDay,e.paymentType.currency)))}}function ua(e,t){1&e&&g.Lb(0,"br")}function da(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,la,2,1,"ng-container",1),g.Bc(3,ba,3,4,"ng-container",1),g.Bc(4,ua,1,0,"br",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.paymentType.name,""),g.xb(1),g.gc("ngIf",e.requiresAuthorization),g.xb(1),g.gc("ngIf",e.maxAmountPerDay),g.xb(1),g.gc("ngIf",!i)}}function ga(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,da,5,4,"ng-container",13),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.performPayments),g.xb(1),g.gc("ngForOf",t.paymentsByAccount[e.accountType.id])}}function fa(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function ma(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,fa,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.name,""),g.xb(1),g.gc("ngIf",!i)}}function pa(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,ma,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.authorizePayments),g.xb(1),g.gc("ngForOf",t.authorizeByAccount[e.accountType.id])}}const ha=function(e,t){return{min:e,max:t}};function va(e,t){if(1&e&&(g.Lb(0,"label-value",4),g.ac(1,"currency"),g.ac(2,"currency")),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.operatorGroup.paymentNotifications)("value",t.format.formatRange(g.kc(8,ha,g.cc(1,2,e.notificationAmount.min,e.accountType.currency),g.cc(2,5,e.notificationAmount.max,e.accountType.currency))))}}function xa(e,t){if(1&e&&(g.Ob(0),g.Bc(1,ca,2,1,"h3",6),g.Lb(2,"label-value",4),g.Bc(3,ga,2,2,"label-value",8),g.Bc(4,pa,2,2,"label-value",8),g.Bc(5,va,3,11,"label-value",7),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",!i.singleAccount),g.xb(1),g.gc("label",i.i18n.operatorGroup.accountAccess)("value",i.userHelper.operatorGroupAccountAccess(e.access)),g.xb(1),g.gc("ngIf",(null==i.paymentsByAccount[e.accountType.id]?null:i.paymentsByAccount[e.accountType.id].length)>0),g.xb(1),g.gc("ngIf",(null==i.authorizeByAccount[e.accountType.id]?null:i.authorizeByAccount[e.accountType.id].length)>0),g.xb(1),g.gc("ngIf",(null==e.notificationAmount?null:e.notificationAmount.min)||(null==e.notificationAmount?null:e.notificationAmount.max))}}function ya(e,t){if(1&e&&(g.Qb(0,"h3",12),g.Dc(1),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",g.bc(2,1,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.generalAccount:e.i18n.operatorGroup.title.generalAccount," ")}}function Pa(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(4);g.gc("label",e.i18n.operatorGroup.chargebackPayments)("value",e.i18n.general.yes)}}function Ia(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function Ea(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,Ia,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Fc(" ",e.display,""),g.xb(1),g.gc("ngIf",!i)}}function Aa(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,Ea,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.operatorGroup.restrictPaymentsToUsers),g.xb(1),g.gc("ngForOf",e.group.restrictPaymentsToUsers)}}function Ca(e,t){if(1&e&&(g.Ob(0),g.Bc(1,ya,3,3,"h3",6),g.Bc(2,Pa,1,2,"label-value",7),g.Bc(3,Aa,2,2,"label-value",8),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",!e.singleAccount),g.xb(1),g.gc("ngIf",e.group.chargebackPayments),g.xb(1),g.gc("ngIf",(null==e.group.restrictPaymentsToUsers?null:e.group.restrictPaymentsToUsers.length)>0)}}function Oa(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",12),g.Dc(2),g.ac(3,"async"),g.Pb(),g.Bc(4,xa,6,6,"ng-container",13),g.Bc(5,Ca,4,3,"ng-container",1),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc("",g.bc(3,3,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.accountAccess:e.i18n.operatorGroup.title.accountAccess," "),g.xb(2),g.gc("ngForOf",e.visibleAccounts),g.xb(1),g.gc("ngIf",(null==e.group.restrictPaymentsToUsers?null:e.group.restrictPaymentsToUsers.length)>0||e.group.chargebackPayments)}}function Sa(e,t){if(1&e&&(g.Qb(0,"h2",12),g.Dc(1),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.Fc("",g.bc(2,1,e.layout.ltsm$)?e.i18n.operatorGroup.mobileTitle.permissions:e.i18n.operatorGroup.title.permissions," ")}}function Da(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.editOwnProfile)("value",e.i18n.general.yes)}}function Qa(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.notifications)("value",e.i18n.general.yes)}}function Fa(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.viewAdvertisements)("value",e.i18n.general.yes)}}function wa(e,t){1&e&&(g.Ob(0),g.Dc(1,", "),g.Nb())}function La(e,t){if(1&e&&(g.Ob(0),g.Dc(1),g.Bc(2,wa,2,0,"ng-container",1),g.Nb()),2&e){const e=t.$implicit,i=t.last;g.xb(1),g.Ec(e.name),g.xb(1),g.gc("ngIf",!i)}}function Na(e,t){if(1&e&&(g.Qb(0,"label-value",14),g.Bc(1,La,3,2,"ng-container",13),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.runOperations),g.xb(1),g.gc("ngForOf",e.group.operations)}}function Ba(e,t){if(1&e&&g.Lb(0,"label-value",4),2&e){const e=g.Zb(2);g.gc("label",e.i18n.operatorGroup.brokering)("value",e.i18n.general.yes)}}function ka(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,oa,2,2,"label-value",3),g.Lb(4,"label-value",4),g.Bc(5,ra,1,2,"label-value",5),g.Bc(6,Oa,6,5,"ng-container",1),g.Bc(7,Sa,3,3,"h2",6),g.Bc(8,Da,1,2,"label-value",7),g.Bc(9,Qa,1,2,"label-value",7),g.Bc(10,Fa,1,2,"label-value",7),g.Bc(11,Na,2,2,"label-value",8),g.Bc(12,Ba,1,2,"label-value",7),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.operatorGroup.title.view)("mobileHeading",e.i18n.operatorGroup.mobileTitle.view)("headingActions",g.bc(2,14,e.headingActions$)),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("label",e.i18n.general.name)("value",e.group.name),g.xb(1),g.gc("ngIf",e.group.description),g.xb(1),g.gc("ngIf",(null==e.visibleAccounts?null:e.visibleAccounts.length)>0),g.xb(1),g.gc("ngIf",e.group.editOwnProfile||e.group.notifications||e.group.viewAdvertisements||e.group.brokering||(null==e.group.operations?null:e.group.operations.length)>0),g.xb(1),g.gc("ngIf",e.group.editOwnProfile),g.xb(1),g.gc("ngIf",e.group.notifications),g.xb(1),g.gc("ngIf",e.group.viewAdvertisements),g.xb(1),g.gc("ngIf",(null==e.group.operations?null:e.group.operations.length)>0),g.xb(1),g.gc("ngIf",e.group.brokering)}}let Ra=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorGroupsService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.operatorGroupsService.viewOperatorGroup({id:this.id}).subscribe(e=>{this.data=e}))}get group(){return this.data}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user);const t=e.accounts||[];this.visibleAccounts=t.filter(e=>e.access!==$e.U.NONE),this.singleAccount=1===t.length,this.paymentsByAccount={},this.authorizeByAccount={};const i=e.payments||[];for(const n of this.visibleAccounts)this.paymentsByAccount[n.accountType.id]=i.filter(e=>e.perform&&e.paymentType.from.id===n.accountType.id),this.authorizeByAccount[n.accountType.id]=i.filter(e=>e.authorize&&e.paymentType.from.id===n.accountType.id).map(e=>e.paymentType);if(e.canEdit){const e=[new be.c(ue.a.Pencil,this.i18n.general.edit,()=>{this.router.navigateByUrl(this.router.url+"/edit")},!0)];this.layout.ltsm&&e.push(new be.c(ue.a.Trash,this.i18n.general.remove,()=>this.remove())),this.headingActions=e}}remove(){this.notification.confirm({message:this.i18n.general.removeConfirm(this.group.name),callback:()=>this.doRemove()})}doRemove(){this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.group.name)),this.router.navigate(["users",this.authHelper.orSelf(this.group.user),"operator-groups"])}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.OPERATOR_GROUPS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Sn.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-operator-group"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],["valueFormat","break",3,"label","value",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],["valueFormat","break",3,"label","value"],[1,"mt-3","mb-0"],[4,"ngFor","ngForOf"],[3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,ka,13,16,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Q.a,Lt.a,p.s],pipes:[p.b,sa.a],encapsulation:2,changeDetection:0}),e})();var Ta=i("yFKC");function Za(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"user-link",16),g.Pb()),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.operatorOwner),g.xb(1),g.gc("user",e.data.user)}}function Ma(e,t){if(1&e&&g.Lb(0,"field-option",19),2&e){const e=t.$implicit,i=g.Zb(4);g.gc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function _a(e,t){if(1&e&&(g.Qb(0,"single-selection-field",17),g.Bc(1,Ma,1,4,"field-option",18),g.Pb()),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.group)("emptyOption",e.i18n.user.operatorNoGroup),g.xb(1),g.gc("ngForOf",e.data.groups)}}function $a(e,t){if(1&e&&g.Lb(0,"input-field",20),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.name)}}function Ha(e,t){if(1&e&&g.Lb(0,"input-field",21),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.username)}}function Ua(e,t){if(1&e&&g.Lb(0,"input-field",24),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.email)("required",e.data.emailRequired)}}function Ga(e,t){if(1&e&&g.Lb(0,"boolean-field",25),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.registration.skipActivationEmail)}}function qa(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ua,1,2,"input-field",22),g.Bc(2,Ga,1,1,"boolean-field",23),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",e.canEdit("email")),g.xb(1),g.gc("ngIf",e.data.allowSetSendActivationEmail)}}function Ka(e,t){if(1&e&&(g.Qb(0,"label-value",28),g.Lb(1,"custom-field-input",29),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",e.name)("kind","field")("fieldSize",t.fieldSize(e))("required",e.required)("labelPosition","boolean"===e.type?"sideForced":"auto"),g.xb(1),g.gc("field",e)("formControlName",e.internalName)}}function Va(e,t){if(1&e&&(g.Ob(0,26),g.Bc(1,Ka,2,7,"label-value",27),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e))}}function ja(e,t){if(1&e&&(g.Ob(0,26),g.Lb(1,"input-field",30),g.Nb()),2&e){const e=g.Zb(3);g.gc("formGroup",e.mobileForm),g.xb(1),g.gc("label",e.i18n.phone.mobile)("required","required"===e.mobileAvailability)("placeholder",e.data.phoneConfiguration.mobileExample)}}function za(e,t){if(1&e&&g.Lb(0,"input-field",32),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.extension)}}function Xa(e,t){if(1&e&&(g.Ob(0,26),g.Lb(1,"input-field",30),g.Bc(2,za,1,1,"input-field",31),g.Nb()),2&e){const e=g.Zb(3);g.gc("formGroup",e.landLineForm),g.xb(1),g.gc("label",e.i18n.phone.landLine)("required","required"===e.data.phoneConfiguration.landLineAvailability)("placeholder",e.data.phoneConfiguration.landLineExample),g.xb(1),g.gc("ngIf",e.data.phoneConfiguration.extensionEnabled)}}function Ya(e,t){if(1&e&&(g.Qb(0,"div",35),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(e.description)}}function Wa(e,t){if(1&e&&g.Lb(0,"boolean-field",36),2&e){const e=g.Zb(4);g.gc("label",e.i18n.user.registration.passwordAssign)}}function Ja(e,t){if(1&e&&g.Lb(0,"boolean-field",40),2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.registration.passwordForceChange)}}function es(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"input-field",37),g.Lb(2,"input-field",38),g.Bc(3,Ja,1,1,"boolean-field",39),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.gc("label",e.name),g.xb(1),g.gc("label",t.i18n.user.passwordConfirmation(e.name)),g.xb(1),g.gc("ngIf",e.canForceChange)}}function ts(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Ob(3,26),g.Bc(4,Ya,2,1,"div",33),g.Bc(5,Wa,1,1,"boolean-field",34),g.Bc(6,es,4,3,"ng-container",10),g.Nb(),g.Nb()),2&e){const e=t.$implicit,i=t.index,n=g.Zb(3);g.xb(2),g.Ec(e.name),g.xb(1),g.gc("formGroup",n.passwordForms[i]),g.xb(1),g.gc("ngIf",e.description),g.xb(1),g.gc("ngIf",n.login.user),g.xb(1),g.gc("ngIf",n.passwordForms[i].get("defined").value)}}function is(e,t){if(1&e){const e=g.Rb();g.Qb(0,"form",5),g.Bc(1,Za,2,2,"label-value",6),g.Bc(2,_a,2,3,"single-selection-field",7),g.Bc(3,$a,1,1,"input-field",8),g.Bc(4,Ha,1,1,"input-field",9),g.Bc(5,qa,3,2,"ng-container",10),g.Bc(6,Va,2,2,"ng-container",11),g.Bc(7,ja,2,4,"ng-container",12),g.Bc(8,Xa,3,5,"ng-container",12),g.Bc(9,ts,7,5,"ng-container",13),g.Qb(10,"actions"),g.Qb(11,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb(2).register()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.self),g.xb(1),g.gc("ngIf",e.data.groups.length>0),g.xb(1),g.gc("ngIf",e.canEdit("name")),g.xb(1),g.gc("ngIf",e.canEdit("username")),g.xb(1),g.gc("ngIf",e.canEdit("email")),g.xb(1),g.gc("ngForOf",e.data.customFields),g.xb(1),g.gc("ngIf","disabled"!==e.mobileAvailability),g.xb(1),g.gc("ngIf","disabled"!==e.landLineAvailability),g.xb(1),g.gc("ngForOf",e.data.passwordTypes),g.xb(2),g.gc("label",e.i18n.general.submit)}}function ns(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,is,12,11,"form",4),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb(),t=g.qc(4);g.gc("heading",e.i18n.user.title.operatorRegistration)("mobileHeading",e.i18n.user.mobileTitle.operatorRegistration),g.xb(1),g.gc("ngIf",null==g.bc(2,4,e.result$))("ngIfElse",t)}}function as(e,t){if(1&e){const e=g.Rb();g.Lb(0,"p",41),g.ac(1,"trust"),g.Qb(2,"actions",42),g.Qb(3,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb().reload()})),g.Pb(),g.Qb(4,"action-button",14),g.Xb("action",(function(){return g.sc(e),g.Zb().viewProfile()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("innerHTML",g.bc(1,3,e.doneMessageHtml),g.tc),g.xb(3),g.gc("label",e.i18n.user.operatorRegistrationAddAnother),g.xb(1),g.gc("label",e.i18n.user.registration.viewProfile)}}let ss=(()=>{class e extends l.a{constructor(e,t,i){super(e),this.userHelper=t,this.operatorsService=i,this.result$=new wt.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.user),this.addSub(this.operatorsService.getOperatorDataForNew({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){this.form=this.formBuilder.group({group:null}),[this.mobileForm,this.landLineForm]=this.userHelper.setupRegistrationForm(this.form,e,!1),this.passwordForms=this.userHelper.passwordRegistrationForms(e),this.editableFields=this.userHelper.fieldNamesByAction(e,"edit")}canEdit(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}get mobileAvailability(){return this.data.phoneConfiguration.mobileAvailability}get landLineAvailability(){return this.data.phoneConfiguration.landLineAvailability}register(){const e=Object(b.e)(this.form);if(this.mobileForm&&e.setControl("mobilePhones",new h.g([this.mobileForm])),this.landLineForm&&e.setControl("landLinePhones",new h.g([this.landLineForm])),e.setControl("passwords",new h.g(this.passwordForms)),!Object(b.I)(e))return;const t=e.value;t.mobilePhones=t.mobilePhones.filter(e=>!Object(b.i)(e.number)),t.landLinePhones=t.landLinePhones.filter(e=>!Object(b.i)(e.number)),this.addSub(this.operatorsService.registerOperator({user:this.user,body:t}).subscribe(e=>this.result$.next(e)))}get doneMessageHtml(){const e=this.result$.value;if(!e)return null;const t=e.user.display;switch(e.status){case $e.Ob.ACTIVE:return this.i18n.user.operatorRegistrationActive(t);case $e.Ob.INACTIVE:return this.i18n.user.operatorRegistrationInactive(t);case $e.Ob.EMAIL_VALIDATION:return this.i18n.user.operatorRegistrationPending(t)}}viewProfile(){const e=this.result$.value;e&&this.router.navigate(["users",e.user.id,"profile"])}fieldSize(e){return this.fieldHelper.fieldSize(e)}resolveMenu(e){return this.menu.userMenu(e.user,u.b.MY_OPERATORS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Ta.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["operator-registration"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading",4,"ngIf"],["done",""],["last","",3,"heading","mobileHeading"],["autocomplete","off",3,"formGroup",4,"ngIf","ngIfElse"],["autocomplete","off",3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","group",3,"label","emptyOption",4,"ngIf"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label","action"],[3,"label"],[3,"user"],["formControlName","group",3,"label","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["formControlName","email",3,"label","required",4,"ngIf"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["formControlName","email",3,"label","required"],["formControlName","skipActivationEmail",3,"label"],[3,"formGroup"],[3,"label","kind","fieldSize","required","labelPosition",4,"ngIf"],[3,"label","kind","fieldSize","required","labelPosition"],["hideLabel","",3,"field","formControlName"],["formControlName","number",3,"label","required","placeholder"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],[3,"innerHTML"],["forceRow",""]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,ns,3,6,"page-content",1),g.Bc(3,as,5,5,"ng-template",null,2,g.Cc),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,p.s,x.a,y.a,Q.a,Lt.a,Le.a,h.u,h.l,Ne.a,Nt.a,h.C,v.a,Yt.a],pipes:[p.b,Wt.a],encapsulation:2,changeDetection:0}),e})();var os=i("TFmz"),rs=i("qCwG"),cs=(i("Ky6R"),i("7nZW")),ls=i("XvX2"),bs=i("5Wk5"),us=i("oOvo"),ds=i("IJ5G");const gs=function(e,t){return{"cell-main":e,"cell-text":t}};function fs(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",8),g.Lb(2,"format-field-value",9),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb().$implicit,a=g.Zb();g.xb(1),g.gc("ngClass",g.kc(6,gs,i,!i)),g.xb(1),g.gc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",a.user(n))("customValues",a.customValues(n))}}function ms(e,t){if(1&e&&(g.Qb(0,"div",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb();g.xb(1),g.Fc(" ",t.operatorGroup(e)," ")}}function ps(e,t){if(1&e&&(g.Qb(0,"mobile-result",5),g.Bc(1,fs,3,9,"ng-container",6),g.Bc(2,ms,2,1,"div",7),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("avatarImage",i.user(e).image)("avatarIcon","operator"===i.resultKind?null:i.SvgIcon.Person),g.xb(1),g.gc("ngForOf",i.fieldsInTile),g.xb(1),g.gc("ngIf","operator"===i.resultKind)}}function hs(e,t){1&e&&g.Lb(0,"th",15)}function vs(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(1),g.Ec(i.fieldName(e))}}function xs(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.Ec(e.i18n.user.group)}}function ys(e,t){if(1&e&&(g.Qb(0,"td",15),g.Lb(1,"avatar",17),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.gc("image",t.user(e).image)}}function Ps(e,t){if(1&e&&(g.Qb(0,"td"),g.Lb(1,"format-field-value",9),g.Pb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(2);g.xb(1),g.gc("fields",n.data.customFields)("plainText",!0)("fieldName",e)("object",n.user(i))("customValues",n.customValues(i))}}function Is(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Ec(t.operatorGroup(e))}}function Es(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",16),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(2);return n.canViewProfile?n.router.navigate(n.path(i)):null})),g.Bc(1,ys,2,1,"td",12),g.Bc(2,Ps,2,5,"td",6),g.Bc(3,Is,2,1,"td",13),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("ngIf","operator"!==e.resultKind),g.xb(1),g.gc("ngForOf",e.fieldsInList),g.xb(1),g.gc("ngIf","operator"===e.resultKind)}}const As=function(e){return{"cursor-pointer":e}};function Cs(e,t){if(1&e&&(g.Qb(0,"table",11),g.Qb(1,"thead"),g.Bc(2,hs,1,0,"th",12),g.Bc(3,vs,2,1,"th",6),g.Bc(4,xs,2,1,"th",13),g.Pb(),g.Qb(5,"tbody"),g.Bc(6,Es,4,3,"tr",14),g.Pb(),g.Pb()),2&e){const e=g.Zb();g.gc("ngClass",g.jc(5,As,e.canViewProfile)),g.xb(2),g.gc("ngIf","operator"!==e.resultKind),g.xb(1),g.gc("ngForOf",e.fieldsInList),g.xb(1),g.gc("ngIf","operator"===e.resultKind),g.xb(2),g.gc("ngForOf",null==e.results?null:e.results.results)}}function Os(e,t){if(1&e&&(g.Qb(0,"div",8),g.Qb(1,"format-field-value",20),g.Dc(2," \xa0 "),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb().$implicit,a=g.Zb();g.gc("ngClass",i?"card-title":"card-text"),g.xb(1),g.gc("fields",a.data.customFields)("fieldName",e)("object",a.user(n))("customValues",a.customValues(n))}}function Ss(e,t){if(1&e&&(g.Qb(0,"tiled-result",18),g.Bc(1,Os,3,5,"div",19),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("image",i.user(e).image)("icon",i.SvgIcon.PersonCircle),g.xb(1),g.gc("ngForOf",i.fieldsInTile)}}const Ds=function(e,t){return{"font-weight-bold":e,"mb-2":t}};function Qs(e,t){if(1&e&&(g.Qb(0,"div",8),g.Lb(1,"format-field-value",9),g.Pb()),2&e){const e=t.$implicit,i=t.first,n=t.last,a=g.Zb().$implicit,s=g.Zb();g.gc("ngClass",g.kc(6,Ds,i,n)),g.xb(1),g.gc("fields",s.data.customFields)("plainText",!0)("fieldName",e)("object",s.user(a))("customValues",s.customValues(a))}}function Fs(e,t){if(1&e&&(g.Qb(0,"map-result",21),g.Bc(1,Qs,2,9,"div",19),g.Pb()),2&e){const e=t.$implicit,i=t.address,n=g.Zb();g.gc("image",n.user(e).image)("address",i),g.xb(1),g.gc("ngForOf",n.fieldsInTile)}}let ws=(()=>{class e extends rs.a{constructor(e){super(e),this.clazz="flex-grow-1 d-flex",this.resultKind="user",this.update=new g.n}set data(e){this._data=e;const t=(e||{}).fieldsInList||[];this.fieldsInList=t.slice(0,Math.min(t.length,7)),this.fieldsInTile=t.slice(0,Math.min(t.length,2)),this.showTableHeader=this.fieldsInList.length>1}get data(){return this._data}ngOnInit(){super.ngOnInit(),this.canViewProfile=!0===(((this.dataForFrontendHolder.auth||{}).permissions||{}).users||{}).viewProfile}user(e){return"contact"===this.resultKind?e.contact:e}operatorGroup(e){if("operator"===this.resultKind){const t=e.group;return t?t.name:this.i18n.user.operatorNoGroup}return null}displayFunction(){return e=>{const t=this.user(e);if(t.display)return t.display;const i=t,n=this.fieldsInList[0];return i.hasOwnProperty(n)?i[n]:(i.customValues||{})[n]}}customValues(e){return null==e?null:e.customValues}address(e){return"contact"===this.resultKind?null:e.address}fieldName(e){return"operator"===this.resultKind&&"display"===e?this.i18n.general.operator:this.fieldHelper.fieldDisplay(e,this.data.customFields)}path(e){const t=this.user(e);return this.authHelper.isSelf(t)?["/users",this.ApiHelper.SELF,"profile"]:"operator"===this.resultKind?["/users","operators",t.id]:this.canViewProfile?"contact"===this.resultKind?["/users","contacts",t.id]:["/users",t.id,"profile"]:null}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r))},e.\u0275cmp=g.Eb({type:e,selectors:[["users-results"]],hostVars:2,hostBindings:function(e,t){2&e&&g.zb(t.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",referencePoint:"referencePoint",data:"data",results:"results",resultKind:"resultKind"},outputs:{update:"update"},features:[g.ub],decls:5,vars:7,consts:[[3,"results","rendering$","resultType","toAddress","referencePoint","toMarkerTitle","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",3,"ngClass",4,"resultTable"],["zoom","",3,"image","icon",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[3,"avatarImage","avatarIcon"],[4,"ngFor","ngForOf"],["class","cell-text",4,"ngIf"],[3,"ngClass"],[3,"fields","plainText","fieldName","object","customValues"],[1,"cell-text"],[1,"table","table-hover",3,"ngClass"],["class","avatar",4,"ngIf"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"avatar"],[3,"click"],[3,"image"],["zoom","",3,"image","icon"],[3,"ngClass",4,"ngFor","ngForOf"],["plainText","",1,"d-block","text-truncate",3,"fields","fieldName","object","customValues"],[3,"image","address"]],template:function(e,t){1&e&&(g.Qb(0,"results-layout",0),g.Xb("update",(function(e){return t.update.emit(e)})),g.Bc(1,ps,3,4,"mobile-result",1),g.Bc(2,Cs,7,7,"table",2),g.Bc(3,Ss,2,3,"tiled-result",3),g.Bc(4,Fs,2,3,"map-result",4),g.Pb()),2&e&&g.gc("results",t.results)("rendering$",t.rendering$)("resultType",t.resultType)("toAddress",t.address)("referencePoint",t.referencePoint)("toMarkerTitle",t.displayFunction())("toLink",t.canViewProfile?t.toLink:null)},directives:[$.a,H.a,U.a,cs.a,ls.a,G.a,p.s,p.t,p.q,bs.a,ke.a,us.a,ds.a],encapsulation:2,changeDetection:0}),e})();function Ls(e,t){1&e&&g.Mb(0)}function Ns(e,t){if(1&e&&(g.Qb(0,"div",9),g.Qb(1,"label-value",10),g.Lb(2,"user-link",11),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user)}}function Bs(e,t){if(1&e&&g.Lb(0,"field-option",14),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function ks(e,t){if(1&e&&(g.Qb(0,"div",9),g.Qb(1,"multi-selection-field",12),g.Bc(2,Bs,1,4,"field-option",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function Rs(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",9),g.Lb(2,"multi-selection-field",15),g.Pb(),g.Qb(3,"div",9),g.Lb(4,"date-field",16),g.Pb(),g.Qb(5,"div",9),g.Lb(6,"date-field",17),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),g.xb(2),g.gc("label",e.i18n.user.creationBegin),g.xb(2),g.gc("label",e.i18n.user.creationEnd)}}function Ts(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"form",4),g.Qb(3,"div",5),g.Bc(4,Ns,3,2,"div",6),g.Bc(5,ks,3,2,"div",6),g.Bc(6,Rs,7,4,"ng-container",7),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb(),g.Qb(8,"users-results",8),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(9,"async"),g.ac(10,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.self?e.i18n.user.title.myOperators:e.i18n.user.title.userOperators)("mobileHeading",e.self?e.i18n.user.mobileTitle.myOperators:e.i18n.user.mobileTitle.userOperators)("headingActions",g.bc(1,11,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("ngIf",g.bc(7,13,e.layout.gtxxs$)),g.xb(2),g.gc("results",g.bc(9,15,e.results$))("rendering$",e.rendering$)("data",g.bc(10,17,e.data$))("resultKind","operator")}}let Zs=(()=>{class e extends Fe.a{constructor(e,t,i){super(e),this.operatorsService=t,this.userHelper=i,this.ResultType=os.a,this.empty=b.i}getFormControlNames(){return["operatorGroups","statuses","creationBegin","creationEnd"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorsService.getUserOperatorsDataForSearch({user:this.param}).subscribe(e=>{this.statusOptions=this.userHelper.statusOptions(),!this.self&&e.canCreateNew&&(this.headingActions=[new be.c(ue.a.PersonPlus,this.i18n.general.addNew,()=>{this.router.navigate(["/users",this.param,"operators","registration"])},!0)]),this.data=e}))}onDataInitialized(e){super.onDataInitialized(e),Object(b.i)(e.fieldsInList)&&(e.fieldsInList=["display"])}toSearchParams(e){const t=e;return t.user=this.param,t.creationPeriod=c.a.rangeFilter(e.creationBegin,e.creationEnd),delete e.customValues,t}doSearch(e){return this.operatorsService.searchUserOperators$Response(e)}resolveMenu(e){return this.menu.userMenu(e.user,u.b.MY_OPERATORS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ta.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-user-operators"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","rendering$","data","resultKind","update"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["labelPosition","side","formControlName","operatorGroups",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions"],["labelPosition","side","formControlName","creationBegin","fieldSize","full",3,"label"],["labelPosition","side","formControlName","creationEnd","fieldSize","full",3,"label"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ls,1,0,"ng-container",1),g.Pb(),g.Bc(3,Ts,11,19,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,h.H,h.v,h.n,ws,Q.a,Lt.a,ht.a,h.u,h.l,p.s,Ne.a,we.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Ms=i("FUMw");function _s(e,t){if(1&e&&(g.Qb(0,"div",8),g.Dc(1),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.Ec(e.type.description)}}function $s(e,t){if(1&e&&g.Lb(0,"input-field",9),2&e){const e=g.Zb();g.gc("label",e.i18n.password.oldPassword)}}const Hs=e=>{const t=e.value;if(e.touched&&null!=t&&""!==t){const i=e.parent;if((null==i.get("newPassword")?"":i.get("newPassword").value)!==t)return{passwordsMatch:!0}}return null};let Us=(()=>{class e extends rs.a{constructor(e,t,i){super(e),this.modalRef=t,this.passwordsService=i,this.done=new g.n}ngOnInit(){super.ngOnInit(),this.self=this.authHelper.isSelf(this.user),this.form=this.formBuilder.group({newPassword:[null,h.F.required],newPasswordConfirmation:[null,h.F.compose([h.F.required,Hs])]}),this.requireOld&&this.form.setControl("oldPassword",this.formBuilder.control(null,h.F.required))}submit(){if(!Object(b.I)(this.form))return;const e=this.form.value;e.checkConfirmation=!0,this.addSub(this.passwordsService.changePassword({user:this.param,type:this.type.id,body:e}).subscribe(()=>{this.done.emit(),this.modalRef.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.a),g.Kb(Ms.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["change-password-dialog"]],inputs:{param:"param",user:"user",type:"type",requireOld:"requireOld"},outputs:{done:"done"},features:[g.ub],decls:11,vars:11,consts:[["class","mb-3",4,"ngIf"],[3,"formGroup"],["required","","focused","","formControlName","oldPassword","type","password",3,"label",4,"ngIf"],["required","","formControlName","newPassword","type","password",3,"label"],["required","","formControlName","newPasswordConfirmation","type","password",3,"label"],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"],[1,"mb-3"],["required","","focused","","formControlName","oldPassword","type","password",3,"label"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Bc(2,_s,2,1,"div",0),g.Qb(3,"form",1),g.Bc(4,$s,1,1,"input-field",2),g.Lb(5,"input-field",3),g.Lb(6,"input-field",4),g.Pb(),g.Qb(7,"actions",5),g.Qb(8,"action-button",6),g.Xb("action",(function(){return t.submit()})),g.ac(9,"async"),g.Pb(),g.Qb(10,"action-button",7),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Fc(" ",t.self?t.i18n.password.title.changeSelf:t.i18n.password.title.changeUser,"\n"),g.xb(1),g.gc("ngIf",t.type.description),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.requireOld),g.xb(1),g.gc("label",t.i18n.password.newPassword),g.xb(1),g.gc("label",t.i18n.password.passwordConfirmation),g.xb(2),g.gc("disabled",g.bc(9,9,t.requesting$))("label",t.i18n.general.submit),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[p.t,h.H,h.v,h.n,Nt.a,h.C,h.u,h.l,x.a,y.a,Xt.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Gs=i("mwYl"),qs=i("psEu");function Ks(e,t){1&e&&g.Mb(0)}function Vs(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"user-info",7),g.Lb(2,"hr"),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("user",e.data.user)}}function js(e,t){1&e&&g.Lb(0,"hr",17)}function zs(e,t){if(1&e&&g.Lb(0,"avatar",18),2&e){const e=g.Zb(3);g.gc("size",64)("icon",e.SvgIcon.Key)}}const Xs=function(e){return{"mt-0":e}};function Ys(e,t){if(1&e&&(g.Qb(0,"h2",19),g.Dc(1),g.Pb()),2&e){const e=g.Zb(),t=e.$implicit;g.gc("ngClass",g.jc(2,Xs,e.first)),g.xb(1),g.Fc(" ",t.type.name,"")}}function Ws(e,t){if(1&e&&(g.Qb(0,"div",20),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Fc(" ",t.i18n.password.statusSince(g.bc(2,1,e.date))," ")}}const Js=function(e){return{"mb-3":e}};function eo(e,t){if(1&e&&(g.Qb(0,"action-button",21),g.Xb("action",(function(){return t.$implicit.onClick()})),g.Pb()),2&e){const e=t.$implicit;g.gc("ngClass",g.jc(2,Js,!t.last))("label",e.label)}}function to(e,t){if(1&e&&(g.Ob(0),g.Bc(1,js,1,0,"hr",8),g.Qb(2,"div",9),g.Qb(3,"div",10),g.Bc(4,zs,1,2,"avatar",11),g.ac(5,"async"),g.Pb(),g.Qb(6,"div",12),g.Bc(7,Ys,2,4,"h2",13),g.Qb(8,"div"),g.Dc(9),g.Pb(),g.Bc(10,Ws,3,3,"div",14),g.Pb(),g.Qb(11,"div",15),g.Bc(12,eo,1,4,"action-button",16),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.first,n=g.Zb(2);g.xb(1),g.gc("ngIf",!i),g.xb(3),g.gc("ngIf",g.bc(5,6,n.layout.gtxxs$)),g.xb(3),g.gc("ngIf",n.multiple),g.xb(2),g.Ec(n.status(e)),g.xb(1),g.gc("ngIf",e.date),g.xb(2),g.gc("ngForOf",n.actions(e))}}function io(e,t){if(1&e&&g.Lb(0,"field-option",29),2&e){const e=t.$implicit;g.gc("value",e.internalName)("text",e.name)}}function no(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",22),g.Qb(1,"alert",23),g.Dc(2),g.Pb(),g.Qb(3,"form",24),g.Qb(4,"single-selection-field",25),g.Bc(5,io,1,2,"field-option",26),g.Pb(),g.Lb(6,"input-field",27),g.Pb(),g.Qb(7,"actions"),g.Qb(8,"action-button",28),g.Xb("action",(function(){return g.sc(e),g.Zb(2).setSecurityAnswer()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("heading",e.i18n.password.title.securityAnswer)("mobileHeading",e.i18n.password.mobileTitle.securityAnswer),g.xb(2),g.Ec(e.i18n.securityQuestion.message),g.xb(1),g.gc("formGroup",e.securityAnswer),g.xb(1),g.gc("label",e.i18n.securityQuestion.question),g.xb(1),g.gc("ngForOf",e.data.dataForSetSecurityAnswer.securityQuestions),g.xb(1),g.gc("label",e.i18n.securityQuestion.answer),g.xb(2),g.gc("label",e.i18n.general.save)}}function ao(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Bc(1,Vs,3,1,"ng-container",4),g.Bc(2,to,13,8,"ng-container",5),g.Pb(),g.Bc(3,no,9,8,"page-content",6)),2&e){const e=g.Zb();g.gc("heading",e.title)("mobileHeading",e.mobileTitle)("last",!(null!=e.data&&e.data.dataForSetSecurityAnswer)),g.xb(1),g.gc("ngIf",e.data.user&&!e.self),g.xb(1),g.gc("ngForOf",e.data.passwords),g.xb(1),g.gc("ngIf",null==e.data?null:e.data.dataForSetSecurityAnswer)}}let so=(()=>{class e extends l.a{constructor(e,t,i,n){super(e),this.modal=t,this.passwordsService=i,this.nextRequestState=n}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.passwordsService.getUserPasswordsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelf(e.user),this.multiple=e.passwords.length>1,this.self?(this.title=this.multiple?this.i18n.password.title.manageMultipleSelf:this.i18n.password.title.manageSingleSelf,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleSelf:this.i18n.password.mobileTitle.manageSingleSelf):(this.title=this.multiple?this.i18n.password.title.manageMultipleUser:this.i18n.password.title.manageSingleUser,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleUser:this.i18n.password.mobileTitle.manageSingleUser),e.dataForSetSecurityAnswer&&(this.securityAnswer=this.formBuilder.group({securityQuestion:[null,h.F.required],securityAnswer:[null,h.F.required]}))}actions(e){const t=[],i=e.permissions||{};return i.change&&t.push(new be.a(this.i18n.password.action.change,()=>{this.change(e)})),i.changeGenerated&&t.push(new be.a(this.i18n.password.action.change,()=>{this.changeGenerated(e)})),i.allowGeneration&&t.push(new be.a(this.i18n.password.action.allowGeneration,()=>{this.allowGeneration(e)})),i.resetAndSend&&(this.data.sendMediums.includes($e.sb.EMAIL)&&t.push(new be.a(this.i18n.password.action.resetAndSendEmail,()=>{this.resetAndSend(e,$e.sb.EMAIL)})),this.data.sendMediums.includes($e.sb.SMS)&&t.push(new be.a(this.i18n.password.action.resetAndSendSms,()=>{this.resetAndSend(e,$e.sb.SMS)}))),i.resetGenerated&&t.push(new be.a(this.i18n.password.action.resetGenerated,()=>{this.resetGenerated(e)})),i.unblock&&t.push(new be.a(this.i18n.password.action.unblock,()=>{this.unblock(e)})),i.generate&&t.push(new be.a(this.i18n.password.action.activate,()=>{this.generate(e)})),i.enable&&t.push(new be.a(this.i18n.password.action.enable,()=>{this.enable(e)})),i.disable&&t.push(new be.a(this.i18n.password.action.disable,()=>{this.disable(e)})),t}setSecurityAnswer(){Object(b.I)(this.securityAnswer),this.securityAnswer.valid&&this.addSub(this.passwordsService.setSecurityAnswer({body:this.securityAnswer.value}).subscribe(()=>{this.notification.snackBar(this.i18n.securityQuestion.set),this.reload()}))}status(e){switch(e.status){case $e.Y.ACTIVE:return this.i18n.password.status.active;case $e.Y.DISABLED:return this.i18n.password.status.disabled;case $e.Y.EXPIRED:return this.i18n.password.status.expired;case $e.Y.INDEFINITELY_BLOCKED:return this.i18n.password.status.indefinitelyBlocked;case $e.Y.NEVER_CREATED:return this.i18n.password.status.neverCreated;case $e.Y.PENDING:return this.i18n.password.status.pending;case $e.Y.RESET:return this.i18n.password.status.reset;case $e.Y.TEMPORARILY_BLOCKED:return this.i18n.password.status.temporarilyBlocked}}change(e){const t=this.modal.show(Us,{class:"modal-form",initialState:{param:this.param,type:e.type,user:this.data.user,requireOld:e.requireOldPasswordForChange}});this.addSub(t.content.done.subscribe(()=>{this.notification.snackBar(this.i18n.password.action.changeDone(e.type.name)),this.reload()}))}generate(e){this.notification.confirm({title:this.i18n.password.action.activate,message:this.i18n.password.action.activateConfirm(e.type.name),callback:()=>this.doGenerate(e)})}doGenerate(e){this.addSub(this.passwordsService.generatePassword({type:e.type.id}).subscribe(t=>{this.nextRequestState.leaveNotification=!0,this.notification.info(this.i18n.password.action.changeGeneratedDone({type:e.type.name,value:t})),this.reload()}))}createDeviceConfirmation(e){return()=>({type:$e.r.GENERATE_PASSWORD,passwordType:e.type.id})}changeGenerated(e){this.notification.confirm({title:this.i18n.password.action.change,message:this.i18n.password.action.changeGeneratedConfirm(e.type.name),createDeviceConfirmation:this.createDeviceConfirmation(e),passwordInput:this.data.confirmationPasswordInput,callback:t=>this.doChangeGenerated(e,t.confirmationPassword)})}doChangeGenerated(e,t){this.addSub(this.passwordsService.changeGenerated({type:e.type.id,confirmationPassword:t}).subscribe(t=>{this.nextRequestState.leaveNotification=!0,this.notification.info(this.i18n.password.action.changeGeneratedDone({type:e.type.name,value:t})),this.reload()}))}allowGeneration(e){this.notification.confirm({title:this.i18n.password.action.allowGeneration,message:this.i18n.password.action.allowGenerationConfirm(e.type.name),callback:()=>this.doAllowGeneration(e)})}doAllowGeneration(e){this.addSub(this.passwordsService.allowGeneration({type:e.type.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.allowGenerationDone(e.type.name)),this.reload()}))}resetGenerated(e){this.notification.confirm({title:this.i18n.password.action.resetGenerated,message:this.i18n.password.action.resetGeneratedConfirm(e.type.name),callback:()=>this.doResetGenerated(e)})}doResetGenerated(e){this.addSub(this.passwordsService.resetGeneratedPassword({type:e.type.id,user:this.param}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.resetGeneratedDone(e.type.name)),this.reload()}))}resetAndSend(e,t){let i,n;switch(t){case $e.sb.EMAIL:i=this.i18n.password.action.resetAndSendEmail,n=this.i18n.password.action.resetAndSendEmailConfirm(e.type.name);break;case $e.sb.SMS:i=this.i18n.password.action.resetAndSendSms,n=this.i18n.password.action.resetAndSendSmsConfirm(e.type.name)}this.notification.confirm({title:i,message:n,callback:()=>this.doResetAndSend(e,t)})}doResetAndSend(e,t){this.addSub(this.passwordsService.resetAndSendPassword({type:e.type.id,sendMediums:[t],user:this.param}).subscribe(()=>{switch(t){case $e.sb.EMAIL:this.notification.snackBar(this.i18n.password.action.resetAndSendEmailDone(e.type.name));break;case $e.sb.SMS:this.notification.snackBar(this.i18n.password.action.resetAndSendSmsDone(e.type.name))}this.reload()}))}unblock(e){this.notification.confirm({title:this.i18n.password.action.unblock,message:this.i18n.password.action.unblockConfirm(e.type.name),callback:()=>this.doUnblock(e)})}doUnblock(e){this.addSub(this.passwordsService.unblockPassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.unblockDone(e.type.name)),this.reload()}))}enable(e){this.notification.confirm({title:this.i18n.password.action.enable,message:this.i18n.password.action.enableConfirm(e.type.name),callback:()=>this.doEnable(e)})}doEnable(e){this.addSub(this.passwordsService.enablePassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.enableDone(e.type.name)),this.reload()}))}disable(e){this.notification.confirm({title:this.i18n.password.action.disable,message:this.i18n.password.action.disableConfirm(e.type.name),callback:()=>this.doDisable(e)})}doDisable(e){this.addSub(this.passwordsService.disablePassword({user:this.param,type:e.type.id}).subscribe(()=>{this.notification.snackBar(this.i18n.password.action.disableDone(e.type.name)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.PASSWORDS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.b),g.Kb(Ms.a),g.Kb(Gs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["manage-passwords"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","last"],[4,"ngIf"],[4,"ngFor","ngForOf"],["hideBack","","last","",3,"heading","mobileHeading",4,"ngIf"],["labelCols","2",3,"user"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-md-2"],["class","ml-2 mr-5 management","iconSize","64px",3,"size","icon",4,"ngIf"],[1,"col-8","col-md-7"],["class","border-0 mb-3",3,"ngClass",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto",3,"ngClass","label","action",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px",1,"ml-2","mr-5","management",3,"size","icon"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"d-block","ml-auto",3,"ngClass","label","action"],["hideBack","","last","",3,"heading","mobileHeading"],["type","info"],[3,"formGroup"],["formControlName","securityQuestion","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ks,1,0,"ng-container",1),g.Pb(),g.Bc(3,ao,4,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,p.s,P.a,ke.a,p.q,y.a,qs.a,h.H,h.v,h.n,Le.a,h.u,h.l,h.C,Nt.a,x.a,Ne.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var oo=i("GJcY");function ro(e,t){1&e&&g.Mb(0)}function co(e,t){1&e&&g.Mb(0)}function lo(e,t){1&e&&g.Mb(0)}const bo=function(e,t){return{$implicit:e,title:t}},uo=function(e,t){return{$implicit:e,title:t,readOnly:!0}};function go(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",3),g.ac(2,"async"),g.Lb(3,"user-info",4),g.Bc(4,ro,1,0,"ng-container",5),g.Bc(5,co,1,0,"ng-container",5),g.Bc(6,lo,1,0,"ng-container",5),g.Pb(),g.Nb()),2&e){const e=g.Zb(),t=g.qc(4);g.xb(1),g.gc("heading",e.i18n.product.title.list)("mobileHeading",e.i18n.product.mobileTitle.list)("headingActions",g.bc(2,10,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(12,bo,e.data.userProducts,e.i18n.product.assigned.individual)),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(15,uo,e.data.groupProducts,e.i18n.product.assigned.group)),g.xb(1),g.gc("ngTemplateOutlet",t)("ngTemplateOutletContext",g.kc(18,uo,e.data.groupSetProducts,e.i18n.product.assigned.groupSet))}}function fo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",13),g.Qb(1,"button",14),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(4).remove(i),t.stopPropagation(),t.preventDefault()})),g.Lb(2,"icon",15),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(5);g.xb(1),g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}function mo(e,t){if(1&e&&(g.Qb(0,"div",10),g.Qb(1,"div",11),g.Dc(2),g.Pb(),g.Bc(3,fo,3,2,"div",12),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3).readOnly,n=g.Zb();g.xb(2),g.Ec(e.name),g.xb(1),g.gc("ngIf",!i&&n.canRemove(e))}}function po(e,t){if(1&e&&(g.Ob(0),g.Bc(1,mo,4,2,"div",9),g.Nb()),2&e){const e=g.Zb(2).$implicit;g.xb(1),g.gc("ngForOf",e)}}function ho(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",14),g.Xb("click",(function(t){g.sc(e);const i=g.Zb().$implicit;return g.Zb(4).remove(i),t.stopPropagation()})),g.Lb(1,"icon",15),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}const vo=function(e){return{"no-border":e}};function xo(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"tr"),g.Qb(2,"td",21),g.Dc(3),g.Pb(),g.Qb(4,"td",21),g.Dc(5),g.Pb(),g.Qb(6,"td",21),g.Dc(7),g.Pb(),g.Qb(8,"td",22),g.Bc(9,ho,2,2,"button",23),g.Pb(),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3).readOnly,a=g.Zb();g.xb(2),g.gc("ngClass",g.jc(8,vo,i)),g.xb(1),g.Fc(" ",e.name," "),g.xb(1),g.gc("ngClass",g.jc(10,vo,i)),g.xb(1),g.Fc(" ",a.resolveKindLabel(e.kind)," "),g.xb(1),g.gc("ngClass",g.jc(12,vo,i)),g.xb(1),g.Fc(" ",null==e.userAccount?null:e.userAccount.name," "),g.xb(1),g.gc("ngClass",g.jc(14,vo,i)),g.xb(1),g.gc("ngIf",!n&&a.canRemove(e))}}function yo(e,t){if(1&e&&(g.Qb(0,"table",16),g.Qb(1,"thead"),g.Qb(2,"th",17),g.Dc(3),g.Pb(),g.Qb(4,"th",18),g.Dc(5),g.Pb(),g.Qb(6,"th",18),g.Dc(7),g.Pb(),g.Lb(8,"th",19),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,xo,10,16,"ng-container",20),g.Pb(),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb();g.xb(3),g.Ec(t.i18n.general.name),g.xb(2),g.Ec(t.i18n.general.type),g.xb(2),g.Fc("",t.i18n.product.userAccount," "),g.xb(3),g.gc("ngForOf",e)}}function Po(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",6),g.Dc(2),g.Pb(),g.Bc(3,po,2,1,"ng-container",7),g.ac(4,"async"),g.Bc(5,yo,11,4,"ng-template",null,8,g.Cc),g.Nb()),2&e){const e=g.qc(6),t=g.Zb().title,i=g.Zb();g.xb(2),g.Ec(t),g.xb(1),g.gc("ngIf",g.bc(4,3,i.layout.ltsm$))("ngIfElse",e)}}function Io(e,t){if(1&e&&g.Bc(0,Po,7,5,"ng-container",1),2&e){const e=t.$implicit,i=g.Zb();g.gc("ngIf",!i.empty(e))}}let Eo=(()=>{class e extends l.a{constructor(e,t){super(e),this.productAssignmentService=t,this.empty=b.i}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentService.getUserProductsData({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){const t=[];e.assignable&&t.push(new be.c(ue.a.PlusCircle,this.i18n.product.assignIndividualProduct,()=>this.assign())),e.history&&t.push(new be.c(ue.a.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["/users",this.user,"product-assignment","history"]))),this.headingActions=t}resolveKindLabel(e){switch(e){case $e.hb.ADMINISTRATOR:return this.i18n.product.kind.administrator;case $e.hb.BROKER:return this.i18n.product.kind.broker;case $e.hb.MEMBER:return this.i18n.product.kind.member}}resolveMenu(){return this.menu.searchUsersMenu()}assign(){this.notification.confirm({title:this.i18n.product.assignIndividualProduct,labelPosition:"above",customFields:[{internalName:"products",name:this.i18n.product.product,type:$e.o.SINGLE_SELECTION,control:$e.m.SINGLE_SELECTION,hasValuesList:!0,defaultValue:this.data.assignable[0].id,possibleValues:this.data.assignable.map(e=>({id:e.id,value:e.name})),required:!0}],callback:e=>{this.addSub(this.productAssignmentService.assignIndividualProduct({product:e.customValues.products,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.product.productAssigned),this.reload()}))}})}canRemove(e){return this.data.unassignable.find(t=>e.id===t||e.internalName===t)}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.productAssignmentService.unassignIndividualProduct({product:e.id,user:this.user}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(oo.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-product-assignment"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["products",""],[3,"heading","mobileHeading","headingActions"],[3,"user"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mt-3","mb-2"],[4,"ngIf","ngIfElse"],["largeTable",""],["class","d-flex mb-2",4,"ngFor","ngForOf"],[1,"d-flex","mb-2"],[1,"cell-main"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","small-height","mb-0"],["width","40%",1,"no-border"],["width","25%",1,"no-border"],["width","10%",1,"no-border"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"actions",3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,go,7,21,"ng-container",1),g.Pb(),g.Bc(3,Io,1,1,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,p.A,p.s,I.b,q.a,p.q],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function Ao(e,t){1&e&&g.Mb(0)}function Co(e,t){if(1&e&&(g.Qb(0,"mobile-result"),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Qb(3,"div",10),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"div",11),g.Dc(7),g.Pb(),g.Qb(8,"div",11),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.Fc(" ",e.product.name," "),g.xb(2),g.Fc(" ",g.bc(5,6,e.date)," "),g.xb(3),g.Gc(" ",i.i18n.product.action," ",e.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),g.xb(2),g.Gc(" ",i.i18n.general.performedBy," ",e.by.display," ")}}function Oo(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"dateTime"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,4,e.date)),g.xb(3),g.Ec(e.product.name),g.xb(2),g.Fc(" ",e.action===i.ProductAssignmentActionEnum.ASSIGN?i.i18n.product.assign:i.i18n.product.unassign," "),g.xb(2),g.Ec(e.by.display)}}function So(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Qb(8,"th"),g.Dc(9),g.Pb(),g.Pb(),g.Qb(10,"tbody"),g.Bc(11,Oo,10,6,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.product.product),g.xb(2),g.Ec(e.i18n.product.action),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function Do(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Qb(1,"label-value",4),g.Lb(2,"user-link",5),g.Pb(),g.Pb(),g.Qb(3,"results-layout",6),g.Bc(4,Co,10,8,"mobile-result",7),g.Bc(5,So,12,5,"table",8),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.product.title.history)("mobileHeading",e.i18n.product.mobileTitle.history),g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)("onClick",e.onClick)}}let Qo=(()=>{class e extends M.a{constructor(e,t){super(e),this.productAssignmentSerivce=t,this.ProductAssignmentActionEnum=$e.gb}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.productAssignmentSerivce.getUserProductsData({user:this.user,fields:["user","history"]}).subscribe(e=>this.data=e))}get onClick(){return e=>null!=e}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(oo.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-product-assignment-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"label"],[3,"user"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Ao,1,0,"ng-container",1),g.Pb(),g.Bc(3,Do,6,6,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,Q.a,Lt.a,$.a,H.a,U.a,G.a,p.s],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var Fo=i("zlpg"),wo=i("mMSl"),Lo=i("dt5f"),No=i("9d5G"),Bo=i("bER3"),ko=i("MYKl"),Ro=i("c/3O");const To=["codeField"];let Zo=(()=>{class e extends rs.a{constructor(e,t,i){super(e),this.modalRef=t,this.phonesService=i,this.verified=new g.n,this.message$=new wt.a(""),this.disabled=!1,this.code=this.formBuilder.control(null,h.F.required)}ngOnInit(){super.ngOnInit(),this.message=this.i18n.phone.verify.message}sendCode(){this.addSub(this.phonesService.sendPhoneVerificationCode({id:this.phone.id}).subscribe(e=>{this.message=this.i18n.phone.verify.done(e),this.code.setValue(null),this.codeField.focus()}))}set message(e){this.message$.next(e)}verify(){Object(b.I)(this.code)&&this.addSub(this.phonesService.verifyPhone({id:this.phone.id,code:this.code.value}).subscribe(e=>{switch(e){case $e.k.CODE_NOT_SENT:case $e.k.EXPIRED:this.notification.error(this.i18n.phone.error.verify.expired);break;case $e.k.FAILED:this.notification.error(this.i18n.phone.error.verify.invalid);break;case $e.k.MAX_ATTEMPTS_REACHED:this.notification.error(this.i18n.phone.error.verify.maxAttempts);break;case $e.k.SUCCESS:this.disabled=!0,this.verified.emit(!0)}}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.a),g.Kb(wo.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["verify-phone"]],viewQuery:function(e,t){var i;1&e&&g.yc(To,!0),2&e&&g.pc(i=g.Yb())&&(t.codeField=i.first)},inputs:{phone:"phone"},outputs:{verified:"verified"},features:[g.ub],decls:18,vars:12,consts:[[1,"row"],[1,"col-3","col-form-label"],["for","smsCode"],[1,"col-6"],["id","smsCode","fieldSize","4","type","number","focused","",3,"formControl"],["codeField",""],[1,"col-3"],[1,"d-block","w-100",3,"label","action"],[1,"mt-3","pb-1"],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"div",0),g.Qb(3,"div",1),g.Qb(4,"label",2),g.Dc(5),g.Pb(),g.Pb(),g.Qb(6,"div",3),g.Lb(7,"input-field",4,5),g.Pb(),g.Qb(9,"div",6),g.Qb(10,"action-button",7),g.Xb("action",(function(){return t.sendCode()})),g.Pb(),g.Pb(),g.Pb(),g.Qb(11,"div",8),g.Dc(12),g.ac(13,"async"),g.Pb(),g.Qb(14,"actions"),g.Qb(15,"action-button",9),g.Xb("action",(function(){return t.verify()})),g.ac(16,"async"),g.Pb(),g.Qb(17,"action-button",10),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Fc(" ",t.i18n.phone.verify.title(t.phone.number),"\n"),g.xb(4),g.Fc(" ",t.i18n.phone.verify.code," "),g.xb(2),g.gc("formControl",t.code),g.xb(3),g.gc("label",t.i18n.phone.verify.send),g.xb(2),g.Ec(g.bc(13,8,t.message$)),g.xb(3),g.gc("disabled",g.bc(16,10,t.requesting$))("label",t.i18n.general.confirm),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[Nt.a,Xt.a,h.u,h.k,y.a,x.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Mo=i("IzEk"),_o=i("SxV6"),$o=i("pz1b"),Ho=i("pBnU"),Uo=i("sGzL"),Go=i("N7zh"),qo=i("CyT4"),Ko=i("dZIy"),Vo=i("z332"),jo=i("oj/z");function zo(e,t){if(1&e&&g.Lb(0,"avatar",21),2&e){const e=g.Zb(4);g.gc("image",e.images[0])("roundBorders",!1)}}function Xo(e,t){if(1&e&&(g.Qb(0,"div",22),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.Fc(" ",e.i18n.user.noImage," ")}}function Yo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(5).removeAllImages()})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.field.image.remove)}}function Wo(e,t){if(1&e){const e=g.Rb();g.Qb(0,"actions",23),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(),g.qc(7).perform()})),g.Pb(),g.Qb(2,"action-button",24),g.Xb("action",(function(){g.sc(e),g.Zb();const t=g.qc(7);return g.Zb(3).captureCamera(t)})),g.Pb(),g.Bc(3,Yo,1,1,"action-button",25),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.field.image.upload),g.xb(1),g.gc("label",e.i18n.field.image.camera),g.xb(1),g.gc("ngIf",e.images.length>0)}}function Jo(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",14),g.Dc(2),g.Pb(),g.Qb(3,"div",15),g.Bc(4,zo,1,2,"avatar",16),g.Bc(5,Xo,2,1,"div",17),g.Pb(),g.Qb(6,"image-upload",18,19),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb(3).onUploadDone(t)})),g.Pb(),g.Bc(8,Wo,4,3,"actions",20),g.ac(9,"async"),g.Nb()}if(2&e){const e=g.qc(7),t=g.Zb(3);g.xb(2),g.Fc(" ",t.i18n.user.title.image," "),g.xb(2),g.gc("ngIf",t.images.length>0),g.xb(1),g.gc("ngIf",0===t.images.length),g.xb(1),g.gc("owner",t.param),g.xb(2),g.gc("ngIf",t.canEdit("image")&&!1===g.bc(9,5,e.uploading$))}}function er(e,t){if(1&e&&(g.Qb(0,"div",33),g.Lb(1,"avatar",34),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(4);g.xb(1),g.gc("image",e)("roundBorders",!1)("additionalImages",i.images)}}function tr(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",35),g.Dc(2),g.Pb(),g.Nb()),2&e){const e=g.Zb(4);g.xb(2),g.Fc(" ",e.i18n.user.noImages," ")}}function ir(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(2),g.qc(9).perform()})),g.Pb(),g.Qb(2,"action-button",24),g.Xb("action",(function(){g.sc(e),g.Zb(2);const t=g.qc(9);return g.Zb(3).captureCamera(t)})),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(5);g.xb(1),g.gc("label",e.i18n.field.image.upload),g.xb(1),g.gc("label",e.i18n.field.image.camera)}}function nr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(5).manageImages()})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.field.image.manage)}}function ar(e,t){if(1&e&&(g.Qb(0,"actions",36),g.Bc(1,ir,3,2,"ng-container",4),g.ac(2,"async"),g.Bc(3,nr,1,1,"action-button",25),g.Pb()),2&e){g.Zb();const e=g.qc(9),t=g.Zb(3);g.xb(1),g.gc("ngIf",t.canUploadImages&&!1===g.bc(2,2,e.uploading$)),g.xb(2),g.gc("ngIf",t.images.length>0)}}function sr(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",26),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Pb(),g.Qb(4,"div",28),g.Bc(5,er,2,3,"div",29),g.Bc(6,tr,3,1,"ng-container",4),g.Pb(),g.Bc(7,ar,4,4,"actions",30),g.Qb(8,"image-upload",31,32),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb(3).onUploadDone(t)})),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(3);g.xb(3),g.Fc(" ",e.i18n.user.title.images," "),g.xb(2),g.gc("ngForOf",e.images),g.xb(1),g.gc("ngIf",0===e.images.length),g.xb(1),g.gc("ngIf",e.canEdit("image")),g.xb(1),g.gc("owner",e.param)("max",e.data.imageConfiguration.maxImages)}}function or(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Jo,10,7,"ng-container",4),g.Bc(2,sr,10,6,"ng-container",4),g.Nb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("ngIf","single"===e.imagesAvailability),g.xb(1),g.gc("ngIf","multiple"===e.imagesAvailability)}}function rr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Lb(1,"user-link",38),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.operatorOwner),g.xb(1),g.gc("user",e.data.userConfiguration.details.user)}}function cr(e,t){if(1&e&&g.Lb(0,"input-field",39),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.name)("required",e.canEdit("name"))}}function lr(e,t){if(1&e&&g.Lb(0,"input-field",40),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.username)("required",e.canEdit("username"))}}function br(e,t){if(1&e&&g.Lb(0,"field-privacy",44),2&e){const e=g.Zb(3);g.gc("control",e.user.get("hiddenFields"))}}function ur(e,t){if(1&e&&(g.Qb(0,"label-value",41),g.Lb(1,"input-field",42),g.Bc(2,br,1,1,"field-privacy",43),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.email)("kind",e.canEdit("email")?"field":"fieldView")("ignoreExtraCell",!e.canManagePrivacy("email")),g.xb(1),g.gc("required",e.canEdit("email"))}}function dr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.emailPending),g.xb(1),g.Fc(" ",e.data.userConfiguration.emailPendingValidation," ")}}function gr(e,t){if(1&e&&g.Lb(0,"custom-field-input",50),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("field",e)("formControlName",e.internalName)("binaryValues",t.data.userConfiguration.binaryValues)}}function fr(e,t){if(1&e&&g.Lb(0,"format-field-value",51),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("fieldValue",t.fieldValue(e))}}function mr(e,t){if(1&e&&g.Lb(0,"field-privacy",52),2&e){const e=g.Zb(2).$implicit,t=g.Zb(2);g.gc("field",e.internalName)("control",t.user.get("hiddenFields"))}}function pr(e,t){if(1&e&&(g.Qb(0,"label-value",46),g.Bc(1,gr,1,3,"custom-field-input",47),g.Bc(2,fr,1,1,"ng-template",null,48,g.Cc),g.Bc(4,mr,1,2,"field-privacy",49),g.Pb()),2&e){const e=g.qc(3),t=g.Zb().$implicit,i=g.Zb(2);g.gc("label",t.name)("kind",i.canEdit(t)?"field":"fieldView")("labelPosition","boolean"===t.type?"sideForced":"auto")("ignoreExtraCell",!i.canManagePrivacy(t))("fieldSize",i.fieldSize(t))("required",t.required),g.xb(1),g.gc("ngIf",i.canEdit(t))("ngIfElse",e)}}function hr(e,t){if(1&e&&(g.Ob(0,6),g.Bc(1,pr,5,8,"label-value",45),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("formGroup",i.user.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e)||!i.isEmpty(e))}}function vr(e,t){if(1&e&&g.Lb(0,"input-field",57),2&e){const e=g.Zb(3);g.gc("placeholder",e.data.phoneConfiguration.mobileExample)}}function xr(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(3);g.Fc(" ",e.singleMobile.get("number").value," ")}}function yr(e,t){if(1&e&&g.Lb(0,"field-privacy",58),2&e){const e=g.Zb(3);g.gc("control",e.singleMobile.get("hidden"))}}function Pr(e,t){if(1&e&&g.Lb(0,"boolean-field",61),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.verified)("formControl",e.singleMobile.get("verified"))}}function Ir(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.verified),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.singleMobile.get("verified").value)," ")}}function Er(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Pr,1,2,"boolean-field",59),g.Bc(2,Ir,2,2,"ng-template",null,60,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(3);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function Ar(e,t){if(1&e){const e=g.Rb();g.Qb(0,"boolean-field",64),g.Xb("click",(function(t){return g.sc(e),g.Zb(4).maybeVerify(t)})),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.enabledSms)("formControl",e.singleMobile.get("enabledForSms"))}}function Cr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.enabledSms),g.xb(1),g.Fc(" ",e.format.formatBoolean(e.singleMobile.get("enabledForSms").value)," ")}}function Or(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ar,1,2,"boolean-field",62),g.Bc(2,Cr,2,2,"ng-template",null,63,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(3);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function Sr(e,t){if(1&e&&(g.Ob(0,6),g.Qb(1,"label-value",53),g.Bc(2,vr,1,1,"input-field",54),g.Bc(3,xr,1,1,"ng-template",null,55,g.Cc),g.Bc(5,yr,1,1,"field-privacy",56),g.Pb(),g.Bc(6,Er,4,2,"ng-container",4),g.Bc(7,Or,4,2,"ng-container",4),g.Nb()),2&e){const e=g.qc(4),t=g.Zb(2);g.gc("formGroup",t.singleMobile),g.xb(1),g.gc("label",t.i18n.phone.mobile)("required","required"===t.data.phoneConfiguration.mobileAvailability)("ignoreExtraCell",!t.canManagePrivacy("phone")),g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e),g.xb(4),g.gc("ngIf",t.phoneHasSms(t.singleMobileManage)),g.xb(1),g.gc("ngIf",t.showEnableForSms(t.singleMobile))}}function Dr(e,t){if(1&e&&g.Lb(0,"input-field",57),2&e){const e=g.Zb(3);g.gc("placeholder",e.data.phoneConfiguration.landLineExample)}}function Qr(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(3);g.Fc(" ",e.singleLandLine.get("number").value," ")}}function Fr(e,t){if(1&e&&g.Lb(0,"field-privacy",58),2&e){const e=g.Zb(3);g.gc("control",e.singleLandLine.get("hidden"))}}function wr(e,t){if(1&e&&g.Lb(0,"input-field",66),2&e){const e=g.Zb(4);g.gc("label",e.i18n.phone.extension)}}function Lr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,wr,1,1,"input-field",65),g.Nb()),2&e){const e=t.ngIf;g.xb(1),g.gc("ngIf",!e.disabled||e.value)}}function Nr(e,t){if(1&e&&(g.Ob(0,6),g.Qb(1,"label-value",53),g.Bc(2,Dr,1,1,"input-field",54),g.Bc(3,Qr,1,1,"ng-template",null,55,g.Cc),g.Bc(5,Fr,1,1,"field-privacy",56),g.Pb(),g.Bc(6,Lr,2,1,"ng-container",4),g.Nb()),2&e){const e=g.qc(4),t=g.Zb(2);g.gc("formGroup",t.singleLandLine),g.xb(1),g.gc("label",t.i18n.phone.landLine)("required","required"===t.data.phoneConfiguration.landLineAvailability)("ignoreExtraCell",!t.canManagePrivacy("address")),g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e),g.xb(4),g.gc("ngIf",t.data.phoneConfiguration.extensionEnabled&&t.singleLandLine.get("extension"))}}function Br(e,t){if(1&e&&g.Lb(0,"boolean-field",69),2&e){const e=g.Zb(3);g.gc("formControl",e.defineSingleAddress)("label",e.i18n.user.addressDefine)}}function kr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"static-map",75),g.Xb("imageLoaded",(function(){g.sc(e);const t=g.Zb(5);return t.mapShown(t.singleAddress)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("address",e.singleAddress.value)}}function Rr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(6);return t.locateAddress(t.singleAddress)})),g.Pb()}if(2&e){const e=g.Zb(6);g.gc("label",e.i18n.general.mapView)}}function Tr(e,t){if(1&e&&(g.Bc(0,Rr,1,1,"action-button",76),g.ac(1,"async")),2&e){const e=g.Zb(5),t=g.qc(4);g.gc("ngIf",!1===g.bc(1,2,e.singleAddress.locating$))("ngIfElse",t)}}function Zr(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Bc(1,kr,1,1,"static-map",73),g.Bc(2,Tr,2,4,"ng-template",null,74,g.Cc),g.Pb()),2&e){const e=g.qc(3),t=g.Zb(4);g.gc("label",t.i18n.general.map),g.xb(1),g.gc("ngIf",null!=t.singleAddress.get("location").value.latitude)("ngIfElse",e)}}function Mr(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"address-form",70),g.Bc(2,Zr,4,3,"label-value",71),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("addressForm",e.singleAddress)("configuration",e.data.addressConfiguration)("managePrivacy",e.data.addressConfiguration.managePrivacy)("binaryValues",e.data.addressBinaryValues[null==e.data.addresses[0]?null:e.data.addresses[0].id]),g.xb(1),g.gc("ngIf",e.maps.enabled)}}function _r(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",67),g.Dc(2),g.Pb(),g.Bc(3,Br,1,2,"boolean-field",68),g.Bc(4,Mr,3,5,"ng-container",4),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.address.address),g.xb(1),g.gc("ngIf",e.canEdit("address")&&"required"!==e.data.addressConfiguration.availability),g.xb(1),g.gc("ngIf",e.defineSingleAddress.value)}}function $r(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",83,84),g.Qb(2,"button",85),g.Xb("click",(function(){return g.sc(e),g.Zb(4).addLandLine()})),g.Dc(3),g.Pb(),g.Qb(4,"button",85),g.Xb("click",(function(){return g.sc(e),g.Zb(4).addMobile()})),g.Dc(5),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(3),g.Fc(" ",e.i18n.user.phoneAddLandLine," "),g.xb(2),g.Fc(" ",e.i18n.user.phoneAddMobile," ")}}function Hr(e,t){if(1&e&&(g.Qb(0,"div",80),g.Qb(1,"button",81),g.Dc(2),g.Pb(),g.Bc(3,$r,6,2,"div",82),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Fc(" ",e.i18n.user.phoneAdd," ")}}function Ur(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",86),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addLandLine()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.user.phoneAddLandLine)}}function Gr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",86),g.Qb(1,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addMobile()})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.user.phoneAddMobile)}}function qr(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.phoneNone," ")}}function Kr(e,t){if(1&e&&g.Lb(0,"input-field",66),2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.extension)}}function Vr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Kr,1,1,"input-field",65),g.Nb()),2&e){const e=t.ngIf;g.xb(1),g.gc("ngIf",!e.disabled||e.value)}}function jr(e,t){if(1&e&&g.Lb(0,"boolean-field",91),2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.verified)}}function zr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb(3);g.gc("label",t.i18n.phone.verified),g.xb(1),g.Fc(" ",t.format.formatBoolean(e.verified)," ")}}function Xr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,jr,1,1,"boolean-field",90),g.Bc(2,zr,2,2,"ng-template",null,60,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(4);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function Yr(e,t){if(1&e){const e=g.Rb();g.Qb(0,"boolean-field",93),g.Xb("click",(function(t){g.sc(e);const i=g.Zb(2).$implicit;return g.Zb(3).maybeVerify(t,i.id)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.phone.enabledSms)}}function Wr(e,t){if(1&e&&(g.Qb(0,"label-value",37),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2).$implicit,t=g.Zb(3);g.gc("label",t.i18n.phone.enabledSms),g.xb(1),g.Fc(" ",t.format.formatBoolean(e.enabledForSms)," ")}}function Jr(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Yr,1,1,"boolean-field",92),g.Bc(2,Wr,2,2,"ng-template",null,63,g.Cc),g.Nb()),2&e){const e=g.qc(3),t=g.Zb(4);g.xb(1),g.gc("ngIf",t.canEdit("phone"))("ngIfElse",e)}}function ec(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removePhone(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.phoneRemove)}}function tc(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,ec,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",t.editableFields.has("phone")&&g.bc(4,3,t.layout.gtxxs$))}}function ic(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removePhone(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.phoneRemove)}}const nc=function(e){return{"mt-3":e}};function ac(e,t){if(1&e&&(g.Qb(0,"div",96),g.Bc(1,ic,1,1,"action-button",25),g.Pb()),2&e){const e=g.Zb(4);g.gc("ngClass",g.jc(2,nc,!e.data.phoneConfiguration.managePrivacy)),g.xb(1),g.gc("ngIf",e.editableFields.has("phone"))}}function sc(e,t){1&e&&g.Lb(0,"hr")}function oc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"input-field",87),g.Lb(2,"input-field",88),g.Bc(3,Vr,2,1,"ng-container",4),g.Bc(4,Xr,4,2,"ng-container",4),g.Bc(5,Jr,4,2,"ng-container",4),g.Bc(6,tc,5,5,"label-value",71),g.Bc(7,ac,2,4,"div",89),g.ac(8,"async"),g.Bc(9,sc,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("id","phone_name"+e.idSuffix)("label",n.phoneNameLabel(e)),g.xb(1),g.gc("id","phone_number"+e.idSuffix)("label",n.phoneNumberLabel(e))("placeholder",n.phoneExample(e)),g.xb(1),g.gc("ngIf",n.hasExtension(e)&&e.form.get("extension")),g.xb(1),g.gc("ngIf","mobile"===e.kind&&n.phoneHasSms(e.form)),g.xb(1),g.gc("ngIf","mobile"===e.kind&&n.showEnableForSms(e.form)),g.xb(1),g.gc("ngIf",n.canManagePrivacy("phone")),g.xb(1),g.gc("ngIf",g.bc(8,12,n.layout.xxs$)||!n.data.phoneConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function rc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Bc(4,Hr,4,1,"div",78),g.Bc(5,Ur,2,1,"div",79),g.Bc(6,Gr,2,1,"div",79),g.Pb(),g.Bc(7,qr,2,1,"div",4),g.Bc(8,oc,10,14,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.phones," "),g.xb(1),g.gc("ngIf",e.canCreateLandLine&&e.canCreateMobile),g.xb(1),g.gc("ngIf",e.canCreateLandLine&&!e.canCreateMobile),g.xb(1),g.gc("ngIf",!e.canCreateLandLine&&e.canCreateMobile),g.xb(1),g.gc("ngIf",0==e.phones.length),g.xb(1),g.gc("ngForOf",e.phones)}}function cc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addAddress()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.addressAdd)}}function lc(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.addressNone," ")}}function bc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeAddress(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.addressRemove)}}function uc(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,bc,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",t.editableFields.has("address")&&!t.maps.enabled&&g.bc(4,3,t.layout.gtxxs$))}}function dc(e,t){1&e&&g.Mb(0)}function gc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",100),g.Qb(1,"static-map",75),g.Xb("imageLoaded",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).mapShown(t.form)})),g.Pb(),g.Bc(2,dc,1,0,"ng-container",101),g.ac(3,"async"),g.Pb()}if(2&e){const e=g.Zb().$implicit,t=g.Zb(3),i=g.qc(4);g.gc("label",t.i18n.general.map),g.xb(1),g.gc("address",e.form.value),g.xb(1),g.gc("ngIf",g.bc(3,4,e.form.locating$))("ngIfThen",i)}}function fc(e,t){1&e&&g.Lb(0,"div",106)}function mc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeAddress(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.addressRemove)}}function pc(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"div",107),g.Qb(2,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).locateAddress(t.form)})),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(5);g.xb(2),g.gc("label",e.i18n.general.mapView)}}function hc(e,t){if(1&e&&(g.Qb(0,"div",102),g.Bc(1,fc,1,0,"div",103),g.ac(2,"async"),g.Qb(3,"div",104),g.Qb(4,"actions",105),g.Bc(5,mc,1,1,"action-button",25),g.Bc(6,pc,3,1,"ng-container",4),g.ac(7,"async"),g.Pb(),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.xb(1),g.gc("ngIf",g.bc(2,3,t.layout.gtxs$)),g.xb(4),g.gc("ngIf",t.editableFields.has("address")),g.xb(1),g.gc("ngIf",null==e.form.get("location").value.latitude&&!1===g.bc(7,5,e.form.locating$))}}function vc(e,t){1&e&&g.Lb(0,"hr")}function xc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"input-field",87),g.Lb(2,"address-form",97),g.Bc(3,uc,5,5,"label-value",71),g.Bc(4,gc,4,6,"label-value",98),g.ac(5,"async"),g.Bc(6,hc,8,7,"div",99),g.ac(7,"async"),g.Bc(8,vc,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("id","address_name"+e.idSuffix)("label",n.i18n.general.name),g.xb(1),g.gc("addressForm",e.form)("ignoreContactFields",1===n.addresses.length)("configuration",n.data.addressConfiguration)("idSuffix",e.idSuffix)("managePrivacy",!1)("binaryValues",n.data.addressBinaryValues[e.id]),g.xb(1),g.gc("ngIf",n.canManagePrivacy("address")),g.xb(1),g.gc("ngIf",n.maps.enabled&&(null!=e.form.get("location").value.latitude||g.bc(5,13,e.form.locating$))),g.xb(2),g.gc("ngIf",n.maps.enabled||g.bc(7,15,n.layout.xxs$)||!n.data.addressConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function yc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Qb(4,"div",86),g.Bc(5,cc,1,1,"action-button",25),g.Pb(),g.Pb(),g.Bc(6,lc,2,1,"div",4),g.Bc(7,xc,9,17,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.addresses," "),g.xb(2),g.gc("ngIf",e.canCreateAddress),g.xb(1),g.gc("ngIf",0==e.data.addresses.length),g.xb(1),g.gc("ngForOf",e.addresses)}}function Pc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){return g.sc(e),g.Zb(3).addContactInfo()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.contactInfoAdd)}}function Ic(e,t){if(1&e&&(g.Qb(0,"div"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Fc(" ",e.i18n.user.contactInfoNone," ")}}function Ec(e,t){if(1&e&&g.Lb(0,"input-field",117),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("id","contact-info_landLineExtension"+e.idSuffix)("label",t.i18n.phone.extension)}}function Ac(e,t){if(1&e&&g.Lb(0,"field-option",119),2&e){const e=g.Zb().$implicit;g.gc("value",e.id)("text",e.name)}}function Cc(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Ac,1,2,"field-option",118),g.Nb()),2&e){const e=t.$implicit;g.xb(1),g.gc("ngIf",e.id)}}function Oc(e,t){if(1&e&&(g.Ob(0,6),g.Qb(1,"label-value",120),g.Lb(2,"custom-field-input",121),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(3);g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("label",e.name)("kind","field")("fieldSize",n.fieldSize(e))("required",e.required)("labelPosition","boolean"===e.type?"sideForced":"auto"),g.xb(1),g.gc("field",e)("binaryValues",n.data.contactInfoBinaryValues[i.id])("formControlName",e.internalName)}}function Sc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb(2).$implicit;return g.Zb(3).removeContactInfo(t)})),g.Pb()}if(2&e){const e=g.Zb(5);g.gc("label",e.i18n.user.contactInfoRemove)}}function Dc(e,t){if(1&e&&(g.Qb(0,"label-value",72),g.Qb(1,"div",94),g.Lb(2,"field-privacy",95),g.Bc(3,Sc,1,1,"action-button",25),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(3);g.gc("label",t.i18n.field.privacy.name),g.xb(2),g.gc("control",e.form.get("hidden")),g.xb(1),g.gc("ngIf",g.bc(4,3,t.layout.gtxxs$))}}function Qc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",122),g.Qb(1,"action-button",24),g.Xb("action",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).removeContactInfo(t)})),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.user.contactInfoRemove)}}function Fc(e,t){1&e&&g.Lb(0,"hr")}function wc(e,t){if(1&e&&(g.Ob(0,6),g.Lb(1,"images-field",108),g.Lb(2,"input-field",109),g.Lb(3,"input-field",110),g.Lb(4,"input-field",111),g.Lb(5,"input-field",112),g.Bc(6,Ec,1,2,"input-field",113),g.Qb(7,"single-selection-field",114),g.Bc(8,Cc,2,1,"ng-container",115),g.Pb(),g.Bc(9,Oc,3,9,"ng-container",11),g.Bc(10,Dc,5,5,"label-value",71),g.Bc(11,Qc,2,1,"div",116),g.ac(12,"async"),g.Bc(13,Fc,1,0,"hr",4),g.Nb()),2&e){const e=t.$implicit,i=t.last,n=g.Zb(3);g.gc("formGroup",e.form),g.xb(1),g.gc("label",n.i18n.general.image)("initialImages",null==n.data.contactInfoBinaryValues[e.id]?null:n.data.contactInfoBinaryValues[e.id].image),g.xb(1),g.gc("id","contact-info_name"+e.idSuffix)("label",n.i18n.general.name),g.xb(1),g.gc("id","contact-info_email"+e.idSuffix)("label",n.i18n.user.email),g.xb(1),g.gc("id","contact-info_mobilePhone"+e.idSuffix)("label",n.i18n.phone.mobile),g.xb(1),g.gc("id","contact-info_landLinePhone"+e.idSuffix)("label",n.i18n.phone.landLine),g.xb(1),g.gc("ngIf",n.data.phoneConfiguration.extensionEnabled),g.xb(1),g.gc("id","contact-info_address"+e.idSuffix)("label",n.i18n.address.address),g.xb(1),g.gc("ngForOf",n.data.addresses),g.xb(1),g.gc("ngForOf",n.data.contactInfoConfiguration.customFields),g.xb(1),g.gc("ngIf",n.canManagePrivacy("contactInfo")),g.xb(1),g.gc("ngIf",g.bc(12,19,n.layout.xxs$)||!n.data.contactInfoConfiguration.managePrivacy),g.xb(2),g.gc("ngIf",!i)}}function Lc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",77),g.Qb(2,"div",27),g.Dc(3),g.Pb(),g.Qb(4,"div",86),g.Bc(5,Pc,1,1,"action-button",25),g.Pb(),g.Pb(),g.Bc(6,Ic,2,1,"div",4),g.Bc(7,wc,14,21,"ng-container",11),g.Nb()),2&e){const e=g.Zb(2);g.xb(3),g.Fc(" ",e.i18n.user.title.contactInfos," "),g.xb(2),g.gc("ngIf",e.canCreateContactInfo),g.xb(1),g.gc("ngIf",0==e.contactInfos.length),g.xb(1),g.gc("ngForOf",e.contactInfos)}}function Nc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Bc(2,or,3,2,"ng-container",4),g.Qb(3,"h2",5),g.Dc(4),g.Pb(),g.Ob(5,6),g.Bc(6,rr,2,2,"label-value",7),g.Bc(7,cr,1,2,"input-field",8),g.Bc(8,lr,1,2,"input-field",9),g.Bc(9,ur,3,4,"label-value",10),g.Bc(10,dr,2,2,"label-value",7),g.Nb(),g.Bc(11,hr,2,2,"ng-container",11),g.Bc(12,Sr,8,8,"ng-container",12),g.Bc(13,Nr,7,7,"ng-container",12),g.Bc(14,_r,5,3,"ng-container",4),g.Bc(15,rc,9,6,"ng-container",4),g.Bc(16,yc,8,4,"ng-container",4),g.Bc(17,Lc,8,4,"ng-container",4),g.Qb(18,"actions"),g.Qb(19,"action-button",13),g.Xb("action",(function(){return g.sc(e),g.Zb().saveOrConfirm()})),g.ac(20,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.editProfile)("mobileHeading",e.i18n.user.mobileTitle.editProfile)("headingActions",g.bc(1,21,e.headingActions$)),g.xb(2),g.gc("ngIf","disabled"!==e.imagesAvailability),g.xb(1),g.gc("ngClass","disabled"===e.imagesAvailability?"border-0 mt-2 mt-md-0":null),g.xb(1),g.Fc(" ",e.i18n.user.title.fields," "),g.xb(1),g.gc("formGroup",e.user),g.xb(1),g.gc("ngIf",e.operatorOfManagedUser),g.xb(1),g.gc("ngIf",e.hasField("name")),g.xb(1),g.gc("ngIf",e.hasField("username")),g.xb(1),g.gc("ngIf",e.hasField("email")),g.xb(1),g.gc("ngIf",e.hasField("email")&&e.data.userConfiguration.emailPendingValidation),g.xb(1),g.gc("ngForOf",null==e.data.userConfiguration?null:e.data.userConfiguration.customFields),g.xb(1),g.gc("ngIf",e.singleMobile),g.xb(1),g.gc("ngIf",e.singleLandLine),g.xb(1),g.gc("ngIf",e.singleAddress),g.xb(1),g.gc("ngIf","multiple"===e.landLineAvailability||"multiple"===e.mobileAvailability),g.xb(1),g.gc("ngIf","multiple"===e.addressAvailability),g.xb(1),g.gc("ngIf","disabled"!==e.contactInfoAvailability),g.xb(2),g.gc("disabled",g.bc(20,23,e.requesting$))("label",e.i18n.general.save)}}function Bc(e,t){1&e&&g.Lb(0,"spinner")}const kc=["name","username","email"];let Rc=0,Tc=(()=>{class e extends l.a{constructor(e,t,i,n,a,s,o,r){super(e),this.usersService=t,this.imagesService=i,this.phonesService=n,this.maps=a,this.addressHelper=s,this.modal=o,this.changeDetector=r,this.ConfirmationMode=No.a,this.ready$=new wt.a(!1),this.confirmationMode$=new wt.a(null),this.createLandLinePhones=[],this.modifyLandLinePhones=[],this.createMobilePhones=[],this.modifyMobilePhones=[],this.createAddresses=[],this.modifyAddresses=[],this.createContactInfos=[],this.modifyContactInfos=[]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.createDeviceConfirmation=()=>({type:$e.r.EDIT_PROFILE}),this.headingActions=[new be.c(ue.a.Search,this.i18n.general.view,()=>this.router.navigate(["users",this.param,"profile"]),!0)],this.addSub(this.usersService.getDataForEditFullProfile({user:this.param}).subscribe(e=>{this.data=e;const t=e.userConfiguration.role,i=e.userConfiguration.details,n=this.authHelper.isSelf(i);this.byManager=!this.authHelper.isSelfOrOwner(i),this.operatorOfManagedUser="operator"===t&&!this.authHelper.isSelf(i.user),n&&this.login.user$.next({id:this.login.user.id,display:e.userConfiguration.details.display,image:Object(b.i)(e.images)?null:e.images[0]}),this.initialize(e),this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||(this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.router.navigate(["users","profile"])),this.ready$.next(!0)}))}locateControl(e){return Object(b.v)(this,e)}hasField(e){return this.enabledFields.has(e)}isRequired(e){if(!this.canEdit(e))return!1;if("name"===e||"username"===e)return!0;if("email"===e)return this.data.userConfiguration.emailRequired;{const t=this.userCustomFields.get(e);return t&&t.required}}fieldName(e){return"string"==typeof e?e:e.internalName}isEmpty(e){const t=this.fieldName(e);if("string"==typeof e)return Object(b.i)(this.user.get(t).value);{const e=this.user.get("customValues");return!e||Object(b.i)(e.get(t).value)}}canEdit(e){return this.editableFields.has(this.fieldName(e))}canManagePrivacy(e){if(!this.data.userConfiguration.enablePrivacy)return!1;switch(e){case"phone":return this.data.phoneConfiguration.managePrivacy;case"address":return this.data.addressConfiguration.managePrivacy;case"contactInfo":return this.data.contactInfoConfiguration.managePrivacy;default:return this.managePrivacyFields.has(this.fieldName(e))}}get landLineAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxLandLines)}get mobileAvailability(){return this.getAvailability((this.data.phoneConfiguration||{}).maxMobiles)}get addressAvailability(){return this.getAvailability((this.data.addressConfiguration||{}).maxAddresses)}get contactInfoAvailability(){return this.getAvailability((this.data.contactInfoConfiguration||{}).maxContactInfos)}get imagesAvailability(){return this.getAvailability((this.data.imageConfiguration||{}).maxImages)}getAvailability(e){return null==e||e<=0?"disabled":1===e?"single":"multiple"}saveOrConfirm(){this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.user.title.confirmation,passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:this.createDeviceConfirmation,callback:e=>{this.save(e.confirmationPassword)}}):this.save()}save(e){const t=new h.m({user:this.user,createLandLinePhones:new h.g(this.createLandLinePhones),modifyLandLinePhones:new h.g(this.modifyLandLinePhones),createMobilePhones:new h.g(this.createMobilePhones),modifyMobilePhones:new h.g(this.modifyMobilePhones),createAddresses:new h.g(this.createAddresses),modifyAddresses:new h.g(this.modifyAddresses),createContactInfos:new h.g(this.createContactInfos),modifyContactInfos:new h.g(this.modifyContactInfos)});!e&&this.confirmationPassword&&(t.setControl("confirmationPassword",this.confirmationPassword),e=this.confirmationPassword.value),Object(b.I)(t)&&this.addSub(this.usersService.saveUserFullProfile({user:this.param,confirmationPassword:e,body:this.editForSubmit()}).subscribe(()=>{this.notification.snackBar(this.i18n.user.profileSaved),this.reload(),Object(b.A)()}))}editForSubmit(){const e={user:Object(b.u)(this.user)?this.user.value:null,createLandLinePhones:this.createLandLinePhones.map(e=>e.value),modifyLandLinePhones:this.modifyLandLinePhones.map(e=>e.value),createMobilePhones:this.createMobilePhones.map(e=>e.value),modifyMobilePhones:this.modifyMobilePhones.map(e=>e.value),removePhones:this.removedPhones,createAddresses:this.createAddresses.map(e=>e.value),modifyAddresses:this.modifyAddresses.map(e=>e.value),removeAddresses:this.removedAddresses,createContactInfos:this.createContactInfos.map(e=>e.value),modifyContactInfos:this.modifyContactInfos.map(e=>e.value),removeContactInfos:this.removedContactInfos};if(this.singleMobile){const t=this.singleMobile.value,i=t.id;i?Object(b.i)(t.number)?e.removePhones.push(i):Object(b.u)(this.singleMobile)&&(e.modifyMobilePhones=[t]):Object(b.i)(t.number)||(e.createMobilePhones=[t])}if(this.singleLandLine){const t=this.singleLandLine.value,i=t.id;i?Object(b.i)(t.number)?e.removePhones.push(i):Object(b.u)(this.singleLandLine)&&(e.modifyLandLinePhones=[t]):Object(b.i)(t.number)||(e.createLandLinePhones=[t])}if(this.singleAddress){const t=this.singleAddress.value,i=t.id,n=this.defineSingleAddress.value;i?n?Object(b.u)(this.singleAddress)&&(e.modifyAddresses=[t]):e.removeAddresses.push(i):n&&(e.createAddresses=[t])}return e}initialize(e){this.userCustomFields=new Map,this.enabledFields=new Set,this.editableFields=new Set,this.managePrivacyFields=new Set,this.removedPhones=[],this.removedAddresses=[],this.removedContactInfos=[],e.contactInfoConfiguration&&e.contactInfoConfiguration.availability!==$e.h.DISABLED&&(e.addressConfiguration.contactInfoEnabled=!0,e.addressConfiguration.contactInfoFields=e.contactInfoConfiguration.customFields);const t=e.userConfiguration.profileFieldActions;for(const i in t){if(!t.hasOwnProperty(i))continue;this.enabledFields.add(i);const e=t[i];e.edit&&this.editableFields.add(i),e.managePrivacy&&this.managePrivacyFields.add(i);const n=this.data.userConfiguration.customFields.find(e=>e.internalName===i);n&&this.userCustomFields.set(i,n)}this.user=this.buildUserForm(),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("",h.F.required)),this.images=this.data.images.slice(),this.phones=[],"single"===this.mobileAvailability?!this.canEdit("phone")&&Object(b.i)(e.mobilePhones)||(this.singleMobileManage=Object(b.i)(e.mobilePhones)?e.phoneConfiguration.mobilePhone:e.mobilePhones[0],this.singleMobile=this.buildMobileForm(this.singleMobileManage)):(e.mobilePhones||[]).forEach(e=>{const t=this.buildMobileForm(e);"multiple"===this.mobileAvailability&&(this.phones.push(e),this.addSub(t.valueChanges.subscribe(()=>{this.modifyMobilePhones.includes(t)||this.modifyMobilePhones.push(t)})))}),"single"===this.landLineAvailability?!this.canEdit("phone")&&Object(b.i)(e.landLinePhones)||(this.singleLandLineManage=Object(b.i)(e.landLinePhones)?e.phoneConfiguration.landLinePhone:e.landLinePhones[0],this.singleLandLine=this.buildLandLineForm(this.singleLandLineManage)):(e.landLinePhones||[]).forEach(e=>{const t=this.buildLandLineForm(e);"multiple"===this.landLineAvailability&&(this.phones.push(e),this.addSub(t.valueChanges.subscribe(()=>{this.modifyLandLinePhones.includes(t)||this.modifyLandLinePhones.push(t)})))}),"single"===this.addressAvailability?!this.canEdit("address")&&Object(b.i)(e.addresses)||(this.defineSingleAddress=this.formBuilder.control(!Object(b.i)(e.addresses)||"required"===e.addressConfiguration.availability),this.singleAddressManage=Object(b.i)(e.addresses)?e.addressConfiguration.address:e.addresses[0],this.singleAddress=this.buildAddressForm(this.singleAddressManage)):((e.addresses||[]).forEach(e=>{const t=this.buildAddressForm(e);"multiple"===this.addressAvailability&&this.addSub(t.valueChanges.subscribe(()=>{this.modifyAddresses.includes(t)||this.modifyAddresses.push(t)}))}),this.addresses=(e.addresses||[]).slice()),(e.contactInfos||[]).forEach(e=>{const t=this.buildContactInfoForm(e);this.addSub(t.valueChanges.subscribe(()=>{this.modifyContactInfos.includes(t)||this.modifyContactInfos.push(t)}))}),this.contactInfos=(e.contactInfos||[]).slice()}buildUserForm(){const e=this.data.userConfiguration,t=this.data.user,i=this.formBuilder.group({version:t.version,hiddenFields:[t.hiddenFields||[]]});for(const n of kc)this.hasField(n)?i.setControl(n,this.formBuilder.control({value:t[n],disabled:!this.canEdit(n)},this.isRequired(n)?h.F.required:null)):i.removeControl(n);return i.setControl("customValues",this.fieldHelper.customValuesFormGroup(e.customFields,{currentValues:t.customValues,disabledProvider:e=>!this.canEdit(e.internalName)})),i}stampDataAndInitForm(e,t){e.idSuffix="_"+(e.id||Rc++),e.form=t,t.locating$=new wt.a(!1),t.patchValue(e)}buildLandLineForm(e){e.kind=$e.eb.LAND_LINE;const t=this.data.phoneConfiguration,i=this.buildPhoneForm(1===t.maxLandLines,t.landLineAvailability===$e.h.REQUIRED);if(t.extensionEnabled){const e=this.formBuilder.control(null);this.editableFields.has("phone")||e.disable(),i.setControl("extension",e)}return this.stampDataAndInitForm(e,i),i}buildMobileForm(e){e.kind=$e.eb.MOBILE;const t=this.data.phoneConfiguration,i=this.buildPhoneForm(1===t.maxMobiles,t.mobileAvailability===$e.h.REQUIRED);return t.smsEnabled&&(i.setControl("verified",this.formBuilder.control(e.verified)),i.setControl("enabledForSms",this.formBuilder.control(e.enabledForSms))),this.stampDataAndInitForm(e,i),i}buildPhoneForm(e,t){const i=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,h.F.required],number:[null,!e||t?h.F.required:null]});return this.editableFields.has("phone")||i.disable(),i}buildAddressForm(e){const t=this.data.addressConfiguration,i=this.addressHelper.addressFormGroup(t);this.stampDataAndInitForm(e,i);for(const n of t.enabledFields){let t=e[n]||null;this.addSub(i.get(n).valueChanges.subscribe(e=>{t!==e&&i.get("location").patchValue({latitude:null,longitude:null}),t=e}))}return this.editableFields.has("address")||i.disable(),i}buildContactInfoForm(e){const t=this.data.contactInfoConfiguration,i=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,h.F.required],image:null,email:null,mobilePhone:null,landLinePhone:null,landLineExtension:null,address:null});return i.setControl("customValues",this.fieldHelper.customValuesFormGroup(t.customFields)),this.stampDataAndInitForm(e,i),i}phoneNameLabel(e){return e.kind===$e.eb.LAND_LINE?this.i18n.phone.nameLandLine:this.i18n.phone.nameMobile}phoneExample(e){return e.kind===$e.eb.LAND_LINE?this.data.phoneConfiguration.landLineExample:this.data.phoneConfiguration.mobileExample}phoneNumberLabel(e){return e.kind===$e.eb.LAND_LINE?this.i18n.phone.numberLandLine:this.i18n.phone.numberMobile}phoneHasSms(e){return!!this.data.phoneConfiguration.smsEnabled&&e.id&&e.kind===$e.eb.MOBILE&&e.number===e.form.value.number}hasExtension(e){return this.data.phoneConfiguration.extensionEnabled&&e.kind===$e.eb.LAND_LINE}get canCreateLandLine(){if("multiple"!==this.landLineAvailability||!this.editableFields.has("phone"))return!1;const e=this.data.phoneConfiguration.maxLandLines;return this.phones.filter(e=>e.kind===$e.eb.LAND_LINE).length<e}get canCreateMobile(){if("multiple"!==this.mobileAvailability||!this.editableFields.has("phone"))return!1;const e=this.data.phoneConfiguration.maxMobiles;return this.phones.filter(e=>e.kind===$e.eb.MOBILE).length<e}get canCreateAddress(){return!("multiple"!==this.addressAvailability||!this.editableFields.has("address"))&&this.addresses.length<this.data.addressConfiguration.maxAddresses}get canCreateContactInfo(){return"multiple"===this.contactInfoAvailability&&this.contactInfos.length<this.data.contactInfoConfiguration.maxContactInfos}get canUploadImages(){return this.images.length<this.data.imageConfiguration.maxImages}addMobile(){const e=Object(d.a)(this.data.phoneConfiguration.mobilePhone);e.name="",this.createMobilePhones.push(this.buildMobileForm(e)),this.phones=[e,...this.phones],this.setFocus("phone_name",e)}addLandLine(){const e=Object(d.a)(this.data.phoneConfiguration.landLinePhone);e.name="",this.createLandLinePhones.push(this.buildLandLineForm(e)),this.phones=[e,...this.phones],this.setFocus("phone_name",e)}addAddress(){const e=Object(d.a)(this.data.addressConfiguration.address);e.name="",this.createAddresses.push(this.buildAddressForm(e)),this.addresses=[e,...this.addresses],this.setFocus("address_name",e)}addContactInfo(){const e=Object(d.a)(this.data.contactInfoConfiguration.contactInfo);this.createContactInfos.push(this.buildContactInfoForm(e)),this.contactInfos=[e,...this.contactInfos],this.setFocus("contact-info_name",e)}removePhone(e){this.phones=this.phones.filter(t=>t!==e);const t=e.id;if(t)this.removedPhones.push(t);else{const t=e.form;this.createMobilePhones=this.createMobilePhones.filter(e=>e!==t),this.createLandLinePhones=this.createLandLinePhones.filter(e=>e!==t)}}removeAddress(e){this.addresses=this.addresses.filter(t=>t!==e);const t=e.id;if(t)this.removedAddresses.push(t);else{const t=e.form;this.createAddresses=this.createAddresses.filter(e=>e!==t)}}removeContactInfo(e){this.contactInfos=this.contactInfos.filter(t=>t!==e);const t=e.id;if(t)this.removedContactInfos.push(t);else{const t=e.form;this.createContactInfos=this.createContactInfos.filter(e=>e!==t)}}setFocus(e,t){const i=e+t.idSuffix;setTimeout(()=>document.getElementById(i).focus(),10)}showEnableForSms(e){return!!this.data.phoneConfiguration.smsEnabled&&(!this.byManager||e.value.verified)}maybeVerify(e,t){if(this.byManager)return;let i;if(i=this.singleMobile?this.singleMobileManage:this.phones.find(e=>e.id===t),null==i)throw new Error("Mobile phone not found: "+t);i.verified||(this.verify(i),e.preventDefault(),e.stopPropagation())}verify(e){const t=this.modal.show(Zo,{class:"modal-form",initialState:{phone:e}});this.addSub(t.content.verified.pipe(Object(Mo.a)(1)).subscribe(i=>{i&&this.phonesService.getPhoneDataForEdit({id:e.id,fields:["phone"]}).subscribe(i=>{const n=i.phone;n.id=e.id,n.enabledForSms=!0;const a=this.buildMobileForm(n);a.markAsTouched();const s=(this.phones||[]).findIndex(t=>t.id===e.id);if(s>=0){const t=this.phones.slice();t[s]=n,this.phones=t;const i=this.modifyMobilePhones.findIndex(t=>t.value.id===e.id),o=this.modifyMobilePhones.slice();i>=0?o[i]=a:o.push(a),this.modifyMobilePhones=o}this.singleMobile&&(this.singleMobile=a),t.hide(),this.changeDetector.detectChanges()})}))}onUploadDone(e){const t=1===this.data.imageConfiguration.maxImages;this.images=t?[e[0]]:[...this.images,...e],this.changeDetector.detectChanges(),self&&t&&this.login.user$.next(Object.assign(Object.assign({},this.login.user$.value),{image:e[0]}))}captureCamera(e){this.notification.captureCamera(t=>e.uploadFile(t))}manageImages(){const e=this.modal.show(Bo.a,{class:"modal-form",initialState:{images:this.images}});e.content.result.pipe(Object(_o.a)()).subscribe(t=>{if(!Object(b.i)(t.removedImages)){for(const e of t.removedImages)this.addSub(this.imagesService.deleteImage({idOrKey:e}).subscribe());this.images=this.images.filter(e=>!t.removedImages.includes(e.id))}!Object(b.i)(t.order)&&(this.images=t.order.map(e=>this.images.find(t=>t.id===e)),this.addSub(this.imagesService.reorderProfileImages({ids:t.order,user:this.param}).subscribe())),self&&this.login.user$.next(Object.assign(Object.assign({},this.login.user$.value),{image:this.images[0]})),e.hide()})}removeAllImages(){for(const e of this.images||[])this.addSub(this.imagesService.deleteImage({idOrKey:e.id}).subscribe());this.images=[],this.changeDetector.detectChanges()}fieldSize(e){return this.fieldHelper.fieldSize(e)}locateAddress(e){const t=e.value;e.locating$.next(!0),this.addSub(this.maps.geocode(t).subscribe(t=>{e.patchValue({location:t}),this.changeDetector.detectChanges()},()=>this.mapShown(e)))}mapShown(e){e.locating$.next(!1),this.changeDetector.detectChanges()}resolveMenu(e){return this.menu.userMenu(e.userConfiguration.details,u.b.EDIT_MY_PROFILE)}fieldValue(e){const t=this.user.get("customValues").get(e.internalName).value;return this.fieldHelper.asFieldValue(e,t,this.data.userConfiguration.binaryValues)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Lo.a),g.Kb(Fo.a),g.Kb(wo.a),g.Kb(Ro.a),g.Kb(ko.a),g.Kb(_.b),g.Kb(g.h))},e.\u0275cmp=g.Eb({type:e,selectors:[["edit-profile"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["locatingSpinner",""],["last","",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"mt-4","mb-2",3,"ngClass"],[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name",3,"label","required",4,"ngIf"],["formControlName","username",3,"label","required",4,"ngIf"],[3,"label","kind","ignoreExtraCell",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[1,"btn-main",3,"disabled","label","action"],[1,"mb-3","border-0","mt-2","mt-md-0"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image","roundBorders",4,"ngIf"],["class","my-3",4,"ngIf"],["containerClass","mt-3","target","profile",3,"owner","uploadDone"],["singleUpload",""],["class","mt-3","reverseRow","",4,"ngIf"],["size","huge","useLightbox","",3,"image","roundBorders"],[1,"my-3"],["reverseRow","",1,"mt-3"],["outline","",3,"label","action"],["outline","",3,"label","action",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["class","mt-2","reverseRow","",4,"ngIf"],["target","profile",3,"owner","max","uploadDone"],["multiUpload",""],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge","useLightbox","",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],["reverseRow","",1,"mt-2"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","name",3,"label","required"],["formControlName","username",3,"label","required"],[3,"label","kind","ignoreExtraCell"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["field","email",3,"control"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required",4,"ngIf"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","binaryValues",4,"ngIf","ngIfElse"],["plainFieldValue",""],[3,"field","control",4,"extraCell"],["hideLabel","",3,"field","formControlName","binaryValues"],[3,"fieldValue"],[3,"field","control"],["kind","field","fieldSize","small",3,"label","required","ignoreExtraCell"],["formControlName","number",3,"placeholder",4,"ngIf","ngIfElse"],["plainPhoneNumber",""],[3,"control",4,"extraCell"],["formControlName","number",3,"placeholder"],[3,"control"],[3,"label","formControl",4,"ngIf","ngIfElse"],["plainVerified",""],[3,"label","formControl"],[3,"label","formControl","click",4,"ngIf","ngIfElse"],["plainSms",""],[3,"label","formControl","click"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],[1,"mb-2"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy","binaryValues"],["kind","field",3,"label",4,"ngIf"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"],["outline","",3,"label","action",4,"ngIf","ngIfElse"],[1,"mt-4","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],["class","section-title-action","dropdown","",4,"ngIf"],["class","section-title-action",4,"ngIf"],["dropdown","",1,"section-title-action"],["dropdownToggle","","type","button","type","button","aria-controls","newPhoneDropDown",1,"btn","btn-outline-primary","dropdown-toggle"],["class","dropdown-menu dropdown-menu-right","role","listbox","id","newPhoneDropDown",4,"dropdownMenu"],["role","listbox","id","newPhoneDropDown",1,"dropdown-menu","dropdown-menu-right"],["dropDownMenu",""],[1,"dropdown-item",3,"click"],[1,"section-title-action"],["formControlName","name","required","",3,"id","label"],["type","tel","formControlName","number","required","",3,"id","label","placeholder"],["class","d-flex justify-content-end",3,"ngClass",4,"ngIf"],["formControlName","verified",3,"label",4,"ngIf","ngIfElse"],["formControlName","verified",3,"label"],["formControlName","enabledForSms",3,"label","click",4,"ngIf","ngIfElse"],["formControlName","enabledForSms",3,"label","click"],[1,"d-flex","w-100","justify-content-between"],["justifyStart","",3,"control"],[1,"d-flex","justify-content-end",3,"ngClass"],["idPrefix","address_",3,"addressForm","ignoreContactFields","configuration","idSuffix","managePrivacy","binaryValues"],["kind","field","class","pb-0",3,"label",4,"ngIf"],["class","row mt-3 no-gutters",4,"ngIf"],["kind","field",1,"pb-0",3,"label"],[4,"ngIf","ngIfThen"],[1,"row","mt-3","no-gutters"],["class","col-4",4,"ngIf"],[1,"col-12","col-sm-8"],["forceRow","",1,"mt-0"],[1,"col-4"],[1,"flex-grow-1"],["formControlName","image","target","contactInfo","separator","@","avatarSize","xlarge",3,"label","initialImages"],["formControlName","name",3,"id","label"],["formControlName","email",3,"id","label"],["formControlName","mobilePhone",3,"id","label"],["formControlName","landLinePhone",3,"id","label"],["formControlName","landLineExtension",3,"id","label",4,"ngIf"],["formControlName","address",3,"id","label"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-end",4,"ngIf"],["formControlName","landLineExtension",3,"id","label"],[3,"value","text",4,"ngIf"],[3,"value","text"],[3,"label","kind","fieldSize","required","labelPosition"],["hideLabel","",3,"field","binaryValues","formControlName"],[1,"d-flex","justify-content-end"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Nc,21,25,"page-content",1),g.Pb(),g.Bc(3,Bc,1,0,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,p.q,h.v,h.n,p.s,x.a,y.a,$o.a,ke.a,Q.a,Lt.a,Nt.a,h.u,h.l,h.C,Ho.a,Uo.a,Yt.a,bs.a,v.a,h.k,Go.a,qo.a,Ko.a,Ko.d,Ko.b,Vo.a,Le.a,Ne.a,jo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Zc=i("qEt1");let Mc=(()=>{class e extends l.a{constructor(e,t){super(e),this.validationService=t}get userId(){return this.data}ngOnInit(){this.addSub(this.validationService.validateEmailChange({key:this.route.snapshot.params.key}).subscribe(()=>{this.notification.snackBar(this.i18n.user.newEmailConfirmed),this.router.navigate(["users","self","profile"])}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Zc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["validate-email-change"]],features:[g.ub],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e})();var _c=i("/QoZ"),$c=i("nUN0"),Hc=i("ZvpF"),Uc=i("naJM"),Gc=i("wR2l"),qc=i("vOpc");function Kc(e,t){1&e&&g.Lb(0,"div",6)}function Vc(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",6),g.Qb(2,"label-value",13),g.Lb(3,"user-link",14),g.Pb(),g.Pb(),g.Bc(4,Kc,1,0,"div",15),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("ngIf",e.layout.gtsm$)}}function jc(e,t){1&e&&g.Mb(0)}function zc(e,t){1&e&&g.Mb(0)}const Xc=function(e,t){return{count:e,total:t}};function Yc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr"),g.Qb(1,"td"),g.Lb(2,"rating-stats",22),g.Pb(),g.Qb(3,"td",21),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb(3).filter(i.level,!0)})),g.Bc(4,jc,1,0,"ng-container",23),g.Pb(),g.Qb(5,"td",21),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb(3).filter(i.level)})),g.Bc(6,zc,1,0,"ng-container",23),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3),n=g.qc(4);g.xb(2),g.gc("level",e.level)("textLeft",e.text),g.xb(2),g.gc("ngTemplateOutlet",n)("ngTemplateOutletContext",g.kc(6,Xc,null==i.allTime?null:i.allTime.counts[e.level],null==i.allTime?null:i.allTime.total)),g.xb(2),g.gc("ngTemplateOutlet",n)("ngTemplateOutletContext",g.kc(9,Xc,null==i.last30Days?null:i.last30Days.counts[e.level],null==i.last30Days?null:i.last30Days.total))}}function Wc(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",16),g.Qb(1,"table",17),g.Qb(2,"thead"),g.Qb(3,"th",18),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,Yc,7,12,"tr",19),g.Qb(11,"tr"),g.Qb(12,"td",20),g.Dc(13),g.Pb(),g.Qb(14,"td",21),g.Xb("click",(function(){return g.sc(e),g.Zb(2).filter(null,!0)})),g.Dc(15),g.Pb(),g.Qb(16,"td",21),g.Xb("click",(function(){return g.sc(e),g.Zb(2).filter()})),g.Dc(17),g.Pb(),g.Pb(),g.Qb(18,"tr"),g.Qb(19,"td",20),g.Dc(20),g.Pb(),g.Qb(21,"td"),g.Dc(22),g.ac(23,"percent"),g.Pb(),g.Qb(24,"td"),g.Dc(25),g.ac(26,"percent"),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(4),g.Ec(e.i18n.reference.value),g.xb(2),g.Ec(e.i18n.reference.allTime),g.xb(2),g.Ec(e.i18n.reference.last30Days),g.xb(2),g.gc("ngForOf",e.levels),g.xb(3),g.Ec(e.i18n.reference.total),g.xb(2),g.Fc(" ",null==e.allTime?null:e.allTime.total," "),g.xb(2),g.Fc(" ",null==e.last30Days?null:e.last30Days.total,""),g.xb(3),g.Fc(" ",e.i18n.reference.percentagePositive,""),g.xb(2),g.Fc(" ",g.bc(23,10,(null==e.allTime?null:e.allTime.totalPositive)/(null==e.allTime?null:e.allTime.total)||0)," "),g.xb(3),g.Fc(" ",g.bc(26,12,(null==e.last30Days?null:e.last30Days.totalPositive)/(null==e.last30Days?null:e.last30Days.total)||0)," ")}}function Jc(e,t){if(1&e&&(g.Qb(0,"mobile-result",24),g.Qb(1,"div",25),g.Qb(2,"div"),g.Qb(3,"div",26),g.Dc(4),g.Pb(),g.Qb(5,"div",27),g.Dc(6),g.ac(7,"dateTime"),g.Pb(),g.Qb(8,"div",28),g.Lb(9,"rating-stats",29),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("avatarImage",e.relatedUser.image)("avatarIcon",i.SvgIcon.Person),g.xb(4),g.Fc(" ",e.relatedUser.display," "),g.xb(2),g.Fc(" ",g.bc(7,5,e.date)," "),g.xb(3),g.gc("level",e.level)}}function el(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",35),g.Xb("click",(function(){g.sc(e);const t=g.Zb().$implicit;return g.Zb(3).remove(t)})),g.Lb(1,"icon",36),g.Pb()}if(2&e){const e=g.Zb(4);g.gc("tooltip",e.i18n.general.remove),g.xb(1),g.gc("icon",e.SvgIcon.Trash)}}function tl(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"tr",32),g.Xb("click",(function(){g.sc(e);const i=t.$implicit,n=g.Zb(3);return n.router.navigate(n.path(i))})),g.Qb(2,"td"),g.Dc(3),g.ac(4,"dateTime"),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.Pb(),g.Qb(7,"td"),g.Lb(8,"rating-stats",29),g.Pb(),g.Qb(9,"td",33),g.Bc(10,el,2,2,"button",34),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.Ec(g.bc(4,4,e.date)),g.xb(3),g.Ec(e.relatedUser.display),g.xb(2),g.gc("level",e.level),g.xb(2),g.gc("ngIf",i.data.manage)}}function il(e,t){if(1&e&&(g.Qb(0,"table",30),g.Qb(1,"thead"),g.Qb(2,"th",18),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Lb(8,"th",31),g.Pb(),g.Qb(9,"tbody"),g.Bc(10,tl,11,6,"ng-container",19),g.ac(11,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.name),g.xb(2),g.Ec(e.i18n.reference.level.level),g.xb(3),g.gc("ngForOf",null==(i=g.bc(11,4,e.results$))?null:i.results)}}function nl(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",3),g.ac(2,"async"),g.Qb(3,"form",4),g.Qb(4,"div",5),g.Bc(5,Vc,5,3,"ng-container",1),g.Qb(6,"div",6),g.Qb(7,"radio-group-field",7),g.Lb(8,"field-option",8),g.Lb(9,"field-option",8),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Bc(10,Wc,27,14,"page-content",9),g.ac(11,"async"),g.ac(12,"async"),g.Qb(13,"results-layout",10),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(14,"async"),g.Bc(15,Jc,10,7,"mobile-result",11),g.Bc(16,il,12,6,"table",12),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.reference.title.search)("mobileHeading",e.i18n.reference.mobileTitle.search)("headingActions",g.bc(2,14,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",e.data.user&&!e.isOwner),g.xb(2),g.gc("label",e.i18n.reference.direction.direction),g.xb(1),g.gc("value",e.ReferenceDirectionEnum.GIVEN)("text",e.i18n.reference.direction.given),g.xb(1),g.gc("value",e.ReferenceDirectionEnum.RECEIVED)("text",e.i18n.reference.direction.received),g.xb(1),g.gc("ngIf",g.bc(11,16,e.layout.gtsm$)&&g.bc(12,18,e.stats$)),g.xb(3),g.gc("results",g.bc(14,20,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}const al=function(e){return{width:e}};function sl(e,t){if(1&e&&(g.Qb(0,"div",40),g.Dc(1," \xa0"),g.Pb()),2&e){const e=g.Zb();g.gc("ngStyle",g.jc(1,al,e.count/e.total*190+"px"))}}const ol=function(e){return{"pl-2":e}};function rl(e,t){if(1&e&&(g.Qb(0,"div",37),g.Bc(1,sl,2,3,"div",38),g.Qb(2,"span",39),g.Dc(3),g.Pb(),g.Pb()),2&e){const e=t.count;g.xb(1),g.gc("ngIf",e>0),g.xb(1),g.gc("ngClass",g.jc(3,ol,e>0)),g.xb(1),g.Ec(e)}}let cl=(()=>{class e extends Fe.a{constructor(e,t,i){super(e),this.referenceHelper=t,this.referencesService=i,this.ReferenceDirectionEnum=$e.nb,this.ReferenceLevelEnum=$e.ob,this.stats$=new wt.a(null)}getFormControlNames(){return["direction","levels","period"]}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.referencesService.getUserReferencesDataForSearch({user:this.param}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),e.set&&!this.isOwner&&(this.headingActions=[new be.c(ue.a.Star,this.i18n.reference.set,()=>{this.router.navigate(e.current?["users","references","edit",e.current.id]:["users","references","set","self",this.param])},!0)]),this.levels=[{level:$e.ob.VERY_GOOD,text:this.i18n.reference.level.veryGood},{level:$e.ob.GOOD,text:this.i18n.reference.level.good},{level:$e.ob.NEUTRAL,text:this.i18n.reference.level.neutral},{level:$e.ob.BAD,text:this.i18n.reference.level.bad},{level:$e.ob.VERY_BAD,text:this.i18n.reference.level.veryBad}],this.searchStatistics(),this.addSub(this.form.controls.direction.valueChanges.subscribe(()=>this.searchStatistics()))}searchStatistics(){this.addSub(this.referencesService.getUserReferenceStatistics({user:this.param,direction:this.form.controls.direction.value}).subscribe(e=>this.stats=e))}toSearchParams(e){return e.user=this.param,e}doSearch(e){return this.referencesService.searchUserReferences$Response(e)}filter(e,t){this.form.patchValue({levels:e?[e]:null,period:t?null:[this.dataForFrontendHolder.now().clone().subtract(30,"day").startOf("day").format(Hc.b),null]})}get toLink(){return e=>this.path(e)}get stats(){return this.stats$.value}set stats(e){this.stats$.next(e),this.allTime=e.periods.filter(e=>null==e.period)[0],this.last30Days=e.periods.filter(e=>null!=e.period)[0]}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.referencesService.deleteReference({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}path(e){return["/users","references","view",e.id]}resolveMenu(e){return this.isOwner?u.b.REFERENCES:this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Uc.a),g.Kb($c.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-references"]],features:[g.ub],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["columnData",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["formControlName","direction",3,"label"],[3,"value","text"],["mode","table",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["mode","table"],[1,"table","table-hover","small-height"],["width","33%"],[4,"ngFor","ngForOf"],[1,"font-weight-bold"],[1,"link","link-undecorated",3,"click"],[1,"w-100",3,"level","textLeft"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"avatarImage","avatarIcon"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[3,"level"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click"],[1,"actions","actions-multiple"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"stats"],["class","bar",3,"ngStyle",4,"ngIf"],[1,"count",3,"ngClass"],[1,"bar",3,"ngStyle"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,nl,17,22,"ng-container",1),g.Pb(),g.Bc(3,rl,4,5,"ng-template",null,2,g.Cc)),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Gc.a,h.u,h.l,Ne.a,$.a,H.a,U.a,Q.a,Lt.a,p.s,qc.a,p.A,G.a,I.b,q.a,p.q,p.w],pipes:[p.b,p.C,V.a],encapsulation:2,changeDetection:0}),e})();function ll(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"dateTime"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.date),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.date)," ")}}function bl(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"form",3),g.Bc(4,ll,3,4,"label-value",4),g.Qb(5,"label-value",5),g.Lb(6,"user-link",6),g.Pb(),g.Qb(7,"label-value",5),g.Lb(8,"user-link",6),g.Pb(),g.Qb(9,"single-selection-field",7),g.Lb(10,"field-option",8),g.Lb(11,"field-option",8),g.Lb(12,"field-option",8),g.Lb(13,"field-option",8),g.Lb(14,"field-option",8),g.Pb(),g.Lb(15,"textarea-field",9),g.Pb(),g.Qb(16,"actions",10),g.Qb(17,"action-button",11),g.Xb("action",(function(){return g.sc(e),g.Zb().save()})),g.ac(18,"async"),g.Pb(),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.create?e.i18n.reference.title.set:e.i18n.reference.title.edit)("mobileHeading",e.create?e.i18n.reference.mobileTitle.set:e.i18n.reference.title.edit)("headingActions",g.bc(2,23,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("ngIf",!e.create),g.xb(1),g.gc("label",e.i18n.reference.from),g.xb(1),g.gc("user",e.data.from),g.xb(1),g.gc("label",e.i18n.reference.to),g.xb(1),g.gc("user",e.data.to),g.xb(1),g.gc("label",e.i18n.reference.level.level),g.xb(1),g.gc("value",e.ReferenceLevelEnum.VERY_BAD)("text",e.i18n.reference.level.veryBad),g.xb(1),g.gc("value",e.ReferenceLevelEnum.BAD)("text",e.i18n.reference.level.bad),g.xb(1),g.gc("value",e.ReferenceLevelEnum.NEUTRAL)("text",e.i18n.reference.level.neutral),g.xb(1),g.gc("value",e.ReferenceLevelEnum.GOOD)("text",e.i18n.reference.level.good),g.xb(1),g.gc("value",e.ReferenceLevelEnum.VERY_GOOD)("text",e.i18n.reference.level.veryGood),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("disabled",g.bc(18,25,e.requesting$))("label",e.i18n.general.submit)}}let ul=(()=>{class e extends l.a{constructor(e,t){super(e),this.referencesService=t,this.ReferenceLevelEnum=$e.ob}ngOnInit(){super.ngOnInit(),this.from=this.route.snapshot.params.from,this.to=this.route.snapshot.params.to,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.referencesService.getReferenceDataForSet({from:this.from,to:this.to}):this.referencesService.getReferenceDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){const t=e.reference;this.form=this.formBuilder.group({level:[t.level,h.F.required],comments:[t.comments,h.F.required],version:t.version})}save(){if(!Object(b.I)(this.form))return;const e=this.form.value,t=this.create?this.referencesService.setReference({body:e,from:this.ApiHelper.SELF,to:this.data.to.id}):this.referencesService.updateReference({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.i18n.reference.referenceSet),history.back()}))}resolveMenu(e){return this.menu.userMenu(e.from,u.b.REFERENCES)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb($c.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["set-reference"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],[3,"label",4,"ngIf"],[3,"label"],[3,"user"],["formControlName","level","required","",3,"label"],[3,"value","text"],["formControlName","comments","required","",3,"label"],["forceRow",""],[3,"disabled","label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,bl,19,27,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Q.a,Lt.a,Le.a,h.u,h.l,h.C,Ne.a,Bt.a,x.a,y.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();function dl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Qb(3,"label-value",3),g.Dc(4),g.ac(5,"dateTime"),g.Pb(),g.Qb(6,"label-value",3),g.Lb(7,"user-link",4),g.Pb(),g.Qb(8,"label-value",3),g.Lb(9,"user-link",4),g.Pb(),g.Qb(10,"label-value",3),g.Lb(11,"rating-stats",5),g.Pb(),g.Qb(12,"label-value",3),g.Dc(13),g.Pb(),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",e.i18n.reference.title.view)("mobileHeading",e.i18n.reference.mobileTitle.view)("headingActions",g.bc(2,13,e.headingActions$)),g.xb(2),g.gc("label",e.i18n.general.date),g.xb(1),g.Fc(" ",g.bc(5,15,e.data.date)," "),g.xb(2),g.gc("label",e.i18n.reference.from),g.xb(1),g.gc("user",e.data.from),g.xb(1),g.gc("label",e.i18n.reference.to),g.xb(1),g.gc("user",e.data.to),g.xb(1),g.gc("label",e.i18n.reference.level.level),g.xb(1),g.gc("level",e.data.level),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(1),g.Fc(" ",e.data.comments," ")}}let gl=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.referencesService=t,this.referenceHelper=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.referencesService.viewReference({id:this.id}).subscribe(e=>this.data=e))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.from)||this.authHelper.isSelfOrOwner(e.to);const t=[];e.canEdit&&t.push(new be.c(ue.a.Pencil,this.i18n.general.edit,()=>this.router.navigate(["/users","references","edit",this.id]),!0)),this.headingActions=t}resolveMenu(){return this.self?u.b.REFERENCES:this.menu.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb($c.a),g.Kb(Uc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-reference"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label"],[3,"user"],[3,"level"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,dl,14,17,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,Q.a,Lt.a,qc.a],pipes:[p.b,V.a],encapsulation:2,changeDetection:0}),e})();var fl=i("p46w"),ml=i.n(fl),pl=i("R8pA");function hl(e,t){if(1&e&&(g.Qb(0,"div",6),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.name,"")}}const vl=function(e){return{"ml-3":e}};function xl(e,t){if(1&e&&(g.Qb(0,"div",7),g.Lb(1,"input",8),g.Qb(2,"label",9),g.Qb(3,"div",10),g.Dc(4),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb().$implicit,n=g.Zb(2);g.gc("ngClass",g.jc(6,vl,i)),g.xb(1),g.gc("formControl",n.control)("id","group_"+e.id)("value",e.id),g.xb(1),g.gc("for","group_"+e.id),g.xb(2),g.Fc(" ",e.name," ")}}function yl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div"),g.Bc(2,hl,2,1,"div",4),g.Bc(3,xl,5,8,"div",5),g.Pb(),g.Nb()),2&e){const e=t.$implicit,i=g.Zb(2);g.xb(2),g.gc("ngIf",e),g.xb(1),g.gc("ngForOf",i.groupsForSet(e))}}function Pl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",2),g.Dc(2),g.Pb(),g.Bc(3,yl,4,2,"ng-container",3),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.user.registration.groupManager),g.xb(1),g.gc("ngForOf",e.groupSets)}}function Il(e,t){if(1&e&&g.Lb(0,"field-option",15),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.name)}}function El(e,t){if(1&e&&(g.Qb(0,"radio-group-field",13),g.Bc(1,Il,1,2,"field-option",14),g.Pb()),2&e){const e=g.Zb(2);g.gc("formControl",e.control),g.xb(1),g.gc("ngForOf",e.groups)}}function Al(e,t){if(1&e&&(g.Qb(0,"div",21),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc(" ",e.description," ")}}function Cl(e,t){if(1&e&&(g.Qb(0,"div",17),g.Qb(1,"div",18),g.Qb(2,"div",19),g.Lb(3,"input",8),g.Qb(4,"label",9),g.Qb(5,"div",10),g.Dc(6),g.Bc(7,Al,2,1,"div",20),g.Pb(),g.Pb(),g.Pb(),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(3),g.gc("formControl",i.control)("id","group_"+e.id)("value",e.id),g.xb(1),g.gc("for","group_"+e.id),g.xb(2),g.Fc(" ",e.name," "),g.xb(1),g.gc("ngIf",e.description)}}function Ol(e,t){if(1&e&&g.Bc(0,Cl,8,6,"div",16),2&e){const e=g.Zb(2);g.gc("ngForOf",e.groups)}}function Sl(e,t){if(1&e&&(g.Qb(0,"div",2),g.Dc(1),g.Pb(),g.Bc(2,El,2,2,"radio-group-field",11),g.Bc(3,Ol,1,1,"ng-template",null,12,g.Cc)),2&e){const e=g.qc(4),t=g.Zb();g.xb(1),g.Ec(t.i18n.user.registration.groupPublic),g.xb(1),g.gc("ngIf",t.singleLine)("ngIfElse",e)}}let Dl=(()=>{class e extends rs.a{constructor(e,t){super(e),this.login=t}ngOnInit(){super.ngOnInit(),this.singleLine=this.groups.length<=3&&0===this.groups.filter(e=>e.description).length}groupsForSet(e){return this.groups.filter(null==e?e=>null==e.groupSet:t=>t.groupSet&&[e.id,e.internalName].includes(t.groupSet))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(pl.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-group"]],inputs:{groupSets:"groupSets",groups:"groups",control:"control"},features:[g.ub],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["asGuest",""],[1,"mb-3"],[4,"ngFor","ngForOf"],["class","mt-3 mb-2","font-weight-bold","",4,"ngIf"],["class","custom-control custom-radio mb-1",3,"ngClass",4,"ngFor","ngForOf"],["font-weight-bold","",1,"mt-3","mb-2"],[1,"custom-control","custom-radio","mb-1",3,"ngClass"],["type","radio",1,"custom-control-input",3,"formControl","id","value"],[1,"custom-control-label",3,"for"],[1,"ml-1"],[3,"formControl",4,"ngIf","ngIfElse"],["multiLine",""],[3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["class","row mb-2",4,"ngFor","ngForOf"],[1,"row","mb-2"],[1,"col-12","col-6","col-sm-8"],[1,"custom-control","custom-radio"],["class","text-muted mt-1 mb-3",4,"ngIf"],[1,"text-muted","mt-1","mb-3"]],template:function(e,t){if(1&e&&(g.Bc(0,Pl,4,2,"ng-container",0),g.Bc(1,Sl,5,3,"ng-template",null,1,g.Cc)),2&e){const e=g.qc(2);g.gc("ngIf",t.login.user)("ngIfElse",e)}},directives:[p.t,p.s,p.q,h.z,h.e,h.u,h.k,Gc.a,Ne.a],encapsulation:2,changeDetection:0}),e})();var Ql=i("n7/T");function Fl(e,t){if(1&e&&g.Lb(0,"img",6),2&e){const e=g.Zb().$implicit;g.gc("src",e.image.url,g.uc)("alt",e.name)}}const wl=function(e,t,i){return{border:e,background:t,color:i}};function Ll(e,t){if(1&e){const e=g.Rb();g.Qb(0,"button",3),g.Xb("click",(function(){g.sc(e);const i=t.$implicit;return g.Zb().registerWith(i)})),g.Bc(1,Fl,1,2,"img",4),g.Lb(2,"span",5),g.ac(3,"trust"),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb();g.gc("ngStyle",g.lc(5,wl,"1px solid "+e.borderColor,e.backgroundColor,e.textColor)),g.xb(1),g.gc("ngIf",e.image),g.xb(1),g.gc("innerHTML",g.bc(3,3,i.i18n.identityProvider.login(e.name)),g.tc)}}let Nl=(()=>{class e extends rs.a{constructor(e,t){super(e),this.uiLayout=t,this.continue=new g.n}registerWith(e){this.continue.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Ql.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-idp"]],inputs:{identityProviders:"identityProviders"},outputs:{continue:"continue"},features:[g.ub],decls:5,vars:5,consts:[[1,"text-center"],["type","button","class","identity-provider centered-button",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"text-muted","text-justify","my-3",3,"innerHTML"],["type","button",1,"identity-provider","centered-button",3,"ngStyle","click"],["class","aria-hidden",3,"src","alt",4,"ngIf"],[3,"innerHTML"],[1,"aria-hidden",3,"src","alt"]],template:function(e,t){1&e&&(g.Qb(0,"div",0),g.Dc(1),g.Pb(),g.Bc(2,Ll,4,9,"button",1),g.Lb(3,"div",2),g.ac(4,"trust")),2&e&&(g.xb(1),g.Ec(t.i18n.identityProvider.registration),g.xb(1),g.gc("ngForOf",t.identityProviders),g.xb(1),g.gc("innerHTML",g.bc(4,3,t.i18n.identityProvider.registrationDisclaimer(t.dataForFrontendHolder.dataForFrontend.title)),g.tc))},directives:[p.s,p.w,p.t],pipes:[Wt.a],encapsulation:2,changeDetection:0}),e})();var Bl=i("HDdC"),kl=i("LRne");function Rl(e,t){if(1&e&&g.Lb(0,"avatar",18),2&e){const e=g.Zb(2);g.gc("image",e.image)}}function Tl(e,t){if(1&e&&g.Dc(0),2&e){const e=g.Zb(2);g.Fc(" ",e.i18n.user.noImage," ")}}function Zl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",22),g.Xb("action",(function(){return g.sc(e),g.Zb(3).removeImage()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("disabled",g.bc(1,2,e.requesting$))("label",e.i18n.field.image.remove)}}function Ml(e,t){if(1&e){const e=g.Rb();g.Qb(0,"div",19),g.Qb(1,"action-button",20),g.Xb("action",(function(){return g.sc(e),g.Zb(),g.qc(11).perform()})),g.ac(2,"async"),g.Pb(),g.Bc(3,Zl,2,4,"action-button",21),g.Pb()}if(2&e){const e=g.Zb(2);g.xb(1),g.gc("disabled",g.bc(2,3,e.requesting$))("label",e.i18n.field.image.upload),g.xb(2),g.gc("ngIf",e.image)}}function _l(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Qb(1,"h2",8),g.Dc(2),g.Pb(),g.Qb(3,"div",9),g.Qb(4,"div",10),g.Qb(5,"div",11),g.Bc(6,Rl,1,1,"avatar",12),g.ac(7,"async"),g.Bc(8,Tl,1,1,"ng-template",null,13,g.Cc),g.Pb(),g.Qb(10,"image-upload",14,15),g.Xb("uploadDone",(function(t){return g.sc(e),g.Zb().onUploadDone(t[0])})),g.Pb(),g.Pb(),g.Bc(12,Ml,4,5,"div",16),g.ac(13,"async"),g.Pb(),g.Qb(14,"h2",17),g.Dc(15),g.Pb(),g.Nb()}if(2&e){const e=g.qc(9),t=g.qc(11),i=g.Zb();g.xb(2),g.Ec(i.i18n.user.title.image),g.xb(4),g.gc("ngIf",g.bc(7,5,i.image$))("ngIfElse",e),g.xb(6),g.gc("ngIf",!1===g.bc(13,7,t.uploading$)),g.xb(3),g.Ec(i.i18n.user.title.fields)}}function $l(e,t){if(1&e&&(g.Qb(0,"label-value",23),g.Lb(1,"user-link",24),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.user.broker),g.xb(1),g.gc("user",e.data.broker)}}function Hl(e,t){if(1&e&&g.Lb(0,"input-field",25),2&e){const e=g.Zb();g.gc("label",e.i18n.user.name)}}function Ul(e,t){if(1&e&&g.Lb(0,"input-field",26),2&e){const e=g.Zb();g.gc("label",e.i18n.user.username)}}function Gl(e,t){if(1&e&&g.Lb(0,"field-privacy",31),2&e){const e=g.Zb(2);g.gc("control",e.form.get("hiddenFields"))}}function ql(e,t){if(1&e&&g.Lb(0,"boolean-field",32),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.skipActivationEmail)}}function Kl(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"label-value",27),g.Lb(2,"input-field",28),g.Bc(3,Gl,1,1,"field-privacy",29),g.Pb(),g.Bc(4,ql,1,1,"boolean-field",30),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("label",e.i18n.user.email)("ignoreExtraCell",!e.canManagePrivacy("email"))("required",e.data.emailRequired),g.xb(1),g.gc("required",e.data.emailRequired),g.xb(2),g.gc("ngIf",e.data.allowSetSendActivationEmail)}}function Vl(e,t){if(1&e&&g.Lb(0,"field-privacy",37),2&e){const e=g.Zb(2).$implicit,t=g.Zb();g.gc("field",e.internalName)("control",t.form.get("hiddenFields"))}}function jl(e,t){if(1&e){const e=g.Rb();g.Qb(0,"label-value",34),g.Qb(1,"custom-field-input",35),g.Xb("imagesUploaded",(function(t){return g.sc(e),g.Zb(2).customImagesUploaded.emit(t)}))("filesUploaded",(function(t){return g.sc(e),g.Zb(2).customFilesUploaded.emit(t)})),g.Pb(),g.Bc(2,Vl,1,2,"field-privacy",36),g.Pb()}if(2&e){const e=g.Zb().$implicit,t=g.Zb();g.gc("label",e.name)("ignoreExtraCell",!t.canManagePrivacy(e))("fieldSize",e.size)("required",e.required),g.xb(1),g.gc("field",e)("formControlName",e.internalName)}}function zl(e,t){if(1&e&&(g.Ob(0,1),g.Bc(1,jl,3,6,"label-value",33),g.Nb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("formGroup",i.form.get("customValues")),g.xb(1),g.gc("ngIf",i.canEdit(e))}}function Xl(e,t){if(1&e&&g.Lb(0,"field-privacy",41),2&e){const e=g.Zb(2);g.gc("control",e.mobileForm.get("hidden"))}}function Yl(e,t){if(1&e&&(g.Qb(0,"label-value",38),g.Lb(1,"input-field",39),g.Bc(2,Xl,1,1,"field-privacy",40),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.phone.mobile)("required","required"===e.mobileAvailability)("formGroup",e.mobileForm),g.xb(1),g.gc("placeholder",e.data.phoneConfiguration.mobileExample)}}function Wl(e,t){if(1&e&&g.Lb(0,"field-privacy",41),2&e){const e=g.Zb(2);g.gc("control",e.landLineForm.get("hidden"))}}function Jl(e,t){if(1&e&&g.Lb(0,"input-field",44),2&e){const e=g.Zb(2);g.gc("label",e.i18n.phone.extension)}}function eb(e,t){if(1&e&&(g.Ob(0,1),g.Qb(1,"label-value",42),g.Lb(2,"input-field",39),g.Bc(3,Wl,1,1,"field-privacy",40),g.Pb(),g.Bc(4,Jl,1,1,"input-field",43),g.Nb()),2&e){const e=g.Zb();g.gc("formGroup",e.landLineForm),g.xb(1),g.gc("label",e.i18n.phone.landLine)("required","required"===e.data.phoneConfiguration.landLineAvailability),g.xb(1),g.gc("placeholder",e.data.phoneConfiguration.landLineExample),g.xb(2),g.gc("ngIf",e.data.phoneConfiguration.extensionEnabled)}}function tb(e,t){if(1&e&&g.Lb(0,"boolean-field",48),2&e){const e=g.Zb(2);g.gc("formControl",e.defineAddress)("label",e.i18n.user.addressDefine)}}function ib(e,t){if(1&e&&g.Lb(0,"address-form",49),2&e){const e=g.Zb(2);g.gc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration)("managePrivacy",e.data.addressConfiguration.managePrivacy)}}function nb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"static-map",53),g.Xb("imageLoaded",(function(){return g.sc(e),g.Zb(3).mapShown()})),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("address",e.addressForm.value)}}function ab(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",20),g.Xb("action",(function(){return g.sc(e),g.Zb(3).locateAddress()})),g.ac(1,"async"),g.Pb()}if(2&e){const e=g.Zb(3);g.gc("disabled",g.bc(1,2,e.locatingAddress$))("label",e.i18n.general.mapView)}}function sb(e,t){if(1&e&&(g.Qb(0,"label-value",50),g.Bc(1,nb,1,1,"static-map",51),g.ac(2,"async"),g.Bc(3,ab,2,4,"ng-template",null,52,g.Cc),g.Pb()),2&e){const e=g.qc(4),t=g.Zb(2);var i;g.gc("label",t.i18n.general.map),g.xb(1),g.gc("ngIf",null!=(null==(i=g.bc(2,3,t.addressForm.get("location").valueChanges))?null:i.latitude))("ngIfElse",e)}}function ob(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2",17),g.Dc(2),g.Pb(),g.Bc(3,tb,1,2,"boolean-field",45),g.Bc(4,ib,1,3,"address-form",46),g.Bc(5,sb,5,5,"label-value",47),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.Ec(e.i18n.address.address),g.xb(1),g.gc("ngIf","required"!==e.data.addressConfiguration.availability),g.xb(1),g.gc("ngIf",e.defineAddress.value),g.xb(1),g.gc("ngIf",e.defineAddress.value&&e.maps.enabled)}}let rb=(()=>{class e extends rs.a{constructor(e,t,i,n,a){super(e),this.userHelper=t,this.imagesService=i,this.maps=n,this.changeDetector=a,this.imageUploaded=new g.n,this.imageRemoved=new g.n,this.customImagesUploaded=new g.n,this.customFilesUploaded=new g.n,this.image$=new wt.a(null),this.location$=new wt.a(null),this.locatingAddress$=new wt.a(!1)}get image(){return this.image$.value}set image(e){this.image$.next(e)}get location(){return this.location$.value}set location(e){this.location$.next(e)}ngOnInit(){super.ngOnInit(),this.editableFields=this.userHelper.fieldNamesByAction(this.data,"edit"),this.managePrivacyFields=this.userHelper.fieldNamesByAction(this.data,"managePrivacy")}get mobileAvailability(){return this.data.phoneConfiguration.mobileAvailability}get landLineAvailability(){return this.data.phoneConfiguration.landLineAvailability}get addressAvailability(){return this.data.addressConfiguration.availability}get imageAvailability(){return this.data.imageConfiguration.availability}onUploadDone(e){this.addSub(this.doRemoveImage().subscribe(()=>{this.image=e,this.imageUploaded.emit(this.image),this.changeDetector.detectChanges()}))}removeImage(){this.addSub(this.doRemoveImage().subscribe())}doRemoveImage(){if(this.image){const e=this.image;return this.errorHandler.requestWithCustomErrorHandler(()=>new Bl.a(t=>{this.imagesService.deleteImage({idOrKey:this.image.id}).subscribe(()=>{this.imageRemoved.emit(this.image),this.image=null,this.changeDetector.detectChanges(),t.next(e)})}))}return Object(kl.a)(null)}canEdit(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}canManagePrivacy(e){return this.managePrivacyFields.has(this.fieldHelper.fieldName(e))}locateAddress(){const e=this.addressForm.value;this.locatingAddress$.next(!0),this.addSub(this.maps.geocode(e).subscribe(e=>{this.addressForm.patchValue({location:e}),this.changeDetector.detectChanges()},()=>this.mapShown()))}mapShown(){this.locatingAddress$.next(!1),this.changeDetector.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(Fo.a),g.Kb(Ro.a),g.Kb(g.h))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-fields"]],inputs:{data:"data",form:"form",mobileForm:"mobileForm",landLineForm:"landLineForm",addressForm:"addressForm",defineAddress:"defineAddress",image:"image"},outputs:{imageUploaded:"imageUploaded",imageRemoved:"imageRemoved",customImagesUploaded:"customImagesUploaded",customFilesUploaded:"customFilesUploaded"},features:[g.ub],decls:10,vars:10,consts:[[4,"ngIf"],[3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],["kind","field",3,"label","required","formGroup",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"border-0"],[1,"row"],[1,"col-12","col-sm-4"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image",4,"ngIf","ngIfElse"],["noImage",""],["containerClass","mt-3","target","userRegistration","keepUrls","",3,"uploadDone"],["upload",""],["class","col-12 col-sm-8 mt-3 mt-sm-0 d-flex justify-content-between justify-content-sm-end align-items-end",4,"ngIf"],[1,"mt-4"],["size","huge","useLightbox","",3,"image"],[1,"col-12","col-sm-8","mt-3","mt-sm-0","d-flex","justify-content-between","justify-content-sm-end","align-items-end"],["outline","",3,"disabled","label","action"],["class","ml-3","outline","",3,"disabled","label","action",4,"ngIf"],["outline","",1,"ml-3",3,"disabled","label","action"],[3,"label"],["hideLink","",3,"user"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["kind","field",3,"label","ignoreExtraCell","required"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["field","email",3,"control"],["formControlName","skipActivationEmail",3,"label"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required",4,"ngIf"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","imagesUploaded","filesUploaded"],[3,"field","control",4,"extraCell"],[3,"field","control"],["kind","field",3,"label","required","formGroup"],["formControlName","number",3,"placeholder"],[3,"control",4,"extraCell"],[3,"control"],["kind","field",3,"label","required"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["switch","",3,"formControl","label",4,"ngIf"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy",4,"ngIf"],["kind","field",3,"label",4,"ngIf"],["switch","",3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"]],template:function(e,t){1&e&&(g.Bc(0,_l,16,9,"ng-container",0),g.Ob(1,1),g.Bc(2,$l,2,2,"label-value",2),g.Bc(3,Hl,1,1,"input-field",3),g.Bc(4,Ul,1,1,"input-field",4),g.Bc(5,Kl,5,5,"ng-container",0),g.Nb(),g.Bc(6,zl,2,2,"ng-container",5),g.Bc(7,Yl,3,4,"label-value",6),g.Bc(8,eb,5,5,"ng-container",7),g.Bc(9,ob,6,4,"ng-container",0)),2&e&&(g.gc("ngIf","disabled"!==t.imageAvailability),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.data.broker),g.xb(1),g.gc("ngIf",t.canEdit("name")),g.xb(1),g.gc("ngIf",t.canEdit("username")),g.xb(1),g.gc("ngIf",t.canEdit("email")),g.xb(1),g.gc("ngForOf",t.data.customFields),g.xb(1),g.gc("ngIf","disabled"!==t.mobileAvailability),g.xb(1),g.gc("ngIf","disabled"!==t.landLineAvailability),g.xb(1),g.gc("ngIf","disabled"!==t.addressAvailability))},directives:[p.t,h.v,h.n,p.s,$o.a,ke.a,y.a,Q.a,Lt.a,Nt.a,h.u,h.l,h.C,Ho.a,Uo.a,v.a,Yt.a,h.k,Go.a,qo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var cb=i("UnhA"),lb=i("g9Ug");const bb=["securityAnswer"];function ub(e,t){if(1&e&&(g.Qb(0,"div",10),g.Lb(1,"avatar",11),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.gc("image",e.image)}}function db(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"avatar",13),g.Pb()),2&e){const e=g.Zb();g.xb(1),g.gc("size",e.image?200:128)("image",e.image)}}function gb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.group)("value",e.group.name)}}function fb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.name)("value",e.name)}}function mb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.username)("value",e.username)}}function pb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.email)("value",e.email)}}function hb(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"format-field-value",16),g.Pb()),2&e){const e=t.$implicit,i=g.Zb();g.gc("label",e.name),g.xb(1),g.gc("fields",i.customFields)("fieldName",e.internalName)("object",i.user)("images",i.customImages)("files",i.customFiles)}}function vb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.phone.mobile)("value",e.mobile)}}function xb(e,t){if(1&e&&g.Lb(0,"label-value",14),2&e){const e=g.Zb();g.gc("label",e.i18n.user.phoneAddLandLine)("value",e.landLine)}}function yb(e,t){if(1&e&&(g.Qb(0,"label-value",15),g.Lb(1,"address-details",17),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.address.address),g.xb(1),g.gc("address",e.address)}}function Pb(e,t){if(1&e&&(g.Qb(0,"div",20),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Ec(e.description)}}function Ib(e,t){if(1&e&&g.Lb(0,"boolean-field",21),2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.passwordAssign)}}function Eb(e,t){if(1&e&&g.Lb(0,"boolean-field",25),2&e){const e=g.Zb(3);g.gc("label",e.i18n.user.registration.passwordForceChange)}}function Ab(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"input-field",22),g.Lb(2,"input-field",23),g.Bc(3,Eb,1,1,"boolean-field",24),g.Nb()),2&e){const e=g.Zb().$implicit,t=g.Zb();g.xb(1),g.gc("label",e.name),g.xb(1),g.gc("label",t.i18n.user.passwordConfirmation(e.name)),g.xb(1),g.gc("ngIf",e.canForceChange)}}function Cb(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Ob(3,7),g.Bc(4,Pb,2,1,"div",18),g.Bc(5,Ib,1,1,"boolean-field",19),g.Bc(6,Ab,4,3,"ng-container",9),g.Nb(),g.Nb()),2&e){const e=t.$implicit,i=t.index,n=g.Zb();g.xb(2),g.Ec(e.name),g.xb(1),g.gc("formGroup",n.passwordForm(i)),g.xb(1),g.gc("ngIf",e.description),g.xb(1),g.gc("ngIf",n.login.user),g.xb(1),g.gc("ngIf",n.passwordForm(i).get("defined").value)}}function Ob(e,t){if(1&e&&g.Lb(0,"field-option",29),2&e){const e=t.$implicit;g.gc("value",e.internalName)("text",e.name)}}function Sb(e,t){if(1&e&&g.Lb(0,"input-field",30,31),2&e){const e=g.Zb(3);g.gc("label",e.i18n.securityQuestion.answer)}}function Db(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"div",20),g.Dc(4),g.Pb(),g.Qb(5,"single-selection-field",26),g.Bc(6,Ob,1,2,"field-option",27),g.Pb(),g.Bc(7,Sb,2,1,"input-field",28),g.ac(8,"async"),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Ec(e.i18n.securityQuestion.question),g.xb(2),g.Fc(" ",e.i18n.user.securityQuestionMessage," "),g.xb(1),g.gc("label",e.i18n.securityQuestion.question)("emptyOption",e.i18n.user.securityQuestionEmpty),g.xb(1),g.gc("ngForOf",e.data.securityQuestions),g.xb(1),g.gc("ngIf",!e.empty(g.bc(8,6,e.form.get("securityQuestion").valueChanges)))}}function Qb(e,t){if(1&e&&(g.Qb(0,"div",35),g.Qb(1,"div",36),g.Dc(2),g.Pb(),g.Lb(3,"accept-agreements",37),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Ec(e.i18n.pendingAgreements.preface),g.xb(1),g.gc("agreements",e.data.agreements)}}function Fb(e,t){if(1&e&&(g.Qb(0,"div",38),g.Qb(1,"div",36),g.Dc(2),g.Pb(),g.Qb(3,"div",36),g.Lb(4,"captcha",39),g.Pb(),g.Pb()),2&e){const e=g.Zb(3);g.xb(2),g.Ec(e.i18n.user.captcha),g.xb(2),g.gc("form",e.form.get("captcha"))}}function wb(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"h2"),g.Dc(2),g.Pb(),g.Qb(3,"div",32),g.Bc(4,Qb,4,2,"div",33),g.Bc(5,Fb,5,2,"div",34),g.Pb(),g.Nb()),2&e){const e=g.Zb(2);g.xb(2),g.Fc(" ",e.i18n.user.title.registrationConfirmation," "),g.xb(2),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>0),g.xb(1),g.gc("ngIf",null!=e.data.captchaType)}}function Lb(e,t){if(1&e&&(g.Ob(0),g.Bc(1,Db,9,8,"ng-container",9),g.Bc(2,wb,6,3,"ng-container",9),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("ngIf",(null==e.data.securityQuestions?null:e.data.securityQuestions.length)>0),g.xb(1),g.gc("ngIf",(null==e.data.agreements?null:e.data.agreements.length)>0||null!=e.data.captchaType)}}let Nb=(()=>{class e extends rs.a{constructor(e,t){super(e),this.login=t,this.empty=b.i,this.focusSecurityAnswer=!1}ngOnInit(){if(super.ngOnInit(),Object(b.i)(this.data.securityQuestions)||this.addSub(this.form.get("securityQuestion").valueChanges.subscribe(e=>{this.focusSecurityAnswer=!Object(b.b)(e)})),!Object(b.i)(this.data.agreements)){const e=this.data.agreements.map(()=>!1);this.agreementsControl=this.formBuilder.array(e),this.addSub(this.agreementsControl.valueChanges.subscribe(e=>{const t=e.length===e.filter(e=>e).length;this.form.patchValue({acceptAgreement:t})}))}}ngAfterViewChecked(){this.focusSecurityAnswer&&(this.securityAnswer.forEach(e=>Object(b.k)(e)),this.focusSecurityAnswer=!1)}passwordForm(e){return this.form.get("passwords").controls[e]}get group(){const e=this.dataForFrontendHolder.dataForUi.publicRegistrationGroups||[];return 1===e.length?null:e.find(e=>e.id===this.user.group)}get name(){return(this.user.name||"").trim()}get username(){return(this.user.username||"").trim()}get email(){return(this.user.email||"").trim()}get mobile(){const e=this.user.mobilePhones||[];return Object(b.i)(e)?null:(e[0].number||"").trim()}get landLine(){const e=this.user.landLinePhones||[],t=Object(b.i)(e)?null:(e[0].number||"").trim();if(Object(b.i)(t))return"";const i=Object(b.i)(e)?null:(e[0].extension||"").trim();return""===i?t:this.i18n.phone.numberExtensionValue({number:t,extension:i})}get address(){const e=this.user.addresses||[];return Object(b.i)(e)?null:e[0]}get customFields(){return this.data.customFields.filter(e=>!Object(b.b)(this.user.customValues[e.internalName]))}get autocompletePasswords(){return(this.login.auth||{}).role?"off":"on"}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(pl.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-confirm"]],viewQuery:function(e,t){var i;1&e&&g.Hc(bb,!0),2&e&&g.pc(i=g.Yb())&&(t.securityAnswer=i)},inputs:{data:"data",form:"form",user:"user",image:"image",customImages:"customImages",customFiles:"customFiles"},features:[g.ub],decls:17,vars:17,consts:[["class","image d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4 mb-3",4,"ngIf"],[1,"flex-grow-1","mb-ls"],[3,"label","value",4,"ngIf"],["valueFormat","component",3,"label",4,"ngFor","ngForOf"],["valueFormat","component",3,"label",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"image","ml-4","mb-3"],["iconSize","128px","useLightbox","",3,"size","image"],[3,"label","value"],["valueFormat","component",3,"label"],[3,"fields","fieldName","object","images","files"],[3,"address"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],["formControlName","securityQuestion",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label",4,"ngIf"],[3,"value","text"],["formControlName","securityAnswer","required","",3,"label"],["securityAnswer",""],[1,"row","no-gutters"],["class","col-12 col-sm-6 col-md-7",4,"ngIf"],["class","col-12 col-sm-6 col-md-5",4,"ngIf"],[1,"col-12","col-sm-6","col-md-7"],[1,"mb-3"],["formControlName","acceptAgreements",3,"agreements"],[1,"col-12","col-sm-6","col-md-5"],[3,"form"]],template:function(e,t){1&e&&(g.Bc(0,ub,2,1,"div",0),g.ac(1,"async"),g.Qb(2,"div",1),g.Bc(3,db,2,2,"div",2),g.ac(4,"async"),g.Qb(5,"div",3),g.Bc(6,gb,1,2,"label-value",4),g.Bc(7,fb,1,2,"label-value",4),g.Bc(8,mb,1,2,"label-value",4),g.Bc(9,pb,1,2,"label-value",4),g.Bc(10,hb,2,6,"label-value",5),g.Bc(11,vb,1,2,"label-value",4),g.Bc(12,xb,1,2,"label-value",4),g.Bc(13,yb,2,2,"label-value",6),g.Pb(),g.Pb(),g.Qb(14,"form",7),g.Bc(15,Cb,7,5,"ng-container",8),g.Bc(16,Lb,3,2,"ng-container",9),g.Pb()),2&e&&(g.gc("ngIf",t.image&&g.bc(1,13,t.layout.ltsm$)),g.xb(3),g.gc("ngIf",t.image&&g.bc(4,15,t.layout.gtxs$)),g.xb(3),g.gc("ngIf",t.group),g.xb(1),g.gc("ngIf",!t.empty(t.name)),g.xb(1),g.gc("ngIf",!t.empty(t.username)),g.xb(1),g.gc("ngIf",!t.empty(t.email)),g.xb(1),g.gc("ngForOf",t.customFields),g.xb(1),g.gc("ngIf",!t.empty(t.mobile)),g.xb(1),g.gc("ngIf",!t.empty(t.landLine)),g.xb(1),g.gc("ngIf",t.address),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngForOf",t.data.passwordTypes),g.xb(1),g.gc("ngIf",!t.login.user))},directives:[p.t,p.s,h.H,h.v,h.n,ke.a,Q.a,bs.a,cb.a,v.a,h.u,h.l,Nt.a,h.C,Le.a,Ne.a,de.a,lb.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function Bb(e,t){if(1&e&&(g.Ob(0),g.Lb(1,"p",0),g.ac(2,"trust"),g.Qb(3,"p"),g.Dc(4),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("innerHTML",g.bc(2,2,e.principalsHtml),g.tc),g.xb(3),g.Ec(e.passwordsMessage)}}let kb=(()=>{class e extends rs.a{constructor(e,t,i){super(e),this.login=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.messageHtml=this.userHelper.registrationMessageHtml(this.result,!!this.dataForFrontendHolder.user),this.principalsHtml=this.userHelper.registrationPrincipalsHtml(this.result),this.passwordsMessage=this.userHelper.registrationPasswordsMessage(this.result)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(pl.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["registration-step-done"]],inputs:{result:"result"},features:[g.ub],decls:3,vars:4,consts:[[3,"innerHTML"],[4,"ngIf"]],template:function(e,t){1&e&&(g.Lb(0,"p",0),g.ac(1,"trust"),g.Bc(2,Bb,5,4,"ng-container",1)),2&e&&(g.gc("innerHTML",g.bc(1,2,t.messageHtml),g.tc),g.xb(2),g.gc("ngIf",null==t.login.user&&"active"==t.result.status))},directives:[p.t],pipes:[Wt.a],encapsulation:2,changeDetection:0}),e})();function Rb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-group",5),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().showIdentityProviders()})),g.ac(6,"async"),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,8,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("groupSets",e.groupSets)("groups",e.groups)("control",e.group),g.xb(2),g.gc("disabled",g.bc(6,10,e.requesting$))("label",e.i18n.general.next)}}function Tb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).backToGroup()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.previous)}}function Zb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Qb(3,"registration-step-idp",8),g.Xb("continue",(function(t){return g.sc(e),g.Zb().continueWithProvider(t)})),g.Pb(),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().continueWithProvider(null)})),g.ac(6,"async"),g.Pb(),g.Bc(7,Tb,1,1,"action-button",9),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("identityProviders",e.data.identityProviders),g.xb(2),g.gc("disabled",g.bc(6,9,e.requesting$))("label",e.i18n.general.skip),g.xb(2),g.gc("ngIf",e.groups.length>1)}}function Mb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).backToIdentityProviders()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.previous)}}function _b(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Qb(3,"registration-step-fields",11),g.Xb("imageUploaded",(function(t){return g.sc(e),g.Zb().image=t}))("imageRemoved",(function(){return g.sc(e),g.Zb().image=null}))("customImagesUploaded",(function(t){return g.sc(e),g.Zb().addCustomImages(t)}))("customFilesUploaded",(function(t){return g.sc(e),g.Zb().addCustomFiles(t)})),g.Pb(),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().showConfirm()})),g.ac(6,"async"),g.Pb(),g.Bc(7,Mb,1,1,"action-button",9),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registration)("mobileHeading",e.i18n.user.mobileTitle.registration)("mode",g.bc(1,13,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("data",e.data)("form",e.form)("mobileForm",e.mobileForm)("landLineForm",e.landLineForm)("defineAddress",e.defineAddress)("addressForm",e.addressForm)("image",e.image),g.xb(2),g.gc("disabled",g.bc(6,15,e.requesting$))("label",e.i18n.general.next),g.xb(2),g.gc("ngIf",e.groups.length>1||(null==e.data.identityProviders?null:e.data.identityProviders.length)>0)}}function $b(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-confirm",12),g.Pb(),g.Qb(4,"actions",6),g.Qb(5,"action-button",7),g.Xb("action",(function(){return g.sc(e),g.Zb().register()})),g.ac(6,"async"),g.Pb(),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb().backToFields()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registrationConfirmation)("mobileHeading",e.i18n.user.mobileTitle.registrationConfirmation)("mode",g.bc(1,12,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("data",e.data)("form",e.confirmForm)("user",e.userNew)("image",e.image)("customImages",e.customImages)("customFiles",e.customFiles),g.xb(2),g.gc("disabled",g.bc(6,14,e.requesting$))("label",e.i18n.general.submit),g.xb(2),g.gc("label",e.i18n.general.previous)}}function Hb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).reload()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.registerAnotherUser)}}function Ub(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).viewProfile()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.user.registration.viewProfile)}}function Gb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"action-button",15),g.Xb("action",(function(){return g.sc(e),g.Zb(2).goToLogin()})),g.Pb()}if(2&e){const e=g.Zb(2);g.gc("label",e.i18n.menu.login)}}function qb(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"div",4),g.Lb(3,"registration-step-done",13),g.ac(4,"async"),g.Pb(),g.Qb(5,"actions",6),g.Bc(6,Hb,1,1,"action-button",14),g.Bc(7,Ub,1,1,"action-button",14),g.Bc(8,Gb,1,1,"action-button",14),g.Pb(),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.i18n.user.title.registrationDone)("mobileHeading",e.i18n.user.mobileTitle.registrationDone)("mode",g.bc(1,7,e.layout.ltsm$)?"fullHeight":"normal"),g.xb(3),g.gc("result",g.bc(4,9,e.result$)),g.xb(3),g.gc("ngIf",e.login.user),g.xb(1),g.gc("ngIf",e.login.user),g.xb(1),g.gc("ngIf",!e.login.user)}}function Kb(e,t){1&e&&(g.Qb(0,"page-content"),g.Lb(1,"spinner"),g.Pb())}let Vb=(()=>{class e extends l.a{constructor(e,t,i,n,a){super(e),this.usersService=t,this.userHelper=i,this.imagesService=n,this.nextRequestState=a,this.steps=["group","idp","fields","confirm","done"],this.customImages=[],this.customFiles=[],this.asyncValidatorsEnabled=!1,this.step$=new wt.a(null),this.result$=new wt.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}get result(){return this.result$.value}set result(e){this.result$.next(e)}ngOnInit(){super.ngOnInit();const e=(this.login.auth||{}).role;if(null==e){const e=this.dataForFrontendHolder.dataForUi;let t;if(t=this.layout.ltmd?e.smallScreenRegistrationWizard:this.layout.md?e.mediumScreenRegistrationWizard:e.largeScreenRegistrationWizard,t)return void this.router.navigate(["wizards","registration",c.a.internalNameOrId(t)],{replaceUrl:!0});this.initializeGroups(e.publicRegistrationGroups)}else this.addSub(this.usersService.getUserDataForSearch({broker:e===$e.pb.BROKER?c.a.SELF:null,fields:["groupsForRegistration"]}).subscribe(e=>{this.groupSets=e.groupsForRegistration.filter(e=>e.kind===$e.F.GROUP_SET),e.groupsForRegistration.find(e=>e.kind!==$e.F.GROUP_SET&&null==e.groupSet)&&this.groupSets.unshift(null),this.initializeGroups(e.groupsForRegistration.filter(e=>e.kind!==$e.F.GROUP_SET))}))}initializeGroups(e){null==this.groups&&(this.groups=e,Object(b.i)(this.groups)?this.router.navigateByUrl("/"):(this.group=new h.j(e[0].id,h.F.required),1===e.length?(this.steps=this.steps.filter(e=>"group"!==e),this.showIdentityProviders()):this.step="group"))}ngOnDestroy(){super.ngOnDestroy(),this.image&&(URL.revokeObjectURL(this.image.url),this.errorHandler.requestWithCustomErrorHandler(()=>{this.addSub(this.imagesService.deleteImage({idOrKey:this.image.id}).subscribe())}))}showIdentityProviders(){this.addSub(this.usersService.getUserDataForNew({group:this.group.value,inviteToken:ml.a.get("inviteToken"),fields:["-agreements.content"]}).subscribe(e=>{this.data=e,Object(b.i)(e.identityProviders)?this.showFields():this.step="idp"}))}continueWithProvider(e){e?this.authHelper.identityProviderPopup(e,"register",this.group.value).pipe(Object(_o.a)()).subscribe(e=>{switch(e.status){case $e.G.REGISTRATION_DONE:this.nextRequestState.replaceSession(e.sessionToken).pipe(Object(_o.a)()).subscribe(()=>{Object(b.D)(!0),this.dataForFrontendHolder.initialize().pipe(Object(_o.a)()).subscribe(e=>{Object(b.D)(!1),c.a.isRestrictedAccess(e)||this.router.navigateByUrl("")})});break;case $e.G.REGISTRATION_DATA:this.identityProviderRequestId=e.requestId,this.data.captchaType=null;const t=this.data.user;if(e.name&&(t.name=e.name),e.username&&(t.username=e.username),e.email&&(t.email=e.email),e.mobilePhone&&(t.mobilePhones=[{number:e.mobilePhone}]),e.landLinePhone&&(t.landLinePhones=[{number:e.landLinePhone,extension:e.landLineExtension}]),e.customValues){t.customValues||(t.customValues={});for(const i of Object.keys(e.customValues))t.customValues[i]=e.customValues[i]}e.image&&(t.images=[e.image.id],this.image=e.image),this.showFields();break;default:this.notification.error(e.errorMessage||this.i18n.error.general)}}):this.showFields()}showFields(){this.prepareForms(this.data),Object(b.l)()}backToGroup(){this.form=null,this.data=null,this.step="group"}backToIdentityProviders(){this.data&&!Object(b.i)(this.data.identityProviders)?this.step="idp":this.backToGroup()}backToFields(){this.confirmForm=null,this.step="fields"}prepareForms(e){let t;this.form=this.formBuilder.group({group:this.group.value,hiddenFields:[e.user.hiddenFields||[]]}),[this.mobileForm,this.landLineForm]=this.userHelper.setupRegistrationForm(this.form,e,!this.login.user),[this.addressForm,this.defineAddress,t]=this.userHelper.registrationAddressForm(e.addressConfiguration),t.forEach(e=>this.addSub(e)),this.data=e,this.step="fields"}showConfirm(){const e=new h.m({user:this.form});this.mobileForm&&e.setControl("mobile",this.mobileForm),this.landLineForm&&e.setControl("landLine",this.landLineForm),this.addressForm&&this.defineAddress.value&&e.setControl("address",this.addressForm),this.asyncValidatorsEnabled=!0;const t=Object(b.I)(e,!0);this.addSub(Object(b.w)(t).subscribe(e=>{this.asyncValidatorsEnabled=!1,e?this.doShowConfirm():Object(b.m)()}))}doShowConfirm(){const e=this.data;this.confirmForm=this.formBuilder.group({});const t=this.userHelper.passwordRegistrationForms(e);this.confirmForm.setControl("passwords",this.formBuilder.array(t)),Object(b.i)(e.securityQuestions)||(this.confirmForm.setControl("securityQuestion",this.formBuilder.control("")),this.confirmForm.setControl("securityAnswer",this.formBuilder.control("",this.userHelper.securityAnswerValidation))),Object(b.i)(e.agreements)||this.confirmForm.setControl("acceptAgreements",this.formBuilder.control([])),null!=e.captchaType&&this.confirmForm.setControl("captcha",this.authHelper.captchaFormGroup()),this.step="confirm",Object(b.A)()}register(){const e=Object(b.I)(this.confirmForm,!0);this.addSub(Object(b.w)(e).subscribe(e=>{e?this.addSub(this.usersService.createUser({body:this.userNew}).subscribe(e=>{this.result=e,this.image=null,ml.a.remove("inviteToken",{path:"/"}),this.step="done"})):Object(b.m)()}))}get userNew(){const e=this.form.value;e.identityProviderRequestId=this.identityProviderRequestId;const t=(this.mobileForm||{}).value,i=(this.landLineForm||{}).value,n=(this.addressForm||{}).value;return this.image&&(e.images=[this.image.id]),t&&!Object(b.b)(t.number)&&(e.mobilePhones=[t]),i&&!Object(b.b)(i.number)&&(e.landLinePhones=[i]),n&&this.defineAddress.value&&(e.addresses=[n]),Object(b.f)(this.confirmForm.value,e),e.inviteToken=ml.a.get("inviteToken"),e}goToLogin(){this.login.goToLoginPage("")}viewProfile(){const e=this.result;e&&this.router.navigate(["users",e.user.id,"profile"])}addCustomImages(e){this.customImages=[...this.customImages,...e]}addCustomFiles(e){this.customFiles=[...this.customFiles,...e]}resolveMenu(){switch(this.dataForFrontendHolder.role){case $e.pb.ADMINISTRATOR:return u.b.ADMIN_REGISTRATION;case $e.pb.BROKER:return u.b.BROKER_REGISTRATION;default:return u.b.PUBLIC_REGISTRATION}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Lo.a),g.Kb(T.a),g.Kb(Fo.a),g.Kb(Gs.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["user-registration"]],features:[g.ub],decls:9,vars:11,consts:[["size","large",3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1"],[3,"groupSets","groups","control"],["forceRow",""],[3,"disabled","label","action"],[3,"identityProviders","continue"],["outline","",3,"label","action",4,"ngIf"],["outline","",3,"label","action"],[3,"data","form","mobileForm","landLineForm","defineAddress","addressForm","image","imageUploaded","imageRemoved","customImagesUploaded","customFilesUploaded"],[3,"data","form","user","image","customImages","customFiles"],[3,"result"],[3,"label","action",4,"ngIf"],[3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.ac(2,"async"),g.Bc(3,Rb,7,12,"page-content",1),g.Bc(4,Zb,8,11,"page-content",1),g.Bc(5,_b,8,17,"page-content",1),g.Bc(6,$b,8,16,"page-content",1),g.Bc(7,qb,9,11,"page-content",1),g.Bc(8,Kb,2,0,"page-content",2),g.Pb()),2&e&&(g.gc("ready",g.bc(1,7,t.step$))("ngSwitch",g.bc(2,9,t.step$)),g.xb(3),g.gc("ngSwitchCase","group"),g.xb(1),g.gc("ngSwitchCase","idp"),g.xb(1),g.gc("ngSwitchCase","fields"),g.xb(1),g.gc("ngSwitchCase","confirm"),g.xb(1),g.gc("ngSwitchCase","done"))},directives:[f.a,p.x,p.y,p.z,m.a,Dl,x.a,y.a,Nl,p.t,rb,Nb,kb,jo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function jb(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content"),g.Lb(1,"registration-step-done",2),g.Qb(2,"actions"),g.Qb(3,"action-button",3),g.Xb("action",(function(){return g.sc(e),g.Zb().goToLogin()})),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=g.Zb();g.xb(1),g.gc("result",e.result),g.xb(2),g.gc("label",e.i18n.menu.login)}}let zb=(()=>{class e extends l.a{constructor(e,t){super(e),this.validationService=t}get result(){return this.data}ngOnInit(){this.addSub(this.validationService.validateUserRegistration({key:this.route.snapshot.params.key}).subscribe(e=>{this.data=e}))}goToLogin(){this.login.goToLoginPage("")}resolveMenu(){return this.menu.homeMenu()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Zc.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["validate-registration"]],features:[g.ub],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"result"],[3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,jb,4,2,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,kb,x.a,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Xb=i("oWwz");const Yb=["field"],Wb=function(){return{excludeContacts:!0}};let Jb=(()=>{class e extends rs.a{constructor(e,t,i){super(e),this.modalRef=t,this.contactsService=i,this.done=new g.n,this.control=new h.j(null,h.F.required)}addContact(){if(Object(b.I)(this.control),!this.control.valid)return;const e=this.field.selection;this.addSub(this.contactsService.createContact({user:c.a.SELF,body:{contact:this.control.value}}).subscribe(()=>{this.done.emit(e),this.modalRef.hide()}))}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.a),g.Kb(Xb.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["add-contact-dialog"]],viewQuery:function(e,t){var i;1&e&&g.yc(Yb,!0),2&e&&g.pc(i=g.Yb())&&(t.field=i.first)},outputs:{done:"done"},features:[g.ub],decls:8,vars:12,consts:[["focused","",3,"filters","allowContacts","allowPrincipal","formControl","label"],["field",""],["forceRow",""],[3,"disabled","label","action"],["outline","",3,"label","action"]],template:function(e,t){1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Lb(2,"user-field",0,1),g.Qb(4,"actions",2),g.Qb(5,"action-button",3),g.Xb("action",(function(){return t.addContact()})),g.ac(6,"async"),g.Pb(),g.Qb(7,"action-button",4),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.user.title.addContact),g.xb(1),g.gc("filters",g.ic(11,Wb))("allowContacts",!1)("allowPrincipal",!1)("formControl",t.control)("label",t.i18n.user.contact),g.xb(3),g.gc("disabled",g.bc(6,9,t.requesting$))("label",t.i18n.general.submit),g.xb(2),g.gc("label",t.i18n.general.cancel))},directives:[Be.a,Xt.a,h.u,h.k,x.a,y.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var eu=i("+HmS");const tu=["usersResults"];function iu(e,t){1&e&&g.Mb(0)}const nu=function(e){return{"d-none":e}};function au(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.ac(2,"async"),g.Qb(3,"div",4),g.Lb(4,"result-type-field",5),g.ac(5,"async"),g.Pb(),g.Pb(),g.Qb(6,"users-results",6,7),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(8,"async"),g.ac(9,"async"),g.ac(10,"async"),g.ac(11,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("ngClass",g.jc(25,nu,g.bc(1,11,e.layout.xxs$)))("heading",e.i18n.user.title.contactList)("mobileHeading",e.i18n.user.mobileTitle.contactList)("headingActions",g.bc(2,13,e.headingActions$)),g.xb(4),g.gc("formControl",e.resultTypeControl)("allowedResultTypes",g.bc(5,15,e.allowedResultTypes$)),g.xb(2),g.gc("ngClass",g.jc(27,nu,g.bc(8,17,e.rendering$)))("results",g.bc(9,19,e.results$))("rendering$",e.rendering$)("data",g.bc(10,21,e.data$))("resultType",g.bc(11,23,e.resultType$))}}let su=(()=>{class e extends Fe.a{constructor(e,t,i){super(e),this.modal=t,this.contactsService=i,this.ResultType=os.a}getFormControlNames(){return["user","keywords"]}getInitialResultType(){return this.layout.xxs?os.a.LIST:os.a.TILES}ngOnInit(){super.ngOnInit(),this.allowedResultTypes=[os.a.TILES,os.a.LIST],this.stateManager.cache("data",this.contactsService.getContactListDataForSearch({user:c.a.SELF})).subscribe(e=>{this.data=e})}toSearchParams(e){return e.user=c.a.SELF,e}doSearch(e){return this.contactsService.searchContactList$Response(e)}onDataInitialized(e){super.onDataInitialized(e);const t=(e.fieldsInList||[]).slice();t.includes("display")||(t.unshift("display"),e.fieldsInList=t),(((this.login.auth||{}).permissions||{}).users||{}).search&&(this.headingActions=[new be.c(ue.a.PlusCircle,this.i18n.general.addNew,()=>this.addNew(),!0)])}addNew(){const e=this.modal.show(Jb,{class:"modal-form"});this.addSub(e.content.done.subscribe(e=>{this.notification.snackBar(this.i18n.user.profile.addContactDone(e.display)),this.reload()}))}resolveMenu(e){return this.menu.userMenu(e.user,u.b.CONTACTS)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.b),g.Kb(Xb.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["contact-list"]],viewQuery:function(e,t){var i;1&e&&g.Hc(tu,!0),2&e&&g.pc(i=g.Yb())&&(t.usersResults=i.first)},features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"ngClass","heading","mobileHeading","headingActions"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["resultKind","contact",3,"ngClass","results","rendering$","data","resultType","update"],["usersResults",""]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,iu,1,0,"ng-container",1),g.Pb(),g.Bc(3,au,12,29,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,p.q,eu.a,h.u,h.k,ws],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var ou=i("9AzD"),ru=i("fe3a"),cu=i("uao2");function lu(e,t){1&e&&g.Mb(0)}function bu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Qb(1,"label-value",13),g.Lb(2,"user-link",14),g.Pb(),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",e.broker)}}function uu(e,t){1&e&&g.Lb(0,"div",15)}function du(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"input-field",16),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("label",e.i18n.general.keywords)}}function gu(e,t){if(1&e&&g.Lb(0,"field-option",19),2&e){const e=t.$implicit,i=g.Zb(5);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function fu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Qb(1,"multi-selection-field",17),g.Bc(2,gu,1,5,"field-option",18),g.Pb(),g.Pb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function mu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"max-distance-field",22),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function pu(e,t){if(1&e&&g.Lb(0,"field-option",25),2&e){const e=t.$implicit,i=g.Zb(6);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function hu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Qb(1,"multi-selection-field",23),g.Bc(2,pu,1,4,"field-option",24),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.assignedProducts),g.xb(1),g.gc("ngForOf",e.data.products)}}function vu(e,t){if(1&e&&g.Lb(0,"field-option",25),2&e){const e=t.$implicit,i=g.Zb(6);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function xu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Qb(1,"multi-selection-field",26),g.Bc(2,vu,1,4,"field-option",24),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.acceptedAgreements),g.xb(1),g.gc("ngForOf",e.data.agreements)}}function yu(e,t){if(1&e&&g.Lb(0,"field-option",25),2&e){const e=t.$implicit,i=g.Zb(6);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function Pu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Qb(1,"multi-selection-field",27),g.Bc(2,yu,1,4,"field-option",24),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.notAcceptedAgreements),g.xb(1),g.gc("ngForOf",e.data.agreements)}}function Iu(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"multi-selection-field",28),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)("emptyLabel",e.i18n.general.notApplied)}}function Eu(e,t){if(1&e&&(g.Qb(0,"div",29),g.Qb(1,"div",12),g.Lb(2,"date-field",30),g.Pb(),g.Qb(3,"div",12),g.Lb(4,"date-field",31),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(2),g.gc("label",e.i18n.user.creationBegin),g.xb(2),g.gc("label",e.i18n.user.creationEnd)}}function Au(e,t){if(1&e&&(g.Qb(0,"div",29),g.Qb(1,"div",12),g.Lb(2,"date-field",32),g.Pb(),g.Qb(3,"div",12),g.Lb(4,"date-field",33),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(2),g.gc("label",e.i18n.user.beginUserActivationDate),g.xb(2),g.gc("label",e.i18n.user.endUserActivationDate)}}function Cu(e,t){if(1&e&&(g.Qb(0,"div",29),g.Qb(1,"div",12),g.Lb(2,"date-field",34),g.Pb(),g.Qb(3,"div",12),g.Lb(4,"date-field",35),g.Pb(),g.Pb()),2&e){const e=g.Zb(5);g.xb(2),g.gc("label",e.i18n.user.beginLastLoginDate),g.xb(2),g.gc("label",e.i18n.user.endLastLoginDate)}}function Ou(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"user-field",36),g.Pb()),2&e){const e=g.Zb(5);g.xb(1),g.gc("label",e.i18n.general.usersOfBroker)("filters",e.userSearchFilters())("allowContacts",!1)}}function Su(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"basic-profile-field-filter",37),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(5);g.xb(1),g.gc("field",e)("formControl",i.form.get("profileFields").get(e.field))}}function Du(e,t){if(1&e&&(g.Qb(0,"div",12),g.Lb(1,"custom-field-filter",37),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(5);g.xb(1),g.gc("field",e)("formControl",i.form.get("profileFields").get(e.internalName))}}function Qu(e,t){if(1&e&&(g.Ob(0),g.Bc(1,mu,2,2,"div",9),g.Bc(2,hu,3,3,"div",9),g.Bc(3,xu,3,3,"div",9),g.Bc(4,Pu,3,3,"div",9),g.Bc(5,Iu,2,3,"div",9),g.Bc(6,Eu,5,2,"div",20),g.Bc(7,Au,5,2,"div",20),g.Bc(8,Cu,5,2,"div",20),g.Bc(9,Ou,2,3,"div",9),g.Bc(10,Su,2,2,"div",21),g.Bc(11,Du,2,2,"div",21),g.Nb()),2&e){const e=g.Zb(4);g.xb(1),g.gc("ngIf",e.data.searchByDistanceData),g.xb(1),g.gc("ngIf",e.byManager&&(null==e.data.products?null:e.data.products.length)>1),g.xb(1),g.gc("ngIf",e.byManager&&(null==e.data.agreements?null:e.data.agreements.length)>1),g.xb(1),g.gc("ngIf",e.byManager&&(null==e.data.agreements?null:e.data.agreements.length)>1),g.xb(1),g.gc("ngIf",e.byManager),g.xb(1),g.gc("ngIf",e.byManager),g.xb(1),g.gc("ngIf",e.byManager),g.xb(1),g.gc("ngIf",e.byManager),g.xb(1),g.gc("ngIf",e.byManager),g.xb(1),g.gc("ngForOf",e.data.basicFields),g.xb(1),g.gc("ngForOf",e.customFieldsInSearch)}}function Fu(e,t){if(1&e&&(g.Ob(0),g.Bc(1,fu,3,2,"div",9),g.Bc(2,Qu,12,11,"ng-container",11),g.ac(3,"async"),g.Nb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("ngIf",g.bc(3,2,e.moreFilters$))}}function wu(e,t){if(1&e&&(g.Qb(0,"form",7),g.Qb(1,"div",8),g.Bc(2,bu,3,2,"div",9),g.Bc(3,uu,1,0,"div",10),g.ac(4,"async"),g.Bc(5,du,2,1,"div",9),g.Bc(6,Fu,4,4,"ng-container",11),g.ac(7,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.gc("formGroup",e.form),g.xb(2),g.gc("ngIf",!e.self&&e.broker),g.xb(1),g.gc("ngIf",g.bc(4,5,e.layout.gtsm$)&&!e.self&&e.broker),g.xb(2),g.gc("ngIf",e.data.allowKeywords),g.xb(1),g.gc("ngIf",g.bc(7,7,e.layout.gtxxs$))}}function Lu(e,t){if(1&e&&(g.Qb(0,"div",42),g.Qb(1,"single-selection-field",43),g.Lb(2,"field-option",44),g.Lb(3,"field-option",45),g.Pb(),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.gc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy)("emptyOption",e.i18n.general.orderByRelevance),g.xb(1),g.gc("text",e.i18n.user.orderBy.alphabeticallyAsc),g.xb(1),g.gc("text",e.i18n.user.orderBy.alphabeticallyDesc)}}function Nu(e,t){if(1&e&&(g.Qb(0,"div",38),g.Qb(1,"div",39),g.Lb(2,"result-type-field",40),g.ac(3,"async"),g.Pb(),g.Bc(4,Lu,4,5,"div",41),g.ac(5,"async"),g.ac(6,"async"),g.Pb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("allowedResultTypes",g.bc(3,3,e.allowedResultTypes$))("formControl",e.resultTypeControl),g.xb(2),g.gc("ngIf",g.bc(5,5,e.layout.gtxxs$)&&"map"!==g.bc(6,7,e.resultType$))}}function Bu(e,t){if(1&e){const e=g.Rb();g.Qb(0,"page-content",3),g.ac(1,"async"),g.Bc(2,wu,8,9,"form",4),g.Bc(3,Nu,7,9,"div",5),g.Pb(),g.Qb(4,"users-results",6),g.Xb("update",(function(t){return g.sc(e),g.Zb().update(t)})),g.ac(5,"async"),g.ac(6,"async"),g.ac(7,"async"),g.ac(8,"async"),g.Pb()}if(2&e){const e=g.Zb();g.gc("mode",e.dataForFrontendHolder.user?"filters":"emptyFilters")("heading",e.heading)("mobileHeading",e.mobileHeading)("headingActions",g.bc(1,11,e.headingActions$)),g.xb(2),g.gc("ngIf",e.dataForFrontendHolder.user),g.xb(1),g.gc("ngIf",e.dataForFrontendHolder.user),g.xb(1),g.gc("results",g.bc(5,13,e.results$))("rendering$",e.rendering$)("data",g.bc(6,15,e.data$))("resultType",g.bc(7,17,e.resultType$))("referencePoint",(g.bc(8,19,e.form.valueChanges)||e.form.value).distanceFilter)}}var ku=function(e){return e[e.Public=0]="Public",e[e.Member=1]="Member",e[e.Admin=2]="Admin",e[e.Broker=3]="Broker",e}({});let Ru=(()=>{class e extends Fe.a{constructor(e,t,i,n){super(e),this.usersService=t,this.userHelper=i,this.countriesResolve=n,this.ResultType=os.a,this.UserSearchKind=ku,this.empty=b.i}getFormControlNames(){return["keywords","groups","customValues","distanceFilter","orderBy","statuses","beginActivationPeriod","endActivationPeriod","beginCreationPeriod","endCreationPeriod","beginLastLoginPeriod","endLastLoginPeriod","notAcceptedAgreements","acceptedAgreements","products","brokers"]}getInitialResultType(){return this.layout.xxs?os.a.LIST:os.a.TILES}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||c.a.SELF,this.self=this.authHelper.isSelf(this.param);const e=this.login.auth,t=null==e?null:e.role,i=this.router.url;i.includes("search")?this.kind=null==t?ku.Public:t===$e.pb.ADMINISTRATOR?ku.Admin:ku.Member:i.includes("brokerings")&&(this.kind=ku.Broker),this.manager=[ku.Admin,ku.Broker].includes(this.kind);const n=[ku.Public,ku.Member].includes(this.kind);n?(this.heading=this.i18n.user.title.directory,this.mobileHeading=this.i18n.user.mobileTitle.directory):this.kind===ku.Broker?this.self?(this.heading=this.i18n.user.title.myBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.myBrokerings):(this.heading=this.i18n.user.title.userBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.userBrokerings):this.kind===ku.Admin&&(this.heading=this.i18n.user.title.search,this.mobileHeading=this.i18n.user.mobileTitle.search);const a=((e||{}).permissions||{}).users||{};if(this.canSearch=this.kind===ku.Broker||!!a.search,this.canViewMap=n&&a.map,!this.canSearch&&!this.canViewMap)return void this.errorHandler.handleForbiddenError({});const s=[];this.canSearch&&(s.push(os.a.TILES),s.push(os.a.LIST)),(this.canViewMap||this.manager)&&s.push(os.a.MAP),this.allowedResultTypes=s,this.countries$=this.countriesResolve.data,this.resultType=this.getInitialResultType(),this.onResultTypeChanged(this.resultType,null)}get statusOptions(){return Object.values($e.Qb).map(e=>({value:e,text:this.userHelper.userStatus(e)}))}shouldUpdateOnResultTypeChange(){return!1}onResultTypeChanged(e,t){const i=e===os.a.MAP;(i!==(t===os.a.MAP)||null==t)&&(this.data=null,this.resetPage());const n=e=>{Object(b.i)(e.fieldsInList)&&(e.fieldsInList=["display"]),this.doIgnoringUpdate(()=>{this.customFieldsInSearch=e.customFields.filter(t=>e.fieldsInSearch.includes(t.internalName)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,this.customFieldsInSearch)),!this.broker&&e.broker&&(this.broker=e.broker),this.data=e,this.headingActions=[...Object(b.i)(e.fieldsInSearch)?[]:[this.moreFiltersAction],...this.exportHelper.headingActions(this.data.exportFormats,e=>this.usersService.exportUsers$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))]})};null==this.data&&(this.rendering=!0,i&&!this.manager?this.stateManager.cache("dataForMap",this.usersService.getDataForMapDirectory()).subscribe(n):this.stateManager.cache("dataForSearch",this.usersService.getUserDataForSearch({fromMenu:!0,broker:this.kind===ku.Broker?this.param:null})).subscribe(n))}get brokeringSearch(){return this.kind===ku.Broker}get byManager(){return[ku.Broker,ku.Admin].includes(this.kind)}toSearchParams(e){const t=Object.assign({},e);this.brokeringSearch&&(t.brokers=[this.param]),t.activationPeriod=c.a.dateRangeFilter(e.beginActivationPeriod,e.endActivationPeriod),t.creationPeriod=c.a.dateRangeFilter(e.beginCreationPeriod,e.endCreationPeriod),t.lastLoginPeriod=c.a.dateRangeFilter(e.beginLastLoginPeriod,e.endLastLoginPeriod),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);const i=e.distanceFilter;i&&(t.maxDistance=i.maxDistance,t.latitude=i.latitude,t.longitude=i.longitude);const n=this.resultType===os.a.MAP;return t.fromMenu=this.kind!==ku.Broker,n&&(t.pageSize=99999,t.addressResult=$e.Ib.ALL),t}userSearchFilters(){return{roles:[$e.pb.BROKER]}}doSearch(e){return this.resultType!==os.a.MAP||this.manager?this.usersService.searchUsers$Response(e):this.usersService.searchMapDirectory$Response(e)}resolveMenu(){switch(this.kind){case ku.Broker:return u.b.MY_BROKERED_USERS;case ku.Public:return u.b.PUBLIC_DIRECTORY;default:return u.b.SEARCH_USERS}}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Lo.a),g.Kb(T.a),g.Kb(s.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-users"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"mode","heading","mobileHeading","headingActions"],["class","filters-form filters-form-separator border-bottom",3,"formGroup",4,"ngIf"],["class","row filters-row",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","update"],[1,"filters-form","filters-form-separator","border-bottom",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-md-6",4,"ngIf"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side",3,"label"],[3,"user"],[1,"col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["class","row no-gutters col-12",4,"ngIf"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","formControlName","products",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","acceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","notAcceptedAgreements",3,"emptyLabel","label"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","beginCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endCreationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endActivationPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","beginLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","endLastLoginPeriod","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","brokers",3,"label","filters","allowContacts"],["labelPosition","side",3,"field","formControl"],[1,"row","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","alphabeticallyAsc",3,"text"],["value","alphabeticallyDesc",3,"text"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,lu,1,0,"ng-container",1),g.Pb(),g.Bc(3,Bu,9,21,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,ws,h.H,h.v,h.n,Q.a,Lt.a,Nt.a,h.u,h.l,ht.a,p.s,Ne.a,ou.a,we.a,Be.a,ru.a,h.k,cu.a,eu.a,Le.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Tu=i("XS/k");function Zu(e,t){1&e&&g.Mb(0)}function Mu(e,t){if(1&e&&(g.Qb(0,"div",11),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.xb(1),g.Gc(" ",t.i18n.general.performedBy,": ",e.by.display," ")}}function _u(e,t){if(1&e&&(g.Qb(0,"mobile-result",8),g.Qb(1,"div",9),g.Dc(2),g.Pb(),g.Bc(3,Mu,2,2,"div",10),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(2);g.gc("date",null==e.period?null:e.period.date),g.xb(2),g.Gc(" ",i.i18n.general.status,": ",i.userHelper.userStatus(e.status)," "),g.xb(1),g.gc("ngIf",e.by)}}function $u(e,t){if(1&e&&(g.Qb(0,"tr"),g.Qb(1,"td"),g.Dc(2),g.ac(3,"date"),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.Pb(),g.Qb(6,"td"),g.Dc(7),g.Pb(),g.Pb()),2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(g.bc(3,3,null==e.period?null:e.period.begin)),g.xb(3),g.Ec(i.userHelper.userStatus(e.status)),g.xb(2),g.Ec(null==e.by?null:e.by.display)}}function Hu(e,t){if(1&e&&(g.Qb(0,"table",12),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Pb(),g.Qb(8,"tbody"),g.Bc(9,$u,8,5,"tr",13),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.Ec(e.i18n.general.date),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.Ec(e.i18n.general.performedBy),g.xb(2),g.gc("ngForOf",e.data.history)}}function Uu(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.Lb(1,"user-info",4),g.Pb(),g.Qb(2,"results-layout",5),g.Bc(3,_u,4,4,"mobile-result",6),g.Bc(4,Hu,10,4,"table",7),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.userStatus.title.historyOperator:e.i18n.userStatus.title.historyUser)("mobileHeading",e.operator?e.i18n.userStatus.mobileTitle.historyOperator:e.i18n.userStatus.mobileTitle.historyUser),g.xb(1),g.gc("user",e.data.user),g.xb(1),g.gc("results",e.data.history)}}let Gu=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.userStatusService=t,this.userHelper=i}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["user","history"]}).subscribe(e=>{this.data=e}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Tu.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-status-history"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Zu,1,0,"ng-container",1),g.Pb(),g.Bc(3,Uu,5,4,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,P.a,$.a,H.a,U.a,G.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function qu(e,t){if(1&e&&g.Lb(0,"field-option",11),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",e)("text",i.userHelper.userStatus(e))}}function Ku(e,t){if(1&e){const e=g.Rb();g.Ob(0),g.Lb(1,"hr"),g.Qb(2,"form",6),g.Qb(3,"single-selection-field",7),g.Bc(4,qu,1,2,"field-option",8),g.Pb(),g.Lb(5,"textarea-field",9),g.Pb(),g.Qb(6,"actions"),g.Qb(7,"action-button",10),g.Xb("action",(function(){return g.sc(e),g.Zb(2).save()})),g.Pb(),g.Pb(),g.Nb()}if(2&e){const e=g.Zb(2);g.xb(2),g.gc("formGroup",e.form),g.xb(1),g.gc("label",e.i18n.userStatus.new),g.xb(1),g.gc("ngForOf",e.data.possibleNewStatuses),g.xb(1),g.gc("label",e.i18n.general.comments),g.xb(2),g.gc("label",e.i18n.general.submit)}}function Vu(e,t){if(1&e&&(g.Qb(0,"page-content",2),g.ac(1,"async"),g.Lb(2,"user-info",3),g.Qb(3,"label-value",4),g.Dc(4),g.Pb(),g.Bc(5,Ku,8,5,"ng-container",5),g.Pb()),2&e){const e=g.Zb();g.gc("heading",e.operator?e.i18n.userStatus.title.statusOperator:e.i18n.userStatus.title.statusUser)("mobileHeading",e.operator?e.i18n.userStatus.mobileTitle.statusOperator:e.i18n.userStatus.mobileTitle.statusUser)("headingActions",g.bc(1,7,e.headingActions$)),g.xb(2),g.gc("user",e.data.user),g.xb(1),g.gc("label",e.i18n.userStatus.current),g.xb(1),g.Fc(" ",e.userHelper.userStatus(e.data.status)," "),g.xb(1),g.gc("ngIf",e.editable)}}let ju=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.userStatusService=t,this.userHelper=i}get editable(){return!Object(b.i)(this.data.possibleNewStatuses)}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["-history"]}).subscribe(e=>{this.data=e})),this.form=this.formBuilder.group({status:[null,h.F.required],comment:null}),this.headingActions=[new be.c(ue.a.Clock,this.i18n.general.viewHistory,()=>this.router.navigate(["users",this.param,"status","history"]),!0)]}save(){if(Object(b.I)(this.form),!this.form.valid)return;const e=this.form.value.status;let t;const i=this.data.user,n=this.userHelper.isOperator(i);switch(e){case $e.Qb.ACTIVE:t=this.i18n.userStatus.confirm.active(i.display);break;case $e.Qb.BLOCKED:t=this.i18n.userStatus.confirm.blocked(i.display);break;case $e.Qb.DISABLED:t=this.i18n.userStatus.confirm.disabled(i.display);break;case $e.Qb.REMOVED:t=this.i18n.userStatus.confirm.removed(i.display);break;case $e.Qb.PURGED:t=this.i18n.userStatus.confirm.purged(i.display)}let a;a=n?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,this.notification.confirm({title:a,message:t,callback:()=>this.submit(e)})}submit(e){const t=this.data.user.display;this.addSub(this.userStatusService.changeUserStatus({user:this.param,body:this.form.value}).subscribe(()=>{let i;switch(e){case $e.Qb.ACTIVE:i=this.i18n.userStatus.done.active(t);break;case $e.Qb.BLOCKED:i=this.i18n.userStatus.done.blocked(t);break;case $e.Qb.DISABLED:i=this.i18n.userStatus.done.disabled(t);break;case $e.Qb.REMOVED:i=this.i18n.userStatus.done.removed(t);break;case $e.Qb.PURGED:i=this.i18n.userStatus.done.purged(t)}this.notification.snackBar(i),this.reload()}))}get operator(){return this.userHelper.isOperator(this.data.user)}resolveMenu(e){return this.menu.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(Tu.a),g.Kb(T.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-user-status"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","status","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[3,"label","action"],[3,"value","text"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,Vu,6,9,"page-content",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,P.a,Q.a,h.H,h.v,h.n,Le.a,h.u,h.l,h.C,p.s,Bt.a,x.a,y.a,Ne.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var zu=i("piyO"),Xu=i("Aw04");function Yu(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.user),g.xb(1),g.Fc(" ",e.user.display," ")}}function Wu(e,t){if(1&e&&g.Lb(0,"user-field",11),2&e){const e=g.Zb();g.gc("label",e.i18n.general.user)}}function Ju(e,t){if(1&e&&g.Lb(0,"field-option",14),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.name)}}function ed(e,t){if(1&e&&(g.Qb(0,"single-selection-field",12),g.Bc(1,Ju,1,2,"field-option",13),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notSet),g.xb(1),g.gc("ngForOf",g.bc(2,3,e.operators$))}}function td(e,t){if(1&e&&g.Lb(0,"boolean-field",15),2&e){const e=g.Zb();g.gc("label",e.i18n.token.action.activate)}}function id(e,t){1&e&&g.Dc(0,"\xa0")}let nd=(()=>{class e extends rs.a{constructor(e,t,i,n){super(e),this.modalRef=t,this.tokensService=i,this.operatorsService=n,this.operators$=new wt.a(null),this.canActivate$=new wt.a(null)}ngOnInit(){this.canActivate$.next(!!this.user),this.form=this.formBuilder.group({user:this.user?this.user.id:null,operator:null,value:[null,h.F.required],activateNow:!1}),this.user||this.form.get("user").valueChanges.subscribe(()=>this.fillOperatorsField())}fillOperatorsField(){const e=this.form.get("user").value;e?(this.canActivate$.next(!0),this.operatorsService.searchUserOperators$Response({user:e,skipTotalCount:!0,pageSize:9999999}).subscribe(e=>{var t;e.ok&&(null===(t=e.body)||void 0===t?void 0:t.length)>0?this.operators$.next(e.body):this.operators$.next(null)})):(this.canActivate$.next(!1),this.operators$.next(null))}submit(){if(Object(b.I)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value);e.operator&&(e.user=e.operator,delete e.operator),this.tokensService.createToken({type:this.type.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.created),this.updateAction()}),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.a),g.Kb(zu.a),g.Kb(Ta.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["create-token"]],inputs:{type:"type",user:"user",required:"required",updateAction:"updateAction"},features:[g.ub],decls:16,vars:18,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],["formControlName","user",3,"label",4,"ngIf"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["required","","formControlName","value",3,"mask","label","placeholder"],["formControlName","activateNow",3,"label",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["kind","fieldView","labelPosition","side",3,"label"],["formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","activateNow",3,"label"]],template:function(e,t){var i;1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"form",0),g.Bc(3,Yu,2,2,"label-value",1),g.Bc(4,Wu,1,1,"user-field",2),g.Bc(5,ed,3,5,"single-selection-field",3),g.ac(6,"async"),g.Lb(7,"input-field",4),g.Bc(8,td,1,1,"boolean-field",5),g.ac(9,"async"),g.Qb(10,"actions",6),g.Qb(11,"action-button",7),g.Xb("action",(function(){return t.submit()})),g.ac(12,"async"),g.Pb(),g.Bc(13,id,1,0,"ng-template",null,8,g.Cc),g.Qb(15,"action-button",9),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.token.title.new(t.type.name)),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("ngIf",t.user),g.xb(1),g.gc("ngIf",!t.user),g.xb(1),g.gc("ngIf",(null==(i=g.bc(6,12,t.operators$))?null:i.length)>0),g.xb(2),g.gc("mask",t.type.mask)("label",t.i18n.token.value)("placeholder",t.type.mask?t.type.mask:""),g.xb(1),g.gc("ngIf",g.bc(9,14,t.canActivate$)),g.xb(3),g.gc("label",t.i18n.general.submit)("disabled",g.bc(12,16,t.requesting$)),g.xb(4),g.gc("label",t.i18n.general.cancel))},directives:[h.H,h.v,h.n,p.t,Nt.a,h.C,h.u,h.l,Xu.a,x.a,y.a,Q.a,Be.a,Le.a,p.s,Ne.a,v.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();function ad(e,t){if(1&e&&g.Lb(0,"user-info",7),2&e){const e=g.Zb(2);g.gc("user",e.data.user)}}function sd(e,t){if(1&e&&(g.Qb(0,"label-value",10),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit,t=g.Zb(2);g.gc("label",t.i18n.general.operator),g.xb(1),g.Fc(" ",null!=e.user&&e.user.user?e.user.display:""," ")}}function od(e,t){if(1&e){const e=g.Rb();g.Qb(0,"mobile-result"),g.Qb(1,"div",8),g.Qb(2,"div"),g.Bc(3,sd,2,2,"label-value",9),g.Qb(4,"label-value",10),g.Dc(5),g.Pb(),g.Qb(6,"label-value",10),g.Dc(7),g.ac(8,"date"),g.Pb(),g.Qb(9,"label-value",10),g.Dc(10),g.ac(11,"date"),g.Pb(),g.Qb(12,"label-value",10),g.Dc(13),g.ac(14,"date"),g.Pb(),g.Qb(15,"label-value",10),g.Dc(16),g.Pb(),g.Pb(),g.Qb(17,"div",11),g.Qb(18,"button",12),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(2);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Lb(19,"icon",13),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("ngIf",!i.self),g.xb(1),g.gc("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),g.xb(1),g.Fc(" ",e.value," "),g.xb(1),g.gc("label",i.i18n.token.creationDate),g.xb(1),g.Fc(" ",g.bc(8,13,e.creationDate)," "),g.xb(2),g.gc("label",i.i18n.token.activationDate),g.xb(1),g.Fc(" ",g.bc(11,15,e.activationDate)," "),g.xb(2),g.gc("label",i.i18n.token.expiryDate),g.xb(1),g.Fc(" ",g.bc(14,17,e.expiryDate)," "),g.xb(2),g.gc("label",i.i18n.general.status),g.xb(1),g.Fc(" ",i.statusDisplay(e.status)," "),g.xb(2),g.gc("tooltip",i.i18n.general.view),g.xb(1),g.gc("icon",i.SvgIcon.Search)}}function rd(e,t){if(1&e&&(g.Qb(0,"th"),g.Dc(1),g.Pb()),2&e){const e=g.Zb(3);g.xb(1),g.Ec(e.i18n.general.operator)}}function cd(e,t){if(1&e&&(g.Qb(0,"td"),g.Dc(1),g.Pb()),2&e){const e=g.Zb().$implicit;g.xb(1),g.Fc("",null!=e.user&&e.user.user?e.user.display:""," ")}}function ld(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",16),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Bc(1,cd,2,1,"td",1),g.Qb(2,"td"),g.Dc(3),g.Pb(),g.Qb(4,"td"),g.Dc(5),g.ac(6,"date"),g.Pb(),g.Qb(7,"td"),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"td"),g.Dc(11),g.ac(12,"date"),g.Pb(),g.Qb(13,"td"),g.Dc(14),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(1),g.gc("ngIf",!i.self),g.xb(2),g.Ec(e.value),g.xb(2),g.Ec(g.bc(6,6,e.creationDate)),g.xb(3),g.Ec(g.bc(9,8,e.activationDate)),g.xb(3),g.Ec(g.bc(12,10,e.expiryDate)),g.xb(3),g.Ec(i.statusDisplay(e.status))}}function bd(e,t){if(1&e&&(g.Qb(0,"table",14),g.Qb(1,"thead"),g.Bc(2,rd,2,1,"th",1),g.Qb(3,"th"),g.Dc(4),g.Pb(),g.Qb(5,"th"),g.Dc(6),g.Pb(),g.Qb(7,"th"),g.Dc(8),g.Pb(),g.Qb(9,"th"),g.Dc(10),g.Pb(),g.Qb(11,"th"),g.Dc(12),g.Pb(),g.Pb(),g.Qb(13,"tbody"),g.Bc(14,ld,15,12,"tr",15),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(2),g.gc("ngIf",!e.self),g.xb(2),g.Ec(e.isNfc()?e.i18n.token.label:e.i18n.token.value),g.xb(2),g.Ec(e.i18n.token.creationDate),g.xb(2),g.Ec(e.i18n.token.activationDate),g.xb(2),g.Ec(e.i18n.token.expiryDate),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.gc("ngForOf",e.data.tokens)}}function ud(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"page-content",2),g.ac(2,"async"),g.Bc(3,ad,1,1,"user-info",3),g.Pb(),g.Qb(4,"results-layout",4),g.Bc(5,od,20,19,"mobile-result",5),g.Bc(6,bd,15,7,"table",6),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(1),g.gc("heading",null==e.data?null:e.data.type.pluralName)("mobileHeading",null==e.data?null:e.data.type.pluralName)("headingActions",g.bc(2,6,e.headingActions$))("mode",e.self?"empty":"normal"),g.xb(2),g.gc("ngIf",!e.self),g.xb(1),g.gc("results",e.data.tokens)}}let dd=(()=>{class e extends l.a{constructor(e,t,i,n){super(e),this.modal=t,this.userHelper=i,this.tokenService=n}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getUserTokens({user:this.user,type:this.type}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.self=this.authHelper.isSelf(e.user),this.canCreate()&&e.type.physicalType!==$e.fb.NFC_TAG&&(this.headingActions=[new be.c(ue.a.PlusCircle,this.i18n.general.add,()=>{this.modal.show(nd,{class:"modal-form",initialState:{type:e.type,user:e.user,required:!0,updateAction:()=>this.reload()}})},!0)]),this.canActivate()&&(this.headingActions=[new be.c(ue.a.CheckCircle,this.i18n.token.action.activate,()=>{this.notification.confirm({title:this.i18n.token.action.activate,customFields:[{internalName:"value",name:this.i18n.token.value,type:$e.o.STRING,pattern:e.type.mask,required:!0}],callback:e=>this.tokenService.activateToken({user:this.user,type:this.type,body:e.customValues.value}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.expiryChanged),this.reload()})})},!0)])}isNfc(){return this.data.type.physicalType===$e.fb.NFC_TAG}canCreate(){var e;return!this.self&&(null===(e=this.dataForFrontendHolder.auth.permissions.tokens.user.find(e=>e.type.id===this.type))||void 0===e?void 0:e.create)}canActivate(){var e;return!!this.self&&(null===(e=this.dataForFrontendHolder.auth.permissions.tokens.my.find(e=>e.type.id===this.type))||void 0===e?void 0:e.activate)}statusDisplay(e){return this.userHelper.tokenStatus(e)}view(e){return["/users","tokens","view",e.id]}resolveMenu(e){return this.authHelper.isSelf(e.user)?new u.a(u.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?u.b.MY_OPERATORS:this.dataForFrontendHolder.role===$e.pb.BROKER?u.b.MY_BROKERED_USERS:u.b.SEARCH_USERS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.b),g.Kb(T.a),g.Kb(zu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["list-token"]],features:[g.ub],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,ud,7,8,"ng-container",1),g.Pb()),2&e&&(g.gc("ready",g.bc(1,2,t.data$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,p.t,m.a,$.a,H.a,U.a,P.a,G.a,Q.a,I.b,q.a,p.s],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function gd(e,t){1&e&&g.Mb(0)}function fd(e,t){if(1&e&&g.Lb(0,"field-option",20),2&e){const e=t.$implicit,i=g.Zb(3);g.gc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function md(e,t){if(1&e&&(g.Qb(0,"div",6),g.Qb(1,"multi-selection-field",18),g.Bc(2,fd,1,5,"field-option",19),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(1),g.gc("label",e.i18n.user.groupFilter),g.xb(1),g.gc("ngForOf",e.data.groups)}}function pd(e,t){if(1&e){const e=g.Rb();g.Qb(0,"mobile-result"),g.Qb(1,"div",21),g.Qb(2,"div"),g.Qb(3,"label-value",22),g.Dc(4),g.Pb(),g.Qb(5,"label-value",22),g.Dc(6),g.Pb(),g.Qb(7,"label-value",22),g.Dc(8),g.ac(9,"date"),g.Pb(),g.Qb(10,"label-value",22),g.Dc(11),g.ac(12,"date"),g.Pb(),g.Qb(13,"label-value",22),g.Dc(14),g.ac(15,"date"),g.Pb(),g.Qb(16,"label-value",22),g.Dc(17),g.Pb(),g.Pb(),g.Qb(18,"div",23),g.Qb(19,"button",24),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(2);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Lb(20,"icon",25),g.Pb(),g.Pb(),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(2);g.xb(3),g.gc("label",i.i18n.general.user),g.xb(1),g.Fc(" ",e.user?e.user.display:i.i18n.token.unassigned," "),g.xb(1),g.gc("label",i.isNfc()?i.i18n.token.label:i.i18n.token.value),g.xb(1),g.Fc(" ",e.value," "),g.xb(1),g.gc("label",i.i18n.token.creationDate),g.xb(1),g.Fc(" ",g.bc(9,14,e.creationDate)," "),g.xb(2),g.gc("label",i.i18n.token.activationDate),g.xb(1),g.Fc(" ",g.bc(12,16,e.activationDate)," "),g.xb(2),g.gc("label",i.i18n.token.expiryDate),g.xb(1),g.Fc(" ",g.bc(15,18,e.expiryDate)," "),g.xb(2),g.gc("label",i.i18n.general.status),g.xb(1),g.Fc(" ",i.statusDisplay(e.status)," "),g.xb(2),g.gc("tooltip",i.i18n.general.view),g.xb(1),g.gc("icon",i.SvgIcon.Search)}}function hd(e,t){if(1&e){const e=g.Rb();g.Qb(0,"tr",28),g.Xb("click",(function(i){g.sc(e);const n=t.$implicit,a=g.Zb(3);return a.router.navigate(a.view(n)),i.stopPropagation(),i.preventDefault()})),g.Qb(1,"td"),g.Dc(2),g.Pb(),g.Qb(3,"td"),g.Dc(4),g.Pb(),g.Qb(5,"td"),g.Dc(6),g.ac(7,"date"),g.Pb(),g.Qb(8,"td"),g.Dc(9),g.ac(10,"date"),g.Pb(),g.Qb(11,"td"),g.Dc(12),g.ac(13,"date"),g.Pb(),g.Qb(14,"td"),g.Dc(15),g.Pb(),g.Pb()}if(2&e){const e=t.$implicit,i=g.Zb(3);g.xb(2),g.Ec(e.user?e.user.display:i.i18n.token.unassigned),g.xb(2),g.Ec(e.value),g.xb(2),g.Ec(g.bc(7,6,e.creationDate)),g.xb(3),g.Ec(g.bc(10,8,e.activationDate)),g.xb(3),g.Ec(g.bc(13,10,e.expiryDate)),g.xb(3),g.Ec(i.statusDisplay(e.status))}}function vd(e,t){if(1&e&&(g.Qb(0,"table",26),g.Qb(1,"thead"),g.Qb(2,"th"),g.Dc(3),g.Pb(),g.Qb(4,"th"),g.Dc(5),g.Pb(),g.Qb(6,"th"),g.Dc(7),g.Pb(),g.Qb(8,"th"),g.Dc(9),g.Pb(),g.Qb(10,"th"),g.Dc(11),g.Pb(),g.Qb(12,"th"),g.Dc(13),g.Pb(),g.Pb(),g.Qb(14,"tbody"),g.Bc(15,hd,16,12,"tr",27),g.ac(16,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);var i;g.xb(3),g.Ec(e.i18n.general.user),g.xb(2),g.Ec(e.isNfc()?e.i18n.token.label:e.i18n.token.value),g.xb(2),g.Ec(e.i18n.token.creationDate),g.xb(2),g.Ec(e.i18n.token.activationDate),g.xb(2),g.Ec(e.i18n.token.expiryDate),g.xb(2),g.Ec(e.i18n.general.status),g.xb(2),g.gc("ngForOf",null==(i=g.bc(16,7,e.results$))?null:i.results)}}function xd(e,t){if(1&e&&(g.Qb(0,"page-content",3),g.ac(1,"async"),g.Qb(2,"form",4),g.Qb(3,"div",5),g.Qb(4,"div",6),g.Lb(5,"user-field",7),g.Pb(),g.Lb(6,"div",8),g.Qb(7,"div",6),g.Lb(8,"date-field",9),g.Pb(),g.Qb(9,"div",6),g.Lb(10,"date-field",10),g.Pb(),g.Lb(11,"div",8),g.Qb(12,"div",6),g.Lb(13,"date-field",11),g.Pb(),g.Qb(14,"div",6),g.Lb(15,"date-field",12),g.Pb(),g.Pb(),g.Qb(16,"div",6),g.Lb(17,"multi-selection-field",13),g.Pb(),g.Bc(18,md,3,2,"div",14),g.Pb(),g.Pb(),g.Qb(19,"results-layout",15),g.ac(20,"async"),g.Bc(21,pd,21,20,"mobile-result",16),g.Bc(22,vd,17,9,"table",17),g.Pb()),2&e){const e=g.Zb();g.gc("heading",null==e.data?null:e.data.type.pluralName)("mobileHeading",null==e.data?null:e.data.type.pluralName)("headingActions",g.bc(1,15,e.headingActions$)),g.xb(2),g.gc("formGroup",e.form),g.xb(3),g.gc("label",e.i18n.general.user),g.xb(3),g.gc("label",e.i18n.token.activationBeginDate),g.xb(2),g.gc("label",e.i18n.token.activationEndDate),g.xb(3),g.gc("label",e.i18n.token.expiryBeginDate),g.xb(2),g.gc("label",e.i18n.token.expiryEndDate),g.xb(2),g.gc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.status)("fieldOptions",e.statusOptions),g.xb(1),g.gc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),g.xb(1),g.gc("results",g.bc(20,17,e.results$))("rendering$",e.rendering$)}}let yd=(()=>{class e extends Fe.a{constructor(e,t,i,n){super(e),this.userHelper=t,this.modal=i,this.tokenService=n}getFormControlNames(){return["user","statuses","groups","activationBeginDate","activationEndDate","expiryBeginDate","expiryEndDate"]}ngOnInit(){super.ngOnInit(),this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getGeneralTokensDataForSearch({type:this.type}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),e.type.physicalType!==$e.fb.NFC_TAG&&(this.headingActions=[new be.c(ue.a.PlusCircle,this.i18n.general.add,()=>{this.modal.show(nd,{class:"modal-form",initialState:{type:e.type,updateAction:()=>this.reload()}})},!0)])}doSearch(e){return this.tokenService.searchGeneralTokens$Response(e)}toSearchParams(e){const t=e;return t.type=this.type,t.activationPeriod=c.a.dateRangeFilter(e.activationBeginDate,e.activationEndDate),t.expiryPeriod=c.a.dateRangeFilter(e.expiryBeginDate,e.expiryEndDate),t}get statusOptions(){return Object.values($e.Ab).map(e=>({value:e,text:this.statusDisplay(e)}))}statusDisplay(e){return this.userHelper.tokenStatus(e)}isNfc(){return this.data.type.physicalType===$e.fb.NFC_TAG}view(e){return["/users","tokens","view",e.id]}resolveMenu(e){return new u.a(u.b.USER_TOKENS,{tokenType:e.type})}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(_.b),g.Kb(zu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["search-token"]],features:[g.ub],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","activationBeginDate","minDate","past100","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","activationEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryBeginDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],[3,"icon"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Bc(2,gd,1,0,"ng-container",1),g.Pb(),g.Bc(3,xd,23,19,"ng-template",null,2,g.Cc)),2&e){const e=g.qc(4);g.gc("ready",g.bc(1,3,t.data$)),g.xb(2),g.gc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,p.t,m.a,h.H,h.v,h.n,Be.a,h.u,h.l,we.a,ht.a,$.a,H.a,U.a,p.s,Ne.a,G.a,Q.a,I.b,q.a],pipes:[p.b,K.a],encapsulation:2,changeDetection:0}),e})();function Pd(e,t){if(1&e&&g.Lb(0,"field-option",9),2&e){const e=t.$implicit;g.gc("value",e.id)("text",e.display)}}function Id(e,t){if(1&e&&(g.Qb(0,"single-selection-field",7),g.Bc(1,Pd,1,2,"field-option",8),g.ac(2,"async"),g.Pb()),2&e){const e=g.Zb();g.gc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notSet),g.xb(1),g.gc("ngForOf",g.bc(2,3,e.operators$))}}function Ed(e,t){1&e&&g.Dc(0,"\xa0")}let Ad=(()=>{class e extends rs.a{constructor(e,t,i,n){super(e),this.modalRef=t,this.tokensService=i,this.operatorsService=n,this.operators$=new wt.a(null)}ngOnInit(){this.form=this.formBuilder.group({user:[null,h.F.required],operator:null}),this.form.get("user").valueChanges.subscribe(e=>this.fillOperatorsField(e))}fillOperatorsField(e){this.operatorsService.searchUserOperators$Response({user:e.id,skipTotalCount:!0,pageSize:999999}).subscribe(e=>{this.operators$.next(e.ok?e.body:null)})}submit(){if(Object(b.I)(this.form),!this.form.valid)return;const e=Object(d.a)(this.form.value);this.tokensService.assignToken({id:this.token,user:e.operator?e.operator:e.user}).subscribe(()=>{this.notification.snackBar(this.i18n.token.action.done.assigned),this.updateAction()}),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(_.a),g.Kb(zu.a),g.Kb(Ta.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["assign-token"]],inputs:{token:"token",updateAction:"updateAction"},features:[g.ub],decls:12,vars:11,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["required","","formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"]],template:function(e,t){var i;1&e&&(g.Qb(0,"h1"),g.Dc(1),g.Pb(),g.Qb(2,"form",0),g.Lb(3,"user-field",1),g.Bc(4,Id,3,5,"single-selection-field",2),g.ac(5,"async"),g.Qb(6,"actions",3),g.Qb(7,"action-button",4),g.Xb("action",(function(){return t.submit()})),g.ac(8,"async"),g.Pb(),g.Bc(9,Ed,1,0,"ng-template",null,5,g.Cc),g.Qb(11,"action-button",6),g.Xb("action",(function(){return t.modalRef.hide()})),g.Pb(),g.Pb(),g.Pb()),2&e&&(g.xb(1),g.Ec(t.i18n.token.title.assign),g.xb(1),g.gc("formGroup",t.form),g.xb(1),g.gc("label",t.i18n.general.user),g.xb(1),g.gc("ngIf",(null==(i=g.bc(5,7,t.operators$))?null:i.length)>0),g.xb(3),g.gc("label",t.i18n.general.submit)("disabled",g.bc(8,9,t.requesting$)),g.xb(4),g.gc("label",t.i18n.general.cancel))},directives:[h.H,h.v,h.n,Be.a,h.C,h.u,h.l,p.t,x.a,y.a,Le.a,p.s,Ne.a],pipes:[p.b],encapsulation:2,changeDetection:0}),e})();var Cd=i("3LNl");function Od(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Lb(1,"user-link",8),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.user),g.xb(1),g.gc("user",null!=e.data.user&&e.data.user.user?e.data.user.user:e.data.user)}}function Sd(e,t){if(1&e&&(g.Qb(0,"label-value",7),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.operator),g.xb(1),g.Fc(" ",e.data.user.display," ")}}function Dd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.creationDate),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.creationDate)," ")}}function Qd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.document.category),g.xb(1),g.Fc(" ",g.bc(2,2,e.data.activationDate)," ")}}function Fd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.general.status),g.xb(1),g.Fc(" ",e.statusDisplay(e.data.status)," ")}}function wd(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.token.activationDeadline),g.xb(1),g.Fc(" ",e.data.activationDeadline?g.bc(2,2,e.data.activationDeadline):e.i18n.token.noDeadline," ")}}function Ld(e,t){if(1&e&&(g.Qb(0,"label-value",5),g.Dc(1),g.ac(2,"date"),g.Pb()),2&e){const e=g.Zb(2);g.gc("label",e.i18n.token.expiryDate),g.xb(1),g.Fc(" ",e.data.expiryDate?g.bc(2,2,e.data.expiryDate):e.i18n.token.noExpiryDate," ")}}function Nd(e,t){1&e&&(g.Lb(0,"img",12),g.ac(1,"trust")),2&e&&g.gc("src",g.cc(1,1,t.ngIf,"url"),g.uc)}function Bd(e,t){if(1&e&&(g.Qb(0,"div"),g.Lb(1,"hr",9),g.Qb(2,"div",10),g.Bc(3,Nd,2,4,"img",11),g.ac(4,"async"),g.Pb(),g.Pb()),2&e){const e=g.Zb(2);g.xb(3),g.gc("ngIf",g.bc(4,1,e.qrCodeUrl$))}}function kd(e,t){if(1&e&&(g.Ob(0),g.Qb(1,"div",3),g.Bc(2,Od,2,2,"label-value",4),g.Bc(3,Sd,2,2,"label-value",4),g.Qb(4,"label-value",5),g.Dc(5),g.Pb(),g.Bc(6,Dd,3,4,"label-value",6),g.Bc(7,Qd,3,4,"label-value",6),g.Bc(8,Fd,2,2,"label-value",6),g.Bc(9,wd,3,4,"label-value",6),g.Bc(10,Ld,3,4,"label-value",6),g.Bc(11,Bd,5,3,"div",2),g.Pb(),g.Nb()),2&e){const e=g.Zb();g.xb(2),g.gc("ngIf",e.showUser()),g.xb(1),g.gc("ngIf",null==e.data.user?null:e.data.user.user),g.xb(1),g.gc("label",e.valueLabel()),g.xb(1),g.Fc(" ",e.data.value," "),g.xb(1),g.gc("ngIf",e.data.creationDate),g.xb(1),g.gc("ngIf",e.data.activationDate),g.xb(1),g.gc("ngIf",e.data.status),g.xb(1),g.gc("ngIf",e.showDeadLine()),g.xb(1),g.gc("ngIf",e.showExpiryDate()),g.xb(1),g.gc("ngIf",e.isQrCode(e.data))}}const Rd=[{path:"",children:[{path:"search",component:Ru},{path:"brokerings",component:Ru,canActivate:[o.a]},{path:":user/brokerings",component:Ru,canActivate:[o.a]},{path:":user/brokers",component:rt,canActivate:[o.a]},{path:":user/brokers/history",component:mt,canActivate:[o.a]},{path:":user/brokers/new",component:qe,canActivate:[o.a]},{path:":user/profile",component:_c.b,resolve:{countries:s.a}},{path:":user/profile/edit",component:Tc,canActivate:[o.a],resolve:{countries:s.a}},{path:"operators",component:Zs,canActivate:[o.a]},{path:":user/operators",component:Zs,canActivate:[o.a]},{path:":user/operators/registration",component:ss,canActivate:[o.a]},{path:"operators/:user",component:_c.b,canActivate:[o.a]},{path:"operators/:user/edit",component:Tc,canActivate:[o.a]},{path:":user/status",component:ju,canActivate:[o.a]},{path:":user/status/history",component:Gu,canActivate:[o.a]},{path:":user/group",component:Ti,canActivate:[o.a]},{path:":user/group/history",component:Ni,canActivate:[o.a]},{path:":user/agreements",component:De,canActivate:[o.a]},{path:":user/agreements/history",component:le,canActivate:[o.a]},{path:"operator-groups",component:Nn,canActivate:[o.a]},{path:":user/operator-groups",component:Nn,canActivate:[o.a]},{path:":user/operator-groups/new",component:aa,canActivate:[o.a]},{path:"operator-groups/:id",component:Ra,canActivate:[o.a]},{path:"operator-groups/:id/edit",component:aa,canActivate:[o.a]},{path:"contacts",component:su,canActivate:[o.a]},{path:"contacts/:user",component:_c.b,canActivate:[o.a],resolve:{countries:s.a}},{path:":user/passwords",component:so,canActivate:[o.a]},{path:":user/identity-providers",component:en,canActivate:[o.a]},{path:"registration",component:Vb,resolve:{countries:s.a}},{path:"validate-registration/:key",component:zb},{path:"connected",component:Qt},{path:"alerts",component:_e},{path:"validate-email-change/:key",component:Mc},{path:":user/notification-settings",component:On,canActivate:[o.a]},{path:"documents",component:jt,canActivate:[o.a]},{path:":user/documents/search",component:pi,canActivate:[o.a]},{path:"documents/edit/:id",component:Mt,canActivate:[o.a]},{path:"documents/view/:id",component:Ci,canActivate:[o.a]},{path:":user/documents/new",component:Mt,canActivate:[o.a]},{path:"documents/process-dynamic/:id",component:ii,canActivate:[o.a]},{path:":user/tokens/:type",component:dd,canActivate:[o.a]},{path:"tokens/search/:type",component:yd,canActivate:[o.a]},{path:"tokens/view/:id",component:(()=>{class e extends M.a{constructor(e,t,i,n,a){super(e),this.userHelper=t,this.modal=i,this.tokenHelper=n,this.tokenService=a,this.qrCodeUrl$=new wt.a(null)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.tokenService.viewToken({id:this.id}).subscribe(e=>this.data=e))}isQrCode(e){return e.type.physicalType===$e.fb.QR_CODE}onDataInitialized(e){this.isQrCode(e)&&this.getTokenQrCodeUrl();const t=[];e.assign&&t.push(new be.c(ue.a.PersonPlus,this.i18n.token.action.assign,()=>{e.status===$e.Ab.UNASSIGNED&&this.modal.show(Ad,{class:"modal-form",initialState:{token:this.id,updateAction:()=>this.reload()}})})),e.setActivationDeadline&&t.push(new be.c(ue.a.CalendarEvent,this.i18n.token.action.changeDeadline,()=>{this.notification.confirm({title:this.i18n.token.action.changeDeadline,customFields:[{internalName:"deadline",name:this.i18n.token.activationDeadline,type:$e.o.DATE,required:!0}],callback:e=>this.tokenService.setTokenActivationDeadline({id:this.id,date:e.customValues.deadline}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.deadlineChanged))})})),e.setExpiryDate&&t.push(new be.c(ue.a.CalendarEvent,this.i18n.token.action.changeExpiry,()=>{this.notification.confirm({title:this.i18n.token.action.changeExpiry,customFields:[{internalName:"expiry",name:this.i18n.token.expiryDate,type:$e.o.DATE,required:!0}],callback:e=>this.tokenService.setTokenExpiryDate({id:this.id,date:e.customValues.expiry}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.expiryChanged))})})),e.block&&t.push(new be.c(ue.a.Lock,this.i18n.token.action.block,()=>{this.tokenService.blockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.blocked))})),e.unblock&&t.push(new be.c(ue.a.Unlock,this.i18n.token.action.unblock,()=>{this.tokenService.unblockToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.unblocked))})),e.activate&&t.push(new be.c(this.tokenHelper.icon(e.type),this.i18n.token.action.activate,()=>{this.tokenService.activatePendingToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.activated))})),e.cancel&&t.push(new be.c(ue.a.XCircle,this.i18n.token.action.cancel,()=>{this.notification.confirm({title:this.i18n.token.action.cancel,message:this.i18n.token.action.message.cancel,callback:()=>this.tokenService.cancelToken({id:this.id}).subscribe(()=>this.notifyDoneAndReload(this.i18n.token.action.done.canceled))})})),this.headingActions=t}notifyDoneAndReload(e){this.notification.snackBar(e),this.reload()}getTokenQrCodeUrl(){this.addSub(this.tokenService.getTokenQrCode({id:this.id,size:$e.I.MEDIUM}).subscribe(e=>this.qrCodeUrl$.next(URL.createObjectURL(e))))}statusDisplay(e){return this.userHelper.tokenStatus(e)}showUser(){var e;return!(this.authHelper.isSelf(this.data.user)||(null===(e=this.data.user)||void 0===e?void 0:e.user)&&this.authHelper.isSelf(this.data.user.user))}valueLabel(){return this.data.type.physicalType===$e.fb.NFC_TAG?this.i18n.token.label:this.i18n.token.value}showDeadLine(){return this.data.status===$e.Ab.ACTIVATION_EXPIRED||this.data.status===$e.Ab.PENDING}showExpiryDate(){return[$e.Ab.ACTIVE,$e.Ab.BLOCKED,$e.Ab.CANCELED,$e.Ab.EXPIRED].includes(this.data.status)}resolveMenu(e){return this.dataForFrontendHolder.role===$e.pb.ADMINISTRATOR?new u.a(u.b.USER_TOKENS,{tokenType:e.type}):this.authHelper.isSelf(e.user)?new u.a(u.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?u.b.MY_OPERATORS:this.dataForFrontendHolder.role===$e.pb.BROKER?u.b.MY_BROKERED_USERS:u.b.SEARCH_USERS}}return e.\u0275fac=function(t){return new(t||e)(g.Kb(g.r),g.Kb(T.a),g.Kb(_.b),g.Kb(Cd.a),g.Kb(zu.a))},e.\u0275cmp=g.Eb({type:e,selectors:[["view-token"]],features:[g.ub],decls:5,vars:9,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){1&e&&(g.Qb(0,"page-layout",0),g.ac(1,"async"),g.Qb(2,"page-content",1),g.ac(3,"async"),g.Bc(4,kd,12,10,"ng-container",2),g.Pb(),g.Pb()),2&e&&(g.gc("ready",g.bc(1,5,t.data$)),g.xb(2),g.gc("heading",t.i18n.token.title.view(null==t.data?null:t.data.type.name))("mobileHeading",t.i18n.token.mobileTitle.view(null==t.data?null:t.data.type.name))("headingActions",g.bc(3,7,t.headingActions$)),g.xb(2),g.gc("ngIf",t.data))},directives:[f.a,m.a,p.t,Q.a,Lt.a],pipes:[p.b,K.a,Wt.a],encapsulation:2,changeDetection:0}),e})(),canActivate:[o.a]},{path:":user/product-assignment",component:Eo,canActivate:[o.a]},{path:":user/product-assignment/history",component:Qo,canActivate:[o.a]},{path:":user/privacy-settings",component:k,canActivate:[o.a]},{path:":user/privacy-settings/edit",component:D,canActivate:[o.a]},{path:":user/references/search",component:cl,canActivate:[o.a]},{path:"references/view/:id",component:gl,canActivate:[o.a]},{path:"references/set/:from/:to",component:ul,canActivate:[o.a]},{path:"references/edit/:id",component:ul,canActivate:[o.a]}]}];let Td=(()=>{class e{}return e.\u0275mod=g.Ib({type:e}),e.\u0275inj=g.Hb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(Rd)],a.i]}),e})(),Zd=(()=>{class e{}return e.\u0275mod=g.Ib({type:e}),e.\u0275inj=g.Hb({factory:function(t){return new(t||e)},imports:[[Td,n.a]]}),e})()}}]);